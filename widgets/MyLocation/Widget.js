// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/layers/GraphicsLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/promiseUtils ../core/accessorSupport/decorators ./Layer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),function(p,t,g,a,r,h,e,m,k,n,l,f,u){return function(q){function c(b){b=q.call(this)||this;
b.elevationInfo=null;b.graphics=new f.default;b.screenSizePerspectiveEnabled=!0;b.type="graphics";return b}g(c,q);c.prototype.destroy=function(){this.removeAll()};c.prototype.add=function(b){this.graphics.add(b);return this};c.prototype.addMany=function(b){this.graphics.addMany(b);return this};c.prototype.removeAll=function(){this.graphics.removeAll();return this};c.prototype.remove=function(b){this.graphics.remove(b)};c.prototype.removeMany=function(b){this.graphics.removeMany(b)};c.prototype.importLayerViewModule=
function(b){return e(this,void 0,void 0,function(){return h(this,function(c){switch(b.type){case "2d":return[2,m.create(function(b){return p(["../views/2d/layers/GraphicsLayerView2D"],b)})];case "3d":return[2,m.create(function(b){return p(["../views/3d/layers/GraphicsLayerView3D"],b)})]}return[2]})})};c.prototype.graphicChanged=function(b){this.emit("graphic-update",b)};a([k.property({type:u})],c.prototype,"elevationInfo",void 0);a([k.property(f.graphicsCollectionProperty)],c.prototype,"graphics",
void 0);a([k.property({type:["show","hide"]})],c.prototype,"listMode",void 0);a([k.property()],c.prototype,"screenSizePerspectiveEnabled",void 0);a([k.property({readOnly:!0})],c.prototype,"type",void 0);return c=a([k.subclass("esri.layers.GraphicsLayer")],c)}(k.declared(n,l))})},"esri/widgets/Locate":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!../nls/common dojo/i18n!./Locate/nls/Locate ../core/accessorSupport/decorators ./Widget ./Locate/LocateViewModel ./support/widget".split(" "),
function(p,t,g,a,r,h,e,m,k,n){return function(l){function f(a){a=l.call(this)||this;a.geolocationOptions=null;a.goToLocationEnabled=null;a.goToOverride=null;a.graphic=null;a.iconClass="esri-icon-north-navigation";a.label=h.widgetLabel;a.scale=null;a.useHeadingEnabled=null;a.view=null;a.viewModel=new k;return a}g(f,l);f.prototype.cancelLocate=function(){};f.prototype.locate=function(){};f.prototype.render=function(){var a,e,c=this.get("viewModel.state"),b="locating"===c,v=(a={},a["esri-disabled"]=
"disabled"===c,a["esri-hidden"]="feature-unsupported"===c,a);a=(e={},e["esri-icon-loading-indicator"]=b,e["esri-rotating"]=b,e["esri-icon-locate"]=!b,e);e="locating"===c?r.cancel:h.title;return n.tsx("div",{bind:this,class:this.classes("esri-locate esri-widget--button esri-widget",v),hidden:"feature-unsupported"===c,onclick:this._locate,onkeydown:this._locate,role:"button",tabIndex:0,"aria-label":e,title:e},n.tsx("span",{"aria-hidden":"true",class:this.classes("esri-icon",a)}),n.tsx("span",{class:"esri-icon-font-fallback-text"},
h.title))};f.prototype._locate=function(){var a=this.viewModel;"locating"===a.state?a.cancelLocate():a.locate()};a([e.aliasOf("viewModel.geolocationOptions")],f.prototype,"geolocationOptions",void 0);a([e.aliasOf("viewModel.goToLocationEnabled")],f.prototype,"goToLocationEnabled",void 0);a([e.aliasOf("viewModel.goToOverride")],f.prototype,"goToOverride",void 0);a([e.aliasOf("viewModel.graphic")],f.prototype,"graphic",void 0);a([e.property()],f.prototype,"iconClass",void 0);a([e.property()],f.prototype,
"label",void 0);a([e.aliasOf("viewModel.scale")],f.prototype,"scale",void 0);a([e.aliasOf("viewModel.useHeadingEnabled")],f.prototype,"useHeadingEnabled",void 0);a([e.aliasOf("viewModel.view")],f.prototype,"view",void 0);a([e.property({type:k}),n.renderable("viewModel.state"),n.vmEvent(["locate","locate-error"])],f.prototype,"viewModel",void 0);a([e.aliasOf("viewModel.cancelLocate")],f.prototype,"cancelLocate",null);a([e.aliasOf("viewModel.locate")],f.prototype,"locate",null);a([n.accessibleHandler()],
f.prototype,"_locate",null);return f=a([e.subclass("esri.widgets.Locate")],f)}(e.declared(m))})},"esri/widgets/Locate/LocateViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper dojo/i18n!./nls/Locate ../../PopupTemplate ../../core/Error ../../core/geolocationUtils ../../core/Handles ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../Popup/actions ../support/GeolocationPositioning".split(" "),
function(p,t,g,a,r,h,e,m,k,n,l,f,u,q,c,b){var v={title:e.currentLocation,fieldInfos:[{fieldName:"timestamp",label:e.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:e.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:e.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:e.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:e.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",
label:e.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:e.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:e.speed,format:{places:0,digitSeparator:!0}}],actions:[c.removeSelectedFeature.clone()],content:[{type:"fields"}]};return function(b){function d(a){var d=b.call(this,a)||this;d._locateController=null;d._handles=new l;d.locate=d.locate.bind(d);d.graphic&&(d.graphic.popupTemplate=new m(v));d._handles.add(u.on(d,"view.popup","trigger-action",
function(b){return c.triggerAction({event:b,view:d.view})}));return d}g(d,b);d.prototype.destroy=function(){this.cancelLocate();this._handles.destroy();this._handles=null};Object.defineProperty(d.prototype,"state",{get:function(){return this._geolocationUsable?this.get("view.ready")?this._locateController?"locating":"ready":"disabled":"feature-unsupported"},enumerable:!0,configurable:!0});d.prototype.locate=function(){return h(this,void 0,void 0,function(){var b,d,a=this;return r(this,function(c){switch(c.label){case 0:this.cancelLocate();
if("disabled"===this.state)throw new k("locate:disabled-state","Cannot locate when disabled.");if("feature-unsupported"===this.state)throw new k("locate:feature-unsupported-state","Cannot locate in unsecure domain.");this._locateController=b=f.createAbortController();c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n.getCurrentPosition(this.geolocationOptions).then(function(d){return a._setPosition(d,{signal:b.signal})}).then(function(b){a.view.graphics.remove(a.graphic);a.graphic&&(a.graphic=a.graphic.clone(),
a.view.graphics.push(a.graphic));a.emit("locate",{position:b});a._locateController=null;return b})];case 2:return[2,c.sent()];case 3:return d=c.sent(),this._locateController=null,this.emit("locate-error",{error:d}),[3,4];case 4:return[2]}})})};d.prototype.cancelLocate=function(){this._locateController&&this._locateController.abort();this._locateController=null};a([q.property()],d.prototype,"_locateController",void 0);a([q.property({dependsOn:["view.ready","_locateController","_geolocationUsable"],
readOnly:!0})],d.prototype,"state",null);a([q.property()],d.prototype,"locate",null);a([q.property()],d.prototype,"cancelLocate",null);return d=a([q.subclass("esri.widgets.Locate.LocateViewModel")],d)}(q.declared(b))})},"esri/core/geolocationUtils":function(){define("require exports ./tsSupport/assignHelper ../config ./Error ./has ./Logger ./promiseUtils ../geometry/Point ../geometry/support/webMercatorUtils ../portal/Portal ../tasks/GeometryService ../tasks/support/ProjectParameters".split(" "),
function(p,t,g,a,r,h,e,m,k,n,l,f,u){function q(b,a,e){if(!a)return m.resolve(b);var d=a.spatialReference;return d.isWGS84?m.resolve(b):d.isWebMercator?m.resolve(n.geographicToWebMercator(b)):c(e).then(function(a){if(!a)return m.reject(new r("geometry-service:missing-url","Geometry service URL is missing"));a=new f({url:a});var c=new u({geometries:[b],outSR:d});return a.project(c,e).then(function(b){return b[0]})})}function c(b){if(a.geometryServiceUrl)return m.resolve(a.geometryServiceUrl);var d=
l.getDefault();return d.load(b).catch(function(){}).then(function(){return d.get("helperServices.geometry.url")})}Object.defineProperty(t,"__esModule",{value:!0});var b=e.getLogger("esri.core.geolocationUtils"),v={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};t.supported=function(){var a=h("esri-geolocation");a||b.warn("geolocation-unsupported","Geolocation unsupported.");a&&((a=h("esri-secure-context"))||b.warn("insecure-context","Geolocation requires a secure origin."));return a};t.getCurrentPosition=
function(b){b||(b=v);return m.create(function(a,d){setTimeout(d,15E3);navigator.geolocation.getCurrentPosition(a,d,b)})};t.positionToPoint=function(b,a){var d=b.position;b=b.view;var c=d&&d.coords||{},c={accuracy:c.accuracy,altitude:c.altitude,altitudeAccuracy:c.altitudeAccuracy,heading:c.heading,latitude:c.latitude,longitude:c.longitude,speed:c.speed},d=d?{coords:c,timestamp:d.timestamp}:d;d=(d=d&&d.coords)?new k({longitude:d.longitude,latitude:d.latitude,z:d.altitude||null,spatialReference:{wkid:4326}}):
null;return q(d,b,a)}})},"esri/widgets/support/GeolocationPositioning":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Graphic ../../core/Accessor ../../core/Error ../../core/Evented ../../core/geolocationUtils ../../core/promiseUtils ../../core/accessorSupport/decorators ../../symbols/PictureMarkerSymbol ./GoTo".split(" "),function(p,t,g,a,r,h,e,m,k,n,l,f,u){return function(h){function c(){var b=null!==h&&h.apply(this,arguments)||
this;b._geolocationUsable=!0;b._iconPath=p.toUrl("../../images/support/sdk_gps_location.png");b.geolocationOptions=null;b.goToLocationEnabled=!0;b.graphic=new r({symbol:new f({url:b._iconPath,width:21,height:21})});b.scale=null;b.useHeadingEnabled=!0;b.view=null;return b}g(c,h);c.prototype.initialize=function(){k.supported()||(this._geolocationUsable=!1)};c.prototype.destroy=function(){this._clear();this.view=null};c.prototype._clear=function(){this.view&&this.view.graphics.remove(this.graphic)};
c.prototype._getScaleWithinConstraints=function(b,a){return a?"2d"===a.type?(a=a.constraints,Math.min(a.effectiveMinScale,Math.max(a.effectiveMaxScale,b))):b:b};c.prototype._getScale=function(b){var a=this.scale;return this._getScaleWithinConstraints("number"===typeof a?a:2500,b)};c.prototype._getHeading=function(a,c){c=c.spatialReference;a=a.coords&&a.coords.heading;if(!(!c||!c.isWebMercator&&!c.isGeographic||"number"!==typeof a||isNaN(a)||0>a||360<a))return a};c.prototype._addHeading=function(a){var b=
a.heading,d=a.target;(a=a.view)&&"number"===typeof b&&!isNaN(b)&&("3d"===a.type?d.heading=b:"2d"===a.type&&(d.rotation=360-b))};c.prototype._animatePoint=function(a,c,d,e){if(!this.goToLocationEnabled)return n.resolve(c);var b=this.view,f=this.useHeadingEnabled?this._getHeading(c,b):void 0;a={target:a,scale:d};this._addHeading({heading:f,target:a,view:b});return this.callGoTo({target:a,options:e}).then(function(){return c})};c.prototype._setPosition=function(a,c){var b=this;return k.positionToPoint({position:a,
view:this.view},c).then(function(d){var e=b.graphic,f=a.coords,f={timestamp:a.timestamp,accuracy:f.accuracy,altitude:f.altitude,altitudeAccuracy:f.altitudeAccuracy,heading:f.heading,latitude:f.latitude,longitude:f.longitude,speed:f.speed};e&&(e.geometry=d,e.attributes=f);e=b._getScale(b.view);return b._animatePoint(d,a,e,c)}).catch(function(){return n.reject(new e("positioning:invalid-point","Cannot position invalid point"))})};a([l.property()],c.prototype,"_geolocationUsable",void 0);a([l.property()],
c.prototype,"geolocationOptions",void 0);a([l.property()],c.prototype,"goToLocationEnabled",void 0);a([l.property()],c.prototype,"graphic",void 0);a([l.property()],c.prototype,"scale",void 0);a([l.property()],c.prototype,"useHeadingEnabled",void 0);a([l.property()],c.prototype,"view",void 0);return c=a([l.subclass("esri.widgets.support.GeolocationPositioning")],c)}(l.declared(h,m,u))})},"widgets/MyLocation/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings"],
function(){})},"url:widgets/MyLocation/css/style.css":'.jimu-widget-mylocation {background-color: #fff; opacity: 0.8; color: rgba(0, 0, 0, 0.8);}.jimu-widget-mylocation:hover {opacity: 1;}.jimu-widget-mylocation.nohttps:hover{opacity: 0.8;}.jimu-widget-mylocation.onCenter {background-color: #000;}.jimu-widget-mylocation .esri-locate-node {display: none;}.jimu-widget-mylocation .place-holder {width: 32px; height: 32px; background-color: #666; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: pointer; border: 1px solid rgba(0, 0, 0, 0.3); text-align: center; line-height: 30px; font-size: 14px; background-position: center center; background-repeat: no-repeat;}.jimu-widget-mylocation .place-holder:before {font-family: \'Themefont\'; content: "\\a907";}.jimu-widget-mylocation .place-holder.locating:before {content: "";}.jimu-widget-mylocation .place-holder.locating {background-image: url("images/loading_black.gif"); background-repeat: no-repeat; background-position: center;}.jimu-widget-mylocation .place-holder.nohttps{color: #bcbcbc;}.jimu-widget-mylocation .place-holder.tracking:before {content: "\\a913" !important; color: rgba(255, 255, 255, 0.8);}.jimu-widget-mylocation .place-holder {background-color: rgba(0, 0, 0, 0);}.jimu-widget-mylocation.onCenter .place-holder {color: #fff;}.jimu-widget-mylocation.onLocate .place-holder {background-color: rgba(0, 0, 0, 0.4);}',
"*now":function(p){p(['dojo/i18n!*preload*widgets/MyLocation/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidget dojo/_base/html dojo/on dojo/when dojo/_base/lang esri/layers/GraphicsLayer esri/widgets/Locate esri/widgets/Locate/LocateViewModel esri/symbols/PictureMarkerSymbol esri/geometry/Point esri/geometry/SpatialReference esri/geometry/support/webMercatorUtils esri/tasks/support/ProjectParameters esri/Graphic esri/config jimu/utils".split(" "),function(p,t,g,a,r,h,e,m,k,n,l,f,u,q,c,b,v){p=p([t],{name:"MyLocation",baseClass:"jimu-widget-mylocation",startup:function(){this.inherited(arguments);
this.placehoder=g.create("div",{"class":"place-holder",title:this.label},this.domNode);this.isNeedHttpsButNot=v.isNeedHttpsButNot();!0===this.isNeedHttpsButNot?(console.log("LocateButton::navigator.geolocation requires a secure origin."),g.addClass(this.domNode,"nohttps"),g.addClass(this.placehoder,"nohttps"),g.setAttr(this.placehoder,"title",this.nls.httpNotSupportError)):window.navigator.geolocation?this.own(a(this.placehoder,"click",h.hitch(this,this.onLocationClick))):g.setAttr(this.placehoder,
"title",this.nls.browserError)},onLocationClick:function(){g.hasClass(this.domNode,"onCenter")||g.hasClass(this.domNode,"locating")?(g.removeClass(this.domNode,"onCenter"),g.removeClass(this.placehoder,"tracking"),this._destroyGeoLocate()):(this._createGeoLocate(),this.geoLocate.viewModel.locate(),g.addClass(this.placehoder,"locating"))},onLocate:function(a){g.removeClass(this.placehoder,"locating");this.graphicsLayer.removeAll();this.geoLocate.viewModel.tracking&&g.addClass(this.placehoder,"tracking");
if(a.error)this.onLocateError(a.error);else g.addClass(this.domNode,"onCenter"),this.neverLocate=!1,this._pointMarkerManualy(a)},onLocateError:function(a){console.error(a.error);g.removeClass(this.placehoder,"locating");g.removeClass(this.domNode,"onCenter");g.removeClass(this.placehoder,"tracking")},_createGeoLocate:function(){var b=this.config.locateButton,c={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};b.geolocationOptions&&h.mixin(c,b.geolocationOptions);this.graphicsLayer=new e;this.sceneView.map.add(this.graphicsLayer);
var f=g.create("div",{"class":"esri-locate-node"},this.domNode);this.geoLocate=new m({viewModel:new k({view:this.sceneView,graphicsLayer:this.graphicsLayer,geolocationOptions:c,locationSymbolEnabled:b.highlightLocation,scale:b.scale,tracking:b.useTracking,clearOnTrackingStopEnabled:!1}),container:f,visible:!1});this.geoLocate.startup();this.geoLocate.own(a(this.geoLocate.viewModel,"locate",h.hitch(this,this.onLocate)));this.geoLocate.own(a(this.geoLocate.viewModel,"locate-error",h.hitch(this,this.onLocateError)))},
_destroyGeoLocate:function(){this.graphicsLayer&&(this.graphicsLayer.removeAll(),this.sceneView.map.remove(this.graphicsLayer));this.geoLocate&&(this.geoLocate.viewModel.graphicsLayer.removeAll(),this.geoLocate.destroy());this.geoLocate=null},destroy:function(){this._destroyGeoLocate();this.inherited(arguments)},_pointMarkerManualy:function(a){"undefined"!==typeof this.config.locateButton.highlightLocation&&!1!==this.config.locateButton.highlightLocation&&(this.highlightSymbol=new n({url:this.folderUrl+
"css/images/sdk_gps_location.png",size:28,width:28,height:28,xoffset:14,yoffset:14}),a=new l({longitude:a.position.coords.longitude,latitude:a.position.coords.latitude,spatialReference:new f({wkid:4326})}),this._project(a).then(h.hitch(this,function(a){a=new c({geometry:a[0],symbol:this.highlightSymbol});this.config.locateButton.highlightLocation&&this.graphicsLayer.add(a)}),h.hitch(this,function(a){this.onLocateError(a)})))},_project:function(a){var c=this.sceneView.spatialReference;if(a.spatialReference.equals(c))return r([a]);
if(u.canProject(a,c))return r([u.project(a,c)]);var d=new q;d.geometries=[a];d.outSR=c;return b.geometryService.project(d)}});p.inPanel=!1;p.hasUIFile=!1;return p});