// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/layers/GraphicsLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/promiseUtils ../core/accessorSupport/decorators ./Layer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),function(q,u,h,a,t,m,b,k,n,p,v,e,l){return function(r){function f(a){a=r.call(this)||this;
a.elevationInfo=null;a.graphics=new e.default;a.screenSizePerspectiveEnabled=!0;a.type="graphics";return a}h(f,r);f.prototype.destroy=function(){this.removeAll()};f.prototype.add=function(a){this.graphics.add(a);return this};f.prototype.addMany=function(a){this.graphics.addMany(a);return this};f.prototype.removeAll=function(){this.graphics.removeAll();return this};f.prototype.remove=function(a){this.graphics.remove(a)};f.prototype.removeMany=function(a){this.graphics.removeMany(a)};f.prototype.on=
function(a,l){return this.inherited(arguments)};f.prototype.importLayerViewModule=function(a){return b(this,void 0,void 0,function(){return m(this,function(l){switch(a.type){case "2d":return[2,k.create(function(d){return q(["../views/2d/layers/GraphicsLayerView2D"],d)})];case "3d":return[2,k.create(function(d){return q(["../views/3d/layers/GraphicsLayerView3D"],d)})]}return[2]})})};f.prototype.graphicChanged=function(a){this.emit("graphic-update",a)};a([n.property({type:l})],f.prototype,"elevationInfo",
void 0);a([n.property(e.graphicsCollectionProperty)],f.prototype,"graphics",void 0);a([n.property({type:["show","hide"]})],f.prototype,"listMode",void 0);a([n.property()],f.prototype,"screenSizePerspectiveEnabled",void 0);a([n.property({readOnly:!0})],f.prototype,"type",void 0);return f=a([n.subclass("esri.layers.GraphicsLayer")],f)}(n.declared(v.ScaleRangeLayer(p)))})},"esri/widgets/Locate":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!../nls/common dojo/i18n!./Locate/nls/Locate ../core/accessorSupport/decorators ./Widget ./Locate/LocateViewModel ./support/widget".split(" "),
function(q,u,h,a,t,m,b,k,n,p){return function(k){function e(a){a=k.call(this)||this;a.geolocationOptions=null;a.goToLocationEnabled=null;a.goToOverride=null;a.graphic=null;a.iconClass="esri-icon-north-navigation";a.label=m.widgetLabel;a.scale=null;a.useHeadingEnabled=null;a.view=null;a.viewModel=new n;return a}h(e,k);e.prototype.cancelLocate=function(){};e.prototype.locate=function(){};e.prototype.render=function(){var a,b,f=this.get("viewModel.state"),e="locating"===f,g=(a={},a["esri-disabled"]=
"disabled"===f,a["esri-hidden"]="feature-unsupported"===f,a);a=(b={},b["esri-icon-loading-indicator"]=e,b["esri-rotating"]=e,b["esri-icon-locate"]=!e,b);b="locating"===f?t.cancel:m.title;return p.tsx("div",{bind:this,class:this.classes("esri-locate esri-widget--button esri-widget",g),hidden:"feature-unsupported"===f,onclick:this._locate,onkeydown:this._locate,role:"button",tabIndex:0,"aria-label":b,title:b},p.tsx("span",{"aria-hidden":"true",class:this.classes("esri-icon",a)}),p.tsx("span",{class:"esri-icon-font-fallback-text"},
m.title))};e.prototype._locate=function(){var a=this.viewModel;"locating"===a.state?a.cancelLocate():a.locate()};a([b.aliasOf("viewModel.geolocationOptions")],e.prototype,"geolocationOptions",void 0);a([b.aliasOf("viewModel.goToLocationEnabled")],e.prototype,"goToLocationEnabled",void 0);a([b.aliasOf("viewModel.goToOverride")],e.prototype,"goToOverride",void 0);a([b.aliasOf("viewModel.graphic")],e.prototype,"graphic",void 0);a([b.property()],e.prototype,"iconClass",void 0);a([b.property()],e.prototype,
"label",void 0);a([b.aliasOf("viewModel.scale")],e.prototype,"scale",void 0);a([b.aliasOf("viewModel.useHeadingEnabled")],e.prototype,"useHeadingEnabled",void 0);a([b.aliasOf("viewModel.view")],e.prototype,"view",void 0);a([b.property({type:n}),p.renderable("viewModel.state"),p.vmEvent(["locate","locate-error"])],e.prototype,"viewModel",void 0);a([b.aliasOf("viewModel.cancelLocate")],e.prototype,"cancelLocate",null);a([b.aliasOf("viewModel.locate")],e.prototype,"locate",null);a([p.accessibleHandler()],
e.prototype,"_locate",null);return e=a([b.subclass("esri.widgets.Locate")],e)}(b.declared(k))})},"esri/widgets/Locate/LocateViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper dojo/i18n!./nls/Locate ../../PopupTemplate ../../core/Error ../../core/geolocationUtils ../../core/Handles ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../Popup/actions ../support/GeolocationPositioning".split(" "),
function(q,u,h,a,t,m,b,k,n,p,v,e,l,r,f,w){var g={title:b.currentLocation,fieldInfos:[{fieldName:"timestamp",label:b.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:b.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:b.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:b.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:b.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",
label:b.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:b.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:b.speed,format:{places:0,digitSeparator:!0}}],actions:[f.removeSelectedFeature.clone()],content:[{type:"fields"}]};return function(d){function c(a){var c=d.call(this,a)||this;c._locateController=null;c._handles=new v;c.locate=c.locate.bind(c);c.graphic&&(c.graphic.popupTemplate=new k(g));c._handles.add(l.on(c,"view.popup","trigger-action",
function(d){return f.triggerAction({event:d,view:c.view})}));return c}h(c,d);c.prototype.destroy=function(){this.cancelLocate();this._handles.destroy();this._handles=null};Object.defineProperty(c.prototype,"state",{get:function(){return this._geolocationUsable?this.get("view.ready")?this._locateController?"locating":"ready":"disabled":"feature-unsupported"},enumerable:!0,configurable:!0});c.prototype.locate=function(){return m(this,void 0,void 0,function(){var d,a,c;return t(this,function(b){switch(b.label){case 0:this.cancelLocate();
if("disabled"===this.state)throw new n("locate:disabled-state","Cannot locate when disabled.");if("feature-unsupported"===this.state)throw new n("locate:feature-unsupported-state","Cannot locate in unsecure domain.");this._locateController=d=e.createAbortController();b.label=1;case 1:return b.trys.push([1,4,,5]),[4,p.getCurrentPosition(this.geolocationOptions)];case 2:return a=b.sent(),[4,this._setPosition(a,{signal:d.signal})];case 3:a=b.sent();if(this._locateController!==d)return[2,null];this.graphic&&
(this.graphic=this.graphic.clone(),this.view.graphics.push(this.graphic));this.emit("locate",{position:a});this._locateController=null;return[2,a];case 4:throw c=b.sent(),this._locateController=null,this.emit("locate-error",{error:c}),c;case 5:return[2]}})})};c.prototype.cancelLocate=function(){this._clear();this._locateController&&this._locateController.abort();this._locateController=null};a([r.property()],c.prototype,"_locateController",void 0);a([r.property({dependsOn:["view.ready","_locateController",
"_geolocationUsable"],readOnly:!0})],c.prototype,"state",null);a([r.property()],c.prototype,"locate",null);a([r.property()],c.prototype,"cancelLocate",null);return c=a([r.subclass("esri.widgets.Locate.LocateViewModel")],c)}(r.declared(w))})},"esri/core/geolocationUtils":function(){define("require exports ./tsSupport/assignHelper ../config ./Error ./has ./Logger ./promiseUtils ../geometry/Point ../geometry/support/webMercatorUtils ../portal/Portal ../tasks/GeometryService ../tasks/support/ProjectParameters".split(" "),
function(q,u,h,a,t,m,b,k,n,p,v,e,l){function r(d,a,b){if(!a)return k.resolve(d);var c=a.spatialReference;return c.isWGS84?k.resolve(d):c.isWebMercator?k.resolve(p.geographicToWebMercator(d)):f(b).then(function(a){if(!a)return k.reject(new t("geometry-service:missing-url","Geometry service URL is missing"));a=new e({url:a});var f=new l({geometries:[d],outSR:c});return a.project(f,b).then(function(a){return a[0]})})}function f(d){if(a.geometryServiceUrl)return k.resolve(a.geometryServiceUrl);var c=
v.getDefault();return c.load(d).catch(function(){}).then(function(){return c.get("helperServices.geometry.url")})}Object.defineProperty(u,"__esModule",{value:!0});var w=b.getLogger("esri.core.geolocationUtils"),g={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};u.supported=function(){var a=m("esri-geolocation");a||w.warn("geolocation-unsupported","Geolocation unsupported.");a&&((a=m("esri-secure-context"))||w.warn("insecure-context","Geolocation requires a secure origin."));return a};u.getCurrentPosition=
function(a){a||(a=g);return k.create(function(d,b){setTimeout(function(){return b(new t("geolocation:timeout","getting the current geolocation position timed out"))},15E3);navigator.geolocation.getCurrentPosition(d,b,a)})};u.positionToPoint=function(a,c){var d=a.position;a=a.view;var b=d&&d.coords||{},b={accuracy:b.accuracy,altitude:b.altitude,altitudeAccuracy:b.altitudeAccuracy,heading:b.heading,latitude:b.latitude,longitude:b.longitude,speed:b.speed},d=d?{coords:b,timestamp:d.timestamp}:d;d=(d=
d&&d.coords)?new n({longitude:d.longitude,latitude:d.latitude,z:d.altitude||null,spatialReference:{wkid:4326}}):null;return r(d,a,c)}})},"esri/widgets/support/GeolocationPositioning":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Graphic ../../core/Accessor ../../core/Error ../../core/Evented ../../core/geolocationUtils ../../core/promiseUtils ../../core/accessorSupport/decorators ../../symbols/PictureMarkerSymbol ./GoTo".split(" "),
function(q,u,h,a,t,m,b,k,n,p,v,e,l,r,f){return function(f){function g(){var a=null!==f&&f.apply(this,arguments)||this;a._geolocationUsable=!0;a._iconPath=q.toUrl("../../images/support/sdk_gps_location.png");a.geolocationOptions=null;a.goToLocationEnabled=!0;a.graphic=new b({symbol:new r({url:a._iconPath,width:21,height:21})});a.scale=null;a.useHeadingEnabled=!0;a.view=null;return a}h(g,f);g.prototype.initialize=function(){v.supported()||(this._geolocationUsable=!1)};g.prototype.destroy=function(){this._clear();
this.view=null};g.prototype._clear=function(){this.view&&this.view.graphics.remove(this.graphic)};g.prototype._getScaleWithinConstraints=function(a,c){return c?"2d"===c.type?(c=c.constraints,Math.min(c.effectiveMinScale,Math.max(c.effectiveMaxScale,a))):a:a};g.prototype._getScale=function(a){var d=this.scale;return this._getScaleWithinConstraints("number"===typeof d?d:2500,a)};g.prototype._getHeading=function(a,c){c=c&&c.spatialReference;a=a.coords&&a.coords.heading;if(!(!c||!c.isWebMercator&&!c.isGeographic||
"number"!==typeof a||isNaN(a)||0>a||360<a))return a};g.prototype._addHeading=function(a){var c=a.heading,d=a.target;(a=a.view)&&"number"===typeof c&&!isNaN(c)&&("3d"===a.type?d.heading=c:"2d"===a.type&&(d.rotation=360-c))};g.prototype._animatePoint=function(a,c,b,f){var d=this.view;if(!this.goToLocationEnabled||!d)return e.resolve(c);var g=this.useHeadingEnabled?this._getHeading(c,d):void 0;a={target:a,scale:b};this._addHeading({heading:g,target:a,view:d});return this.callGoTo({target:a,options:f}).then(function(){return c})};
g.prototype._setPosition=function(a,c){return m(this,void 0,void 0,function(){var d,b,f,e,g,h,k,l,m,p,q,r,u,w;return t(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,v.positionToPoint({position:a,view:this.view},c)];case 1:return d=t.sent(),b=this.graphic,f=a.timestamp,e=a.coords,g=e.accuracy,h=e.altitude,k=e.altitudeAccuracy,l=e.heading,m=e.latitude,p=e.longitude,q=e.speed,r={timestamp:f,accuracy:g,altitude:h,altitudeAccuracy:k,heading:l,latitude:m,longitude:p,speed:q},b&&
(b.geometry=d,b.attributes=r),u=this._getScale(this.view),[2,this._animatePoint(d,a,u,c)];case 2:throw w=t.sent(),new n("positioning:invalid-point","Cannot position invalid point",{error:w});case 3:return[2]}})})};a([l.property()],g.prototype,"_geolocationUsable",void 0);a([l.property()],g.prototype,"geolocationOptions",void 0);a([l.property()],g.prototype,"goToLocationEnabled",void 0);a([l.property()],g.prototype,"graphic",void 0);a([l.property()],g.prototype,"scale",void 0);a([l.property()],g.prototype,
"useHeadingEnabled",void 0);a([l.property()],g.prototype,"view",void 0);return g=a([l.subclass("esri.widgets.support.GeolocationPositioning")],g)}(l.declared(f.GoToMixin(p.EventedMixin(k))))})},"widgets/MyLocation/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/MyLocation/css/style.css":'.jimu-widget-mylocation {background-color: #fff; opacity: 0.8; color: rgba(0, 0, 0, 0.8);}.jimu-widget-mylocation:hover {opacity: 1;}.jimu-widget-mylocation.nohttps:hover{opacity: 0.8;}.jimu-widget-mylocation.onCenter {background-color: #000;}.jimu-widget-mylocation .esri-locate-node {display: none;}.jimu-widget-mylocation .place-holder {width: 32px; height: 32px; background-color: #666; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: pointer; border: 1px solid rgba(0, 0, 0, 0.3); text-align: center; line-height: 30px; font-size: 14px; background-position: center center; background-repeat: no-repeat;}.jimu-widget-mylocation .place-holder:before {font-family: \'Themefont\'; content: "\\a907";}.jimu-widget-mylocation .place-holder.locating:before {content: "";}.jimu-widget-mylocation .place-holder.locating {background-image: url("images/loading_black.gif"); background-repeat: no-repeat; background-position: center;}.jimu-widget-mylocation .place-holder.nohttps{color: #bcbcbc;}.jimu-widget-mylocation .place-holder.tracking:before {content: "\\a913" !important; color: rgba(255, 255, 255, 0.8);}.jimu-widget-mylocation .place-holder {background-color: rgba(0, 0, 0, 0);}.jimu-widget-mylocation.onCenter .place-holder {color: #fff;}.jimu-widget-mylocation.onLocate .place-holder {background-color: rgba(0, 0, 0, 0.4);}',
"*now":function(q){q(['dojo/i18n!*preload*widgets/MyLocation/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidget dojo/_base/html dojo/on dojo/when dojo/_base/lang esri/layers/GraphicsLayer esri/widgets/Locate esri/widgets/Locate/LocateViewModel esri/symbols/PictureMarkerSymbol esri/geometry/Point esri/geometry/SpatialReference esri/geometry/support/webMercatorUtils esri/tasks/support/ProjectParameters esri/Graphic esri/config jimu/utils".split(" "),function(q,u,h,a,t,m,b,k,n,p,v,e,l,r,f,w,g){q=q([u],{name:"MyLocation",baseClass:"jimu-widget-mylocation",startup:function(){this.inherited(arguments);
this.placehoder=h.create("div",{"class":"place-holder",title:this.label},this.domNode);this.isNeedHttpsButNot=g.isNeedHttpsButNot();!0===this.isNeedHttpsButNot?(console.log("LocateButton::navigator.geolocation requires a secure origin."),h.addClass(this.domNode,"nohttps"),h.addClass(this.placehoder,"nohttps"),h.setAttr(this.placehoder,"title",this.nls.httpNotSupportError)):window.navigator.geolocation?this.own(a(this.placehoder,"click",m.hitch(this,this.onLocationClick))):h.setAttr(this.placehoder,
"title",this.nls.browserError)},onLocationClick:function(){h.hasClass(this.domNode,"onCenter")||h.hasClass(this.domNode,"locating")?this._destroyGeoLocate():(this._destroyGeoLocate(),this._createGeoLocateAndLocate())},_createGeoLocateAndLocate:function(){this.getGeoLocateInstance();this.geoLocate.viewModel.locate();h.addClass(this.placehoder,"locating")},getGeoLocateInstance:function(){var d=this.config.locateButton,c={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};d.geolocationOptions&&m.mixin(c,
d.geolocationOptions);this.graphicsLayer=new b;this.sceneView.map.add(this.graphicsLayer);var e=h.create("div",{"class":"esri-locate-node"},this.domNode),c={view:this.sceneView,graphicsLayer:this.graphicsLayer,geolocationOptions:c,scale:d.scale,tracking:d.useTracking,clearOnTrackingStopEnabled:!1};d.highlightLocation||(c.graphic=null);this.geoLocate=new k({viewModel:new n(c),container:e,visible:!1});this.geoLocate.own(a(this.geoLocate.viewModel,"locate",m.hitch(this,this.onLocate)));this.geoLocate.own(a(this.geoLocate.viewModel,
"locate-error",m.hitch(this,this.onLocateError)));this.geoLocate.startup();return this.geoLocate},onLocate:function(a){h.removeClass(this.placehoder,"locating");this.graphicsLayer.removeAll();this.geoLocate.viewModel.tracking&&h.addClass(this.placehoder,"tracking");if(a.error)this.onLocateError(a.error);else h.addClass(this.domNode,"onCenter"),this.neverLocate=!1},onLocateError:function(a){console.error(a.error);h.removeClass(this.placehoder,"locating");h.removeClass(this.domNode,"onCenter");h.removeClass(this.placehoder,
"tracking")},_destroyGeoLocate:function(){this.graphicsLayer&&(this.graphicsLayer.removeAll(),this.sceneView.map.remove(this.graphicsLayer));this.geoLocate&&(this.geoLocate.viewModel.cancelLocate(),this.geoLocate.viewModel.graphicsLayer.removeAll(),this.geoLocate.destroy(),this.geoLocate=null);h.removeClass(this.domNode,"onCenter");h.removeClass(this.placehoder,"tracking")},destroy:function(){this._destroyGeoLocate();this.inherited(arguments)},_pointMarkerManualy:function(a){"undefined"!==typeof this.config.locateButton.highlightLocation&&
!1!==this.config.locateButton.highlightLocation&&(this.highlightSymbol=new p({url:this.folderUrl+"css/images/sdk_gps_location.png",size:28,width:28,height:28,xoffset:14,yoffset:14}),a=new v({longitude:a.position.coords.longitude,latitude:a.position.coords.latitude,spatialReference:new e({wkid:4326})}),this._project(a).then(m.hitch(this,function(a){a=new f({geometry:a[0],symbol:this.highlightSymbol});this.config.locateButton.highlightLocation&&this.graphicsLayer.add(a)}),m.hitch(this,function(a){this.onLocateError(a)})))},
_project:function(a){var c=this.sceneView.spatialReference;if(a.spatialReference.equals(c))return t([a]);if(l.canProject(a,c))return t([l.project(a,c)]);var b=new r;b.geometries=[a];b.outSR=c;return w.geometryService.project(b)}});q.inPanel=!1;q.hasUIFile=!1;return q});