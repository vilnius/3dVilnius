// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Search":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper @dojo/framework/shim/array dojo/i18n!../nls/common dojo/i18n!./Search/nls/Search dojo/regexp ../intl ../core/events ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Search/SearchResultRenderer ./Search/SearchViewModel ./support/widget".split(" "),function(p,l,m,b,f,d,g,r,h,t,e,c,a,k,y,q,v){var B=/<[a-z/][\s\S]*>/i;return function(k){function n(a){var b=
k.call(this)||this;b._handles=new e;b._inputNode=null;b._sourceMenuButtonNode=null;b._sourceListNode=null;b._suggestionListNode=null;b._searchResultRenderer=new y;b._suggestPromise=null;b._relatedTarget=null;b.activeMenu="none";b.activeSource=null;b.activeSourceIndex=null;b.allPlaceholder=null;b.allSources=null;b.autoNavigate=null;b.autoSelect=null;b.defaultSources=null;b.goToOverride=null;b.iconClass="esri-icon-search";b.includeDefaultSources=null;b.label=g.widgetLabel;b.locationEnabled=null;b.maxResults=
null;b.maxSuggestions=null;b.minSuggestCharacters=null;b.popupEnabled=null;b.popupTemplate=null;b.portal=null;b.resultGraphic=null;b.resultGraphicEnabled=null;b.results=null;b.searchAllEnabled=null;b.searchTerm=null;b.selectedResult=null;b.sources=null;b.suggestions=null;b.suggestionsEnabled=null;b.view=null;b.viewModel=new q;b.own(c.watch(b,"searchTerm",function(c){if(c&&"warning"===b.activeMenu||!c&&!b.get("viewModel.selectedSuggestion.location"))b.activeMenu="none"}),c.on(b,"viewModel.allSources",
"change",function(){return b._watchSourceChanges()}),c.init(b,["viewModel.popupTemplate","viewModel.popupTemplate.content"],function(){"{Match_addr}"===b.get("viewModel.popupTemplate.content")&&(b.viewModel.popupTemplate.content=b._renderSearchResultsContent.bind(b))}));return b}m(n,k);n.prototype.postInitialize=function(){this.viewModel.load()};n.prototype.destroy=function(){this._handles.destroy();this._handles=null;this._cancelSuggest();this._searchResultRenderer&&(this._searchResultRenderer.viewModel=
null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)};n.prototype.clear=function(){};n.prototype.focus=function(){this._inputNode&&(this.activeMenu="suggestion",this._inputNode.focus(),this.emit("search-focus"))};n.prototype.blur=function(c){this._inputNode&&(this._inputNode.blur(),this._inputBlur(c),this.emit("search-blur"))};n.prototype.search=function(c){var a=this;this.activeMenu="none";this._cancelSuggest();return this.viewModel.search(c).catch(function(c){a.activeMenu=
"none";return c}).then(function(c){a.activeMenu=c.numResults?"none":"warning";return c})};n.prototype.suggest=function(c){var a=this;this._cancelSuggest();var b=this.viewModel.suggest(c).then(function(c){if(a._suggestPromise===b)return a._suggestPromise=null,c.numResults&&(a.activeMenu="suggestion"),a._scrollToTopSuggestion(),c}).catch(function(){if(a._suggestPromise===b)return a._suggestPromise=null});return this._suggestPromise=b};n.prototype.render=function(){var c=this,a,b,e=this.viewModel,k=
e.activeSourceIndex,t=e.suggestions,f=e.maxInputLength,y=e.placeholder,z=e.searchTerm,r=e.searchAllEnabled,n=e.allSources,B=this._getSourceName(k),H=(""+z).trim(),m=this.activeMenu,l=this.id,x=this.viewModel.state,p=this.id+"-suggest-menu",f=v.tsx("input",{bind:this,placeholder:y,"aria-label":g.searchButtonTitle,maxlength:f,autocomplete:"off",type:"text",tabindex:"0",class:this.classes("esri-input","esri-search__input"),"aria-autocomplete":"list",value:z,"aria-haspopup":"true","aria-owns":p,role:"textbox",
onkeydown:this._handleInputKeydown,onkeyup:this._handleInputKeyup,onclick:this._handleInputClick,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:v.storeNode,"data-node-ref":"_inputNode",onfocusout:this._storeRelatedTarget,onfocus:this.focus,onblur:this.blur,title:z?"":y}),f=v.tsx("form",{key:"esri-search__form",bind:this,class:"esri-search__form",onsubmit:this._formSubmit,role:"search"},f),y=z?v.tsx("div",{key:"esri-search__clear-button",bind:this,role:"button",class:this.classes("esri-search__clear-button",
"esri-widget--button"),tabindex:"0",title:g.clearButtonTitle,onfocus:this._clearButtonFocus,onclick:this._handleClearButtonClick,onkeydown:this._handleClearButtonClick},v.tsx("span",{"aria-hidden":"true",class:"esri-icon-close"})):null,O=this.locationEnabled&&!H?v.tsx("ul",{key:"esri-search__suggestion-list-current-location",class:this.classes("esri-menu__list","esri-search__suggestions-list","esri-search__suggestions-list--current-location")},v.tsx("li",{bind:this,onclick:this._handleUseCurrentLocationClick,
onkeydown:this._handleUseCurrentLocationClick,onkeyup:this._handleSuggestionKeyup,role:"menuitem",class:"esri-menu__list-item",tabindex:"-1"},v.tsx("span",{"aria-hidden":"true",role:"presentation",class:"esri-icon-locate-circled"})," ",g.useCurrentLocation)):null,F=1<n.length&&k===q.ALL_INDEX,k=t?t.map(function(a,b){var e=a.sourceIndex,d=a.results.length;b=d&&F?c._getSuggestionHeaderNode(e):null;a=a.results.map(function(a,b){return c._getSuggestionNode(a,b,e)});a=d?v.tsx("ul",{key:"esri-search__suggestion-list-"+
e,class:c.classes("esri-menu__list","esri-search__suggestions-list")},a):null;return[b,a]}):null,p=v.tsx("div",{id:p,"aria-expanded":"suggestion"===m,key:"esri-search__suggestions-menu",class:this.classes("esri-menu","esri-search__suggestions-menu"),role:"menu",bind:this,afterCreate:v.storeNode,"data-node-ref":"_suggestionListNode"},O,k),p=v.tsx("div",{key:"esri-search__input-container",class:"esri-search__input-container"},f,p,y),k=v.tsx("div",{key:"esri-search__submit-button",bind:this,role:"button",
title:g.searchButtonTitle,class:this.classes("esri-search__submit-button","esri-widget--button"),tabindex:"0",onclick:this._handleSearchButtonClick,onkeydown:this._handleSearchButtonClick},v.tsx("span",{"aria-hidden":"true",role:"presentation",class:"esri-icon-search"}),v.tsx("span",{class:"esri-icon-font-fallback-text"},g.searchButtonTitle)),z=H?h.substitute(g.noResultsFoundForValue,{value:'"'+z+'"'}):g.noResultsFound,z=e.get("selectedSuggestion.location")||H?v.tsx("div",{key:"esri-search__no_results"},
v.tsx("div",{class:"esri-search__warning-header"},g.noResults),v.tsx("div",{class:"esri-search__warning-text"},z)):null,e=e.get("selectedSuggestion.location")||H?null:v.tsx("div",{key:"esri-search__empty-search"},v.tsx("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),v.tsx("span",{class:"esri-search__no-value-text"},g.emptyValue)),e=v.tsx("div",{key:"esri-search__error-menu",class:this.classes("esri-menu","esri-search__warning-menu")},v.tsx("div",{class:"esri-search__warning-body"},
z,e)),H=1<n.length,n=n&&n.toArray(),r=r?this._getSourceNode(q.ALL_INDEX):null,l=l+"-source-menu",B=H?v.tsx("div",{key:"esri-search__source-menu-button",bind:this,role:"button",title:g.searchIn,"aria-haspopup":"true","aria-expanded":"source"===m,"aria-controls":l,class:this.classes("esri-search__sources-button","esri-widget--button"),tabindex:"0",onkeydown:this._handleSourceMenuButtonKeydown,onclick:this._handleSourcesMenuToggleClick,onkeyup:this._handleSourceMenuButtonKeyup,onblur:this._sourcesButtonBlur,
afterCreate:v.storeNode,"data-node-ref":"_sourceMenuButtonNode"},v.tsx("span",{"aria-hidden":"true",role:"presentation",class:"esri-icon-down-arrow esri-search__sources-button--down"}),v.tsx("span",{"aria-hidden":"true",role:"presentation",class:"esri-icon-up-arrow esri-search__sources-button--up"}),v.tsx("span",{class:"esri-search__source-name"},B)):null,r=H?v.tsx("ul",{bind:this,afterCreate:v.storeNode,"data-node-ref":"_sourceListNode",class:"esri-menu__list"},r,n.map(function(a,b){return c._getSourceNode(b)})):
null,l=v.tsx("div",{id:l,key:"esri-search__source-menu",class:this.classes("esri-menu","esri-search__sources-menu"),role:"menu"},r),m=(a={},a["esri-search--multiple-sources"]=H,a["esri-search--loading"]="loading"===x,a["esri-search--searching"]="searching"===x,a["esri-search--warning"]="warning"===m,a["esri-search--sources"]="source"===m,a["esri-search--show-suggestions"]="suggestion"===m,a);a=(b={},b["esri-disabled"]="disabled"===x,b);b="loading"===x?v.tsx("div",{role:"presentation",class:"esri-widget__loader",
key:"base-loader"},v.tsx("span",{"aria-hidden":"true",role:"presentation",class:"esri-widget__loader-animation"}),v.tsx("span",{class:"esri-icon-font-fallback-text"},g.searchButtonTitle),v.tsx("span",{class:"esri-widget__loader-text"},d.loading)):v.tsx("div",{role:"presentation",class:this.classes(m,"esri-search__container"),key:"base-container"},B,l,p,k,e);return v.tsx("div",{class:this.classes("esri-search esri-widget",a)},b)};n.prototype._watchSourceChanges=function(){var a=this,b=this._handles,
e=this.viewModel.allSources;b.remove("sources");e.forEach(function(e){return b.add(c.watch(e,"name",function(){return a.scheduleRender()}),"sources")})};n.prototype._handleSourceMenuButtonKeydown=function(a){var c=t.eventKey(a);"ArrowUp"===c||"ArrowDown"===c||"End"===c||"Home"===c?(a.preventDefault(),a.stopPropagation(),this.activeMenu="source"):this._handleSourcesMenuToggleClick(a)};n.prototype._handleSourcesMenuToggleClick=function(a){var c="source"===this.activeMenu;this.activeMenu=c?"none":"source";
this.renderNow();c?this._sourceMenuButtonNode&&this._sourceMenuButtonNode.focus():(c=this._sourceListNode?this._sourceListNode.getElementsByTagName("li"):null)&&(a="End"===t.eventKey(a)?c[c.length-1]:c[0])&&a.focus()};n.prototype._handleClearButtonClick=function(){this.viewModel.clear();this._focus()};n.prototype._handleSearchButtonClick=function(){this.search()};n.prototype._handleSuggestionClick=function(a){if(a=a.currentTarget["data-suggestion"])this._focus(),this.search(a)};n.prototype._handleUseCurrentLocationClick=
function(){this._focus("none");this.viewModel.searchNearby()};n.prototype._handleSourceClick=function(a){this.viewModel.activeSourceIndex=a.currentTarget["data-source-index"];this._focus("none")};n.prototype._sourcesButtonBlur=function(a){this._removeActiveMenu(a&&a.relatedTarget,this._sourceListNode)};n.prototype._inputBlur=function(a){a=a&&a.relatedTarget;this._removeActiveMenu(a?a:this._relatedTarget,this._suggestionListNode)};n.prototype._storeRelatedTarget=function(a){this._relatedTarget=a.relatedTarget};
n.prototype._clearButtonFocus=function(){this.activeMenu="none"};n.prototype._removeActiveMenu=function(a,c){!a||a&&c&&c.contains(a)||(this.activeMenu="none")};n.prototype._cancelSuggest=function(){this._suggestPromise=null};n.prototype._handleInputKeydown=function(a){var c=t.eventKey(a);("Tab"===c||"Escape"===c||a.shiftKey&&"Tab"===c)&&this._cancelSuggest()};n.prototype._handleInputKeyup=function(a){var c=t.eventKey(a),b=a.ctrlKey||a.metaKey||"Copy"===c||"ArrowLeft"===c||"ArrowRight"===c||"Enter"===
c||"Shift"===c,e=this._suggestionListNode?this._suggestionListNode.getElementsByTagName("li"):null;b||("Tab"===c||"Escape"===c||a.shiftKey&&"Tab"===c?(this._cancelSuggest(),"Escape"===c&&(this.activeMenu="none")):"ArrowUp"!==c&&"ArrowDown"!==c||!e?this.viewModel.searchTerm&&this.suggest():(this.activeMenu="suggestion",a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),(a=e["ArrowUp"===c?e.length-1:0])&&a.focus()))};n.prototype._scrollToTopSuggestion=function(){this._suggestionListNode&&
(this._suggestionListNode.scrollTop=0)};n.prototype._handleInputClick=function(a){this.activeMenu="suggestion"};n.prototype._handleInputPaste=function(a){var c=this.get("viewModel.searchTerm");a=a.target;c!==a.value&&(this.viewModel.searchTerm=a.value);c&&this.suggest()};n.prototype._handleSourceMenuButtonKeyup=function(a){var c=t.eventKey(a);if("ArrowUp"===c||"ArrowDown"===c||"Home"===c||"End"===c)a.stopPropagation(),a.preventDefault(),(a=this._sourceListNode?this._sourceListNode.getElementsByTagName("li"):
null)&&(c=a["ArrowUp"===c||"End"===c?a.length-1:0])&&c.focus()};n.prototype._handleSourceKeyup=function(a){var c=a.target,b=this._sourceListNode?f.from(this._sourceListNode.getElementsByTagName("li")):null,e=t.eventKey(a);if("Escape"===e)this._focus("none"),this._sourceMenuButtonNode&&this._sourceMenuButtonNode.focus();else if(b){c=b.indexOf(c);if("Home"===e||"End"===e||"ArrowUp"===e||"ArrowDown"===e)a.stopPropagation(),a.preventDefault();"Home"===e?(b=b[0])&&b.focus():"End"===e?(b=b[b.length-1])&&
b.focus():"ArrowUp"===e?(a=c-1,(b=0>a?this._sourceMenuButtonNode:b[a])&&b.focus()):"ArrowDown"===e&&(a=c+1,(b=a>=b.length?this._sourceMenuButtonNode:b[a])&&b.focus())}};n.prototype._handleSuggestionKeyup=function(a){var c=a.target,b=this._suggestionListNode?f.from(this._suggestionListNode.getElementsByTagName("li")):null,c=b.indexOf(c),e=t.eventKey(a);this._cancelSuggest();if("Backspace"===e||"Delete"===e)this._focus();else if("Escape"===e)this._focus("none");else if(b){if("Home"===e||"End"===e||
"ArrowUp"===e||"ArrowDown"===e)a.stopPropagation(),a.preventDefault();"Home"===e&&(a=b[0])&&a.focus();"End"===e&&(a=b[b.length-1])&&a.focus();"ArrowUp"===e?(--c,(b=0>c?b[b.length-1]:b[c])&&b.focus()):"ArrowDown"===e&&(c+=1,(b=c>=b.length?b[0]:b[c])&&b.focus())}};n.prototype._focus=function(a){this.focus();a&&(this.activeMenu=a)};n.prototype._formSubmit=function(a){a.preventDefault();this.search()};n.prototype._getSourceName=function(a){var c=this.viewModel.allSources.getItemAt(a);return a===q.ALL_INDEX?
g.all:c?c.name||g.untitledSource:g.untitledSource};n.prototype._getSuggestionHeaderNode=function(a){var c=this._getSourceName(a);return v.tsx("div",{key:"esri-search__suggestion-header-"+a,class:"esri-menu__header"},c)};n.prototype._splitResult=function(a,c){c=r.escapeString(c);return a.replace(new RegExp("(^|)("+c+")(|$)","ig"),"$1|$2|$3").split("|")};n.prototype._getSuggestionNode=function(a,c,b){if(b=this.viewModel.searchTerm){var e=a.text||g.untitledResult,d=[];if(B.test(e))d.push(v.tsx("div",
{innerHTML:e}));else{var e=this._splitResult(e,b),h=b.toLowerCase();e.forEach(function(a,c){a&&a.length&&(a.toLowerCase()===h?d.push(v.tsx("strong",{key:c},a)):d.push(a))})}return v.tsx("li",{bind:this,onclick:this._handleSuggestionClick,onkeydown:this._handleSuggestionClick,onkeyup:this._handleSuggestionKeyup,key:"esri-search__suggestion$-{sourceIndex}_"+c,"data-suggestion":a,role:"menuitem",class:"esri-menu__list-item",tabindex:"-1"},d)}};n.prototype._getSourceNode=function(a){var c,b=(c={},c["esri-menu__list-item--active"]=
a===this.viewModel.activeSourceIndex,c);return v.tsx("li",{bind:this,key:"esri-search__source-"+a,onclick:this._handleSourceClick,onkeydown:this._handleSourceClick,onkeyup:this._handleSourceKeyup,"data-source-index":a,role:"menuitem",class:this.classes("esri-search__source","esri-menu__list-item",b),tabindex:"-1"},this._getSourceName(a))};n.prototype._renderSearchResultsContent=function(){this._searchResultRenderer.showMoreResultsOpen=!1;this._searchResultRenderer.viewModel=this.viewModel;return this._searchResultRenderer};
b([a.property(),v.renderable()],n.prototype,"activeMenu",void 0);b([a.aliasOf("viewModel.activeSource"),v.renderable()],n.prototype,"activeSource",void 0);b([a.aliasOf("viewModel.activeSourceIndex"),v.renderable()],n.prototype,"activeSourceIndex",void 0);b([a.aliasOf("viewModel.allPlaceholder"),v.renderable()],n.prototype,"allPlaceholder",void 0);b([a.aliasOf("viewModel.allSources")],n.prototype,"allSources",void 0);b([a.aliasOf("viewModel.autoNavigate")],n.prototype,"autoNavigate",void 0);b([a.aliasOf("viewModel.autoSelect")],
n.prototype,"autoSelect",void 0);b([a.aliasOf("viewModel.defaultSources")],n.prototype,"defaultSources",void 0);b([a.aliasOf("viewModel.goToOverride")],n.prototype,"goToOverride",void 0);b([a.property()],n.prototype,"iconClass",void 0);b([a.aliasOf("viewModel.includeDefaultSources")],n.prototype,"includeDefaultSources",void 0);b([a.property()],n.prototype,"label",void 0);b([v.renderable(),a.aliasOf("viewModel.locationEnabled")],n.prototype,"locationEnabled",void 0);b([a.aliasOf("viewModel.maxResults")],
n.prototype,"maxResults",void 0);b([a.aliasOf("viewModel.maxSuggestions")],n.prototype,"maxSuggestions",void 0);b([a.aliasOf("viewModel.minSuggestCharacters")],n.prototype,"minSuggestCharacters",void 0);b([a.aliasOf("viewModel.popupEnabled")],n.prototype,"popupEnabled",void 0);b([a.aliasOf("viewModel.popupTemplate")],n.prototype,"popupTemplate",void 0);b([a.aliasOf("viewModel.portal")],n.prototype,"portal",void 0);b([a.aliasOf("viewModel.resultGraphic")],n.prototype,"resultGraphic",void 0);b([a.aliasOf("viewModel.resultGraphicEnabled")],
n.prototype,"resultGraphicEnabled",void 0);b([a.aliasOf("viewModel.results"),v.renderable()],n.prototype,"results",void 0);b([a.aliasOf("viewModel.searchAllEnabled"),v.renderable()],n.prototype,"searchAllEnabled",void 0);b([a.aliasOf("viewModel.searchTerm"),v.renderable()],n.prototype,"searchTerm",void 0);b([a.aliasOf("viewModel.selectedResult")],n.prototype,"selectedResult",void 0);b([a.aliasOf("viewModel.sources")],n.prototype,"sources",void 0);b([a.aliasOf("viewModel.suggestions"),v.renderable()],
n.prototype,"suggestions",void 0);b([a.aliasOf("viewModel.suggestionsEnabled")],n.prototype,"suggestionsEnabled",void 0);b([a.aliasOf("viewModel.view"),v.renderable()],n.prototype,"view",void 0);b([v.vmEvent("search-complete search-clear search-start select-result suggest-start suggest-complete".split(" ")),a.property({type:q}),v.renderable(["viewModel.allSources","viewModel.activeSource.placeholder","viewModel.activeSource.name","viewModel.state"])],n.prototype,"viewModel",void 0);b([a.aliasOf("viewModel.clear")],
n.prototype,"clear",null);b([v.accessibleHandler()],n.prototype,"_handleSourcesMenuToggleClick",null);b([v.accessibleHandler()],n.prototype,"_handleClearButtonClick",null);b([v.accessibleHandler()],n.prototype,"_handleSearchButtonClick",null);b([v.accessibleHandler()],n.prototype,"_handleSuggestionClick",null);b([v.accessibleHandler()],n.prototype,"_handleUseCurrentLocationClick",null);b([v.accessibleHandler()],n.prototype,"_handleSourceClick",null);return n=b([a.subclass("esri.widgets.Search")],
n)}(a.declared(k))})},"esri/widgets/Search/SearchResultRenderer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/i18n!./nls/Search ../../core/accessorSupport/decorators ../Widget ./SearchViewModel ../support/widget".split(" "),function(p,l,m,b,f,d,g,r,h){return function(g){function e(c){c=g.call(this)||this;c.showMoreResultsOpen=!1;c.viewModel=null;return c}m(e,g);e.prototype.render=function(){var c=this,a,b=this.get("viewModel.selectedResult"),
e=this.get("viewModel.results"),b=b&&b.name||"",d=1<this._countResults(e),g=d&&e.map(function(a){return c._moreResultsList(a)}),e=d?h.tsx("div",{key:"esri-search-renderer__more-results-button",class:"esri-search-result-renderer__more-results-item"},h.tsx("a",{class:"esri-widget__anchor",href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?f.hideMoreResults:f.showMoreResults)):null,d=d?h.tsx("div",{key:"esri-search-renderer__more-results-container",
class:"esri-search-result-renderer__more-results-list"},g):null,g=(a={},a["esri-search-result-renderer__more-results--show-more-results"]=this.showMoreResultsOpen,a);return h.tsx("div",{class:"esri-search-result-renderer esri-widget"},h.tsx("div",{key:"esri-search-renderer__container",class:this.classes("esri-search-result-renderer__more-results",g)},h.tsx("div",{key:"esri-search-renderer__result-name",class:"esri-search-result-renderer__more-results-item"},b),h.tsx("div",{key:"esri-search-renderer__more-results"},
e,d)))};e.prototype._showMoreResultsClick=function(c){c.preventDefault();this.showMoreResultsOpen=!this.showMoreResultsOpen;(c=this.get("viewModel.view.popup"))&&c.reposition()};e.prototype._selectResultClick=function(c){c.preventDefault();c=c.currentTarget["data-result"];this.viewModel&&this.viewModel.select(c)};e.prototype._moreResultsList=function(c){var a=this,b=c.results,e=b.length,d=!!e,g=this.get("viewModel.selectedResult"),e=1===e&&b[0]===g,g=this._getSourceName(c.source,c.sourceIndex),g=
1<this.get("viewModel.results").length&&!e?h.tsx("div",{key:"esri-search-result-renderer__header-"+c.sourceIndex,class:"esri-search-result-renderer__more-results-list-header"},g):null,b=d&&b.map(function(c,b){return a._moreResultsListItem(c,b)}),b=d&&!e?h.tsx("ul",{key:"esri-search-result-renderer__list-"+c.sourceIndex},b):null;return d?h.tsx("div",{key:"esri-search-result-renderer__results-"+c.sourceIndex},g,b):null};e.prototype._moreResultsListItem=function(c,a){var b=this.get("viewModel.selectedResult");
return c!==b?h.tsx("li",{key:"esri-search-result-renderer__list-item-"+a},h.tsx("a",{class:"esri-widget__anchor",href:"#",tabindex:"0",bind:this,"data-result":c,onclick:this._selectResultClick,onkeydown:this._selectResultClick},c.name)):null};e.prototype._getSourceName=function(c,a){return a===r.ALL_INDEX?f.all:c.name};e.prototype._countResults=function(c){return c?c.reduce(function(a,c){return a+c.results.length},0):0};b([h.renderable(),d.property()],e.prototype,"showMoreResultsOpen",void 0);b([d.property(),
h.renderable(["viewModel.results","viewModel.selectedResult"])],e.prototype,"viewModel",void 0);b([h.accessibleHandler()],e.prototype,"_showMoreResultsClick",null);b([h.accessibleHandler()],e.prototype,"_selectResultClick",null);return e=b([d.subclass("esri.widgets.Search.SearchResultRenderer")],e)}(d.declared(g))})},"esri/widgets/Search/SearchViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper dojo/i18n!./nls/Search ../../Graphic ../../PopupTemplate ../../core/Accessor ../../core/asyncUtils ../../core/Collection ../../core/Error ../../core/Evented ../../core/geolocationUtils ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/Point ../../geometry/SpatialReference ../../portal/Portal ../../styles/basic ../../symbols/PictureMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleMarkerSymbol ../../symbols/TextSymbol ../../views/support/layerViewUtils ./LayerSearchSource ./LocatorSearchSource ./SearchSource ./support/geometryUtils ./support/locatorUtils ../support/GoTo".split(" "),
function(p,l,m,b,f,d,g,r,h,t,e,c,a,k,y,q,v,B,x,n,C,w,u,A,G,D,J,K,z,E,N,T,H,Q,R,L,U,O){function F(a,c){return a.hasOwnProperty(c)&&null!=a[c]&&""!==a[c]}var I=B.getLogger("esri.widgets.Search.SearchViewModel"),P=c.ofType({key:function(a){return a.layer?"layer":"locator"},base:R,typeMap:{layer:H,locator:Q}}),S=A.WGS84,V=/<(?:.|\s)*?>/g;return function(c){function k(a){a=c.call(this)||this;a._handles=new q;a._gotoController=null;a._searching=null;a._loadingDefaultSources=null;a.allPlaceholder=g.allPlaceholder;
a.autoNavigate=!0;a.autoSelect=!0;a.defaultSources=new P;a.defaultSymbol=new J({url:p.toUrl("../../images/search/search-symbol-32.svg"),size:24,width:24,height:24});a.includeDefaultSources=!0;a.maxInputLength=128;a.maxResults=6;a.maxSuggestions=6;a.minSuggestCharacters=1;a.popupEnabled=!0;a.popupTemplate=new h({title:g.searchResult,content:"{Match_addr}"});a.portal=G.getDefault();a.resultGraphicEnabled=!0;a.resultGraphic=null;a.results=null;a.selectedSuggestion=null;a.searchAllEnabled=!0;a.selectedResult=
null;a.sources=new P;a.suggestionDelay=150;a.suggestions=null;a.suggestionsEnabled=!0;a.view=null;return a}m(k,c);k.prototype.initialize=function(){var a=this;this._handles.add(C.on(this,["defaultSources","sources"],"change",function(){return a.notifyChange("allSources")}))};k.prototype.destroy=function(){this._abortGoTo();this.clearGraphics();this._loadingDefaultSources=null;this._clearLoadingDefaultSources();this._handles.destroy();this._handles=null};Object.defineProperty(k.prototype,"activeSource",
{get:function(){return this.allSources.getItemAt(this.activeSourceIndex)||null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"activeSourceIndex",{get:function(){return 1!==this.allSources.length&&this.searchAllEnabled?-1:0},set:function(a){void 0===a?this._clearOverride("activeSourceIndex"):this._override("activeSourceIndex",a)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"allSources",{get:function(){var a=this.sources,c=this.defaultSources,b=this.includeDefaultSources,
a="function"===typeof b?b.call(null,{sources:a,defaultSources:c}):b?c.concat(a):a,c=this._get("allSources")||new P;c.removeAll();c.addMany(a.filter(Boolean));return c},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"locationEnabled",{get:function(){return this._get("locationEnabled")||y.supported()},set:function(c){if(void 0===c)this._clearOverride("locationEnabled");else{var b=y.supported();if(c&&!b){var e=new a("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",
{geolocation:navigator.geolocation});I.error(e)}this._override("locationEnabled",c&&b)}},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"placeholder",{get:function(){var a=this.activeSourceIndex,c=this.allPlaceholder,c=void 0===c?g.allPlaceholder:c;return-1===a?c:(a=this.allSources.getItemAt(a))?a.placeholder:""},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"searchTerm",{get:function(){return this._get("searchTerm")||""},set:function(a){this._set("searchTerm",
a||"");this.clearGraphics();this.selectedSuggestion&&this.selectedSuggestion.text!==a&&this._set("selectedSuggestion",null);""===a&&this._clear()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"state",{get:function(){return this._searching?"searching":this._loadingDefaultSources?"loading":0===this.allSources.length?"disabled":"ready"},enumerable:!0,configurable:!0});k.prototype.load=function(){return d(this,void 0,void 0,function(){var a=this;return f(this,function(c){this._handles.add([C.init(this,
["portal","includeDefaultSources"],function(){return a._loadPortal()}),C.init(this,["view","portal","includeDefaultSources"],function(){return a._loadDefaultSources()})]);return[2]})})};k.prototype.clear=function(){this.searchTerm=""};k.prototype.clearGraphics=function(){this._removeHighlight();this._closePopup();this.view&&this.view.graphics.remove(this.resultGraphic);this._set("resultGraphic",null)};k.prototype.search=function(a){var c=this;this.emit("search-start");this.clearGraphics();var b=this._createSuggestionForSearch(a);
this._searching=a=this._whenViewAndPortalLoaded().then(function(){return c._getResultsFromSources(b).then(function(a){var e={activeSourceIndex:c.activeSourceIndex,searchTerm:b.text,numResults:0,numErrors:0,errors:[],results:[]};c._formatResponse(e,a,b);a=c._getFirstResult(e.results);var k=(b.location&&a?a.name:b.text).replace(V,"");c._set("searchTerm",k);(b.key&&"number"===typeof b.sourceIndex||b.location)&&c._set("selectedSuggestion",b);c._set("results",e.results);c.emit("search-complete",e);return c._selectFirstResult(a).then(function(){return e})})}).then(function(a){c._clearSearching();
return a},function(a){c._clearSearching();throw a;});this.notifyChange("state");return a};k.prototype.searchNearby=function(){var c=this;if(!this.locationEnabled){var b=new a("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});I.error(b);return n.reject(b)}this._searching=b=y.getCurrentPosition().then(function(a){return y.positionToPoint({position:a,view:c.view})}).then(function(a){return c.search(a)});this.notifyChange("state");b.catch(function(){}).then(function(){return c._clearSearching()});
return b};k.prototype.select=function(c){var b=this;this.clearGraphics();if(!c){var k=new a("select:missing-parameter","Cannot select without a searchResult.",{searchResult:c});I.error(k);return n.reject(k)}var d=this.view,h=F(c,"sourceIndex")?c.sourceIndex:this._getSourceIndexOfResult(c),g=this.allSources.getItemAt(h);if(!g)return k=new a("select:missing-source","Cannot select without a source.",{source:g}),I.error(k),n.reject(k);var k=g instanceof H?this._getLayerSourcePopupTemplate(g):g.popupTemplate,
t=g.resultSymbol||this._getDefaultSymbol(c),f=F(g,"resultGraphicEnabled")?g.resultGraphicEnabled:this.resultGraphicEnabled,z=F(g,"autoNavigate")?g.autoNavigate:this.autoNavigate,y=F(g,"popupEnabled")?g.popupEnabled:this.popupEnabled,u=y?k||this.popupTemplate:null,w=c.feature;if(!w)return k=new a("select:missing-feature","Cannot select without a feature.",{feature:w}),I.error(k),n.reject(k);var E=w.attributes,q=w.geometry,W=w.layer,K=w.sourceLayer,v=L.getPointFromGeometry(q),k={layerViewQuery:this._getLayerView(w),
elevationQuery:d&&x.isSome(v)?L.getPointWithElevation(v,d).catch(function(){return v}):n.resolve(v)};return n.eachAlways(k).then(function(a){var k=a.layerViewQuery.value,ca=a.elevationQuery.value;t instanceof N&&(t.text=c.name);a=d&&z?b._getGoToTarget(c,g):null;return(x.isSome(a)?e.safeCast(b._goToSearchResult(a)):n.resolve()).then(function(){var a=k?w:new r({geometry:q,symbol:t,attributes:E,layer:W,sourceLayer:K,popupTemplate:u}),e=y&&b.get("view.popup");(e=e&&a.getEffectivePopupTemplate(e.defaultPopupTemplateEnabled))&&
d.popup.open({features:[a],location:ca});k&&T.hasHighlight(k)&&!e&&b._highlightFeature({graphic:a,layerView:k});!k&&f&&d&&d.graphics.push(a);b._set("selectedResult",c);b._set("resultGraphic",a);b.emit("select-result",{result:c,source:g,sourceIndex:h});return c})})};k.prototype.suggest=function(a,c){var b=this,e=a||this.searchTerm;this.emit("suggest-start",{searchTerm:e});return this._suggestTimer(c).then(function(){return b._suggestImmediate(e).then(function(a){b._set("suggestions",a.results);b.emit("suggest-complete",
a);return a})})};k.prototype._loadPortal=function(){var a=this.portal;this.includeDefaultSources&&a&&!a.loaded&&a.load()};k.prototype._clearLoadingDefaultSources=function(){this._loadingDefaultSources=null;this.notifyChange("state")};k.prototype._clearSearching=function(){this._searching=null;this.notifyChange("state")};k.prototype._convertHelperServices=function(){var a=this.get("portal.helperServices.geocode");return a?a.map(function(a){if(!1!==a.placefinding&&(a=Q.fromJSON(a),U.isArcGISWorldGeocoder(a.get("locator.url"))&&
a.set({singleLineFieldName:"SingleLine",outFields:["Addr_type","Match_addr","StAddr","City"],placeholder:g.placeholder,defaultZoomScale:2500}),a.singleLineFieldName))return a}).filter(Boolean):[]};k.prototype._convertApplicationProperties=function(){var a=this,c=this.get("view.map.applicationProperties.viewing.search"),b=this.get("view.map");if(!b||!c)return[];var e=c.hintText;return c.enabled?c.layers.map(function(c){var k=b.findLayerById(c.id);if(k){c=a._getLayerJSON(c);var d=H.fromJSON(c);d.placeholder=
e;a._getLayer(k,c).then(function(a){d.layer=a});return d}}).filter(Boolean):[]};k.prototype._getSubLayer=function(a,c){return a&&a.allSublayers?(a=a.allSublayers.find(function(a){return a.id===c.subLayer}))?e.safeCast(a.createFeatureLayer()):n.reject():n.reject()};k.prototype._getLayer=function(c,b){var e=this;if("feature"===c.type||"scene"===c.type)return n.resolve(c);if("map-image"===c.type)return c.load().then(function(){return e._getSubLayer(c,b).catch(function(){var b=new a("search:create-featurelayer",
"Could not create a FeatureLayer from the MapImageLayer",{layer:c});I.error(b);return null})})};k.prototype._getLayerJSON=function(a){return"function"===typeof a.toJSON?a.toJSON():a};k.prototype._updateDefaultSources=function(){var a=this.defaultSources,c=this.includeDefaultSources;a.removeAll();c&&a.addMany(this._convertApplicationProperties().concat(this._convertHelperServices()));this.notifyChange("allSources")};k.prototype._abortGoTo=function(){this._gotoController&&this._gotoController.abort();
this._gotoController=null};k.prototype._clear=function(){this._abortGoTo();this._set("results",null);this._set("suggestions",null);this._set("selectedResult",null);this._set("selectedSuggestion",null);this.emit("search-clear")};k.prototype._closePopup=function(){var a=this.get("view.popup"),c=this.resultGraphic;if(a&&c){var b=a.selectedFeature;b&&b===c&&a.close()}};k.prototype._suggestTimer=function(a){return n.after(null!=a?a:this.suggestionDelay)};k.prototype._createLocationForSearch=function(a){return a instanceof
r?L.getPointFromGeometry(a.geometry):a instanceof u?a:Array.isArray(a)&&2===a.length?new u({longitude:a[0],latitude:a[1]}):null};k.prototype._createSuggestionForSearch=function(a){if(a&&F(a,"key")&&F(a,"text")&&F(a,"sourceIndex"))return a;var c=this._createLocationForSearch(a),b="string"===typeof a?a:this.searchTerm,e=this.selectedSuggestion,k=this.selectedResult,d=(a=!a&&e&&k)&&e.location;return a&&e.key===k.key&&e.sourceIndex===k.sourceIndex||d?e:{location:x.unwrap(c),text:c?"":b,sourceIndex:null,
key:null}};k.prototype._getFirstResult=function(a){var c=null;a&&a.some(function(a){a=a.results[0];var b=!!a;b&&(c=a);return b});return c};k.prototype._selectFirstResult=function(a){return this.autoSelect&&a?this.select(a):n.resolve()};k.prototype._suggestImmediate=function(a){var c=this;return this._whenViewAndPortalLoaded().then(function(){return c._getSuggestionsFromSources(a)}).then(function(b){var e={activeSourceIndex:c.activeSourceIndex,searchTerm:a,numResults:0,numErrors:0,errors:[],results:[]};
c._formatResponse(e,b);return e})};k.prototype._formatSourceResponse=function(a,c,b){var e=c&&c.value||[];c=c&&c.error;var k=this.allSources.getItemAt(b);c?(a.errors.push({sourceIndex:b,source:k,error:c}),a.numErrors++):(a.results.push({sourceIndex:b,source:k,results:e}),a.numResults+=e.length)};k.prototype._formatResponse=function(a,c,b){var e=this;if(c)if(-1===a.activeSourceIndex){var k=b&&F(b,"sourceIndex")&&-1!==b.sourceIndex?b.sourceIndex:void 0;c.forEach(function(c,b){e._formatSourceResponse(a,
c,void 0!==k?k:b)})}else this._formatSourceResponse(a,c[0],a.activeSourceIndex)};k.prototype._getResultsFromSources=function(c){var b=this,e=this.allSources,k=!c.location&&F(c,"sourceIndex")?c.sourceIndex:this.activeSourceIndex,d=[];if(!e.length)return e=new a("search:no-sources-defined","At least one source is required.",{allSources:e}),I.error(e),n.reject(e);-1===k?e.forEach(function(a,e){d.push(b._getResultsFromSource(c,e))}):d.push(this._getResultsFromSource(c,k));return n.eachAlways(d)};k.prototype._getSuggestionsFromSources=
function(c){var b=this,e=this.allSources,k=this.activeSourceIndex,d=[];if(!e.length)return e=new a("suggest:no-sources-defined","At least one source is required.",{allSources:e}),I.error(e),n.reject(e);-1===k?e.forEach(function(a,e){d.push(b._getSuggestionsFromSource(c,e))}):d.push(this._getSuggestionsFromSource(c,k));return n.eachAlways(d)};k.prototype._getResultsFromSource=function(a,c){var b=this.allSources.getItemAt(c),e=a.location,e=void 0===e?null:e,k=this.get("view.spatialReference")||S,d=
F(b,"maxResults")?b.maxResults:this.maxResults,g=b instanceof H&&F(b,"exactMatch")?b.exactMatch:!1;return b.getResults({view:this.view,sourceIndex:c,location:e,suggestResult:a,spatialReference:k,exactMatch:g,maxResults:d})};k.prototype._getSuggestionsFromSource=function(a,c){var b=this.allSources.getItemAt(c),e=F(b,"suggestionsEnabled")?b.suggestionsEnabled:this.suggestionsEnabled,k=a.trim().length,d=F(b,"minSuggestCharacters")?b.minSuggestCharacters:this.minSuggestCharacters;return e&&k>=d?(e=this.get("view.spatialReference")||
S,k=F(b,"maxSuggestions")?b.maxSuggestions:this.maxSuggestions,b.getSuggestions({view:this.view,sourceIndex:c,suggestTerm:a,spatialReference:e,maxSuggestions:k})):n.resolve()};k.prototype.createDefaultSymbol=function(a,c){if("point"===c)return new E({color:a.color,size:a.size,outline:{color:a.outline.color,width:a.outline.width}});if("polyline"===c)return new z({color:a.color,width:a.width});if("polygon"===c)return new K({color:a.color,outline:{color:a.outline.color,width:a.outline.width}})};k.prototype._getLayerSourcePopupTemplate=
function(a){var c=a.layer;if(c)return F(a,"popupTemplate")?a.popupTemplate:c.popupTemplate};k.prototype._getSourceIndexOfResult=function(a){var c=null;this.results.some(function(b){return b.results.some(function(e){return e===a?(c=b.sourceIndex,!0):!1})});return c};k.prototype._getGoToTarget=function(a,c){var b=a.extent;a=a.feature;return c instanceof H?a||b:b||a};k.prototype._goToSearchResult=function(a){return d(this,void 0,void 0,function(){var c,b,e;return f(this,function(k){switch(k.label){case 0:c=
!!a,this._abortGoTo(),this._gotoController=b=n.createAbortController(),e={target:{target:a},options:{animate:c,signal:b.signal}},k.label=1;case 1:return k.trys.push([1,3,,4]),[4,this.callGoTo(e)];case 2:return k.sent(),[3,4];case 3:return k.sent(),[3,4];case 4:return this._gotoController=null,[2]}})})};k.prototype._whenViewAndPortalLoaded=function(){var a=this.includeDefaultSources,c=this.portal,b=this.view,b=b?b.when():n.resolve(),a=c&&a?c.when():n.resolve();return n.eachAlways([b,a]).then(function(){})};
k.prototype._loadDefaultSources=function(){return d(this,void 0,void 0,function(){var a,c,b=this;return f(this,function(e){switch(e.label){case 0:return this._loadingDefaultSources=c=(a=this.includeDefaultSources)?this._whenViewAndPortalLoaded():n.resolve(),this.notifyChange("state"),[4,c.catch(function(){}).then(function(){b._loadingDefaultSources===c&&(b._clearLoadingDefaultSources(),b._updateDefaultSources())})];case 1:return e.sent(),[2]}})})};k.prototype._getDefaultSymbol=function(a){var c=this.get("view.map.basemap.id");
a=x.get(a,"feature","geometry","type");return x.isSome(a)&&(c=(c=D.getSchemes({theme:"default",basemap:c,geometryType:a})||D.getSchemes({theme:"default",basemap:"topo",geometryType:a}))&&c.primaryScheme)?(c.color&&F(c,"opacity")&&(c.color.a=c.opacity),this.createDefaultSymbol(c,a)):this.defaultSymbol};k.prototype._removeHighlight=function(){this._handles.remove("highlight")};k.prototype._getLayerView=function(a){var c=this.view;if(!a||!c)return n.resolve(null);var b=a.layer;return c.when(function(a){return a.whenLayerView(b)})};
k.prototype._highlightFeature=function(a){var c=a.graphic,b=c.attributes,e=c.layer.objectIdField;a=a.layerView.highlight(b&&b[e]||c);this._handles.add(a,"highlight")};k.ALL_INDEX=-1;b([w.property({readOnly:!0,dependsOn:["activeSourceIndex","allSources.length"],value:null})],k.prototype,"activeSource",null);b([w.property({dependsOn:["allSources.length","searchAllEnabled"]})],k.prototype,"activeSourceIndex",null);b([w.property()],k.prototype,"allPlaceholder",void 0);b([w.property({dependsOn:["defaultSources.length",
"sources.length","includeDefaultSources"],readOnly:!0})],k.prototype,"allSources",null);b([w.property()],k.prototype,"autoNavigate",void 0);b([w.property()],k.prototype,"autoSelect",void 0);b([w.property({readOnly:!0})],k.prototype,"defaultSources",void 0);b([w.property()],k.prototype,"defaultSymbol",void 0);b([w.property()],k.prototype,"includeDefaultSources",void 0);b([w.property()],k.prototype,"locationEnabled",null);b([w.property()],k.prototype,"maxInputLength",void 0);b([w.property()],k.prototype,
"maxResults",void 0);b([w.property()],k.prototype,"maxSuggestions",void 0);b([w.property()],k.prototype,"minSuggestCharacters",void 0);b([w.property({readOnly:!0,dependsOn:["activeSourceIndex","activeSource.placeholder","allPlaceholder","allSources"]})],k.prototype,"placeholder",null);b([w.property()],k.prototype,"popupEnabled",void 0);b([w.property({type:h})],k.prototype,"popupTemplate",void 0);b([w.property({type:G})],k.prototype,"portal",void 0);b([w.property()],k.prototype,"resultGraphicEnabled",
void 0);b([w.property({readOnly:!0})],k.prototype,"resultGraphic",void 0);b([w.property({readOnly:!0})],k.prototype,"results",void 0);b([w.property({readOnly:!0})],k.prototype,"selectedSuggestion",void 0);b([w.property()],k.prototype,"searchAllEnabled",void 0);b([w.property({readOnly:!0})],k.prototype,"selectedResult",void 0);b([w.property()],k.prototype,"searchTerm",null);b([w.property({type:P})],k.prototype,"sources",void 0);b([w.property({readOnly:!0,dependsOn:["allSources.length"]})],k.prototype,
"state",null);b([w.property()],k.prototype,"suggestionDelay",void 0);b([w.property({readOnly:!0})],k.prototype,"suggestions",void 0);b([w.property()],k.prototype,"suggestionsEnabled",void 0);b([w.property()],k.prototype,"view",void 0);b([w.property()],k.prototype,"clear",null);return k=b([w.subclass("esri.widgets.Search.SearchViewModel")],k)}(w.declared(O.GoToMixin(k.EventedMixin(t))))})},"esri/core/geolocationUtils":function(){define("require exports ./tsSupport/assignHelper ../config ./Error ./has ./Logger ./promiseUtils ../geometry/Point ../geometry/support/webMercatorUtils ../portal/Portal ../tasks/GeometryService ../tasks/support/ProjectParameters".split(" "),
function(p,l,m,b,f,d,g,r,h,t,e,c,a){function k(b,e,k){if(!e)return r.resolve(b);var d=e.spatialReference;return d.isWGS84?r.resolve(b):d.isWebMercator?r.resolve(t.geographicToWebMercator(b)):y(k).then(function(e){if(!e)return r.reject(new f("geometry-service:missing-url","Geometry service URL is missing"));e=new c({url:e});var g=new a({geometries:[b],outSR:d});return e.project(g,k).then(function(a){return a[0]})})}function y(a){if(b.geometryServiceUrl)return r.resolve(b.geometryServiceUrl);var c=
e.getDefault();return c.load(a).catch(function(){}).then(function(){return c.get("helperServices.geometry.url")})}Object.defineProperty(l,"__esModule",{value:!0});var q=g.getLogger("esri.core.geolocationUtils"),v={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};l.supported=function(){var a=d("esri-geolocation");a||q.warn("geolocation-unsupported","Geolocation unsupported.");a&&((a=d("esri-secure-context"))||q.warn("insecure-context","Geolocation requires a secure origin."));return a};l.getCurrentPosition=
function(a){a||(a=v);return r.create(function(c,b){setTimeout(function(){return b(new f("geolocation:timeout","getting the current geolocation position timed out"))},15E3);navigator.geolocation.getCurrentPosition(c,b,a)})};l.positionToPoint=function(a,c){var b=a.position;a=a.view;var e=b&&b.coords||{},e={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed},b=b?{coords:e,timestamp:b.timestamp}:b;b=(b=
b&&b.coords)?new h({longitude:b.longitude,latitude:b.latitude,z:b.altitude||null,spatialReference:{wkid:4326}}):null;return k(b,a,c)}})},"esri/styles/basic":function(){define(["../core/lang","../Color"],function(p,l){function m(b,g){var d;if(b)switch(d={},d.color=new l(b.color),g){case "point":d.outline={color:new l(b.outline.color),width:b.outline.width};d.size=b.size;break;case "polyline":d.width=b.width;break;case "polygon":d.outline={color:new l(b.outline.color),width:b.outline.width}}return d}
var b={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,1],width:1},size:8},secondary:[{color:[226,119,40,
1],outline:{color:[255,255,255,1],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,1],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[26,26,26,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,1],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,
255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,.8],outline:{color:[255,255,255,1],width:1}},secondary:[{color:[128,128,128,.8],outline:{color:[255,255,255,1],width:1}},{color:[255,255,255,.8],outline:{color:[128,128,128,1],width:1}}]},dark:{primary:{color:[227,139,79,.8],outline:{color:[51,51,51,1],width:1}},secondary:[{color:[178,178,178,.8],outline:{color:[51,51,51,1],width:1}},{color:[26,26,26,.8],
outline:{color:[128,128,128,1],width:1}}]}}}},f={};(function(){var d,g,r,h,t,e,c,a;for(d in b)for(h in g=b[d],r=g.basemapGroups,t=f[d]={basemaps:[].concat(r.light).concat(r.dark),point:{},polyline:{},polygon:{}},r)for(e=r[h],c=0;c<e.length;c++)a=e[c],g.pointSchemes&&(t.point[a]=g.pointSchemes[h]),g.lineSchemes&&(t.polyline[a]=g.lineSchemes[h]),g.polygonSchemes&&(t.polygon[a]=g.polygonSchemes[h])})();return{getAvailableThemes:function(d){var g=[],r,h,t;for(r in b)h=b[r],t=f[r],d&&t.basemaps&&-1===
t.basemaps.indexOf(d)||g.push({name:h.name,label:h.label,description:h.description,basemaps:t.basemaps.slice(0)});return g},getSchemes:function(b){var d=b.basemap,r=b.geometryType;b=f[b.theme];var h;(b=(b=b&&b[r])&&b[d])&&(h={primaryScheme:m(b.primary,r),secondarySchemes:b.secondary.map(function(b){return m(b,r)})});return h},cloneScheme:function(b){var d;b&&(d=p.mixin({},b),d.color&&(d.color=new l(d.color)),d.outline&&(d.outline={color:d.outline.color&&new l(d.outline.color),width:d.outline.width}));
return d}}})},"esri/widgets/Search/LayerSearchSource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/lang ../../core/accessorSupport/decorators ./SearchSource ./support/layerSearchUtils".split(" "),function(p,l,m,b,f,d,g,r,h){return function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;a.displayField=null;a.exactMatch=null;a.searchFields=null;a.searchQueryParams=null;a.searchTemplate=
null;a.suggestionTemplate=null;a.suggestQueryParams=null;a.getResults=function(c){return h.getResults(f({source:a},c))};a.getSuggestions=function(c){return h.getSuggestions(f({source:a},c))};return a}m(e,t);c=e;Object.defineProperty(e.prototype,"layer",{set:function(a){this._set("layer",a);a&&a.load()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"name",{get:function(){return this._getLayerTitle()||""},set:function(a){void 0===a?this._clearOverride("name"):this._override("name",
a)},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new c({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?d.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,searchExtent:this.searchExtent?
this.searchExtent.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?d.clone(this.searchFields):null,searchQueryParams:this.searchQueryParams?d.clone(this.searchQueryParams):null,suggestionTemplate:this.suggestionTemplate,suggestQueryParams:this.suggestQueryParams?d.clone(this.suggestQueryParams):null,zoomScale:this.zoomScale})};
e.prototype._getFirstStringField=function(){var a=this.layer,c="";a&&a.fields&&a.fields.some(function(a){return"string"===a.type?(c=a.name,!0):!1});return c};e.prototype._getDisplayField=function(){return this.displayField||this.layer.displayField||this._getFirstStringField()};e.prototype._getSearchFieldsString=function(){var a=this.layer;return a.loaded?": "+(this.searchFields||[this._getDisplayField()]).map(function(c){var b=a.getField(c);return b&&b.alias||c}).join(", "):""};e.prototype._getLayerTitle=
function(){var a=this.layer;if(a&&(a=a.title))return""+a+this._getSearchFieldsString()};var c;b([g.property({json:{read:{source:"field.name"},write:{target:"field.name"}}})],e.prototype,"displayField",void 0);b([g.property({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],e.prototype,"exactMatch",void 0);b([g.property({value:null})],e.prototype,"layer",null);b([g.property({dependsOn:["layer.title","layer.loaded"]})],e.prototype,"name",null);b([g.property()],e.prototype,
"searchFields",void 0);b([g.property()],e.prototype,"searchQueryParams",void 0);b([g.property()],e.prototype,"searchTemplate",void 0);b([g.property()],e.prototype,"suggestionTemplate",void 0);b([g.property()],e.prototype,"suggestQueryParams",void 0);return e=c=b([g.subclass("esri.widgets.Search.LayerSearchSource")],e)}(g.declared(r))})},"esri/widgets/Search/SearchSource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Identifiable ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(p,l,m,b,f,d,g){return function(d){function h(b){b=d.call(this)||this;b.autoNavigate=null;b.filter=null;b.getResults=null;b.getSuggestions=null;b.maxResults=null;b.maxSuggestions=null;b.minSuggestCharacters=null;b.outFields=null;b.placeholder="";b.popupEnabled=null;b.popupTemplate=null;b.prefix="";b.resultGraphicEnabled=null;b.resultSymbol=null;b.searchExtent=null;b.suggestionsEnabled=null;b.suffix="";b.withinViewEnabled=!1;b.zoomScale=null;return b}m(h,d);b([g.property()],h.prototype,"autoNavigate",
void 0);b([g.property()],h.prototype,"filter",void 0);b([g.property()],h.prototype,"getResults",void 0);b([g.property()],h.prototype,"getSuggestions",void 0);b([g.property()],h.prototype,"maxResults",void 0);b([g.property()],h.prototype,"maxSuggestions",void 0);b([g.property()],h.prototype,"minSuggestCharacters",void 0);b([g.property()],h.prototype,"outFields",void 0);b([g.property()],h.prototype,"placeholder",void 0);b([g.property()],h.prototype,"popupEnabled",void 0);b([g.property()],h.prototype,
"popupTemplate",void 0);b([g.property()],h.prototype,"prefix",void 0);b([g.property()],h.prototype,"resultGraphicEnabled",void 0);b([g.property()],h.prototype,"resultSymbol",void 0);b([g.property()],h.prototype,"searchExtent",void 0);b([g.property()],h.prototype,"suggestionsEnabled",void 0);b([g.property()],h.prototype,"suffix",void 0);b([g.property()],h.prototype,"withinViewEnabled",void 0);b([g.property()],h.prototype,"zoomScale",void 0);return h=b([g.subclass("esri.widgets.Search.SearchSource")],
h)}(g.declared(f.IdentifiableMixin(d.JSONSupport)))})},"esri/widgets/Search/support/layerSearchUtils":function(){define("require exports dojo/date/locale ../../../intl ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/promiseUtils ../../../core/unitUtils ./geometryUtils".split(" "),function(p,l,m,b,f,d,g,r,h,t){function e(a,c){var b=a.filter,e=a.searchExtent;c=c&&c.extent;a=a.withinViewEnabled&&c?c:void 0;return b&&b.geometry||e||a}function c(a){return a?a.load().then(r.resolve).catch(r.reject):
r.resolve()}function a(a){return a&&!!a.get("capabilities.query.supportsPagination")}function k(a){var c="";a&&(a=a.fields)&&a.some(function(a){return"string"===a.type?(c=a.name,!0):!1});return c}function y(a,c){return a&&c?c.every(function(c){return!!a.getField(c)}):!1}function q(a){for(var c=0;c<a.length;c++)if(255<a.charCodeAt(c))return!0;return!1}function v(a,c,b){var e=null;(a=a.codedValues)&&a.some(function(a){var k=a.name,k=b?k:k.toLowerCase();return(b?c:c.toLowerCase())===k?(e=a.code.toString(),
!0):!1});return e}function B(a,c){return(c=c&&c.where)?"("+a+") AND ("+c+")":a}function x(a,c,b,e,k){var d=c.definitionExpression,g="";if(a){var h=A.test(c.url)&&q(a)?"N":"";b&&b.forEach(function(b){var d=c.getField(b);b=((b="function"===typeof c.getFieldDomain&&c.getFieldDomain(b))&&"coded-value"===b.type?v(b,a,k):null)||a||null;if(null!==b){var f=d.type,d=d.name;"string"===f||"date"===f||"global-id"===f?k?d=B(d+" \x3d "+h+"'"+b+"'",e):(b=b.toUpperCase(),d=B("UPPER("+d+") LIKE "+h+"'%"+b+"%'",e)):
"oid"===f||"small-integer"===f||"integer"===f||"single"===f||"double"===f?(b=Number(b),d=isNaN(b)?null:B(d+" \x3d "+b,e)):d=B(d+" \x3d "+b,e);d&&(g+=g?" OR ("+d+")":"("+d+")")}})}return d?"("+d+") AND ("+g+")":g}function n(a,c){var b=null;(a=a.codedValues)&&a.length&&a.some(function(a){return a.code===c?(b=a.name,!0):!1});return b}function C(a,c,e){var k=a.layer,d=a.attributes,g="function"===typeof k.getFieldDomain&&k.getFieldDomain(e);return c?b.substitute(c,d):e&&a.hasOwnProperty("attributes")&&
d.hasOwnProperty(e)?(a=d[e],e=k.getField(e),g&&"coded-value"===g.type?n(g,a):e&&"date"===e.type?m.format(new Date(a)):"number"===typeof a?a.toString():"string"!==typeof a?"":a.trim()):""}function w(a,c,b,e){return a.features.map(function(a){var k=a.attributes[a.layer.objectIdField];return{text:C(a,c.suggestionTemplate,e),key:k,sourceIndex:b}})}function u(a,c,b,e,k,g,h){return a.features.map(function(a){var f=a.clone(),r=a.layer,r=(r=r&&r.objectIdField)&&a.attributes[r];a=C(a,b.searchTemplate,k);var u=
t.createExtentFromGeometry(f.geometry,c,g);return{extent:h?t.scaleExtent(d.clone(u),c,h):u,feature:f,key:r,name:a,sourceIndex:e}})}Object.defineProperty(l,"__esModule",{value:!0});var A=/https?:\/\/services.*\.arcgis\.com/i,G=/(?:\{([^}]+)\})/g,D=g.getLogger("esri.widgets.Search.support.layerSearchUtils");l.getResults=function(b){var d=b.exactMatch,g=void 0===d?!1:d,t=b.location,w=b.maxResults,q=b.spatialReference,v=b.source,n=b.sourceIndex,m=b.suggestResult,A=b.view,l=v.layer,p=v.filter,B=v.zoomScale,
G=A&&A.scale,C=e(v,A);return c(l).then(function(){return r.create(function(a,c){var b=l.popupTemplate;if(b)return b.getRequiredFields(l.fields).then(function(c){return a(c)},c);a(null)})}).then(function(c){var b=l.objectIdField,e=l.returnZ,d=v.displayField||v.layer.displayField||k(v.layer);if(!l.getField(d))return D.error("invalid-field: displayField is invalid."),r.reject(new f("getResults():invalid-field","displayField is invalid."));c=c&&c.length?c:[d];var z=(c=v.outFields||c)&&-1!==c.indexOf("*");
-1!==c.indexOf(b)||z||c.push(b);if(!z&&!y(l,c))return D.error("invalid-field: outField is invalid."),r.reject(new f("getResults():invalid-field","outField is invalid."));b=l.createQuery();(z=v.searchQueryParams)&&b.set(z);q&&(b.outSpatialReference=q,z=1/h.getMetersPerUnitForSR(q))&&(b.maxAllowableOffset=z);z=!!l.get("capabilities.data.supportsZ");b.returnZ=z&&!1!==e;b.returnGeometry=!0;c&&(b.outFields=c);if(t)b.geometry=t;else if(m.key)b.objectIds=[parseInt(m.key,10)];else{e=v.searchFields||[d];if(!y(l,
e))return D.error("invalid-field: search field is invalid."),r.reject(new f("getResults():invalid-field","search field is invalid."));a(l)&&(b.num=w);C&&(b.geometry=C);c=m.text.trim();if(!c)return r.resolve();var z=v.prefix,E=v.suffix;c=(""+(void 0===z?"":z)+c+(void 0===E?"":E)).replace(/\'/g,"''");e=x(c,l,e,p,g);if(!e)return r.resolve();b.where=e}return l.queryFeatures(b).then(function(a){return u(a,A,v,n,d,G,B)})})};l.getSuggestions=function(b){var d=b.source,g=b.spatialReference,h=b.suggestTerm,
t=b.maxSuggestions,u=b.sourceIndex,q=d.layer,v=d.filter,n=e(d,b.view);return c(q).then(function(){if(!a(q))return r.resolve();var c=d.displayField||d.layer.displayField||k(d.layer),b=d.searchFields||[c],e=[];d.suggestionTemplate?d.suggestionTemplate.replace(G,function(a,c){e.push(c);return a}):e.push(c);var z=e&&-1!==e.indexOf("*");-1!==e.indexOf(q.objectIdField)||z||e.push(q.objectIdField);var E=!!q.getField(c),z=z||y(q,e),l=y(q,b);if(!E)return D.error("invalid-field: displayField is invalid."),
r.reject(new f("getSuggestions():invalid-field","displayField is invalid."));if(!z)return D.error("invalid-field: outField is invalid."),r.reject(new f("getSuggestions():invalid-field","outField is invalid."));if(!l)return D.error("invalid-field: search field is invalid."),r.reject(new f("getSuggestions():invalid-field","search field is invalid."));E=q.createQuery();(z=d.suggestQueryParams)&&E.set(z);E.outSpatialReference=g;E.returnGeometry=!1;E.num=t;E.outFields=e;n&&(E.geometry=n);z=h.trim();if(!z)return r.resolve();
var l=d.prefix,m=d.suffix,z=(""+(void 0===l?"":l)+z+(void 0===m?"":m)).replace(/\'/g,"''"),b=x(z,q,b,v,!1);if(!b)return r.resolve();E.where=b;return q.queryFeatures(E).then(function(a){return w(a,d,u,c)})})}})},"esri/widgets/Search/support/geometryUtils":function(){define("require exports ../../../geometry ../../../core/Error ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/scaleUtils ../../../views/MapView".split(" "),function(p,l,m,b,f,d,g,r,h){function t(c,
a,b){var e=c.hasZ?c.z:void 0;return a&&a.map?(b?r.getExtentForScale(a,b):a.extent).clone().centerAt(c).set({zmax:e,zmin:e}):new m.Extent({xmin:c.x-.25,ymin:c.y-.25,xmax:c.x+.25,ymax:c.y+.25,spatialReference:c.spatialReference,zmin:e,zmax:e})}Object.defineProperty(l,"__esModule",{value:!0});var e=f.getLogger("esri.widgets.Search.support.geometryUtils");l.getPointWithElevation=function(c,a){return a?c?c.hasZ||a instanceof h?g.resolve(c):(a=a.get("map.ground"))&&a.layers.length?a.queryElevation(c).then(function(a){return a.geometry}):
g.resolve(c):(e.error("missing-parameter: point is missing."),g.reject(new b("searchgeometryutils:missing-parameter","point is missing."))):(e.error("missing-parameter: view is missing."),g.reject(new b("searchgeometryutils:missing-parameter","view is missing.")))};l.getPointFromGeometry=function(c){return c instanceof m.Point?c:c instanceof m.Extent?c.center:c instanceof m.Polygon?c.centroid:c instanceof m.Multipoint?c.getPoint(0):c instanceof m.Polyline?c.getPoint(0,0):null};l.createExtentFromGeometry=
function(c,a,b){if(d.isNone(c))return null;if(c instanceof m.Extent)return c;if(c instanceof m.Multipoint||c instanceof m.Polygon||c instanceof m.Polyline)return c.extent;if(c instanceof m.Point)return t(c,a,b)};l.scaleExtent=function(c,a,b){return d.isNone(c)||d.isNone(a)?null:t(c.center,a,b)}})},"esri/views/MapView":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/asyncUtils ../core/Error ../core/has ../core/Logger ../core/promiseUtils ../core/screenUtils ../core/watchUtils ../core/workers ../core/accessorSupport/decorators ./BreakpointsOwner ./DOMContainer ./Magnifier ./MapViewBase ./2d/input/MapViewInputManager ./2d/support/HighlightOptions ./support/screenshotUtils ./support/WebGLRequirements ./ui/2d/DefaultUI2D @dojo/framework/shim/Promise".split(" "),
function(p,l,m,b,f,d,g,r,h,t,e,c,a,k,y,q,v,B,x,n,C,w,u,A){function G(){return d(this,void 0,void 0,function(){var a,c,b,e,d,k,g;return f(this,function(h){switch(h.label){case 0:return[4,Promise.all([new Promise(function(a,c){p(["./webgl"],a,c)}),new Promise(function(a,c){p(["./2d/mapViewDeps"],a,c)}),new Promise(function(a,c){p(["./2d/engine"],a,c)})])];case 1:return a=h.sent(),c=a[1],b=c.GraphicsView2D,e=c.LabelManager,d=c.MapViewNavigation,k=c.MagnifierView2D,g=a[2].Stage,K=b,z=e,E=d,N=k,J=g,[2]}})})}
var D=t.getLogger("esri.views.MapView"),J,K,z,E,N;return function(d){function f(a){a=d.call(this,a)||this;a._magnifierView=null;a._stage=null;a._resolveWhenReady=[];a.graphicsView=null;a.highlightOptions=new C;a.magnifier=new B;a.inputManager=new n({view:a});a.mapViewNavigation=null;a.supersampleScreenhotsEnabled=!0;a.ui=new A;a.rendering=!1;k.initialize();return a}m(f,d);Object.defineProperty(f.prototype,"background",{get:function(){return this.get("map.initialViewProperties.background")||null},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"interacting",{get:function(){return this.mapViewNavigation&&this.mapViewNavigation.interacting||!1},enumerable:!0,configurable:!0});f.prototype.toMap=function(a){if(c.isSupportedScreenPointEvent(a)){var b=c.createScreenPointFromSupportedEvent(this,a);return this.inherited(arguments,[b])}return this.inherited(arguments)};f.prototype.hitTest=function(a){var b=c.isSupportedScreenPointEvent(a)?c.createScreenPointFromSupportedEvent(this,
a):a;if(!this.internallyReady||isNaN(b.x)||isNaN(b.y))return e.resolve({screenPoint:b,results:[]});var d=this.toMap(b);a=[this.graphicsView];a.push.apply(a,this.allLayerViews.toArray().reverse());return e.all(a.map(function(a){return a&&a.hitTest?a.hitTest(b.x,b.y):null})).then(function(a){return{screenPoint:b,results:a.filter(function(a){return null!=a}).map(function(a){return{mapPoint:d,graphic:a}})}})};f.prototype.takeScreenshot=function(a){return this.internallyReady?this._stage.takeScreenshot(w.toRenderSettings(a,
this),this.allLayerViews):e.reject("Map view cannot be used before it is ready")};f.prototype.on=function(a,c,b){var e=this.inputManager&&this.inputManager.viewEvents.register(a,c,b);return e?e:this.inherited(arguments)};f.prototype.hasEventListener=function(a){return this.inherited(arguments)||this.inputManager&&this.inputManager.viewEvents.hasHandler(a)};f.prototype.graphicChanged=function(a){this.graphicsView&&this.graphicsView.graphicUpdateHandler(a)};f.prototype.whenReady=function(){var a=this;
return e.create(function(c){a.internallyReady?c(a):a._resolveWhenReady.push(c)})};f.prototype.forceDOMReadyCycle=function(){this.forceReadyCycle()};f.prototype.validate=function(){var a=u.check({supportsMajorWebPerformanceCaveat:!0});h("safari")&&9>h("safari")&&(a=new r("mapview:browser-not-supported","This browser is not supported by MapView (Safari \x3c 9)",{type:"safari",requiredVersion:9,detectedVersion:h("safari")}));return a?(D.warn("#validate()",a.message),e.reject(a)):g.safeCast(G())};f.prototype._startup=
function(){var c=this;this.timeline.begin("MapView Startup");if(!this.internallyReady){this.inherited(arguments);this.graphics.owner=this;var b=new J(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenhotsEnabled,contextOptions:{deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline}),e=new K({view:this,graphics:this.graphics}),d=new E({view:this,animationManager:this.animationManager}),
k=new z({view:this});this._magnifierView=new N;this._magnifierView.magnifier=this.magnifier;this._stage=b;this._frameTask.graphicsView=e;this._set("graphicsView",e);this._set("mapViewNavigation",d);this._set("labelManager",k);this.handles.add([this.allLayerViews.on("change",function(){return c._updateStageChildren()}),b.on("post-render",function(){return c._set("rendering",c.allLayerViews.some(function(a){return!0===a.rendering}))}),b.on("webgl-error",function(a){return c.fatalError=a.error}),a.init(this,
"stationary",function(a){return b.stationary=a},!0),a.init(this,"state.viewpoint",function(a){return b.state=c.state},!0),a.init(this,"background",function(a){return b.background=a},!0),a.init(this,"magnifier",function(a){return c._magnifierView.magnifier=a},!0),a.init(this,"renderingOptions",function(a){return b.renderingOptions=a},!0),a.init(this,"highlightOptions",function(){return b.highlightOptions=c.highlightOptions},!0)],"map-view");b.state=this.state;b.background=this.background;this._updateStageChildren();
e=this._resolveWhenReady;this._resolveWhenReady=[];e.forEach(function(a){return a(c)});this.timeline.end("MapView Startup")}};f.prototype._tearDown=function(){this.internallyReady&&(this.handles.remove("map-view"),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this.graphicsView.destroy(),this.mapViewNavigation.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",
null),this.graphics.owner=null,this.inherited(arguments))};f.prototype._updateStageChildren=function(){var a=this;this._stage.removeAllChildren();this.allLayerViews.filter(function(a){return null!=a.container}).forEach(function(c,b){a._stage.addChildAt(c.container,b)});this._stage.addChild(this.graphicsView.container);this._stage.addChild(this._magnifierView)};b([y.property({readOnly:!0,dependsOn:["map.initialViewProperties?.background"]})],f.prototype,"background",null);b([y.property()],f.prototype,
"graphicsView",void 0);b([y.property({type:C})],f.prototype,"highlightOptions",void 0);b([y.property({type:B})],f.prototype,"magnifier",void 0);b([y.property({readOnly:!0})],f.prototype,"inputManager",void 0);b([y.property({readOnly:!0})],f.prototype,"mapViewNavigation",void 0);b([y.property({dependsOn:["mapViewNavigation.interacting"],type:Boolean})],f.prototype,"interacting",null);b([y.property({type:Boolean,constructOnly:!0})],f.prototype,"supersampleScreenhotsEnabled",void 0);b([y.property({type:A})],
f.prototype,"ui",void 0);b([y.property({readOnly:!0})],f.prototype,"rendering",void 0);b([y.property({constructOnly:!0})],f.prototype,"renderCanvas",void 0);b([y.property({constructOnly:!0})],f.prototype,"deactivatedWebGLExtensions",void 0);b([y.property({constructOnly:!0})],f.prototype,"debugWebGLExtensions",void 0);return f=b([y.subclass("esri.views.MapView")],f)}(y.declared(q.BreakpointsOwner(v.DOMContainer(x))))})},"esri/views/Magnifier":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/accessorSupport/decorators".split(" "),
function(p,l,m,b,f,d){return function(g){function f(b){b=g.call(this)||this;b.factor=1.5;b.offsetX=0;b.offsetY=0;b.position=null;b.visible=!1;return b}m(f,g);Object.defineProperty(f.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});b([d.property({type:Number})],f.prototype,"factor",void 0);b([d.property({type:Number})],f.prototype,"offsetX",void 0);b([d.property({type:Number})],f.prototype,"offsetY",void 0);b([d.property()],f.prototype,"position",
void 0);b([d.property({readOnly:!0,dependsOn:["factor","offsetX","offsetY","position","visible"]})],f.prototype,"version",null);b([d.property({type:Boolean})],f.prototype,"visible",void 0);return f=b([d.subclass("esri.views.Magnifier")],f)}(d.declared(f))})},"esri/views/MapViewBase":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../geometry ../Viewpoint ../core/Error ../core/Logger ../core/promiseUtils ../core/screenUtils ../core/watchUtils ../core/accessorSupport/decorators ../geometry/support/webMercatorUtils ../layers/support/TileInfo ./PopupView ./View ./ViewAnimation ./2d/AnimationManager ./2d/FrameTask ./2d/MapViewConstraints ./2d/PaddedViewState ./2d/tiling ./2d/viewpointUtils ./2d/support/Timeline".split(" "),
function(p,l,m,b,f,d,g,r,h,t,e,c,a,k,y,q,v,B,x,n,C,w,u,A,G){var D=h.getLogger("esri.views.MapView");return function(h){function q(a){var c=h.call(this,a)||this;c._frameTask=new n.default(c);c.featuresTilingScheme=null;c.fullOpacity=1;c.interacting=!1;c.initialExtent=null;c.labelManager=null;c.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0};c.resizeAlign="center";c.timeline=new G.Timeline;c.type="2d";c.constraints=new C;c.padding={top:0,
right:0,bottom:0,left:0};var b=c.handles,e=function(){return c.notifyChange("updating")};b.add([c.watch("viewpoint",function(a){return c._flipStationary()},!0),c.on("resize",function(a){return c._resizeHandler(a)}),c.watch("animationManager.animation",function(a){c.animation=a}),c.allLayerViews.on("change",function(){e();b.remove("map-view-base-layerViewsUpdating");b.add(c.allLayerViews.map(function(a){return a.watch("updating",e)}),"map-view-base-layerViewsUpdating")})],"map-view-base");c.watch("ready",
function(a){a?(c._startup(),c._frameTask&&c._frameTask.start()):(c._frameTask&&c._frameTask.stop(),c._tearDown())},!0);return c}b(q,h);q.prototype.destroy=function(){this.destroyed||(this._set("ready",!1),this._frameTask.destroy(),this._tearDown(),this._gotoTask=this._frameTask=null)};Object.defineProperty(q.prototype,"animation",{set:function(a){var c=this,b=this._get("animation");a!==b&&(b&&b.stop(),!a||a.isFulfilled()?this._set("animation",null):(this._set("animation",a),b=function(){a===c._get("animation")&&
(c._set("animation",null),c._frameTask.requestFrame())},a.when(b,b)))},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"center",{get:function(){if(!this.internallyReady)return this._get("center");var a=this.content.center;return new d.Point({x:a[0],y:a[1],spatialReference:this.content.spatialReference})},set:function(a){if(null!=a)if(this._normalizeInput(a))if(this.internallyReady){var c=this.viewpoint;A.centerAt(c,c,a);this.viewpoint=c}else this._set("center",a),this.notifyChange("initialExtentRequired");
else D.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"constraints",{set:function(a){var c=this,b=this._get("constraints");b&&(this.handles.remove("map-view-base-constraints"),b.destroy());this._set("constraints",a);a&&(a.view=this,this.internallyReady&&(this.state.viewpoint=a.fit(this.content.viewpoint)),this.handles.add(a.on("update",
function(){c.internallyReady&&c.state&&(c.state.viewpoint=a.fit(c.content.viewpoint))}),"map-view-base-constraints"))},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"extent",{get:function(){return this.internallyReady?this.content.extent.clone():this._get("extent")},set:function(a){if(null!=a){var c=this._normalizeInput(a);c?c.width&&c.height?this.internallyReady?(a=this.viewpoint,A.setExtent(a,a,c,this.size,{constraints:this.constraints}),this.viewpoint=a):(this._set("extent",
c),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),this.notifyChange("initialExtentRequired")):D.error("#extent","invalid extent size"):D.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))}},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"initialExtentRequired",{get:function(){var a=this.extent,c=this.center,b=this.scale,e=this.viewpoint,
d=this.zoom;return this.get("map.initialViewProperties.viewpoint")||a||c&&(0!==b||-1!==d)||e?!1:!0},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"padding",{get:function(){return this.internallyReady?this.state.padding:this._get("padding")},set:function(a){this.internallyReady?(this.state.padding=a,this._set("padding",this.state.padding)):this._set("padding",a)},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"resolution",{get:function(){return this.state?this.state.resolution:
0},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"rotation",{get:function(){return this.internallyReady?this.content.rotation:this._get("rotation")},set:function(a){if(!isNaN(a))if(this.internallyReady){var c=this.viewpoint;A.rotateTo(c,c,a);this.viewpoint=c}else this._set("rotation",a)},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"scale",{get:function(){return this.internallyReady?this.content.scale:this._get("scale")},set:function(a){if(a&&!isNaN(a))if(this.internallyReady){var c=
this.viewpoint;A.scaleTo(c,c,a);this.viewpoint=c}else{this._set("scale",a);this._set("zoom",-1);if(a=this._get("extent"))this._set("extent",null),this._set("center",a.center);this.notifyChange("initialExtentRequired")}},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"stationary",{get:function(){return!this.animation&&!this.interacting&&!this._get("resizing")&&!this._stationaryTimer},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"updating",{get:function(){return!this.destroyed&&
(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||!0===this.get("graphicsView.updating")||this.allLayerViews.some(function(a){return!a.destroyed&&a.attached&&!0===a.updating}))},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"viewpoint",{get:function(){if(!this.internallyReady)return this._get("viewpoint");var a=this.content;return a&&a.viewpoint.clone()},set:function(a){if(null!=a){var c=this._normalizeInput(a);c?this.internallyReady?(a=new g({targetGeometry:new d.Point,
scale:0,rotation:0}),A.copy(a,c),this.constraints.constrain(a,this.content.viewpoint),this.state.viewpoint=a,this._frameTask.requestFrame(),this._set("viewpoint",a)):(this._set("viewpoint",c),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),this.notifyChange("initialExtentRequired")):!a.scale||isNaN(a.scale)?D.error("#viewpoint","invalid scale value of "+a.scale):a.targetGeometry?D.error("#viewpoint","incompatible spatialReference "+JSON.stringify(a.targetGeometry.spatialReference)+
" with view's spatialReference "+JSON.stringify(this.spatialReference)):D.error("#viewpoint","geometry not defined")}},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"zoom",{get:function(){return this.internallyReady?this.constraints.scaleToZoom(this.scale):this._get("zoom")},set:function(a){if(null!=a){if(!this.internallyReady){this.notifyChange("initialExtentRequired");this._set("zoom",a);this._set("scale",0);var c=this._get("extent");c&&(this._set("extent",null),this._set("center",
c.center))}this.constraints.effectiveLODs&&(c=this.viewpoint,A.scaleTo(c,c,this.constraints.zoomToScale(a)),this.viewpoint=c,this._set("zoom",this.constraints.scaleToZoom(this.scale)))}},enumerable:!0,configurable:!0});q.prototype.goTo=function(a,b){var e=this;if(a)return c.whenTrueOnce(this,"ready",b&&b.signal).then(function(){e.animation&&(e.animation=null);var c=m({animate:!0},b),d=A.createAsync(a,e);e._gotoTask={};return c.animate?e._gotoAnimated(d,c):e._gotoImmediate(d,c)});D.error("#goTo()",
"target cannot be null or undefined")};q.prototype.hitTest=function(a){return t.reject("Should be implemented by subclasses")};q.prototype.popupHitTest=function(a){var c=this;return this.hitTest(a).then(function(b){return m({},b,{mapPoint:c.toMap(a)})})};q.prototype.toMap=function(a){if(!this.internallyReady)return null;a=this.state.toMap([0,0],[a.x,a.y]);return new d.Point({x:a[0],y:a[1],spatialReference:this.spatialReference})};q.prototype.isTileInfoRequired=function(){return!0};q.prototype.toScreen=
function(a){if(!this.internallyReady)return null;a=this._normalizeInput(a);a=[a.x,a.y];a=this.state.toScreen(a,a);return e.createScreenPoint(a[0],a[1])};q.prototype.pixelSizeAt=function(a,c){if(!this.internallyReady)return NaN;a&&null!=a.x&&(c=a.y,a=a.x);return this.content.pixelSizeAt([a,c])};q.prototype.requestLayerViewUpdate=function(a){this.internallyReady&&this._frameTask.requestLayerViewUpdate(a)};q.prototype.requestUpdate=function(a){this.internallyReady&&this._frameTask.requestUpdate(a)};
q.prototype.getDefaultSpatialReference=function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null};q.prototype.isSpatialReferenceSupported=function(a,c){return c||this._get("ready")?!0:null!==this._getDefaultViewpoint()};q.prototype._createOrReplaceAnimation=function(a){if(!this.animation||this.animation.done)this.animation=new B;this.animation.update(a);return this.animation};q.prototype._cancellableGoTo=function(a,c,b,e){var d=this,
k=b.then(function(){a===d._gotoTask&&(d.animation=null)}).catch(function(b){a===d._gotoTask&&(d.animation=null,c.done||c.stop());throw b;}),g=t.create(function(a){return a(k)},function(){a!==d._gotoTask||c.done||c.stop()});c.when().catch(function(){a===d._gotoTask&&g.cancel&&g.cancel()});return g};q.prototype._gotoImmediate=function(a,c){var b=this,e=this._gotoTask,d=this._createOrReplaceAnimation(a);a=a.then(function(a){t.throwIfAborted(c);if(e!==b._gotoTask)throw new r("view:goto-interrupted","Goto was interrupted");
b.viewpoint=d.target=a;d.finish()});return this._cancellableGoTo(e,d,a,c)};q.prototype._gotoAnimated=function(a,c){var b=this,e=this._gotoTask,d=this._createOrReplaceAnimation(a);a=a.then(function(a){if(e!==b._gotoTask)throw new r("view:goto-interrupted","Goto was interrupted");d.update(a);b.animationManager.animate(d,b.viewpoint,c);return d.when().then(function(){},function(){})});return this._cancellableGoTo(e,d,a,c)};q.prototype._resizeHandler=function(a){var c=this.state;if(c){var b=this.content.viewpoint,
e=this.content.size.concat();c.size=[a.width,a.height];A.resize(b,b,e,this.content.size,this.resizeAlign);b=this.constraints.constrain(b,null);this.state.viewpoint=b}};q.prototype._startup=function(){if(!this.internallyReady){var a=this._getDefaultViewpoint();this.constraints.view=this;this.constraints.fit(a);this._set("animationManager",new x({view:this}));this._set("state",new w({padding:this._get("padding"),size:this.size,viewpoint:a}));this._set("content",this.state.content);this._set("featuresTilingScheme",
new u.TileInfoView(y.create({spatialReference:this.spatialReference,size:512})));this.internallyReady=!0}};q.prototype._tearDown=function(){if(this.internallyReady){this.internallyReady=!1;this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null,this.notifyChange("stationary"));var a=this._get("content"),c=a.center,b=a.spatialReference,c=new d.Point({x:c[0],y:c[1],spatialReference:b});this._set("viewpoint",null);this._set("extent",null);this._set("center",c);this._set("zoom",
-1);this._set("rotation",a.rotation);this._set("scale",a.scale);this._set("spatialReference",b);this.constraints.view=null;this.animationManager.destroy();this._set("animationManager",null);this._set("state",null);this._set("content",null);this.animation=null}};q.prototype._flipStationary=function(){var a=this;this._stationaryTimer&&clearTimeout(this._stationaryTimer);this._stationaryTimer=setTimeout(function(){a._stationaryTimer=null;a.notifyChange("stationary")},160);this.notifyChange("stationary")};
q.prototype._normalizeInput=function(a,c){void 0===c&&(c=this.spatialReference);var b=a&&a.targetGeometry||a;return c?b?c.equals(b.spatialReference)?a:k.canProject(b,c)?a&&"esri.Viewpoint"===a.declaredClass?(a.targetGeometry=k.project(b,c),a):k.project(b,c):null:null:a};q.prototype._getDefaultViewpoint=function(){var a=this.constraints,c=this._get("zoom"),b=this._get("scale"),e=this._normalizeInput(this._get("center")),d=this._normalizeInput(this._get("extent")),k=this._get("rotation"),h=this._normalizeInput(this._get("viewpoint"));
a.effectiveLODs?-1!==c&&(b=a.zoomToScale(c)):c=-1;var f=null,q=null,c=0,a=h&&h.rotation,t=h&&h.targetGeometry;t&&("extent"===t.type?f=t:"point"===t.type&&(q=t,c=h.scale));h=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"));t=this._normalizeInput(this.initialExtent);d=d||f||h||t;e=e||q||d&&d.center;b=b||c||d&&A.extentToScale(d,this.size);return e&&b?new g({targetGeometry:e,scale:b,rotation:k||a||0}):null};f([a.property()],q.prototype,"animation",null);f([a.property({readOnly:!0})],
q.prototype,"animationManager",void 0);f([a.property({value:null,type:d.Point,dependsOn:["content.viewpoint"]})],q.prototype,"center",null);f([a.property({type:C})],q.prototype,"constraints",null);f([a.property({readOnly:!0})],q.prototype,"content",void 0);f([a.property({value:null,type:d.Extent,dependsOn:["content.viewpoint"]})],q.prototype,"extent",null);f([a.property({readOnly:!0})],q.prototype,"featuresTilingScheme",void 0);f([a.property()],q.prototype,"fullOpacity",void 0);f([a.property({readOnly:!0})],
q.prototype,"interacting",void 0);f([a.property({type:d.Extent})],q.prototype,"initialExtent",void 0);f([a.property({dependsOn:["map.initialViewProperties?.viewpoint"]})],q.prototype,"initialExtentRequired",null);f([a.property()],q.prototype,"labelManager",void 0);f([a.property({value:{top:0,right:0,bottom:0,left:0},cast:function(a){return m({top:0,right:0,bottom:0,left:0},a)}})],q.prototype,"padding",null);f([a.property({type:Object})],q.prototype,"renderingOptions",void 0);f([a.property()],q.prototype,
"resizeAlign",void 0);f([a.property({readOnly:!0,dependsOn:["content.viewpoint"]})],q.prototype,"resolution",null);f([a.property({value:0,type:Number,dependsOn:["content.viewpoint"]})],q.prototype,"rotation",null);f([a.property({value:0,type:Number,dependsOn:["content.viewpoint"]})],q.prototype,"scale",null);f([a.property({type:d.SpatialReference,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],q.prototype,"spatialReference",void 0);f([a.property({readOnly:!0})],
q.prototype,"state",void 0);f([a.property()],q.prototype,"stationary",null);f([a.property({type:G.Timeline,readOnly:!0})],q.prototype,"timeline",void 0);f([a.property({readOnly:!0})],q.prototype,"type",void 0);f([a.property({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"]})],q.prototype,"updating",null);f([a.property({value:null,type:g,dependsOn:["content.viewpoint"]})],q.prototype,"viewpoint",null);f([a.property({value:-1,dependsOn:["scale"]})],
q.prototype,"zoom",null);return q=f([a.subclass("esri.views.MapViewBase")],q)}(a.declared(q.PopupView(v)))})},"esri/views/2d/AnimationManager":function(){define("../../Viewpoint ../../core/Accessor ../../core/scheduling ../../core/now ../../geometry/Point ../ViewAnimation ./unitBezier ./viewpointUtils".split(" "),function(p,l,m,b,f,d,g,r){var h=function(b,e,c,a){var d=b.targetGeometry,h=e.targetGeometry;a?"string"===typeof a&&(a=g.parse(a)||g.ease):a=g.ease;this.easing=a;this.duration=c;this.sCenterX=
d.x;this.sCenterY=d.y;this.sScale=b.scale;this.sRotation=b.rotation;this.tCenterX=h.x;this.tCenterY=h.y;this.tScale=e.scale;this.tRotation=e.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:-180>this.dRotation&&(this.dRotation+=360)};h.prototype.applyRatio=function(b,e){var c=this.easing(e),a,d;1<=e?(e=this.tCenterX,a=this.tCenterY,d=this.tRotation,
c=this.tScale):(e=this.sCenterX+c*this.dCenterX,a=this.sCenterY+c*this.dCenterY,d=this.sRotation+c*this.dRotation,c=this.sScale+c*this.dScale);b.targetGeometry.x=e;b.targetGeometry.y=a;b.scale=c;b.rotation=d};return l.createSubclass({constructor:function(){this.viewpoint=new p({targetGeometry:new f,scale:0,rotation:0});this._updateTask=m.addFrameTask({postRender:this._postRender.bind(this)});this._updateTask.pause()},properties:{animation:null,duration:{value:200},transition:{value:null},easing:{value:g.ease},
view:null,viewpoint:null},animate:function(d,e,c){this.stop();r.copy(this.viewpoint,e);this.transition=new h(this.viewpoint,d.target,c&&c.duration||this.duration,c&&c.easing||this.easing);e=function(){this.animation===d&&this._updateTask&&("finished"===d.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this._updateTask.pause(),this.updateFunction=this.animation=null)}.bind(this);d.when(e,e);this._startTime=b();this._updateTask.resume();
return this.animation=d},animateContinous:function(g,e){this.stop();this.updateFunction=e;this.viewpoint=g;var c=new d({target:g.clone()});g=function(){this.animation===c&&this._updateTask&&(this._updateTask.pause(),this.updateFunction=this.animation=null)}.bind(this);c.when(g,g);this._startTime=b();this._updateTask.resume();return this.animation=c},stop:function(){this.animation&&(this.animation.stop(),this.updateFunction=this.animation=null)},_postRender:function(g){var e=this.animation;e&&e.state!==
d.STOPPED?(this.updateFunction?this.updateFunction(this.viewpoint,g.deltaTime):(g=(b()-this._startTime)/this.transition.duration,e=1<=g,this.transition.applyRatio(this.viewpoint,g),e&&this.animation.finish()),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())):this._updateTask.pause()}})})},"esri/views/2d/unitBezier":function(){define([],function(){var p=function(l,b,f,d){function g(a,c){var b,e,d,k;c=null==c?1E-6:c;d=a;for(e=0;8>e;e++){k=((t*d+h)*d+r)*d-a;if(Math.abs(k)<c)return d;
b=(3*t*d+2*h)*d+r;if(1E-6>Math.abs(b))break;d-=k/b}b=0;e=1;d=a;if(d<b)return b;if(d>e)return e;for(;b<e;){k=((t*d+h)*d+r)*d;if(Math.abs(k-a)<c)break;a>k?b=d:e=d;d=.5*(e-b)+b}return d}var r=3*l,h=3*(f-l)-r,t=1-r-h,e=3*b,c=3*(d-b)-e,a=1-e-c;return function(b,d){b=g(b,d);return((a*b+c)*b+e)*b}},l=/^cubic-bezier\((.*)\)/;p.parse=function(m){var b=p[m]||null;!b&&(m=l.exec(m))&&(m=m[1].split(",").map(function(b){return parseFloat(b.trim())}),4!==m.length||m.some(function(b){return isNaN(b)})||(b=p.apply(p,
m)));return b};p.ease=p(.25,.1,.25,1);p.linear=p(0,0,1,1);p.easeIn=p["ease-in"]=p(.42,0,1,1);p.easeOut=p["ease-out"]=p(0,0,.58,1);p.easeInOut=p["ease-in-out"]=p(.42,0,.58,1);return p})},"esri/views/2d/FrameTask":function(){define(["require","exports","../../core/scheduling"],function(p,l,m){Object.defineProperty(l,"__esModule",{value:!0});p=function(){function b(b){var d=this;this.view=b;this._frameTaskHandle=null;this.updateEnabled=this.stationary=!0;this.prepare=function(){d._updateParameters.state=
d.view.state;d._updateParameters.stationary=d.view.stationary;d._updateParameters.pixelRatio=window.devicePixelRatio;d._updateParameters.renderingOptions=d.view.renderingOptions};this.update=function(){if(d.updateEnabled){for(var b=d.view,f=b.labelManager,h=d.graphicsView,t=b.allLayerViews.toArray().filter(function(a){return a.isFulfilled()&&null==a.layerViews}),e=t.length,c=b.state,a=0;a<t.length;a++)if(b=t[a],b.attached){var k=b.lastUpdateId;if(null==k||!d.stationary&&!b.moving)b.moving=!0,b.moveStart();
k!==c.id&&b.viewChange();d.stationary&&b.moving&&(b.moving=!1,b.moveEnd());b.lastUpdateId=c.id}f&&f.lastUpdateId!==c.id&&(f.viewChange(),f.lastUpdateId=c.id);h&&h.lastUpdateId!==c.id&&(h.viewChange(),h.lastUpdateId=c.id);f=d._layerViewsTrash;for(h=0;h<f.length;h++)b=f[h],d._detachLayerView(b);for(h=f.length=0;h<e;h++)b=t[h],b.isFulfilled()&&!b.attached&&d._attachLayerView(b);t=d._updateParameters;e=d._layerViewsToUpdate;b=e.slice();h=e.length=0;for(c=b;h<c.length;h++)b=c[h],!("attached"in b)||"attached"in
b&&b.attached?b.processUpdate(t):e.push(b);e=d._updatablesToUpdate;b=e.slice();for(e=e.length=0;e<b.length;e++)b[e].processUpdate(t);0===d._layerViewsToUpdate.length&&0===d._updatablesToUpdate.length&&0===f.length&&d._frameTaskHandle.pause()}}}b.prototype.destroy=function(){this.stop()};b.prototype.start=function(){var b=this;this.stationary=this.view.stationary;this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions};
this._layerViewsTrash=[];this._layerViewsToUpdate=[];this._updatablesToUpdate=[];this._allLayerViewsChangeHandle=this.view.allLayerViews.on("change",function(d){Array.prototype.push.apply(b._layerViewsTrash,d.removed);b.requestFrame()});this._stationaryHandle=this.view.watch("stationary",function(d){b.stationary=d;b.requestFrame()});this._frameTaskHandle=m.addFrameTask(this)};b.prototype.stop=function(){var b=this;this._frameTaskHandle&&(this.view.allLayerViews.forEach(function(d){return b._detachLayerView(d)}),
this._stationaryHandle.remove(),this._allLayerViewsChangeHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._allLayerViewsChangeHandle=this._frameTaskHandle=this._layerViewsTrash=this._layerViewsToUpdate=null,this.stationary=!0)};b.prototype.requestLayerViewUpdate=function(b){this._layerViewsToUpdate.push(b);this.requestFrame()};b.prototype.requestUpdate=function(b){this._updatablesToUpdate.push(b);this.requestFrame()};b.prototype.requestFrame=function(){this._frameTaskHandle&&
this._frameTaskHandle.resume()};b.prototype._attachLayerView=function(b){b.attached||(b.attached=!0,b.attach(),this._updateParameters.stationary?b.moving=!1:(b.moving=!0,b.moveStart()))};b.prototype._detachLayerView=function(b){b.attached&&(b.detach(),b.attached=!1,b.moving=!1)};return b}();l.default=p})},"esri/views/2d/MapViewConstraints":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Evented ../../core/accessorSupport/decorators ../../layers/support/LOD ./constraints/RotationConstraint ./constraints/ZoomConstraint".split(" "),
function(p,l,m,b,f,d,g,r,h){return function(f){function e(){var c=null!==f&&f.apply(this,arguments)||this;c.lods=null;c.minScale=0;c.maxScale=0;c.minZoom=-1;c.maxZoom=-1;c.rotationEnabled=!0;c.snapToZoom=!0;return c}m(e,f);e.prototype.initialize=function(){this.watch("_zoom, _rotation",this.emit.bind(this,"update"),!0)};e.prototype.destroy=function(){this.view=null;this._set("_zoom",null);this._set("_rotation",null)};Object.defineProperty(e.prototype,"_rotation",{get:function(){return new r({rotationEnabled:this.rotationEnabled})},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"_defaultLODs",{get:function(){var c=this.get("view.defaultsFromMap.tileInfo"),a=this.get("view.spatialReference");return c&&a&&c.spatialReference.equals(a)?c.lods:null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"_zoom",{get:function(){return new h({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})},enumerable:!0,
configurable:!0});e.prototype.canZoomInTo=function(c){var a=this.effectiveMaxScale;return 0===a||c>=a};e.prototype.canZoomOutTo=function(c){var a=this.effectiveMinScale;return 0===a||c<=a};e.prototype.constrain=function(c,a){this._zoom.constrain(c,a);this._rotation.constrain(c,a);return c};e.prototype.fit=function(c){return this._zoom.fit(c)};e.prototype.zoomToScale=function(c){return this._zoom.zoomToScale(c)};e.prototype.scaleToZoom=function(c){return this._zoom.scaleToZoom(c)};e.prototype.snapScale=
function(c){return this._zoom.snapToClosestScale(c)};e.prototype.snapToNextScale=function(c){return this._zoom.snapToNextScale(c)};e.prototype.snapToPreviousScale=function(c){return this._zoom.snapToPreviousScale(c)};b([d.property({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],e.prototype,"effectiveLODs",void 0);b([d.property({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],e.prototype,"effectiveMinScale",void 0);b([d.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],e.prototype,"effectiveMaxScale",
void 0);b([d.property({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],e.prototype,"effectiveMinZoom",void 0);b([d.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],e.prototype,"effectiveMaxZoom",void 0);b([d.property({type:[g]})],e.prototype,"lods",void 0);b([d.property()],e.prototype,"minScale",void 0);b([d.property()],e.prototype,"maxScale",void 0);b([d.property()],e.prototype,"minZoom",void 0);b([d.property()],e.prototype,"maxZoom",void 0);b([d.property()],e.prototype,"rotationEnabled",
void 0);b([d.property()],e.prototype,"snapToZoom",void 0);b([d.property()],e.prototype,"view",void 0);b([d.property({type:r,dependsOn:["rotationEnabled"]})],e.prototype,"_rotation",null);b([d.property({dependsOn:["view.spatialReference","view.defaultsFromMap.tileInfo"]})],e.prototype,"_defaultLODs",null);b([d.property({readOnly:!0,type:h,dependsOn:"lods minZoom maxZoom minScale maxScale snapToZoom _defaultLODs".split(" ")})],e.prototype,"_zoom",null);return e=b([d.subclass("esri.views.2d.MapViewConstraints")],
e)}(d.declared(f.EventedAccessor))})},"esri/views/2d/constraints/RotationConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(p,l,m,b,f,d){return function(g){function f(){var b=null!==g&&g.apply(this,arguments)||this;b.enabled=!0;b.rotationEnabled=!0;return b}m(f,g);h=f;f.prototype.constrain=function(b,e){if(!this.enabled||!e)return b;this.rotationEnabled||
(b.rotation=e.rotation);return b};f.prototype.clone=function(){return new h({enabled:this.enabled,rotationEnabled:this.rotationEnabled})};var h;b([d.property()],f.prototype,"enabled",void 0);b([d.property()],f.prototype,"rotationEnabled",void 0);return f=h=b([d.subclass("esri.views.2d.constraints.RotationConstraint")],f)}(d.declared(f))})},"esri/views/2d/constraints/ZoomConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../layers/support/LOD".split(" "),
function(p,l,m,b,f,d,g){return function(f){function h(b){b=f.call(this,b)||this;b._lodByScale={};b._scales=[];b.effectiveLODs=null;b.effectiveMinZoom=-1;b.effectiveMaxZoom=-1;b.effectiveMinScale=0;b.effectiveMaxScale=0;b.lods=null;b.minZoom=-1;b.maxZoom=-1;b.minScale=0;b.maxScale=0;b.snapToZoom=!0;return b}m(h,f);t=h;h.prototype.initialize=function(){var b=this,c,a,d=this.lods;a=this.minScale;c=this.maxScale;var h=this.minZoom,g=this.maxZoom,f=-1,t=-1,r=!1,n=!1;0!==a&&0!==c&&a<c&&(c=[c,a],a=c[0],
c=c[1]);if(d&&d.length){d=d.map(function(a){return a.clone()});d.sort(function(a,b){return b.scale-a.scale});d.forEach(function(a,b){return a.level=b});for(var l,w=0,u=d;w<u.length;w++){var m=u[w];!r&&0<a&&a>=m.scale&&(f=m.level,r=!0);!n&&0<c&&c>=m.scale&&(t=l?l.level:-1,n=!0);l=m}-1===h&&(h=0===a?0:f);-1===g&&(g=0===c?d.length-1:t);h=Math.max(h,0);h=Math.min(h,d.length-1);g=Math.max(g,0);g=Math.min(g,d.length-1);h>g&&(a=[g,h],h=a[0],g=a[1]);a=d[h].scale;c=d[g].scale;d.splice(0,h);d.splice(g-h+1,
d.length);d.forEach(function(a,c){b._lodByScale[a.scale]=a;b._scales[c]=a.scale});this._set("effectiveLODs",d);this._set("effectiveMinZoom",h);this._set("effectiveMaxZoom",g)}this._set("effectiveMinScale",a);this._set("effectiveMaxScale",c)};h.prototype.constrain=function(b,c){if(c&&b.scale===c.scale)return b;var a=this.effectiveMinScale,e=this.effectiveMaxScale,d=b.targetGeometry,h=c&&c.targetGeometry,g=0!==a&&b.scale>a;if(0!==e&&b.scale<e||g)a=g?a:e,h&&(c=(a-c.scale)/(b.scale-c.scale),d.x=h.x+(d.x-
h.x)*c,d.y=h.y+(d.y-h.y)*c),b.scale=a;this.snapToZoom&&this.effectiveLODs&&(b.scale=this._getClosestScale(b.scale));return b};h.prototype.fit=function(b){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(b,null);var c=this.scaleToZoom(b.scale);b.scale=this.zoomToScale(.99<Math.abs(c-Math.floor(c))?Math.round(c):Math.floor(c));return b};h.prototype.zoomToScale=function(b){if(!this.effectiveLODs)return 0;b-=this.effectiveMinZoom;b=Math.max(0,b);var c=this._scales;if(0>=b)return c[0];if(b>=
c.length)return c[c.length-1];var a=Math.round(b);return c[a]+(a-b)*(c[Math.round(b-.5)]-c[a])};h.prototype.scaleToZoom=function(b){if(!this.effectiveLODs)return-1;var c=this._scales,a,e;if(b>=c[0])return this.effectiveMinZoom;if(b<=c[c.length-1])return this.effectiveMaxZoom;for(var d=0;d<c.length-1;d++){a=c[d];e=c[d+1];if(e===b)return c=d+this.effectiveMinZoom,c+1;if(a>b&&e<b)return c=d+this.effectiveMinZoom,c+1-(b-e)/(a-e)}};h.prototype.snapToClosestScale=function(b){if(!this.effectiveLODs)return b;
b=this.scaleToZoom(b);return this.zoomToScale(Math.round(b))};h.prototype.snapToNextScale=function(b,c){void 0===c&&(c=.5);if(!this.effectiveLODs)return b*c;b=Math.round(this.scaleToZoom(b));return this.zoomToScale(b+1)};h.prototype.snapToPreviousScale=function(b,c){void 0===c&&(c=2);if(!this.effectiveLODs)return b*c;b=Math.round(this.scaleToZoom(b));return this.zoomToScale(b-1)};h.prototype.clone=function(){return new t({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,
maxScale:this.maxScale})};h.prototype._getClosestScale=function(b){if(this._lodByScale[b])return this._lodByScale[b].scale;b=this._scales.reduce(function(c,a,e,d){return Math.abs(a-b)<=Math.abs(c-b)?a:c},this._scales[0]);return this._lodByScale[b].scale};var t;b([d.property({readOnly:!0})],h.prototype,"effectiveLODs",void 0);b([d.property({readOnly:!0})],h.prototype,"effectiveMinZoom",void 0);b([d.property({readOnly:!0})],h.prototype,"effectiveMaxZoom",void 0);b([d.property({readOnly:!0})],h.prototype,
"effectiveMinScale",void 0);b([d.property({readOnly:!0})],h.prototype,"effectiveMaxScale",void 0);b([d.property({type:[g]})],h.prototype,"lods",void 0);b([d.property()],h.prototype,"minZoom",void 0);b([d.property()],h.prototype,"maxZoom",void 0);b([d.property()],h.prototype,"minScale",void 0);b([d.property()],h.prototype,"maxScale",void 0);b([d.property()],h.prototype,"snapToZoom",void 0);return h=t=b([d.subclass("esri.views.2d.constraints.ZoomConstraint")],h)}(d.declared(f))})},"esri/views/2d/PaddedViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ./viewpointUtils ./ViewState".split(" "),
function(p,l,m,b,f,d,g,r,h,t){var e=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.left=0;a.top=0;a.right=0;a.bottom=0;return a}m(a,c);b([d.property()],a.prototype,"left",void 0);b([d.property()],a.prototype,"top",void 0);b([d.property()],a.prototype,"right",void 0);b([d.property()],a.prototype,"bottom",void 0);return a=b([d.subclass("esri.views.2d.PaddedViewState.Padding")],a)}(d.declared(f));return function(c){function a(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];
var d=c.apply(this,a)||this;d.content=new t;d._updateContent=function(){var a=r.vec2f64.create();return function(){var b=d._get("size"),c=d._get("padding");if(b&&c){var e=d.content;g.vec2.set(a,c.left+c.right,c.top+c.bottom);g.vec2.subtract(a,b,a);g.vec2.copy(e.size,a);if(b=e.viewpoint)d.viewpoint=b}}}();d.watch(["size","padding"],d._updateContent,!0);d.padding=new e;d.size=[0,0];return d}m(a,c);Object.defineProperty(a.prototype,"padding",{set:function(a){this._set("padding",a||new e)},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"viewpoint",{set:function(a){if(a){var b=a.clone();this.content.viewpoint=a;h.addPadding(b,a,this._get("size"),this._get("padding"));a=this._viewpoint2D;var c=b.targetGeometry;a.center[0]=c.x;a.center[1]=c.y;a.rotation=b.rotation;a.scale=b.scale;a.spatialReference=c.spatialReference;this._update()}},enumerable:!0,configurable:!0});b([d.property()],a.prototype,"content",void 0);b([d.property({type:e})],a.prototype,"padding",null);b([d.property()],
a.prototype,"viewpoint",null);return a=b([d.subclass("esri.views.2d.PaddedViewState")],a)}(d.declared(t))})},"esri/views/2d/input/MapViewInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/Handles ../../../core/watchUtils ../../../core/accessorSupport/decorators ./handlers/DoubleClickZoom ./handlers/DragPan ./handlers/DragRotate ./handlers/GamepadNavigation ./handlers/KeyPan ./handlers/KeyRotate ./handlers/KeyZoom ./handlers/MouseWheelZoom ./handlers/PinchAction ../../input/BrowserEventSource ../../input/InputManager ../../input/ViewEvents ../../input/handlers/PreventContextMenu ../../input/recognizers/Drag ../../input/recognizers/PointerClickHoldAndDrag ../../input/recognizers/SingleAndDoubleClick".split(" "),
function(p,l,m,b,f,d,g,r,h,t,e,c,a,k,y,q,v,B,x,n,C,w,u,A){var G={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},D={zoomIn:["\x3d","+"],zoomOut:["-","_"]},J={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};return function(f){function l(){var a=null!==f&&f.apply(this,arguments)||this;a._handles=new d;return a}m(l,f);l.prototype.initialize=function(){var a=this;this.viewEvents=new n.ViewEvents(this.view);
this._handles.add([g.whenNot(this.view,"ready",function(){return a._disconnect()}),g.when(this.view,"ready",function(){return a._connect()})])};l.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect();this.viewEvents.destroy();this.viewEvents=null};l.prototype._disconnect=function(){this._inputManager&&(this.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null)};l.prototype._connect=
function(){var b=new B.BrowserEventSource(this.view.surface,this.view.input),d=[new u.PointerClickHoldAndDrag,new A.SingleAndDoubleClick,new w.Drag],d=new x.InputManager(b,d);d.installHandlers("prevent-context-menu",[new C.PreventContextMenu]);d.installHandlers("navigation",[new v.PinchRotateAndZoom(this.view),new c.GamepadNavigation(this.view),new q.MouseWheelZoom(this.view),new h.DoubleClickZoom(this.view),new t.DragPan(this.view,"primary"),new a.KeyPan(this.view,G),new y.KeyZoom(this.view,D),new k.KeyRotate(this.view,
J),new e.DragRotate(this.view,"secondary"),new h.DoubleClickZoom(this.view,["Ctrl"])]);this.viewEvents.connect(d);this._source=b;this._inputManager=d};Object.defineProperty(l.prototype,"debug",{get:function(){return{inputManager:this._inputManager}},enumerable:!0,configurable:!0});b([r.property()],l.prototype,"view",void 0);return l=b([r.subclass("esri.views.2d.input.MapViewInputManager")],l)}(r.declared(f))})},"esri/views/2d/input/handlers/DoubleClickZoom":function(){define(["require","exports",
"../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(p,l,m,b,f){Object.defineProperty(l,"__esModule",{value:!0});p=function(b){function d(d,h){var g=b.call(this,!0)||this;g.view=d;g.registerIncoming("double-click",h,function(b){return g._handleDoubleClick(b,h)});return g}m(d,b);d.prototype._handleDoubleClick=function(b,d){f.eventMatchesPointerAction(b.data,"primary")&&(b.stopPropagation(),d?this.view.mapViewNavigation.zoomOut([b.data.x,
b.data.y]):this.view.mapViewNavigation.zoomIn([b.data.x,b.data.y]))};return d}(b.InputHandler);l.DoubleClickZoom=p})},"esri/views/2d/input/handlers/DragPan":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),function(p,l,m,b,f,d){Object.defineProperty(l,"__esModule",{value:!0});p=function(g){function f(h,f,e){var c=g.call(this,!0)||this;c.view=h;c.pointerAction=f;c.registerIncoming("drag",
e,function(a){return c._handleDrag(a)});c.registerIncoming("pointer-down",function(a){return c.stopMomentumNavigation()});var a=c.view.mapViewNavigation;c.dragEventSeparator=new b.DragEventSeparator({start:function(b,d){a.pan.begin(c.view,d.data);d.stopPropagation()},update:function(b,d){a.pan.update(c.view,d.data);d.stopPropagation()},end:function(b,d){a.pan.end(c.view,d.data);d.stopPropagation()},condition:function(a,b){return 1===a&&d.eventMatchesPointerAction(b.data,c.pointerAction)}});return c}
m(f,g);f.prototype._handleDrag=function(b){var d=this.view.mapViewNavigation;d.pinch.zoomMomentum||d.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(b)};f.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pan.stopMomentumNavigation()};return f}(f.InputHandler);l.DragPan=p})},"esri/views/2d/input/handlers/DragRotate":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),
function(p,l,m,b,f,d){Object.defineProperty(l,"__esModule",{value:!0});p=function(g){function f(h,f,e){var c=g.call(this,!0)||this;c.view=h;c.pointerAction=f;var a=c.view.mapViewNavigation;c.dragEventSeparator=new b.DragEventSeparator({start:function(b,d){a.rotate.begin(c.view,d.data);d.stopPropagation()},update:function(b,d){a.rotate.update(c.view,d.data);d.stopPropagation()},end:function(b,d){a.rotate.end(c.view,d.data);d.stopPropagation()},condition:function(a,b){return 1===a&&d.eventMatchesPointerAction(b.data,
c.pointerAction)}});c.registerIncoming("drag",e,function(a){return c.dragEventSeparator.handle(a)});return c}m(f,g);return f}(f.InputHandler);l.DragRotate=p})},"esri/views/2d/input/handlers/GamepadNavigation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Handles ../../../../core/scheduling ../../../../core/watchUtils ../../viewpointUtils ../../../input/InputHandler ../../../navigation/gamepadAndKeyboardUtils".split(" "),function(p,l,m,b,f,d,g,r,h){Object.defineProperty(l,
"__esModule",{value:!0});p=function(a){function k(c){var d=a.call(this,!0)||this;d.view=c;d.frameTask=null;d.watchHandles=new b;d.currentDevice=null;d.transformation={translation:[0,0,0],heading:0,tilt:0};d.handle=d.registerIncoming("gamepad",function(a){return d.handleEvent(a)});d.handle.pause();return d}m(k,a);k.prototype.onInstall=function(b){var c=this;a.prototype.onInstall.call(this,b);this.watchHandles.add([d.init(this.view.navigation.gamepad,"enabled",function(a){a?(c.handle.resume(),c.frameTask||
(c.frameTask=f.addFrameTask({update:function(a){return c.frameUpdate(a.deltaTime)}}))):(c.handle.pause(),c.frameTask&&(c.frameTask.remove(),c.frameTask=null))})])};k.prototype.onUninstall=function(){this.watchHandles.removeAll();this.frameTask&&(this.frameTask.remove(),this.frameTask=null);a.prototype.onUninstall.call(this)};k.prototype.handleEvent=function(a){var b=this.view.navigation.gamepad.device;b&&a.data.device!==b||this.currentDevice&&this.currentDevice!==a.data.device||("end"===a.data.action?
(this.currentDevice=null,h.resetTransformation(this.transformation)):(this.currentDevice=a.data.device,h.extractTransformation(a.data,this.view.navigation.gamepad,this.transformation)))};k.prototype.frameUpdate=function(a){var b=this.transformation;if(!h.isZeroTransformation(b)){var d=this.view.viewpoint.clone(),k=e*this.view.navigation.gamepad.velocityFactor*a;g.translateBy(d,d,[b.translation[0]*k,-b.translation[1]*k]);k=this.view.size;g.scaleAndRotateBy(d,d,1+b.translation[2]*c*a,this.view.constraints.rotationEnabled?
-b.heading*t*a:0,[k[0]/2,k[1]],k);a=this.view.constraints.constrain(d,this.view.viewpoint);this.view.viewpoint=a}};return k}(r.InputHandler);l.GamepadNavigation=p;var t=.06,e=.7,c=6E-4})},"esri/views/2d/input/handlers/KeyPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(p,l,m,b){Object.defineProperty(l,"__esModule",{value:!0});p=function(b){function d(d,f,h){var g,e=b.call(this,!0)||this;e.view=d;e.keys=f;e._pressed=!1;e._keyMap=
(g={},g[f.left]="left",g[f.right]="right",g[f.up]="up",g[f.down]="down",g);e.registerIncoming("key-down",h,function(b){return e._handleKeyDown(b)});e.registerIncoming("key-up",h,function(b){return e._handleKeyUp(b)});e.registerIncoming("blur",h,function(){return e._handleBlur()});return e}m(d,b);d.prototype._handleKeyDown=function(b){b.data.repeat||this._handleKey(b,!0)};d.prototype._handleKeyUp=function(b){this._handleKey(b,!1)};d.prototype._handleBlur=function(){this._pressed&&(this._pressed=!1,
this.view.mapViewNavigation.stop())};d.prototype._handleKey=function(b,d){var h=this._keyMap[b.data.key];if(this._pressed=null!=h){if(d)switch(h){case "left":this.view.mapViewNavigation.continousPanLeft();break;case "right":this.view.mapViewNavigation.continousPanRight();break;case "up":this.view.mapViewNavigation.continousPanUp();break;case "down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();b.stopPropagation()}};return d}(b.InputHandler);
l.KeyPan=p})},"esri/views/2d/input/handlers/KeyRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(p,l,m,b){Object.defineProperty(l,"__esModule",{value:!0});p=function(b){function d(d,f,h){var g,e=b.call(this,!0)||this;e.view=d;e.keys=f;e._pressed=!1;e._keyToDirection=(g={},g[f.clockwiseOption1]="clockwise",g[f.clockwiseOption2]="clockwise",g[f.counterClockwiseOption1]="counterClockwise",g[f.counterClockwiseOption2]="counterClockwise",
g[f.resetOption1]="reset",g[f.resetOption2]="reset",g);e.registerIncoming("key-down",h,function(b){return e._handleKeyDown(b)});e.registerIncoming("key-up",h,function(b){return e._handleKeyUp(b)});e.registerIncoming("blur",h,function(){return e._handleBlur()});return e}m(d,b);d.prototype._handleKeyDown=function(b){b.data.repeat||this._handleKey(b,!0)};d.prototype._handleKeyUp=function(b){this._handleKey(b,!1)};d.prototype._handleBlur=function(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())};
d.prototype._handleKey=function(b,d){var h=b.modifiers;if(!(0<h.size&&!h.has("Shift")||!this.view.constraints.rotationEnabled)&&(h=this._keyToDirection[b.data.key],this._pressed=null!=h)){if(d)switch(h){case "clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case "counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case "reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();b.stopPropagation()}};
return d}(b.InputHandler);l.KeyRotate=p})},"esri/views/2d/input/handlers/KeyZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(p,l,m,b){Object.defineProperty(l,"__esModule",{value:!0});p=function(b){function d(d,f,h){var g=b.call(this,!0)||this;g.view=d;g.keys=f;g._keysToZoomAction={};g.registerIncoming("key-down",h,function(b){return g._handleKeyDown(b)});f.zoomIn.forEach(function(b){return g._keysToZoomAction[b]=0});f.zoomOut.forEach(function(b){return g._keysToZoomAction[b]=
1});return g}m(d,b);d.prototype._handleKeyDown=function(b){this._handleKey(b)};d.prototype._handleKey=function(b){var d=b.modifiers;0<d.size&&!d.has("Shift")||(d=this._keysToZoomAction[b.data.key],0===d?(this.view.mapViewNavigation.zoomIn(),b.stopPropagation()):1===d&&(this.view.mapViewNavigation.zoomOut(),b.stopPropagation()))};return d}(b.InputHandler);l.KeyZoom=p})},"esri/views/2d/input/handlers/MouseWheelZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],
function(p,l,m,b){Object.defineProperty(l,"__esModule",{value:!0});p=function(b){function d(d,f){var h=b.call(this,!0)||this;h.view=d;h._canZoom=!0;h.registerIncoming("mouse-wheel",f,function(b){return h._handleMouseWheel(b)});return h}m(d,b);d.prototype._handleMouseWheel=function(b){var d=this;if(this._canZoom){var h=this.view.mapViewNavigation,f=b.data;if(f=h.zoom(1/Math.pow(.6,1/60*f.deltaY),[f.x,f.y]))this._canZoom=!1,f.catch(function(b){}).then(function(){d._canZoom=!0;h.end()});b.stopPropagation()}};
return d}(b.InputHandler);l.MouseWheelZoom=p})},"esri/views/2d/input/handlers/PinchAction":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/DragEventSeparator","../../../input/InputHandler"],function(p,l,m,b,f){Object.defineProperty(l,"__esModule",{value:!0});p=function(d){function f(f){var h=d.call(this,!0)||this;h.view=f;h.registerIncoming("drag",function(b){return h._handleDrag(b)});h.registerIncoming("pointer-down",function(b){return h.stopMomentumNavigation()});
var g=h.view.mapViewNavigation;h.dragEventSeparator=new b.DragEventSeparator({start:function(b,c){g.pinch.begin(h.view,c.data);c.stopPropagation()},update:function(b,c){g.pinch.update(h.view,c.data);c.stopPropagation()},end:function(b,c){g.pinch.end(h.view,c.data);c.stopPropagation()},condition:function(b){return 2<=b}});return h}m(f,d);f.prototype._handleDrag=function(b){this.dragEventSeparator.handle(b)};f.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()};
return f}(f.InputHandler);l.PinchRotateAndZoom=p})},"esri/views/2d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Color ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(p,l,m,b,f,d,g){var r=0;return function(d){function h(){var b=null!==d&&d.apply(this,arguments)||this;b.color=new f([0,255,255]);b.haloOpacity=1;b.fillOpacity=.25;return b}m(h,d);Object.defineProperty(h.prototype,
"version",{get:function(){return r++},enumerable:!0,configurable:!0});b([g.property({readOnly:!0,dependsOn:["color","haloColor","haloOpacity","fillOpacity"]})],h.prototype,"version",null);b([g.property({type:f})],h.prototype,"color",void 0);b([g.property({type:f})],h.prototype,"haloColor",void 0);b([g.property()],h.prototype,"haloOpacity",void 0);b([g.property()],h.prototype,"fillOpacity",void 0);return h=b([g.subclass("esri.views.2d.support.HighlightOptions")],h)}(g.declared(d))})},"esri/views/ui/2d/DefaultUI2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI".split(" "),
function(p,l,m,b,f,d){return function(d){function g(b){b=d.call(this)||this;b.components=["attribution","zoom"];return b}m(g,d);b([f.property()],g.prototype,"components",void 0);return g=b([f.subclass("esri.views.ui.2d.DefaultUI2D")],g)}(f.declared(d))})},"esri/widgets/Search/LocatorSearchSource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/lang ../../core/accessorSupport/decorators ../../tasks/Locator ./SearchSource ./support/locatorUtils".split(" "),
function(p,l,m,b,f,d,g,r,h,t){return function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.categories=null;a.countryCode=null;a.defaultZoomScale=null;a.locator=null;a.locationType=null;a.name="";a.placeholder="";a.searchTemplate="";a.singleLineFieldName=null;a.suggestionsEnabled=null;a.zoomScale=null;a.getResults=function(b){return t.getResults(f({source:a},b))};a.getSuggestions=function(b){return t.getSuggestions(f({source:a},b))};return a}m(c,e);a=c;c.prototype.readLocator=function(a,
b){return(a=b.url)?new r({url:a}):null};c.prototype.writeLocator=function(a,b){b.url=a?a.url:null};c.prototype.clone=function(){return new a({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?d.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?
this.resultSymbol.clone():null,searchExtent:this.searchExtent?this.searchExtent.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?d.clone(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,locator:this.locator,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})};var a;b([g.property()],c.prototype,"categories",void 0);b([g.property()],
c.prototype,"countryCode",void 0);b([g.property({json:{write:!0}})],c.prototype,"defaultZoomScale",void 0);b([g.property({type:r})],c.prototype,"locator",void 0);b([g.reader("locator",["url"])],c.prototype,"readLocator",null);b([g.writer("locator")],c.prototype,"writeLocator",null);b([g.property()],c.prototype,"locationType",void 0);b([g.property({json:{write:!0}})],c.prototype,"name",void 0);b([g.property({json:{write:!0}})],c.prototype,"placeholder",void 0);b([g.property()],c.prototype,"searchTemplate",
void 0);b([g.property({json:{write:!0}})],c.prototype,"singleLineFieldName",void 0);b([g.property({json:{read:{source:"suggest"},write:{target:"suggest"}}})],c.prototype,"suggestionsEnabled",void 0);b([g.property({json:{write:!0}})],c.prototype,"zoomScale",void 0);return c=a=b([g.subclass("esri.widgets.Search.LocatorSearchSource")],c)}(g.declared(h))})},"esri/tasks/Locator":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../request ../core/accessorSupport/decorators ../geometry/SpatialReference ./Task ./support/AddressCandidate".split(" "),
function(p,l,m,b,f,d,g,r,h,t){return function(e){function c(a){a=e.call(this,a)||this;a.outSpatialReference=null;a.url=null;return a}m(c,e);c.prototype.addressToLocations=function(a,b){var c=a.address,e=a.categories,h=a.countryCode,k=a.forStorage,g=a.location,l=a.locationType,t=a.magicKey,w=a.maxLocations,u=a.outFields;a=a.searchExtent;var m=g?g.clone().normalize():null,r=a?a.shiftCentralMeridian():null,p=this.outSpatialReference,g=this.parsedUrl;a=this.requestOptions;e={f:"json",outSR:p?JSON.stringify(p.toJSON()):
null,outFields:u?u.join(","):null,searchExtent:r?JSON.stringify(r.toJSON()):null,category:e?e.join(","):null,countryCode:h||null,magicKey:t||null,location:m,locationType:l||null,maxLocations:w||null,forStorage:k||null};c={query:this._encode(f({},g.query,c,e))};b=f({},a,b,c);return d(g.path+"/findAddressCandidates",b).then(this._handleAddressToLocationsResponse)};c.prototype.suggestLocations=function(a,b){var c=this.parsedUrl,e=this.requestOptions,h=a.location,g=a.searchExtent,h=h?h.clone().normalize():
null,g=g?g.shiftCentralMeridian():null;a={f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:g?JSON.stringify(g.toJSON()):null,category:a.categories?a.categories.join(","):null,countryCode:a.countryCode||null,location:h};a={query:this._encode(f({},c.query,a))};b=f({},e,b,a);return d(c.path+"/suggest",b).then(this._handleSuggestLocationsResponse)};c.prototype.addressesToLocations=function(a,b){var c=this.outSpatialReference,e=this.parsedUrl,h=this.requestOptions,g=a.addresses,k=a.categories,
l=a.locationType;a=a.countryCode;var t=[];Array.isArray(g)&&g.forEach(function(a){t.push({attributes:a})});c={category:k?k.join(","):null,sourceCountry:a||null,addresses:JSON.stringify({records:t}),locationType:l||null,f:"json",outSR:c?JSON.stringify(c):null};c={query:this._encode(f({},e.query,c))};b=f({},h,b,c);return d(e.path+"/geocodeAddresses",b).then(this._handleAddressesToLocationsResponse)};c.prototype.locationToAddress=function(a,b){var c=a.locationType,e=(a=a.location)?a.clone().normalize():
null,h="undefined"!==typeof e,g=this.outSpatialReference;a=this.parsedUrl;var k=this.requestOptions,c={outSR:g?JSON.stringify(g.toJSON()):null,location:h?JSON.stringify(e.toJSON()):null,locationType:c||null,f:"json"},c={query:this._encode(f({},a.query,c))};b=f({},k,b,c);return d(a.path+"/reverseGeocode",b).then(this._handleLocationToAddressResponse)};c.prototype._handleAddressToLocationsResponse=function(a){a=a.data;if(!a)return[];var b=a.candidates,c=a.spatialReference;return b?b.map(function(a){if(a){var b=
a.extent,d=a.location,e=b?b&&"number"===typeof b.xmin&&"number"===typeof b.ymin&&"number"===typeof b.xmax&&"number"===typeof b.ymax:!0;if(d&&"number"===typeof d.x&&"number"===typeof d.y&&e)return b&&(b.spatialReference=c),d.spatialReference=c,t.fromJSON(a)}}):[]};c.prototype._handleSuggestLocationsResponse=function(a){return(a=a.data)?a.suggestions||[]:[]};c.prototype._handleAddressesToLocationsResponse=function(a){a=a.data;if(!a)return[];var b=a.locations,c=a.spatialReference;return b?b.map(function(a){var b=
a.location;b&&(b.spatialReference=c);return t.fromJSON(a)}):[]};c.prototype._handleLocationToAddressResponse=function(a){if(a=a.data){var b=a.address;return t.fromJSON({address:b&&b.Match_addr||"",attributes:b||{},location:a.location,score:100})}};b([g.property({type:r})],c.prototype,"outSpatialReference",void 0);b([g.property()],c.prototype,"url",void 0);return c=b([g.subclass("esri.tasks.Locator")],c)}(g.declared(h))})},"esri/tasks/support/AddressCandidate":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../geometry/Extent ../../geometry/Point".split(" "),
function(p,l,m,b,f,d,g,r){return function(h){function f(b){b=h.call(this,b)||this;b.address=null;b.attributes=null;b.extent=null;b.location=null;b.score=null;return b}b(f,h);m([d.property({type:String,json:{write:!0}})],f.prototype,"address",void 0);m([d.property({type:Object,json:{write:!0}})],f.prototype,"attributes",void 0);m([d.property({type:g,json:{write:!0}})],f.prototype,"extent",void 0);m([d.property({type:r,json:{write:!0}})],f.prototype,"location",void 0);m([d.property({type:Number,json:{write:!0}})],
f.prototype,"score",void 0);return f=m([d.subclass("esri.tasks.support.AddressCandidate")],f)}(d.declared(f.JSONSupport))})},"esri/widgets/Search/support/locatorUtils":function(){define("require exports ../../../Graphic ../../../core/maybe ../../../core/promiseUtils ./geometryUtils".split(" "),function(p,l,m,b,f,d){function g(b){var a=b.source,c=b.spatialReference,d=b.location,h=b.sourceIndex,f=b.view;b=a.locator;var g=a.zoomScale,l=a.defaultZoomScale,n=f&&f.scale;c&&(b.outSpatialReference=c);return b.locationToAddress({location:d}).then(function(a){return e([a],
{sourceIndex:h,scale:n,view:f,zoomScale:g,defaultZoomScale:l})})}function r(b,a){var c=b.filter,e=b.searchExtent;b=b.withinViewEnabled;var h=a&&a.extent;return(a=d.createExtentFromGeometry(c&&c.geometry,a,a&&a.scale))||e||(b&&h?h:void 0)}function h(c){var a=c.source,d=c.suggestResult,h=c.spatialReference,g=c.view,l=c.maxResults,m=c.sourceIndex,t=a&&a.zoomScale,n=a&&a.defaultZoomScale;c=d.text.trim();if(!c)return f.resolve();c=""+(!d.key&&a.prefix?a.prefix:"")+c+(!d.key&&a.suffix?a.suffix:"");var p=
{},w=a.locator,u=g&&g.scale,A=r(a,g);if(!w)return f.resolve();a.categories&&(p.categories=a.categories);a.locationType&&(p.locationType=a.locationType);h&&(w.outSpatialReference=h);if(h=g&&g.get("extent.center"))p.location=h;p.maxLocations=l;A&&(p.searchExtent=b.unwrap(A));a.countryCode&&(p.countryCode=a.countryCode);var G=d.key;G&&(p.magicKey=G);p.address={};p.address[a.singleLineFieldName||"Single Line Input"]=c;a.outFields&&(p.outFields=a.outFields);return w.addressToLocations(p).then(function(a){return e(a,
{key:G,scale:u,sourceIndex:m,view:g,zoomScale:t,defaultZoomScale:n})})}function t(b,a){return b.map(function(b){return{text:b.text,key:b.magicKey,sourceIndex:a}})}function e(b,a){return b.map(function(b){var c=a.key,e=a.scale,h=a.sourceIndex,f=a.view,g=a.zoomScale,k=a.defaultZoomScale,l=b.extent,w=b.location,u=b.address;b=new m({geometry:w,attributes:b.attributes});l=l||w;e=d.createExtentFromGeometry(l,f,e);f=g?d.scaleExtent(e,f,g):k&&"point"===l.type?d.scaleExtent(e,f,k):e;w=w?w.x+","+w.y:"";return{extent:f,
feature:b,key:c,name:u||w,sourceIndex:h}})}Object.defineProperty(l,"__esModule",{value:!0});l.getResults=function(b){return b.location?g(b):h(b)};l.getSuggestions=function(c){var a=c.source,d=c.spatialReference,e=c.view,h=c.suggestTerm,g=c.maxSuggestions,l=c.sourceIndex;c={};var m=a.locator,n=r(a,e);if(!m)return f.resolve();a.categories&&(c.categories=a.categories);m.outSpatialReference=d;if(d=e&&e.get("extent.center"))c.location=d;h=h.trim();if(!h)return f.resolve();d=a.prefix;e=a.suffix;c.text=
""+(void 0===d?"":d)+h+(void 0===e?"":e);n&&(c.searchExtent=b.unwrap(n));c.maxSuggestions=g;a.countryCode&&(c.countryCode=a.countryCode);return m.suggestLocations(c).then(function(a){return t(a,l)})};l.isArcGISWorldGeocoder=function(b){return b?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(b)||/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi.test(b):!1}})},"esri/layers/SceneLayer":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../PopupTemplate ../renderers ../request ../core/asyncUtils ../core/Error ../core/Logger ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/PropertyOrigin ../core/accessorSupport/utils ./FeatureLayer ./Layer ./mixins/ArcGISService ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/SceneService ./support/commonProperties ./support/commonProperties ./support/FeatureReduction ./support/FeatureReductionSelection ./support/fieldProperties ./support/FieldsIndex ./support/fieldUtils ./support/I3SLayerDefinitions ./support/LabelClass ./support/labelingInfo ./support/RangeInfo ../portal/PortalItem ../renderers/support/jsonUtils ../renderers/support/styleUtils ../support/popupUtils ../tasks/support/Query".split(" "),
function(p,l,m,b,f,d,g,r,h,t,e,c,a,k,y,q,v,B,x,n,C,w,u,A,G,D,J,K,z,E,N,T,H,Q,R,L,U,O,F,I,P,S,V,aa){function X(a,b,c){a&&((a=P.read(a,b,c)||void 0)||M.error("Failed to create renderer",{rendererDefinition:a,layer:this,context:c}));return a}var W=["3DObject","Point"],M=a.getLogger("esri.layers.SceneLayer"),Y=H.defineFieldProperties(),Z={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",
polygons:"polygons","features-polygons":"polygons"},ba={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"};return function(a){function u(b,c){b=a.call(this)||this;b.featureReduction=null;b.rangeInfos=null;b.operationalLayerType="ArcGISSceneServiceLayer";b.type="scene";b.fields=null;b.outFields=null;b.nodePages=null;b.materialDefinitions=null;b.textureSetDefinitions=null;b.geometryDefinitions=null;b.serviceUpdateTimeStamp=null;b.definitionExpression=null;b.path=null;b.labelsVisible=
!0;b.labelingInfo=null;b.legendEnabled=!0;b.cachedDrawingInfo={color:!1};b.popupEnabled=!0;b.popupTemplate=null;b.objectIdField=null;b.objectIdFilter=null;b._fieldUsageInfo={};b.screenSizePerspectiveEnabled=!0;return b}b(u,a);u.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?m({url:a},b):a};u.prototype.getField=function(a){return this.fieldsIndex.get(a)};u.prototype.getFieldDomain=function(a){return(a=this.getField(a))&&a.domain?a.domain:null};Object.defineProperty(u.prototype,
"fieldsIndex",{get:function(){return new Q(this.fields)},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"elevationInfo",{set:function(a){this._set("elevationInfo",a);this.loaded&&this._validateElevationInfo()},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"geometryType",{get:function(){return ba[this.profile]||"mesh"},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"renderer",{set:function(a){R.fixRendererFields(a,this.fields);this._set("renderer",
a)},enumerable:!0,configurable:!0});u.prototype.readCachedDrawingInfo=function(a,b){if(null==a||"object"!==typeof a)a={};null==a.color&&(a.color=!1);return a};Object.defineProperty(u.prototype,"defaultPopupTemplate",{get:function(){return this.associatedLayer||this.attributeStorageInfo?this.createPopupTemplate():null},enumerable:!0,configurable:!0});u.prototype.readObjectIdField=function(a,b){!a&&b.fields&&b.fields.some(function(b){"esriFieldTypeOID"===b.type&&(a=b.name);return!!a});return a||void 0};
u.prototype.readProfile=function(a,b){a=b.store.profile;if(null!=a&&Z[a])return Z[a];M.error("Unknown or missing profile",{profile:a,layer:this});return"mesh-pyramids"};u.prototype.load=function(a){var b=this,c=k.isSome(a)?a.signal:null;a=e.safeCast(this.loadFromPortal({supportedTypes:["Scene Service"]},a)).then(function(){return e.safeCast(b._fetchService(c))},function(){return e.safeCast(b._fetchService(c))}).then(function(){return q.all([b._verifyRootNodeAndUpdateExtent(b.nodePages,c),b._setAssociatedFeatureLayer(c)])}).then(function(){return b._validateElevationInfo()}).then(function(){return b._applyAssociatedLayerOverrides()}).then(function(){return b._populateFieldUsageInfo()}).then(function(){return S.loadStyleRenderer(b,
{origin:"service"},c)}).then(function(){return R.fixRendererFields(b.renderer,b.fields)});this.addResolvingPromise(a);return this.when()};u.prototype.importLayerViewModule=function(a){return g(this,void 0,void 0,function(){return d(this,function(b){return"2d"===a.type?[2,q.reject(new c("scene-layer:view-not-supported","SceneLayer is only supported in 3D"))]:null==this.profile||"mesh-pyramids"===this.profile?[2,q.create(function(a){return p(["../views/3d/layers/SceneLayerView3D"],a)})]:[2,q.create(function(a){return p(["../views/3d/layers/SceneLayerGraphicsView3D"],
a)})]})})};u.prototype.createQuery=function(){var a=new aa;"mesh"!==this.geometryType&&(a.returnGeometry=!0,a.returnZ=!0);a.where=this.definitionExpression||"1\x3d1";a.sqlFormat="standard";return a};u.prototype.queryExtent=function(a,b){var c=this;return this._getAssociatedLayerForQuery().then(function(d){return d.queryExtent(a||c.createQuery(),b)})};u.prototype.queryFeatureCount=function(a,b){var c=this;return this._getAssociatedLayerForQuery().then(function(d){return d.queryFeatureCount(a||c.createQuery(),
b)})};u.prototype.queryFeatures=function(a,b){var c=this;return this._getAssociatedLayerForQuery().then(function(d){return d.queryFeatures(a||c.createQuery(),b)}).then(function(a){if(a&&a.features)for(var b=0,d=a.features;b<d.length;b++){var e=d[b];e.layer=c;e.sourceLayer=c}return a})};u.prototype.queryObjectIds=function(a,b){var c=this;return this._getAssociatedLayerForQuery().then(function(d){return d.queryObjectIds(a||c.createQuery(),b)})};u.prototype.getFieldUsageInfo=function(a){var b={supportsLabelingInfo:!1,
supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[a]||b:(M.error("#getFieldUsageInfo()","Unavailable until layer is loaded"),b)};u.prototype.createPopupTemplate=function(a){return V.createPopupTemplate(this,a)};u.prototype._getAssociatedLayerForQuery=function(){var a=this;if(!this.loaded)return this.load().then(function(){return a._getAssociatedLayerForQuery()});var b=this.associatedLayer;return null!=b?q.resolve(b):q.reject(new c("scenelayer:query-not-available",
"SceneLayer queries are not available without associated feature layer"))};u.prototype.hasCachedStatistics=function(a){return null!=this.statisticsInfo&&this.statisticsInfo.some(function(b){return b.name===a})};u.prototype.queryCachedStatistics=function(a,b){return g(this,void 0,void 0,function(){var e,h,f,g,u;return d(this,function(d){switch(d.label){case 0:return[4,this.load(b)];case 1:d.sent();if(!this.statisticsInfo)throw new c("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");
e=this.fieldsIndex.get(a);if(!e)throw new c("scenelayer:field-unexisting","Field '"+a+"' does not exist on the layer");h=0;for(f=this.statisticsInfo;h<f.length;h++)if(g=f[h],g.name===e.name)return u=v.join(this.parsedUrl.path,g.href),[2,t(u,{query:{f:"json"},responseType:"json",signal:b?b.signal:null}).then(function(a){return a.data})];throw new c("scenelayer:no-cached-statistics","Cached statistics for this attribute are not available");}})})};u.prototype._validateLayer=function(a){if(a.layerType&&
-1===W.indexOf(a.layerType))throw new c("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:a.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new c("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(1<this.version.major)throw new c("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,
supportedVersions:"1.x"});a=this.normalReferenceFrame;var b=this.spatialReference,d=!1,e=!1;if(null==a)e=d=!0;else switch(b=b&&b.isGeographic,a){case "east-north-up":case "earth-centered":d=!0;e=b;break;case "vertex-reference-frame":d=!0;e=!b;break;default:d=!1}if(!d)throw new c("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!e)throw new c("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.");
};u.prototype._populateFieldUsageInfo=function(){this._fieldUsageInfo={};if(this.fields)for(var a=function(a){var c=!(!b.attributeStorageInfo||!b.attributeStorageInfo.some(function(b){return b.name===a.name})),d=!!(b.associatedLayer&&b.associatedLayer.fields&&b.associatedLayer.fields.some(function(b){return b&&a.name===b.name}));b._fieldUsageInfo[a.name]={supportsLabelingInfo:c,supportsRenderer:c,supportsPopupTemplate:c||d,supportsLayerQuery:d}},b=this,c=0,d=this.fields;c<d.length;c++)a(d[c])};u.prototype._applyAssociatedLayerOverrides=
function(){if(this.associatedLayer){if(this.associatedLayer.fields){for(var a=null,b=0,c=this.associatedLayer.fields;b<c.length;b++){var d=c[b];this.getField(d.name)||(a||(a=this.fields?this.fields.slice():[]),a.push(d.clone()))}a&&this._set("fields",a)}a=["popupTemplate","popupEnabled"];b=C.getProperties(this);for(c=0;c<a.length;c++)d=a[c],this._buddyIsMoreImportant(d)&&(b.setDefaultOrigin(this.associatedLayer.originOf(d)),b.set(d,this.associatedLayer[d]),b.setDefaultOrigin("user"))}};u.prototype._setAssociatedFeatureLayer=
function(a){return g(this,void 0,void 0,function(){var b;return d(this,function(c){switch(c.label){case 0:return[4,this._fetchAssociatedFeatureLayer(a)];case 1:return this.associatedLayer=b=c.sent(),[2]}})})};u.prototype._fetchAssociatedFeatureLayer=function(a){return g(this,void 0,void 0,function(){var b;return d(this,function(c){switch(c.label){case 0:if(-1===["mesh-pyramids","points"].indexOf(this.profile))return[2,null];c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this.portalItem&&this.portalItem.isResolved()?
this._fetchAssociatedFeatureLayerFromRelatedItems(this.portalItem,a):this._fetchAssociatedFeatureLayerFromUrl(a)];case 2:return b=c.sent(),[4,b.load({signal:a})];case 3:return[2,c.sent()];case 4:return c.sent(),this._logWarningOnPopupEnabled(),[2,null];case 5:return[2]}})})};u.prototype._logWarningOnPopupEnabled=function(){var a=this;B.whenValidOnce(this,["popupTemplate","popupEnabled"],function(){return a.popupEnabled&&null!=a.popupTemplate}).then(function(){return function(){var b="this SceneLayer: "+
a.title;null==a.attributeStorageInfo?M.warn("Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on "+b):M.info("Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on "+b)}})};u.prototype._fetchAssociatedFeatureLayerFromRelatedItems=function(a,b){return g(this,void 0,void 0,function(){var c,e;return d(this,function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),[4,a.fetchRelatedItems({relationshipType:"Service2Service",
direction:"reverse"},{signal:b})];case 1:return c=d.sent(),(e=c.filter(function(a){return"Feature Service"===a.type})[0])?[4,this._fetchAssociatedFeatureLayerFromPortalItem(new I({id:e.id,portal:e.portal}),b)]:[3,3];case 2:return[2,d.sent()];case 3:throw Error();case 4:return d.sent(),[2,this._fetchAssociatedFeatureLayerFromUrl(b)];case 5:return[2]}})})};u.prototype._fetchAssociatedFeatureLayerFromPortalItem=function(a,b){return g(this,void 0,void 0,function(){var c;return d(this,function(d){switch(d.label){case 0:return[4,
a.load({signal:b})];case 1:return d.sent(),[4,this._findMatchingAssociatedSublayerUrl(a.url,b)];case 2:return c=d.sent(),[2,new w({url:c,portalItem:a})]}})})};u.prototype._fetchAssociatedFeatureLayerFromUrl=function(a){return g(this,void 0,void 0,function(){var b;return d(this,function(c){switch(c.label){case 0:return[4,this._findMatchingAssociatedSublayerUrl(null,a)];case 1:return b=c.sent(),[2,new w({url:b})]}})})};u.prototype._findMatchingAssociatedSublayerUrl=function(a,b){void 0===a&&(a=null);
return g(this,void 0,void 0,function(){var c,e,h,f,g,u,k,l,w,m,n,p,A,r;return d(this,function(d){switch(d.label){case 0:c=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);if(!c)return[2,q.reject()];null==a&&(a=c[1]+"/FeatureServer");e=a.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1");h={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:b};f=c[1]+"/SceneServer";g=parseInt(c[2],10);u=t(f,h).catch(function(a){return{data:{layers:null}}});k=t(e,h);return[4,q.all([k,
u])];case 1:l=d.sent();w=l[0];m=l[1];n=m.data&&m.data.layers;p=w.data&&w.data.layers;if(!Array.isArray(p))throw Error("expected layers array");if(Array.isArray(n))for(A=0;A<Math.min(n.length,p.length);A++){if(r=n[A],r.id===g)return[2,e+"/"+p[A].id]}else if(g<p.length)return[2,e+"/"+p[g].id];throw Error("could not find matching associated sublayer");}})})};u.prototype._buddyIsMoreImportant=function(a){if(!this.associatedLayer)return!1;var b=n.nameToId(this.originOf(a));a=n.nameToId(this.associatedLayer.originOf(a));
return null!=a&&a<=n.OriginId.SERVICE?null==b||b<n.OriginId.SERVICE:null!=a&&a<=n.OriginId.PORTAL_ITEM?null==b||b<n.OriginId.PORTAL_ITEM:!1};u.prototype._validateElevationInfo=function(){var a=this.elevationInfo;a&&("mesh-pyramids"===this.profile&&"absolute-height"!==a.mode&&M.warn(".elevationInfo\x3d","Mesh scene layers only support absolute-height elevation mode"),a.featureExpressionInfo&&"0"!==a.featureExpressionInfo.expression&&M.warn(".elevationInfo\x3d","Scene layers do not support featureExpressionInfo"))};
f([x.property({types:{key:"type",base:N.default,typeMap:{selection:T.default}},json:{origins:{"web-scene":{read:{source:"layerDefinition.featureReduction"},write:{target:"layerDefinition.featureReduction"}}}}})],u.prototype,"featureReduction",void 0);f([x.property({type:[F.default],json:{read:!1,origins:{"web-scene":{read:{source:"layerDefinition.rangeInfos"},write:{target:"layerDefinition.rangeInfos"}}}}})],u.prototype,"rangeInfos",void 0);f([x.property({json:{read:!1}})],u.prototype,"associatedLayer",
void 0);f([x.property({type:["show","hide"]})],u.prototype,"listMode",void 0);f([x.property({type:["ArcGISSceneServiceLayer"]})],u.prototype,"operationalLayerType",void 0);f([x.property({json:{read:!1},readOnly:!0})],u.prototype,"type",void 0);f([x.property(m({},Y.fields,{readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}}))],u.prototype,"fields",void 0);f([x.property({readOnly:!0,dependsOn:["fields"]})],u.prototype,"fieldsIndex",null);f([x.property(Y.outFields)],u.prototype,"outFields",void 0);
f([x.property({type:L.I3SNodePageDefinition,readOnly:!0})],u.prototype,"nodePages",void 0);f([x.property({type:[L.I3SMaterialDefinition],readOnly:!0})],u.prototype,"materialDefinitions",void 0);f([x.property({type:[L.I3STextureSetDefinition],readOnly:!0})],u.prototype,"textureSetDefinitions",void 0);f([x.property({type:[L.I3SGeometryDefinition],readOnly:!0})],u.prototype,"geometryDefinitions",void 0);f([x.property({readOnly:!0})],u.prototype,"serviceUpdateTimeStamp",void 0);f([x.property({readOnly:!0})],
u.prototype,"attributeStorageInfo",void 0);f([x.property({readOnly:!0})],u.prototype,"statisticsInfo",void 0);f([x.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],u.prototype,"definitionExpression",void 0);f([x.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],u.prototype,"path",void 0);f([x.property(z.elevationInfo)],u.prototype,"elevationInfo",
null);f([x.property({type:String,dependsOn:["profile"]})],u.prototype,"geometryType",null);f([x.property(z.labelsVisible)],u.prototype,"labelsVisible",void 0);f([x.property({type:[U],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:O.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:O.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],u.prototype,"labelingInfo",void 0);f([x.property(z.legendEnabled)],
u.prototype,"legendEnabled",void 0);f([x.property(z.opacityDrawingInfo)],u.prototype,"opacity",void 0);f([x.property({types:h.webSceneRendererTypes,json:{origins:{service:{read:{source:"drawingInfo.renderer",reader:X}}},read:{source:"layerDefinition.drawingInfo.renderer",reader:X},write:{target:"layerDefinition.drawingInfo.renderer"}},value:null})],u.prototype,"renderer",null);f([x.property({json:{read:!1}})],u.prototype,"cachedDrawingInfo",void 0);f([x.reader("service","cachedDrawingInfo")],u.prototype,
"readCachedDrawingInfo",null);f([x.property(z.popupEnabled)],u.prototype,"popupEnabled",void 0);f([x.property({type:r,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],u.prototype,"popupTemplate",void 0);f([x.property({readOnly:!0,json:{read:!1},dependsOn:["fields","title","attributeStorageInfo","associatedLayer"]})],u.prototype,"defaultPopupTemplate",null);f([x.property({type:String,json:{read:!1}})],u.prototype,"objectIdField",void 0);f([x.reader("service","objectIdField",["objectIdField",
"fields"])],u.prototype,"readObjectIdField",null);f([x.property({json:{read:!1}})],u.prototype,"objectIdFilter",void 0);f([x.property({type:String,json:{read:!1}})],u.prototype,"profile",void 0);f([x.reader("service","profile",["store.profile"])],u.prototype,"readProfile",null);f([x.property({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],u.prototype,"normalReferenceFrame",void 0);f([x.property(E.screenSizePerspectiveEnabled)],u.prototype,
"screenSizePerspectiveEnabled",void 0);return u=f([x.subclass("esri.layers.SceneLayer")],u)}(x.declared(J.ScaleRangeLayer(K.SceneService(A.ArcGISService(G.OperationalLayer(D.PortalLayer(y.MultiOriginJSONMixin(u))))))))})},"esri/layers/mixins/SceneService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/Error ../../core/Logger ../../core/promiseUtils ../../core/urlUtils ../../core/accessorSupport/decorators ../../geometry/Extent ../../geometry/HeightModelInfo ../../geometry/SpatialReference ../support/arcgisLayerUrl ../support/commonProperties".split(" "),
function(p,l,m,b,f,d,g,r,h,t,e,c,a,k,y,q,v){Object.defineProperty(l,"__esModule",{value:!0});var B=h.getLogger("esri.layers.mixins.SceneService");l.SceneService=function(h){return function(h){function l(){var a=null!==h&&h.apply(this,arguments)||this;a.blendMode=null;a.spatialReference=null;a.fullExtent=null;a.heightModelInfo=null;a.minScale=0;a.maxScale=0;a.version={major:Number.NaN,minor:Number.NaN,versionString:""};a.copyright=null;a.sublayerTitleMode="item-title";a.title=null;a.layerId=null;return a}
m(l,h);l.prototype.readSpatialReference=function(a,b){return this._readSpatialReference(b)};l.prototype._readSpatialReference=function(a){if(null!=a.spatialReference)return y.fromJSON(a.spatialReference);a=a.store;a=(a=a.indexCRS||a.geographicCRS)&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10);return null!=a?new y(a):null};l.prototype.readFullExtent=function(b,c){b=c.store;c=this._readSpatialReference(c);return null==c||null==b||null==b.extent||!Array.isArray(b.extent)||b.extent.some(function(a){return a<
x})?null:new a({xmin:b.extent[0],ymin:b.extent[1],xmax:b.extent[2],ymax:b.extent[3],spatialReference:c})};l.prototype.readVersion=function(a,b){a=b.store;b=null!=a.version?a.version.toString():"";a={major:Number.NaN,minor:Number.NaN,versionString:b};b=b.split(".");2<=b.length&&(a.major=parseInt(b[0],10),a.minor=parseInt(b[1],10));return a};l.prototype.readTitlePortalItem=function(a,b){return"item-title"!==this.sublayerTitleMode?void 0:a};l.prototype.readTitleService=function(a,b){a=this.portalItem&&
this.portalItem.title;if("item-title"===this.sublayerTitleMode)return q.titleFromUrlAndName(this.url,b.name);b=b.name||q.parse(this.url).title;"item-title-and-service-name"===this.sublayerTitleMode&&a&&(b=a+" - "+b);return q.cleanTitle(b)};l.prototype.readLayerId=function(a,b){return b.id};Object.defineProperty(l.prototype,"url",{set:function(a){a=q.sanitizeUrlWithLayerId(this,a,B);this._set("url",a.url);null!=a.layerId&&this._set("layerId",a.layerId)},enumerable:!0,configurable:!0});l.prototype.writeUrl=
function(a,b,c,d){q.writeUrlWithLayerId(this,a,"layers",b,d)};Object.defineProperty(l.prototype,"parsedUrl",{get:function(){var a=this._get("url");if(!a)return null;a=e.urlToObject(a);null!=this.layerId&&q.match.test(a.path)&&(a.path=a.path+"/layers/"+this.layerId);return a},enumerable:!0,configurable:!0});l.prototype._verifyRootNodeAndUpdateExtent=function(a,b){return d(this,void 0,void 0,function(){var c,d,e;return f(this,function(h){switch(h.label){case 0:if(!a)return[3,4];h.label=1;case 1:return h.trys.push([1,
3,,4]),c=this._updateExtentFromRootPage,d=[a],[4,this._fetchRootPage(a,b)];case 2:return[2,c.apply(this,d.concat([h.sent()]))];case 3:return h.sent(),[3,4];case 4:return e=this._updateExtentFromRootNode,[4,this._fetchRootNode(b)];case 5:return[2,e.apply(this,[h.sent()])]}})})};l.prototype._fetchRootPage=function(a,b){return d(this,void 0,void 0,function(){var c,d,e;return f(this,function(h){switch(h.label){case 0:if(!a)return[2,t.reject()];c=Math.floor(a.rootIndex/a.nodesPerPage);d=this.parsedUrl.path+
"/nodepages/"+c;return[4,g(d,{responseType:"json",signal:b})];case 1:return e=h.sent(),[2,e.data]}})})};l.prototype._updateExtentFromRootPage=function(a,b){if(null==b||null==b.nodes)throw new r("sceneservice:invalid-node-page","Inavlid node page.");b=b.nodes[a.rootIndex%a.nodesPerPage];if(null==b||null==b.obb||null==b.obb.center||null==b.obb.halfSize)throw new r("sceneservice:invalid-node-page","Inavlid node page.");a=b.obb.halfSize;b=b.obb.center[2];a=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);this.fullExtent.zmin=
b-a;this.fullExtent.zmax=b+a};l.prototype._updateExtentFromRootNode=function(a){if(null!=this.fullExtent&&!this.fullExtent.hasZ&&null!=a&&Array.isArray(a.mbs)&&4===a.mbs.length){var b=a.mbs[2];a=a.mbs[3];this.fullExtent.zmin=b-a;this.fullExtent.zmax=b+a}};l.prototype._fetchRootNode=function(a){return d(this,void 0,void 0,function(){var b,c,d;return f(this,function(h){switch(h.label){case 0:if(!this.rootNode)return[2];b=e.join(this.parsedUrl.path,this.rootNode);h.label=1;case 1:return h.trys.push([1,
3,,4]),[4,g(b,{query:{f:"json"},responseType:"json",signal:a})];case 2:return c=h.sent(),[2,c.data];case 3:throw d=h.sent(),new r("sceneservice:root-node-missing","Root node missing.",{error:d,url:b});case 4:return[2]}})})};l.prototype._fetchService=function(a){return d(this,void 0,void 0,function(){var b;return f(this,function(c){switch(c.label){case 0:return null==this.layerId&&/SceneServer\/*$/i.test(this.url)?[4,this._fetchFirstLayerId(a)]:[3,2];case 1:b=c.sent(),null!=b&&(this.layerId=b),c.label=
2;case 2:return[2,this._fetchServiceLayer(a)]}})})};l.prototype._fetchFirstLayerId=function(a){return d(this,void 0,void 0,function(){var b;return f(this,function(c){switch(c.label){case 0:return[4,g(this.url,{query:{f:"json"},responseType:"json",signal:a})];case 1:return b=c.sent(),b.data&&Array.isArray(b.data.layers)&&0<b.data.layers.length?[2,b.data.layers[0].id]:[2,void 0]}})})};l.prototype._fetchServiceLayer=function(a){return d(this,void 0,void 0,function(){var b,c;return f(this,function(d){switch(d.label){case 0:return[4,
g(this.parsedUrl.path,{query:{f:"json"},responseType:"json",signal:a})];case 1:return b=d.sent(),b.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),c=b.data,this.read(c,{origin:"service",url:this.parsedUrl}),this._validateLayer(c),[2]}})})};l.prototype._validateLayer=function(a){};b([c.shared({id:{json:{origins:{service:{read:!1},"portal-item":{read:!1}}}}})],l.prototype,"properties",void 0);b([c.property({type:y})],l.prototype,"spatialReference",void 0);b([c.reader("spatialReference",["spatialReference",
"store.indexCRS","store.geographicCRS"])],l.prototype,"readSpatialReference",null);b([c.property({type:a})],l.prototype,"fullExtent",void 0);b([c.reader("fullExtent",["store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],l.prototype,"readFullExtent",null);b([c.property({readOnly:!0,type:k})],l.prototype,"heightModelInfo",void 0);b([c.property({type:Number,json:{read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"},origins:{service:{read:{source:"minScale"},
write:!1}}}})],l.prototype,"minScale",void 0);b([c.property({type:Number,json:{read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"},origins:{service:{read:{source:"maxScale"},write:!1}}}})],l.prototype,"maxScale",void 0);b([c.property({readOnly:!0})],l.prototype,"version",void 0);b([c.reader("version",["store.version"])],l.prototype,"readVersion",null);b([c.property({type:String,json:{read:{source:"copyrightText"}}})],l.prototype,"copyright",void 0);b([c.property({type:String,
json:{read:!1}})],l.prototype,"sublayerTitleMode",void 0);b([c.property({type:String})],l.prototype,"title",void 0);b([c.reader("portal-item","title")],l.prototype,"readTitlePortalItem",null);b([c.reader("service","title",["name"])],l.prototype,"readTitleService",null);b([c.property({type:Number})],l.prototype,"layerId",void 0);b([c.reader("service","layerId",["id"])],l.prototype,"readLayerId",null);b([c.property(v.url)],l.prototype,"url",null);b([c.writer("url")],l.prototype,"writeUrl",null);b([c.property({dependsOn:["layerId"]})],
l.prototype,"parsedUrl",null);b([c.property({readOnly:!0})],l.prototype,"store",void 0);b([c.property({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],l.prototype,"rootNode",void 0);return l=b([c.subclass("esri.layers.mixins.SceneService")],l)}(c.declared(h))};var x=-1E38})},"esri/layers/support/I3SLayerDefinitions":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(p,l,m,b,f,d){Object.defineProperty(l,"__esModule",{value:!0});p=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.nodesPerPage=null;a.rootIndex=0;a.lodSelectionMetricType=null;return a}m(a,c);b([d.property({type:Number})],a.prototype,"nodesPerPage",void 0);b([d.property({type:Number})],a.prototype,"rootIndex",void 0);b([d.property({type:String})],a.prototype,"lodSelectionMetricType",void 0);return a=b([d.subclass("esri.layer.support.I3SNodePageDefinition")],a)}(d.declared(f.JSONSupport));
l.I3SNodePageDefinition=p;var g=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.factor=1;return a}m(a,c);b([d.property({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],a.prototype,"id",void 0);b([d.property({type:Number})],a.prototype,"factor",void 0);return a=b([d.subclass("esri.layer.support.I3SMaterialTexture")],a)}(d.declared(f.JSONSupport));l.I3SMaterialTexture=g;var r=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.baseColorFactor=
[1,1,1,1];a.baseColorTexture=null;a.metallicRoughnessTexture=null;a.metallicFactor=1;a.roughnessFactor=1;return a}m(a,c);b([d.property({type:[Number]})],a.prototype,"baseColorFactor",void 0);b([d.property({type:g})],a.prototype,"baseColorTexture",void 0);b([d.property({type:g})],a.prototype,"metallicRoughnessTexture",void 0);b([d.property({type:Number})],a.prototype,"metallicFactor",void 0);b([d.property({type:Number})],a.prototype,"roughnessFactor",void 0);return a=b([d.subclass("esri.layer.support.I3SMaterialPBRMetallicRoughness")],
a)}(d.declared(f.JSONSupport));l.I3SMaterialPBRMetallicRoughness=r;p=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.alphaMode="opaque";a.alphaCutoff=.25;a.doubleSided=!1;a.cullFace="none";a.normalTexture=null;a.occlusionTexture=null;a.emissiveTexture=null;a.emissiveFactor=null;a.pbrMetallicRoughness=null;return a}m(a,c);b([d.enumeration.serializable()({opaque:"opaque",mask:"mask",blend:"blend"})],a.prototype,"alphaMode",void 0);b([d.property({type:Number})],a.prototype,"alphaCutoff",
void 0);b([d.property({type:Boolean})],a.prototype,"doubleSided",void 0);b([d.enumeration.serializable()({none:"none",back:"back",front:"front"})],a.prototype,"cullFace",void 0);b([d.property({type:g})],a.prototype,"normalTexture",void 0);b([d.property({type:g})],a.prototype,"occlusionTexture",void 0);b([d.property({type:g})],a.prototype,"emissiveTexture",void 0);b([d.property({type:[Number]})],a.prototype,"emissiveFactor",void 0);b([d.property({type:r})],a.prototype,"pbrMetallicRoughness",void 0);
return a=b([d.subclass("esri.layer.support.I3SMaterialDefinition")],a)}(d.declared(f.JSONSupport));l.I3SMaterialDefinition=p;var h=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}m(a,c);b([d.property({type:String,json:{read:{source:["name","index"],reader:function(a,b){return null!=a?a:""+b.index}}}})],a.prototype,"name",void 0);b([d.enumeration.serializable()({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2"})],a.prototype,"format",void 0);return a=b([d.subclass("esri.layer.support.I3STextureFormat")],
a)}(d.declared(f.JSONSupport));l.I3STextureFormat=h;p=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.atlas=!1;return a}m(a,c);b([d.property({type:[h]})],a.prototype,"formats",void 0);b([d.property({type:Boolean})],a.prototype,"atlas",void 0);return a=b([d.subclass("esri.layer.support.I3STextureSetDefinition")],a)}(d.declared(f.JSONSupport));l.I3STextureSetDefinition=p;var t=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}m(a,c);b([d.enumeration.serializable()({Float32:"Float32",
UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],a.prototype,"type",void 0);b([d.property({type:Number})],a.prototype,"component",void 0);return a=b([d.subclass("esri.layer.support.I3SGeometryAttribute")],a)}(d.declared(f.JSONSupport));l.I3SGeometryAttribute=t;var e=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}m(a,c);b([d.enumeration.serializable()({draco:"draco"})],a.prototype,"encoding",void 0);b([d.property({type:[String]})],a.prototype,"attributes",void 0);
return a=b([d.subclass("esri.layer.support.I3SGeometryAttribute")],a)}(d.declared(f.JSONSupport));l.I3SGeometryCompressedAttributes=e;p=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a.offset=0;return a}m(a,c);b([d.property({type:Number})],a.prototype,"offset",void 0);b([d.property({type:t})],a.prototype,"position",void 0);b([d.property({type:t})],a.prototype,"normal",void 0);b([d.property({type:t})],a.prototype,"uv0",void 0);b([d.property({type:t})],a.prototype,"color",void 0);
b([d.property({type:t})],a.prototype,"uvRegion",void 0);b([d.property({type:t})],a.prototype,"featureId",void 0);b([d.property({type:t})],a.prototype,"faceRange",void 0);b([d.property({type:e})],a.prototype,"compressedAttributes",void 0);return a=b([d.subclass("esri.layer.support.I3SGeometryBuffer")],a)}(d.declared(f.JSONSupport));l.I3SGeometryBuffer=p;f=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}m(a,c);b([d.enumeration.serializable()({triangle:"triangle"})],a.prototype,
"topology",void 0);b([d.property()],a.prototype,"geometryBuffers",void 0);return a=b([d.subclass("esri.layer.support.I3SMeshDefinition")],a)}(d.declared(f.JSONSupport));l.I3SGeometryDefinition=f})},"esri/layers/support/RangeInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(p,l,m,b,f,d){Object.defineProperty(l,"__esModule",{value:!0});p=function(g){function f(){var b=
null!==g&&g.apply(this,arguments)||this;b.name=null;b.field=null;b.currentRangeExtent=null;b.fullRangeExtent=null;b.type="rangeInfo";return b}m(f,g);b([d.property({type:String,json:{read:!0,write:!0}})],f.prototype,"name",void 0);b([d.property({type:String,json:{read:!0,write:!0}})],f.prototype,"field",void 0);b([d.property({type:[Number],json:{read:!0,write:!0}})],f.prototype,"currentRangeExtent",void 0);b([d.property({type:[Number],json:{read:!0,write:!0}})],f.prototype,"fullRangeExtent",void 0);
b([d.property({type:["rangeInfo"],readOnly:!0,json:{read:!1,write:!0}})],f.prototype,"type",void 0);return f=b([d.subclass("esri.layers.support.RangeInfo")],f)}(d.declared(f.JSONSupport));l.RangeInfo=p;l.default=p})},"widgets/Search/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/promise/all jimu/portalUtils jimu/utils esri/request".split(" "),function(p,l,m,b,f,d,g,r){return{map:null,layerInfosObj:null,appConfig:null,_esriLocatorRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,
setMap:function(b){this.map=b},setLayerInfosObj:function(b){this.layerInfosObj=b},setAppConfig:function(b){this.appConfig=b},getConfigInfo:function(d){if(d&&d.sources&&0<d.sources.length){var h=null;return this.searchLayer(this.map)&&d.upgradeFromGeocoder?(h=this.map.itemInfo.itemData.applicationProperties.viewing.search,h=l.map(h.layers,p.hitch(this,function(b,c){c.hintText=b;return this._getQueryTypeGeocoder(c)},h.hintText)),f(h).then(p.hitch(this,function(b){d.sources=[].concat(b).concat(d.sources);
return d}))):d}return b(this._getSoucesFromPortalAndWebmap()).then(p.hitch(this,function(b){return{allPlaceholder:"",showInfoWindowOnSelect:!0,sources:b}}))},_getSoucesFromPortalAndWebmap:function(){var b=[],g=null;this.searchLayer(this.map)&&(g=this.map.itemInfo.itemData.applicationProperties.viewing.search,l.forEach(g.layers,p.hitch(this,function(d,c){c.hintText=d;b.push(this._getQueryTypeGeocoder(c))},g.hintText)));return d.getPortalSelfInfo(this.appConfig.portalUrl).then(p.hitch(this,function(d){if((d=
d.helperServices&&d.helperServices.geocode)&&0<d.length)for(var c=0,a=d.length;c<a;c++){var e=d[c];e&&b.push(this._processSingleLine(e))}return f(b).then(p.hitch(this,function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d&&(d&&"query"===d.type||(d={name:d.name||this._getGeocodeName(d.url),url:d.url,singleLineFieldName:d.singleLineFieldName,placeholder:d.placeholder||window.jimuNls.common.findAddressOrPlace||d.name||this._getGeocodeName(d.url),maxResults:6,searchInCurrentMapExtent:!1,type:"locator"}),
b.push(d))}return b}))}))},_getQueryTypeGeocoder:function(b){var d=this.map.findLayerById(b.id),e=null,c=null,c=b.id,e=null;d&&d.allSublayers&&(e=d.allSublayers.find(function(a){return a.id===b.subLayer}));return d?(e="scene"===d.type?d.url+"/layers/"+d.layerId:e?e.url||d.url+"/"+b.subLayer:d.url+"/"+d.layerId,{name:d.title,layerId:c,url:e,placeholder:b.hintText||window.jimuNls.common.findAddressOrPlace,searchFields:[b.field.name],displayField:b.field.name,exactMatch:b.field.exactMatch||!1,maxResults:6,
searchInCurrentMapExtent:!1,type:"query"}):null},_isEsriLocator:function(b){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(b)},_processSingleLine:function(b){if(b.singleLineFieldName)return b;if(this._isEsriLocator(b.url))return b.singleLineFieldName="SingleLine",b;var d=new m;r(b.url,{query:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(p.hitch(this,function(e){e.singleLineAddressField&&e.singleLineAddressField.name?(b.singleLineFieldName=e.singleLineAddressField.name,
d.resolve(b)):(console.warn(b.url+"has no singleLineFieldName"),d.resolve(null))}),p.hitch(this,function(b){console.error(b);d.resolve(null)}));return d.promise},_getGeocodeName:function(b){if("string"!==typeof b)return"geocoder";b=b.split("/");return b[b.length-2]||"geocoder"},getGeocoderName:function(b){return this._getGeocodeName(b)},hasAppSearchInfo:function(b){return b.itemInfo&&b.itemInfo.itemData&&b.itemInfo.itemData.applicationProperties&&b.itemInfo.itemData.applicationProperties.viewing&&
b.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(b){if(!b||!this.hasAppSearchInfo(b))return!1;b=b.itemInfo.itemData.applicationProperties.viewing.search;return b.enabled&&0!==b.layers.length?!0:!1}}})},"widgets/Search/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Search/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchNode" class\x3d"search-node"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchResultsNode" class\x3d"searchResults arcgisSearch esri-search"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Search/css/style.css":".jimu-widget-search{min-height: 32px;}.jimu-widget-search .search-node.default-width-for-openAtStart{width: 300px;}.jimu-widget-search .esri-search__container{border: 1px solid #57585A;}.jimu-widget-search .result-item-selected{background: #eee;}.jimu-widget-search .esri-search .esri-search-button:hover,.jimu-widget-search .esri-search .esri-search-button:focus {background-color: #485566; color: white;}.jimu-widget-search .esri-search .show-all-results{position: absolute; height: 25px; color: #686868; line-height: 25px; display: none; width: 237px; margin: auto; background-color: #fff; padding: 0 12px; cursor: pointer;}.jimu-widget-search .searchResults .esri-menu{border-radius: 0; color: #686868; font-size: 12px; padding: 0; top: 33px; visibility: visible;}.jimu-widget-search .searchMenu {position: absolute; top: 100%; left: 0; z-index: 1000; display: none; float: left; padding: 5px 0; margin: 2px 0 0; font-size: 14px; line-height: 16px; background-color: #fff; -webkit-background-clip: padding-box; background-clip: padding-box; border: 1px solid #57585A; -webkit-border-radius: 4px; border-radius: 4px; overflow: auto; max-height: 300px;}.jimu-widget-search .searchMenu ul {margin: 0; padding: 0; list-style: none;}.jimu-widget-search .esri-search .esri-menu li.active{background-color: #d9dde0; color: #686868; font-size: 14px;}.jimu-widget-search .esri-search .esri-menu li{padding: 0 12px; line-height: 25px; cursor: pointer;}.jimu-widget-search .esri-search .esri-menu li:hover,.jimu-widget-search .esri-search .esri-menu li:focus {background-color: #eee;}.jimu-widget-search .esri-search .esri-menu .menu-header{background-color: #d9dde0; color: #686868; font-size: 14px; min-height: 30px; padding: 0 12px; line-height: 30px;}",
"*now":function(p){p(['dojo/i18n!*preload*widgets/Search/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/when dojo/on dojo/query dojo/keys dojo/Deferred dojo/promise/all jimu/BaseWidget jimu/utils esri/widgets/Search esri/widgets/Search/SearchViewModel esri/tasks/Locator esri/tasks/support/Query esri/layers/FeatureLayer esri/layers/SceneLayer esri/symbols/PictureMarkerSymbol esri/PopupTemplate ./utils dojo/NodeList-dom".split(" "),function(p,l,m,b,f,d,g,r,h,t,e,c,a,k,y,q,v,B,x,n,C){return p([e],{name:"Search",baseClass:"jimu-widget-search",
searchDijit:null,searchResults:null,_highlightedFeatureHandle:null,postCreate:function(){this.listenWidgetIds.push("framework")},startup:function(){this.inherited(arguments);this.config&&this.config.sources||(this.config.sources=[]);C.setMap(this.sceneView.map);C.setAppConfig(this.appConfig);f(C.getConfigInfo(this.config)).then(l.hitch(this,function(a){return t(this._convertConfig(a)).then(function(a){return m.filter(a,function(a){return a})})})).then(l.hitch(this,function(b){this.domNode&&(b=new k({activeSourceIndex:1===
b.length?0:-1,allPlaceholder:c.stripHTML(this.config.allPlaceholder?this.config.allPlaceholder:window.jimuNls.common.findAddressOrPlace),autoSelect:!0,buttonModeEnabled:!1,labelEnabled:!1,popupEnabled:c.isDefined(this.config.showInfoWindowOnSelect)?!!this.config.showInfoWindowOnSelect:!0,view:this.sceneView,sources:b,theme:"arcgisSearch"}),this.searchDijit=new a({viewModel:b,includeDefaultSources:!1,container:this.searchNode}),this._resetSearchDijitStyle(),this.own(this.searchDijit.viewModel.watch("activeSourceIndex",
l.hitch(this,"_onSourceIndexChange"))),this.own(d(this.searchDijit.viewModel,"select-result",l.hitch(this,"_onSelectResult"))),this.own(d(this.searchDijit.domNode,"click",l.hitch(this,"_onSearchDijitClick"))),this.own(d(this.searchDijit._inputNode,"keyup",l.hitch(this,function(a){a.keyCode!==r.ENTER&&this._onClearSearch()}))),this.own(d(this.searchDijit.viewModel,"suggest-results",l.hitch(this,"_onSuggestResults"))),this.own(d(this.searchDijit.viewModel,"search-clear",l.hitch(this,"_onClearSearch"))),
this.fetchData("framework"))}))},_convertConfig:function(a){return m.map(a.sources,l.hitch(this,function(a){var b=new h;if(a&&a.url&&"locator"===a.type)b.resolve({locator:new y(a.url||""),outFields:["*"],singleLineFieldName:a.singleLineFieldName||"",name:c.stripHTML(a.name||""),placeholder:c.stripHTML(a.placeholder||""),highlightSymbol:new x({url:this.folderUrl+"css/images/search-pointer.png",size:36,width:36,height:36,xoffset:9,yoffset:18}),countryCode:a.countryCode||"",maxSuggestions:a.maxSuggestions||
6,maxResults:a.maxResults||6,zoomScale:a.zoomScale||5E4,withinViewEnabled:!!a.searchInCurrentMapExtent});else if(a&&a.url&&"query"===a.type){var d=this._getLayerViewByLayerId(a.layerId),e;e=/\/sceneserver\//gi.test(a.url)?new B({url:a.url||null,outFields:["*"]}):new v({url:a.url||null,outFields:["*"]});e.load().then(l.hitch(this,function(){var f=this._getInfoTemplate(e,a,a.displayField),g=null;a.searchFields&&0<a.searchFields.length?g=a.searchFields:(g=[],m.forEach(e.fields,function(a){"esriFieldTypeOID"!==
a.type&&a.name!==e.objectIdField&&"esriFieldTypeGeometry"!==a.type&&g.push(a.name)}));f={layer:e,outFields:["*"],searchFields:g,displayField:a.displayField||"",exactMatch:!!a.exactMatch,name:c.stripHTML(a.name||""),placeholder:c.stripHTML(a.placeholder||""),maxSuggestions:a.maxSuggestions||6,maxResults:a.maxResults||6,popupTemplate:f||null,zoomScale:a.zoomScale||5E4,withinViewEnabled:!!a.searchInCurrentMapExtent,featureLayerId:a.layerId,featurelayerGeometryType:e.geometryType};d&&(f.resultGraphicEnabled=
!1);"scene"===e.type&&(f.autoNavigate=!1);b.resolve(f)}),l.hitch(this,function(){b.resolve(null)}))}else b.resolve(null);return b}))},_getInfoTemplate:function(a,b){var d,e=[];m.filter(a.fields,function(a){var b=a.name.toLowerCase();0>b.indexOf("shape")&&0>b.indexOf("objectid")&&0>b.indexOf("perimeter")&&e.push(a.name)});(a=c.getDefaultPopupInfo(a,b.name+": {"+b.displayField+"}",e))&&(d=new n({title:a.title,content:[{type:"fields",fieldInfos:a.fieldInfos}]}));return d},destroy:function(){C.setAppConfig(null);
var a=this.sceneView.popup.viewModel;a&&(a.visible=!1);this.searchDijit&&this.searchDijit.viewModel&&(this.searchDijit.viewModel.set("view",null),this.searchDijit.viewModel.clear());this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove();this.inherited(arguments)},_getLayerViewByLayerId:function(a){return this.sceneView.layerViews.find(l.hitch(this,function(b){return b.layer.id===a}))},_onSelectResult:function(a){var b=a.result;if(b&&b.name){var b=a.result.feature,c=this._getLayerViewByLayerId(a.source.featureLayerId);
if(c){var d=new q;d.where=c.layer.objectIdField+" \x3d "+b.attributes[c.layer.objectIdField];d.outFields=["*"];d.returnGeometry=!0;d.maxAllowableOffset=0;d.outSpatialReference=this.sceneView.spatialReference;c.layer.queryFeatures(d).then(l.hitch(this,function(a){if(a=a.features[0])this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove(),this._highlightedFeatureHandle=c.highlight(a),"scene"===c.layer.type&&this.sceneView.goTo(a)}))}"point"===a.source.featurelayerGeometryType&&a.source.zoomScale&&
this.sceneView.goTo({scale:a.source.zoomScale})}},_onSearchComplete:function(){},onReceiveData:function(a,b,c){"framework"===a&&"framework"===b&&c&&c.searchString&&(this.searchDijit.viewModel.set("value",c.searchString),this.searchDijit.viewModel.search())},setPosition:function(){this._resetSearchDijitStyle();this.inherited(arguments)},resize:function(){this._resetSearchDijitStyle()},_onSourceIndexChange:function(){this.searchDijit.viewModel.value&&this.searchDijit.viewModel.search(this.searchDijit.viewModel.value)},
_onSuggestResults:function(){this._resetSelectorPosition(".searchMenu");this._hideResultMenu()},_onClearSearch:function(){b.setStyle(this.searchResultsNode,"display","none");this.searchResultsNode.innerHTML="";this.searchResults=null;this.sceneView.popup.close();this._highlightedFeatureHandle&&this._highlightedFeatureHandle.remove()},_onSearchDijitClick:function(){this._resetSelectorPosition(".esri-source-menu")},_resetSelectorPosition:function(a){var d=b.getMarginBox(window.jimuConfig.layoutId);
g(a,this.domNode).forEach(l.hitch(this,function(e){var f=b.position(e),h=l.getObject("viewModel.sources.length",!1,this.searchDijit);if(1<h&&".esri-source-menu"===a){var k=g(a+" li[data-index]",this.domNode)[0],k=c.isDefined(k)?b.getMarginBox(k).h:30;f.h=k*(h+1)}if("none"!==b.getStyle(e,"display")){var h=b.position(this.searchDijit.domNode),k=h.y-2,m=d.h-h.y-h.h;m>f.y+f.h||k>f.h?b.setStyle(e,"top",(m>f.y+f.h?h.h:-f.h-2)+"px"):(b.setStyle(e,"height",Math.max(m,k)+"px"),b.setStyle(e,"top",(m>k?h.h:
-k-2)+"px"))}}))},_onSelectSearchResult:function(a){for(a=a.target;!b.hasAttr(a,"data-source-index")||!b.getAttr(a,"data-index");)a=a.parentNode;var c=null,c=b.getAttr(a,"data-source-index");a=parseInt(b.getAttr(a,"data-index"),10);"all"!==c&&(c=parseInt(c,10));this.searchResults&&this.searchResults[c]&&this.searchResults[c][a]&&(c=this.searchResults[c][a],this.searchDijit.viewModel.select(c))},_hideResultMenu:function(){g(".show-all-results",this.searchResultsNode).style("display","block");g(".searchMenu",
this.searchResultsNode).style("display","none")},_showResultMenu:function(){b.setStyle(this.searchResultsNode,"display","block");g(".show-all-results",this.searchResultsNode).style("display","none");g(".searchMenu",this.searchResultsNode).style("display","block");var a=g(".esri-input-container",this.searchDijit.domNode)[0];if(a){var a=b.getMarginBox(a),c={width:a.w+"px"};if(window.isRTL){var d=b.getMarginBox(this.searchDijit.domNode);c.right=d.w-a.l-a.w+"px"}else c.left=a.l+"px";g(".show-all-results",
this.searchResultsNode).style(c);g(".searchMenu",this.searchResultsNode).style(c)}},_resetSearchDijitStyle:function(){}})});