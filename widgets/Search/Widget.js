// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Search":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Search/SearchViewModel ./Search/SearchResultRenderer ./Widget ../core/lang ../core/watchUtils ../PopupTemplate dojo/regexp dojo/keys dojo/query dojo/i18n!./Search/nls/Search".split(" "),function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r){return function(c){function f(a){a=c.call(this)||this;a._inputNode=null;a._sourceMenuButtonNode=
null;a._sourceListNode=null;a._suggestionListNode=null;a._searchResultRenderer=new b({container:document.createElement("div")});a._suggestPromise=null;a._popupTemplate=new k({title:r.searchResult,content:a._renderSearchResultsContent.bind(a)});a._relatedTarget=null;a.activeMenu="none";a.activeSource=null;a.activeSourceIndex=null;a.allPlaceholder=null;a.autoNavigate=null;a.autoSelect=null;a.defaultSource=null;a.locationToAddressDistance=null;a.maxResults=null;a.maxSuggestions=null;a.minSuggestCharacters=
null;a.popupEnabled=null;a.popupOpenOnSelect=null;a.popupTemplate=null;a.resultGraphic=null;a.resultGraphicEnabled=null;a.results=null;a.searchAllEnabled=null;a.searching=!1;a.searchTerm=null;a.selectedResult=null;a.sources=null;a.suggestions=null;a.suggestionsEnabled=null;a.view=null;a.viewModel=new e;return a}h(f,c);f.prototype.postInitialize=function(){var a=this;this.viewModel.popupTemplate=this._popupTemplate;this.own(m.whenNot(this,"searchTerm",function(){a.activeMenu="none"}))};f.prototype.destroy=
function(){this._cancelSuggest();this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)};f.prototype.clear=function(){};f.prototype.focus=function(){this._inputNode&&(this._inputNode.focus(),this.emit("search-focus"))};f.prototype.blur=function(a){this._inputNode&&(this._inputNode.blur(),this._inputBlur(a),this.emit("search-blur"))};f.prototype.search=function(a){var c=this;this.activeMenu="none";this._set("searching",
!0);this._cancelSuggest();return this.viewModel.search(a).then(function(a){c.activeMenu=a.numResults?"none":"warning";c._set("searching",!1);return a}).otherwise(function(){c._set("searching",!1);c.activeMenu="none";return null})};f.prototype.suggest=function(a){var c=this;this._cancelSuggest();return this._suggestPromise=a=this.viewModel.suggest(a).then(function(a){a.numResults&&(c.activeMenu="suggestion");return a}).otherwise(function(){c.activeMenu="none";return null})};f.prototype.render=function(){var a=
this,c=this.viewModel,b=c.searchTerm,k=this._getSourceName(c.activeSourceIndex),m=b.trim(),d=this.id,p=l.tsx("input",{bind:this,placeholder:c.placeholder,"aria-label":r.searchButtonTitle,maxlength:c.maxInputLength,autocomplete:"off",type:"text",tabindex:"0",class:"esri-search__input",value:b,"aria-haspopup":"true",id:d+"_input",role:"textbox",onkeydown:this._handleInputKeydown,onkeyup:this._handleInputKeyup,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:this._storeInputNode,
afterUpdate:this._storeInputNode,onfocusout:this._storeRelatedTarget,onfocus:this.focus,onblur:this.blur}),p=l.tsx("form",{key:"esri-search__form",bind:this,class:"esri-search__form",onsubmit:this._formSubmit,role:"search"},p),q=b?l.tsx("div",{key:"esri-search__clear-button",bind:this,role:"button",class:l.join("esri-search__clear-button","esri-widget-button"),tabindex:"0",title:r.clearButtonTitle,onfocus:this._clearButtonFocus,onclick:this._handleClearButtonClick,onkeydown:this._handleClearButtonClick},
l.tsx("span",{"aria-hidden":"true",class:"esri-icon-close"})):null,h=c.suggestions?c.suggestions.map(function(c){var b=c.sourceIndex,g=c.results.length?a._getSuggestionHeaderNode(b):null;c=c.results.map(function(c,g){return a._getSuggestionNode(c,g,b)});return l.tsx("div",{key:"esri-search__suggestion-container-"+b},g,l.tsx("ul",{key:"esri-search__suggestion-list-"+b},c))}):null,h=l.tsx("div",{key:"esri-search__suggestions-menu",class:l.join("esri-menu","esri-search__suggestions-menu"),role:"menu",
bind:this,afterCreate:this._storeSuggestionsListNode,afterUpdate:this._storeSuggestionsListNode},h),p=l.tsx("div",{key:"esri-search__input-container",class:"esri-search__input-container"},p,h,q),q=l.tsx("div",{key:"esri-search__submit-button",bind:this,role:"button",title:r.searchButtonTitle,class:l.join("esri-search__submit-button","esri-widget-button"),tabindex:"0",onclick:this._handleSearchButtonClick,onkeydown:this._handleSearchButtonClick},l.tsx("span",{"aria-hidden":"true",role:"presentation",
class:"esri-icon-search"}),l.tsx("span",{class:"esri-icon-font-fallback-text"},r.searchButtonTitle)),b=g.substitute({value:'"'+b+'"'},r.noResultsFound),b=m?l.tsx("div",{key:"esri-search__no_results"},l.tsx("div",{class:"esri-search__warning-header"},r.noResults),l.tsx("div",{class:"esri-search__warning-text"},b)):null,m=m?null:l.tsx("div",{key:"esri-search__empty-search"},l.tsx("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),l.tsx("span",{class:"esri-search__no-value-text"},r.emptyValue)),
m=l.tsx("div",{key:"esri-search__error-menu",class:l.join("esri-menu","esri-search__warning-menu")},l.tsx("div",{class:"esri-search__warning-body"},b,m)),h=c.sources,b=1<h.length,h=h&&h.toArray(),c=c.searchAllEnabled?this._getSourceNode(e.ALL_INDEX):null,k=b?l.tsx("div",{key:"esri-search__source-menu-button",bind:this,role:"button",title:r.searchIn,id:d+"_menu_button",class:l.join("esri-search__sources-button","esri-widget-button"),tabindex:"0",onkeydown:this._handleSourcesMenuToggleClick,onclick:this._handleSourcesMenuToggleClick,
onkeyup:this._handleSourceMenuButtonKeyup,onblur:this._sourcesButtonBlur,afterCreate:this._storeSourceMenuButtonNode,afterUpdate:this._storeSourceMenuButtonNode},l.tsx("span",{"aria-hidden":"true",role:"presentation",class:"esri-icon-down-arrow esri-search__sources-button--down"}),l.tsx("span",{"aria-hidden":"true",role:"presentation",class:"esri-icon-up-arrow esri-search__sources-button--up"}),l.tsx("span",{class:"esri-search__source-name"},k)):null,d=b?l.tsx("ul",{bind:this,afterCreate:this._storeSourcesListNode,
afterUpdate:this._storeSourcesListNode},c,h.map(function(c,b){return a._getSourceNode(b)})):null,d=l.tsx("div",{key:"esri-search__source-menu",class:l.join("esri-menu","esri-search__sources-menu"),role:"menu"},d),c=this.activeMenu,c=(f={},f["esri-search--multiple-sources"]=b,f["esri-search--loading"]=this.searching,f["esri-search--warning"]="warning"===c,f["esri-search--sources"]="source"===c,f["esri-search--show-suggestions"]="suggestion"===c,f);return l.tsx("div",{class:"esri-search esri-widget"},
l.tsx("div",{role:"presentation",classes:c,class:"esri-search__container"},k,d,p,q,m));var f};f.prototype._handleSourcesMenuToggleClick=function(){this.activeMenu="source"===this.activeMenu?"none":"source"};f.prototype._handleClearButtonClick=function(){this.viewModel.clear();this.focus()};f.prototype._handleSearchButtonClick=function(){this.search()};f.prototype._handleSuggestionClick=function(a){if(a=a.currentTarget["data-suggestion"])this.search(a),this.focus()};f.prototype._handleSourceClick=
function(a){this.viewModel.activeSourceIndex=a.currentTarget["data-source-index"];this.activeMenu="none";this.focus()};f.prototype._sourcesButtonBlur=function(a){this._removeActiveMenu(a&&a.relatedTarget,this._sourceListNode)};f.prototype._inputBlur=function(a){a=a&&a.relatedTarget;this._removeActiveMenu(a?a:this._relatedTarget,this._suggestionListNode)};f.prototype._storeRelatedTarget=function(a){this._relatedTarget=a.relatedTarget};f.prototype._clearButtonFocus=function(){this.activeMenu="none"};
f.prototype._removeActiveMenu=function(a,c){a&&c&&c.contains(a)||(this.activeMenu="none")};f.prototype._cancelSuggest=function(){var a=this._suggestPromise;a&&(a.cancel(),this._suggestPromise=null)};f.prototype._storeSuggestionsListNode=function(a){this._suggestionListNode=a};f.prototype._storeSourcesListNode=function(a){this._sourceListNode=a};f.prototype._storeInputNode=function(a){this._inputNode=a};f.prototype._storeSourceMenuButtonNode=function(a){this._sourceMenuButtonNode=a};f.prototype._handleInputKeydown=
function(a){var c=a.keyCode;(c===p.TAB||c===p.ESCAPE||a.shiftKey&&c===p.TAB)&&this._cancelSuggest()};f.prototype._handleInputKeyup=function(a){var c=a.keyCode,b=a.ctrlKey||a.metaKey||c===p.copyKey||c===p.LEFT_ARROW||c===p.RIGHT_ARROW||c===p.ENTER||c===p.SHIFT,g=this._suggestionListNode?u("li",this._suggestionListNode):null,e=c===p.UP_ARROW,k=c===p.DOWN_ARROW;b||(c===p.TAB||c===p.ESCAPE||a.shiftKey&&c===p.TAB?(this._cancelSuggest(),c===p.ESCAPE&&(this.activeMenu="none")):(e||k)&&g?(this.activeMenu=
"suggestion",a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),(a=g[e?g.length-1:0])&&a.focus()):this.viewModel.searchTerm&&this.suggest())};f.prototype._handleInputPaste=function(a){var c=this.viewModel;a=a.target;c.searchTerm!==a.value&&(c.searchTerm=a.value);c.searchTerm&&this.suggest()};f.prototype._handleSourceMenuButtonKeyup=function(a){var c=a.keyCode,b=c===p.UP_ARROW,c=c===p.DOWN_ARROW;if(b||c)a.stopPropagation(),a.preventDefault(),(a=this._sourceListNode?u("li",this._sourceListNode):
null)&&(b=a[b?a.length-1:0])&&b.focus()};f.prototype._handleSourceKeyup=function(a){var c=a.target,b=this._sourceListNode?u("li",this._sourceListNode):null,g=a.keyCode;g===p.ESCAPE?(this.activeMenu="none",this.focus()):b&&(c=b.indexOf(c),g===p.UP_ARROW?(a.stopPropagation(),a.preventDefault(),a=c-1,(b=0>a?this._sourceMenuButtonNode:b[a])&&b.focus()):g===p.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),a=c+1,(b=a>=b.length?this._sourceMenuButtonNode:b[a])&&b.focus()))};f.prototype._handleSuggestionKeyup=
function(a){var c=a.target,b=this._suggestionListNode?u("li",this._suggestionListNode):null,c=b.indexOf(c),g=a.keyCode;this._cancelSuggest();g===p.BACKSPACE||g===p.DELETE?this.focus():g===p.ESCAPE?(this.activeMenu="none",this.focus()):b&&(g===p.UP_ARROW?(a.stopPropagation(),a.preventDefault(),a=c-1,0>a?this.focus():(b=b[a])&&b.focus()):g===p.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),a=c+1,a>=b.length?this.focus():(b=b[a])&&b.focus()))};f.prototype._formSubmit=function(a){a.preventDefault();
this.search()};f.prototype._getSourceName=function(a){var c=this.viewModel.sources.getItemAt(a);return a===e.ALL_INDEX?r.all:c?c.name:r.untitledSource};f.prototype._getSuggestionHeaderNode=function(a){var c=this.viewModel;return 1<c.sources.length&&c.activeSourceIndex===e.ALL_INDEX?(a=this._getSourceName(a),l.tsx("div",{class:"esri-header"},a)):null};f.prototype._splitResult=function(a,c){c=q.escapeString(c);return a.replace(new RegExp("(^|)("+c+")(|$)","ig"),"$1|$2|$3").split("|")};f.prototype._getSuggestionNode=
function(a,c,b){var g=this.viewModel.searchTerm;if(g){var e=this._splitResult(a.text||r.untitledResult,g),k=g.toLowerCase(),m=[];e.forEach(function(a,g){a&&a.length&&(g=b+"-"+c+"-"+g,a.toLowerCase()===k?m.push(l.tsx("strong",{key:"esri-search__partial-match-"+g},a)):m.push(a))});return l.tsx("li",{bind:this,onclick:this._handleSuggestionClick,onkeydown:this._handleSuggestionClick,onkeyup:this._handleSuggestionKeyup,key:"esri-search__suggestion$-{sourceIndex}_"+c,"data-suggestion":a,role:"menuitem",
tabindex:"0"},m)}};f.prototype._getSourceNode=function(a){var c=(b={},b["esri-search__source--active"]=a===this.viewModel.activeSourceIndex,b);return l.tsx("li",{bind:this,key:"esri-search__source-"+a,onclick:this._handleSourceClick,onkeydown:this._handleSourceClick,onkeyup:this._handleSourceKeyup,"data-source-index":a,role:"menuitem",class:"esri-search__source",classes:c,tabindex:"0"},this._getSourceName(a));var b};f.prototype._renderSearchResultsContent=function(){this._searchResultRenderer.showMoreResultsOpen=
!1;this._searchResultRenderer.viewModel=this.viewModel;return this._searchResultRenderer};d([a.property(),l.renderable()],f.prototype,"activeMenu",void 0);d([a.aliasOf("viewModel.activeSource"),l.renderable()],f.prototype,"activeSource",void 0);d([a.aliasOf("viewModel.activeSourceIndex"),l.renderable()],f.prototype,"activeSourceIndex",void 0);d([a.aliasOf("viewModel.allPlaceholder"),l.renderable()],f.prototype,"allPlaceholder",void 0);d([a.aliasOf("viewModel.autoNavigate")],f.prototype,"autoNavigate",
void 0);d([a.aliasOf("viewModel.autoSelect")],f.prototype,"autoSelect",void 0);d([a.aliasOf("viewModel.defaultSource")],f.prototype,"defaultSource",void 0);d([a.aliasOf("viewModel.locationToAddressDistance")],f.prototype,"locationToAddressDistance",void 0);d([a.aliasOf("viewModel.maxResults")],f.prototype,"maxResults",void 0);d([a.aliasOf("viewModel.maxSuggestions")],f.prototype,"maxSuggestions",void 0);d([a.aliasOf("viewModel.minSuggestCharacters")],f.prototype,"minSuggestCharacters",void 0);d([a.aliasOf("viewModel.popupEnabled")],
f.prototype,"popupEnabled",void 0);d([a.aliasOf("viewModel.popupOpenOnSelect")],f.prototype,"popupOpenOnSelect",void 0);d([a.aliasOf("viewModel.popupTemplate")],f.prototype,"popupTemplate",void 0);d([a.aliasOf("viewModel.resultGraphic")],f.prototype,"resultGraphic",void 0);d([a.aliasOf("viewModel.resultGraphicEnabled")],f.prototype,"resultGraphicEnabled",void 0);d([a.aliasOf("viewModel.results"),l.renderable()],f.prototype,"results",void 0);d([a.aliasOf("viewModel.searchAllEnabled"),l.renderable()],
f.prototype,"searchAllEnabled",void 0);d([a.property({readOnly:!0}),l.renderable()],f.prototype,"searching",void 0);d([a.aliasOf("viewModel.searchTerm"),l.renderable()],f.prototype,"searchTerm",void 0);d([a.aliasOf("viewModel.selectedResult")],f.prototype,"selectedResult",void 0);d([a.aliasOf("viewModel.sources"),l.renderable()],f.prototype,"sources",void 0);d([a.aliasOf("viewModel.suggestions"),l.renderable()],f.prototype,"suggestions",void 0);d([a.aliasOf("viewModel.suggestionsEnabled")],f.prototype,
"suggestionsEnabled",void 0);d([a.aliasOf("viewModel.view"),l.renderable()],f.prototype,"view",void 0);d([l.vmEvent("search-complete search-clear search-start select-result suggest-start suggest-complete".split(" ")),a.property({type:e}),l.renderable("viewModel")],f.prototype,"viewModel",void 0);d([a.aliasOf("viewModel.clear")],f.prototype,"clear",null);d([l.accessibleHandler()],f.prototype,"_handleSourcesMenuToggleClick",null);d([l.accessibleHandler()],f.prototype,"_handleClearButtonClick",null);
d([l.accessibleHandler()],f.prototype,"_handleSearchButtonClick",null);d([l.accessibleHandler()],f.prototype,"_handleSuggestionClick",null);d([l.accessibleHandler()],f.prototype,"_handleSourceClick",null);return f=d([a.subclass("esri.widgets.Search")],f)}(a.declared(c))})},"esri/widgets/Search/SearchViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../core/Error ../../core/Evented ../../core/HandleRegistry ../../core/promiseUtils ../../core/watchUtils ../../styles/basic ./FeatureLayerSearchSource ./LocatorSearchSource ../../tasks/Locator dojo/has ../../Graphic ../../geometry/Point ../../symbols/PictureMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleMarkerSymbol ../../symbols/TextSymbol ../../PopupTemplate ../../geometry/SpatialReference ./support/geometryUtils ./SearchSource dojo/i18n!./nls/Search ../../core/accessorSupport/decorators".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r,t,v,w,A,E,D,x,B,H,z,C,G,y){function F(a,c){return a.hasOwnProperty(c)&&null!=a[c]&&""!==a[c]}var I=l.ofType({key:function(a){return a.featureLayer?"feature-layer":"locator"},base:C,typeMap:{"feature-layer":q,locator:p}}),J=H.WGS84,L=new p({locator:new u({url:"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"}),singleLineFieldName:"SingleLine",outFields:["Addr_type","Match_addr","StAddr","City"],name:G.esriLocatorName,localSearchOptions:{minScale:3E5,
distance:5E4},placeholder:G.placeholder,resultSymbol:new w({url:n.toUrl(r("trident")?"../../images/search/search-symbol-32.png":"../../images/search/search-symbol-32.svg"),size:24,width:24,height:24})});return function(a){function b(b){b=a.call(this)||this;b._handles=new c;b._viewReadyPromise=null;b._viewAnimation=null;b._popupTemplate=new B({title:G.searchResult,content:"{Match_addr}"});b.activeSource=null;b.activeSourceIndex=0;b.allPlaceholder=G.allPlaceholder;b.autoNavigate=!0;b.autoSelect=!0;
b.defaultSource=L;b.locationToAddressDistance=1500;b.maxInputLength=128;b.maxResults=6;b.maxSuggestions=6;b.minSuggestCharacters=1;b.placeholder="";b.popupOpenOnSelect=!0;b.popupTemplate=null;b.popupEnabled=!0;b.resultGraphicEnabled=!0;b.resultGraphic=null;b.results=null;b.selectedSuggestion=null;b.searchAllEnabled=!0;b.selectedResult=null;b.sources=new I([L]);b.suggestionDelay=150;b.suggestions=null;b.suggestionsEnabled=!0;b.view=null;return b}h(b,a);b.prototype.initialize=function(){var a=this;
this._handles.add([m.init(this,"activeSourceIndex",function(b){a._updateActiveSource();a._setPlaceholder(b)}),m.init(this,"allPlaceholder",function(){a._setPlaceholder(a.activeSourceIndex)}),m.init(this,"sources",function(){a._setDefaultActiveSourceIndex();a._setPlaceholder(a.activeSourceIndex)}),m.init(this,"searchAllEnabled",function(){return a._setDefaultActiveSourceIndex()})])};b.prototype.destroy=function(){this.clearGraphics();this._viewReadyPromise&&this._viewReadyPromise.cancel();this._handles.destroy();
this._handles=null};Object.defineProperty(b.prototype,"popup",{get:function(){return this.get("view.popup")||null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"searchTerm",{get:function(){return this._get("searchTerm")||""},set:function(a){this._set("searchTerm",a||"");this.clearGraphics();this.selectedSuggestion&&this.selectedSuggestion.text!==a&&this._set("selectedSuggestion",null);""===a&&this._clear()},enumerable:!0,configurable:!0});b.prototype.clear=function(){this.searchTerm=
""};b.prototype.clearGraphics=function(){this._closePopup();this.view&&this.view.graphics.remove(this.resultGraphic);this._set("resultGraphic",null)};b.prototype.search=function(a){var b=this;this.emit("search-start");var c=this._getLocationSearch(a),g=this._createSuggestionForSearch(a);return this._ready(this.view).then(function(){return b._getResultsFromSources(c,g).then(function(a){var c={activeSourceIndex:b.activeSourceIndex,searchTerm:g.text,numResults:0,numErrors:0,errors:[],results:[]};b._formatResponse(c,
a,g);b._set("searchTerm",g.text);g.key&&g.sourceIndex&&b._set("selectedSuggestion",g);b._set("results",c.results);b.emit("search-complete",c);return b._selectFirstResult(c.results).then(function(){return c})})})};b.prototype.select=function(a){var b=this;this.clearGraphics();if(!a)return g.reject(new e("searchviewmodel:missing-parameter","searchResult is required."));var c=this.view,k=F(a,"sourceIndex")?a.sourceIndex:this._getSourceIndexOfResult(a),m=this.sources.getItemAt(k);if(!m)return g.reject(new e("searchviewmodel:missing-source",
"source not found for selection."));var d=m instanceof q?this._getSourcePopupTemplate(m):null,p=m.resultSymbol||this._getDefaultSymbol(a),l=F(m,"resultGraphicEnabled")?m.resultGraphicEnabled:this.resultGraphicEnabled,h=F(m,"autoNavigate")?m.autoNavigate:this.autoNavigate,f=F(m,"popupOpenOnSelect")?m.popupOpenOnSelect:this.popupOpenOnSelect,u=F(m,"popupEnabled")?m.popupEnabled:this.popupEnabled,r=u?d||this.popupTemplate||this._popupTemplate:null,d=a.feature,w=this.popup,v=d.attributes,C=d.geometry;
if(!d)return g.reject(new e("searchviewmodel:missing-feature","The SearchResult must contain a feature for selection."));d=z.getPointFromGeometry(C);return(c?z.getPointWithElevation(d,c):g.resolve(d)).then(function(e){p instanceof x&&(p.text=a.name);var d=new t({geometry:C,symbol:p,attributes:v,popupTemplate:r});return(c&&h?b._goToSearchResult(c,a.extent):g.resolve()).then(function(){b._viewAnimation=null;l&&c&&c.graphics.push(d);w&&u&&f&&w.open({features:[d],location:e});b._set("selectedResult",
a);b._set("resultGraphic",d);b.emit("select-result",{result:a,source:m,sourceIndex:k});return a})})};b.prototype.suggest=function(a,b){var c=this,g=a||this.searchTerm;this.emit("suggest-start",{searchTerm:g});return this._suggestTimer(b).then(function(){return c._suggestImmediate(g).then(function(a){c._set("suggestions",a.results);c.emit("suggest-complete",a);return a})})};b.prototype._clear=function(){this._viewAnimation&&(this._viewAnimation.stop(),this._viewAnimation=null);this._set("results",
null);this._set("suggestions",null);this._set("selectedResult",null);this._set("selectedSuggestion",null);this.emit("search-clear")};b.prototype._closePopup=function(){var a=this.get("view.popup"),b=this.resultGraphic;if(a&&this.popupEnabled&&b){var c=a.selectedFeature;c&&c===b&&a.close()}};b.prototype._suggestTimer=function(a){return g.after(null!=a?a:this.suggestionDelay)};b.prototype._getLocationSearch=function(a){if(a instanceof t)return z.getPointFromGeometry(a.geometry);if(a instanceof v)return a;
if(Array.isArray(a)&&2===a.length)return new v({longitude:a[0],latitude:a[1]})};b.prototype._createSuggestionForSearch=function(a){if(a&&F(a,"key")&&F(a,"text")&&F(a,"sourceIndex"))return a;a="string"===typeof a?a:this.searchTerm;var b=this.selectedSuggestion,c=this.selectedResult;return b&&c&&b.text===c.name?b:{text:a,key:null,sourceIndex:null}};b.prototype._getFirstResult=function(a){var b=null;a&&a.some(function(a){a=a.results[0];var c=!!a;c&&(b=a);return c});return b};b.prototype._selectFirstResult=
function(a){return this.autoSelect&&a?(a=this._getFirstResult(a))?this.select(a):g.resolve():g.resolve()};b.prototype._suggestImmediate=function(a){var b=this;return this._ready(this.view).then(function(){return b._getSuggestionsFromSources(a)}).then(function(c){var g={activeSourceIndex:b.activeSourceIndex,searchTerm:a,numResults:0,numErrors:0,errors:[],results:[]};b._formatResponse(g,c);return g})};b.prototype._formatSourceResponse=function(a,b,c){var g=b&&b.value||[];b=b&&b.error;var e=this.sources.getItemAt(c);
b?(a.errors.push({sourceIndex:c,source:e,error:b}),a.numErrors++):(a.results.push({sourceIndex:c,source:e,results:g}),a.numResults+=g.length)};b.prototype._formatResponse=function(a,b,c){var g=this;if(b)if(-1===a.activeSourceIndex){var e=c&&F(c,"sourceIndex")&&-1!==c.sourceIndex?c.sourceIndex:void 0;b.forEach(function(b,c){g._formatSourceResponse(a,b,void 0!==e?e:c)})}else this._formatSourceResponse(a,b[0],a.activeSourceIndex)};b.prototype._getResultsFromSources=function(a,b){var c=this,e=!a&&F(b,
"sourceIndex")?b.sourceIndex:this.activeSourceIndex,m=[];-1===e?this.sources.forEach(function(g,e){m.push(c._getResultsFromSource(a,b,e))}):m.push(this._getResultsFromSource(a,b,e));return g.eachAlways(m)};b.prototype._getSuggestionsFromSources=function(a){var b=this,c=this.activeSourceIndex,e=[];-1===c?this.sources.forEach(function(c,g){e.push(b._getSuggestionsFromSource(a,g))}):e.push(this._getSuggestionsFromSource(a,c));return g.eachAlways(e)};b.prototype._getResultsFromSource=function(a,b,c){var g=
this.sources.getItemAt(c),e=this.get("view.spatialReference")||J,m=F(g,"maxResults")?g.maxResults:this.maxResults,k=g instanceof q&&F(g,"exactMatch")?g.exactMatch:!1,d=g instanceof p&&F(g,"locationToAddressDistance")?g.locationToAddressDistance:this.locationToAddressDistance;return g.getResults({view:this.view,sourceIndex:c,location:a,suggestResult:b,spatialReference:e,exactMatch:k,maxResults:m,distance:d})};b.prototype._getSuggestionsFromSource=function(a,b){var c=this.sources.getItemAt(b),e=F(c,
"suggestionsEnabled")?c.suggestionsEnabled:this.suggestionsEnabled,m=a.trim().length,k=F(c,"minSuggestCharacters")?c.minSuggestCharacters:this.minSuggestCharacters;return e&&m>=k?(e=this.get("view.spatialReference")||J,m=F(c,"maxSuggestions")?c.maxSuggestions:this.maxSuggestions,c.getSuggestions({view:this.view,sourceIndex:b,suggestTerm:a,spatialReference:e,maxSuggestions:m})):g.resolve()};b.prototype.createDefaultSymbol=function(a,b){if("point"===b)return new D({color:a.color,size:a.size,outline:{color:a.outline.color,
width:a.outline.width}});if("polyline"===b)return new E({color:a.color,width:a.width});if("polygon"===b)return new A({color:a.color,outline:{color:a.outline.color,width:a.outline.width}})};b.prototype._updateActiveSource=function(){var a=this.sources.getItemAt(this.activeSourceIndex)||null;this._set("activeSource",a)};b.prototype._getPlaceHolderText=function(a){var b=this.sources.getItemAt(a),c=this.allPlaceholder,c=void 0===c?G.allPlaceholder:c;return-1===a?c:b?b.placeholder:""};b.prototype._setPlaceholder=
function(a){this._set("placeholder",this._getPlaceHolderText(a))};b.prototype._setDefaultActiveSourceIndex=function(){this.activeSourceIndex=1!==this.sources.length&&this.searchAllEnabled?-1:0};b.prototype._getSourcePopupTemplate=function(a){var b=a.featureLayer;if(b)return F(a,"popupTemplate")?a.popupTemplate:b.popupTemplate};b.prototype._getSourceIndexOfResult=function(a){var b=null;this.results.some(function(c){return c.results.some(function(g){if(g===a)return b=c.sourceIndex,!0})});return b};
b.prototype._goToSearchResult=function(a,b){var c=!!b,g={animate:c};a="3d"===a.type?a.goTo({target:b,tilt:0},g):a.goTo({target:b},g);c&&(this._viewAnimation=a);return a};b.prototype._ready=function(a){this._viewReadyPromise&&this._viewReadyPromise.cancel();return a?this._viewReadyPromise=a.always().then(function(){return null}):g.resolve()};b.prototype._getDefaultSymbol=function(a){var b=this.get("view.map.basemap.id");if(a=a&&a.feature&&a.feature.geometry&&a.feature.geometry.type)if(b=(b=k.getSchemes({theme:"default",
basemap:b||"topo",geometryType:a}))&&b.primaryScheme)return b.color&&F(b,"opacity")&&(b.color.a=b.opacity),this.createDefaultSymbol(b,a);return L.resultSymbol};b.ALL_INDEX=-1;d([y.property({readOnly:!0})],b.prototype,"activeSource",void 0);d([y.property()],b.prototype,"activeSourceIndex",void 0);d([y.property()],b.prototype,"allPlaceholder",void 0);d([y.property()],b.prototype,"autoNavigate",void 0);d([y.property()],b.prototype,"autoSelect",void 0);d([y.property({readOnly:!0})],b.prototype,"defaultSource",
void 0);d([y.property()],b.prototype,"locationToAddressDistance",void 0);d([y.property()],b.prototype,"maxInputLength",void 0);d([y.property()],b.prototype,"maxResults",void 0);d([y.property()],b.prototype,"maxSuggestions",void 0);d([y.property()],b.prototype,"minSuggestCharacters",void 0);d([y.property({readOnly:!0})],b.prototype,"placeholder",void 0);d([y.property({dependsOn:["view.popup"],readOnly:!0})],b.prototype,"popup",null);d([y.property()],b.prototype,"popupOpenOnSelect",void 0);d([y.property()],
b.prototype,"popupTemplate",void 0);d([y.property()],b.prototype,"popupEnabled",void 0);d([y.property()],b.prototype,"resultGraphicEnabled",void 0);d([y.property({readOnly:!0})],b.prototype,"resultGraphic",void 0);d([y.property({readOnly:!0})],b.prototype,"results",void 0);d([y.property({readOnly:!0})],b.prototype,"selectedSuggestion",void 0);d([y.property()],b.prototype,"searchAllEnabled",void 0);d([y.property({readOnly:!0})],b.prototype,"selectedResult",void 0);d([y.property()],b.prototype,"searchTerm",
null);d([y.property({type:I})],b.prototype,"sources",void 0);d([y.property()],b.prototype,"suggestionDelay",void 0);d([y.property({readOnly:!0})],b.prototype,"suggestions",void 0);d([y.property()],b.prototype,"suggestionsEnabled",void 0);d([y.property()],b.prototype,"view",void 0);d([y.property()],b.prototype,"clear",null);return b=d([y.subclass("esri.widgets.Search.SearchViewModel")],b)}(y.declared(a,b))})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","../Color"],function(n,
f,h){function d(a,b){var c;if(a)switch(c={},c.color=new h(a.color),b){case "point":c.outline={color:new h(a.outline.color),width:a.outline.width};c.size=a.size;break;case "polyline":c.width=a.width;break;case "polygon":c.outline={color:new h(a.outline.color),width:a.outline.width}}return c}var a={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),
dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,1],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[26,26,26,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[26,
26,26,1],outline:{color:[178,178,178,1],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,.8],outline:{color:[255,255,255,1],width:1}},secondary:[{color:[128,128,128,.8],outline:{color:[255,255,255,1],width:1}},{color:[255,255,255,
.8],outline:{color:[128,128,128,1],width:1}}]},dark:{primary:{color:[227,139,79,.8],outline:{color:[51,51,51,1],width:1}},secondary:[{color:[178,178,178,.8],outline:{color:[51,51,51,1],width:1}},{color:[26,26,26,.8],outline:{color:[128,128,128,1],width:1}}]}}}},l={};(function(){var e,b,c,g,m,k,d,p;for(e in a)for(g in b=a[e],c=b.basemapGroups,m=l[e]={basemaps:[].concat(c.light).concat(c.dark),point:{},polyline:{},polygon:{}},c)for(k=c[g],d=0;d<k.length;d++)p=k[d],b.pointSchemes&&(m.point[p]=b.pointSchemes[g]),
b.lineSchemes&&(m.polyline[p]=b.lineSchemes[g]),b.polygonSchemes&&(m.polygon[p]=b.polygonSchemes[g])})();return{getAvailableThemes:function(e){var b=[],c,g,m;for(c in a)g=a[c],m=l[c],e&&-1===n.indexOf(m.basemaps,e)||b.push({name:g.name,label:g.label,description:g.description,basemaps:m.basemaps.slice(0)});return b},getSchemes:function(a){var b=a.basemap,c=a.geometryType;a=l[a.theme];var g;(a=(a=a&&a[c])&&a[b])&&(g={primaryScheme:d(a.primary,c),secondarySchemes:n.map(a.secondary,function(a){return d(a,
c)})});return g},cloneScheme:function(a){var b;a&&(b=f.mixin({},a),b.color&&(b.color=new h(b.color)),b.outline&&(b.outline={color:b.outline.color&&new h(b.outline.color),width:b.outline.width}));return b}}})},"esri/widgets/Search/FeatureLayerSearchSource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/lang ./SearchSource ./support/featureLayerUtils ../../core/accessorSupport/decorators".split(" "),
function(n,f,h,d,a,l,e,b,c){return function(g){function e(){var a=null!==g&&g.apply(this,arguments)||this;a.displayField=null;a.exactMatch=null;a.searchFields=null;a.searchQueryParams=null;a.searchTemplate=null;a.suggestionTemplate=null;a.suggestQueryParams=null;return a}h(e,g);k=e;Object.defineProperty(e.prototype,"featureLayer",{set:function(a){this._set("featureLayer",a);this._loadFeatureLayer()},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new k({autoNavigate:this.autoNavigate,
filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?l.clone(this.outFields):null,placeholder:this.placeholder,popup:this.popup,popupEnabled:this.popupEnabled,popupOpenOnSelect:this.popupOpenOnSelect,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,searchExtent:this.searchExtent?this.searchExtent.clone():null,suggestionsEnabled:this.suggestionsEnabled,
suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,featureLayer:this.featureLayer,searchFields:this.searchFields?l.clone(this.searchFields):null,searchQueryParams:this.searchQueryParams?l.clone(this.searchQueryParams):null,suggestionTemplate:this.suggestionTemplate,suggestQueryParams:this.suggestQueryParams?l.clone(this.suggestQueryParams):null,zoomScale:this.zoomScale})};e.prototype.getResults=function(c){return b.getResults(a({source:this},
c))};e.prototype.getSuggestions=function(c){return b.getSuggestions(a({source:this},c))};e.prototype._getFirstStringField=function(){var a=this.featureLayer,b="";a&&a.fields&&a.fields.some(function(a){if("string"===a.type)return b=a.name,!0});return b};e.prototype._getDisplayField=function(){return this.displayField||this.featureLayer.displayField||this._getFirstStringField()};e.prototype._setFallbackNameFromFeatureLayer=function(a){(a=this._getFeatureLayerTitle(a))&&(this.name||this._set("name",
a))};e.prototype._loadFeatureLayer=function(){var a=this,b=this.featureLayer;b&&b.load().then(function(){return a._setFallbackNameFromFeatureLayer(b)})};e.prototype._getFeatureLayerTitle=function(a){var b=a.title,c="";(this.searchFields||[this._getDisplayField()]).forEach(function(b,g){c+=0===g?": ":", ";g=a.getField(b);c+=g&&g.alias||b});return b+c};d([c.property()],e.prototype,"displayField",void 0);d([c.property()],e.prototype,"exactMatch",void 0);d([c.property()],e.prototype,"featureLayer",null);
d([c.property()],e.prototype,"searchFields",void 0);d([c.property()],e.prototype,"searchQueryParams",void 0);d([c.property()],e.prototype,"searchTemplate",void 0);d([c.property()],e.prototype,"suggestionTemplate",void 0);d([c.property()],e.prototype,"suggestQueryParams",void 0);return e=k=d([c.subclass("esri.widgets.Search.FeatureLayerSearchSource")],e);var k}(c.declared(e))})},"esri/widgets/Search/SearchSource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Identifiable".split(" "),
function(n,f,h,d,a,l,e){return function(b){function c(a){a=b.call(this)||this;a.autoNavigate=null;a.filter=null;a.maxResults=6;a.maxSuggestions=6;a.minSuggestCharacters=1;a.name="";a.outFields=null;a.placeholder="";a.popup=null;a.popupEnabled=null;a.popupTemplate=null;a.popupOpenOnSelect=null;a.prefix="";a.resultGraphicEnabled=null;a.resultSymbol=null;a.searchExtent=null;a.suggestionsEnabled=null;a.suffix="";a.withinViewEnabled=!1;a.zoomScale=null;return a}h(c,b);d([a.property()],c.prototype,"autoNavigate",
void 0);d([a.property()],c.prototype,"filter",void 0);d([a.property()],c.prototype,"maxResults",void 0);d([a.property()],c.prototype,"maxSuggestions",void 0);d([a.property()],c.prototype,"minSuggestCharacters",void 0);d([a.property()],c.prototype,"name",void 0);d([a.property()],c.prototype,"outFields",void 0);d([a.property()],c.prototype,"placeholder",void 0);d([a.property()],c.prototype,"popup",void 0);d([a.property()],c.prototype,"popupEnabled",void 0);d([a.property()],c.prototype,"popupTemplate",
void 0);d([a.property()],c.prototype,"popupOpenOnSelect",void 0);d([a.property()],c.prototype,"prefix",void 0);d([a.property()],c.prototype,"resultGraphicEnabled",void 0);d([a.property()],c.prototype,"resultSymbol",void 0);d([a.property()],c.prototype,"searchExtent",void 0);d([a.property()],c.prototype,"suggestionsEnabled",void 0);d([a.property()],c.prototype,"suffix",void 0);d([a.property()],c.prototype,"withinViewEnabled",void 0);d([a.property()],c.prototype,"zoomScale",void 0);return c=d([a.subclass("esri.widgets.Search.SearchSource")],
c)}(a.declared(l,e))})},"esri/widgets/Search/support/featureLayerUtils":function(){define("require exports ../../../core/Error ../../../core/lang ../../../core/promiseUtils ../../../geometry/support/scaleUtils ./geometryUtils dojo/date/locale".split(" "),function(n,f,h,d,a,l,e,b){function c(a,b){var c=a.filter,g=a.searchExtent;b=b&&b.extent;a=a.withinViewEnabled&&b?b:void 0;return c&&c.geometry||g||a}function g(b){return b?("not-loaded"===b.loadStatus?b.load():b).then(a.resolve).otherwise(a.reject):
a.resolve()}function m(a){return a&&!!a.get("capabilities.query.supportsPagination")}function k(a){var b="";a&&(a=a.fields)&&a.some(function(a){if("string"===a.type)return b=a.name,!0});return b}function q(a,b){return a&&b?b.every(function(b){return!!a.getField(b)}):!1}function p(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1}function u(a,b,c){var g=null;(a=a.codedValues)&&a.some(function(a){var e=a.name,e=c?e:e.toLowerCase();if((c?b:b.toLowerCase())===e)return g=a.code.toString(),
!0});return g}function r(a,b){return(b=b&&b.where)?"("+a+") AND ("+b+")":a}function t(a,b,c,g,e){var k="";if(a){var m=D.test(b.url)&&p(a)?"N":"";c&&c.forEach(function(c){var d=b.getField(c);c=((c=b.getFieldDomain(c))&&"coded-value"===c.type?u(c,a,e):null)||a||null;if(null!==c){var p=d.type,d=d.name;"string"===p||"date"===p?e?d=r(d+" \x3d "+m+"'"+c+"'",g):(c=c.toUpperCase(),d=r("UPPER("+d+") LIKE "+m+"'%"+c+"%'",g)):"oid"===p||"small-integer"===p||"integer"===p||"single"===p||"double"===p?(c=parseFloat(c),
d=isNaN(c)?null:r(d+" \x3d "+c,g)):d=r(d+" \x3d "+c,g);d&&(k+=k?" OR ("+d+")":"("+d+")")}})}return k}function v(a,b){var c=null;(a=a.codedValues)&&a.length&&a.some(function(a){if(a.code===b)return c=a.name,!0});return c}function w(a,c,g,e){var k=a.layer,m=a.attributes;e=k.getFieldDomain(g);return c?d.substitute(m,c):g&&a.hasOwnProperty("attributes")&&m.hasOwnProperty(g)?(a=m[g],g=k.getField(g),e&&"coded-value"===e.type?v(e,a):g&&"date"===g.type?b.format(new Date(a)):a):""}function A(a,b,c,g){return a.features.map(function(a){var e=
a.attributes[a.layer.objectIdField];return{text:w(a,b.suggestionTemplate,g,b),key:e,sourceIndex:c}})}function E(a,b,c,g,k,m,d){return a.features.map(function(a){var p=a.clone();a=w(a,c.searchTemplate,k,c);var l=e.createExtentFromGeometry(p.geometry,b,m);return{extent:d?e.scaleExtent(l.clone(),b,d):l,feature:p,name:a,sourceIndex:g}})}Object.defineProperty(f,"__esModule",{value:!0});var D=/https?:\/\/services.*\.arcgis\.com/i,x=/(?:\{([^}]+)\})/g;f.getResults=function(b){var e=b.exactMatch,d=void 0===
e?!1:e,p=b.location,f=b.maxResults,u=b.spatialReference,r=b.source,w=b.sourceIndex,v=b.suggestResult,A=b.view,K=r.featureLayer,x=r.filter,n=r.zoomScale,B=A&&A.scale,D=c(r,A);return g(K).then(function(){var b=r.displayField||r.featureLayer.displayField||k(r.featureLayer);if(!K.getField(b))return a.reject(new h("searchfeaturelayerutils:invalid-field","displayField is invalid."));var c=r.outFields||[b];if(!(c&&1===c.length&&"*"===c[0]||q(K,c)))return a.reject(new h("searchfeaturelayerutils:invalid-field",
"outField is invalid."));var g=K.createQuery(),e=r.searchQueryParams;e&&g.set(e);u&&(g.outSpatialReference=u,e=l.getMetersPerUnitForSR(u))&&(g.maxAllowableOffset=e);g.returnGeometry=!0;c&&(g.outFields=c);if(p)g.geometry=p;else if(v.key)g.objectIds=[parseInt(v.key,10)];else{c=r.searchFields||[b];if(!q(K,c))return a.reject(new h("searchfeaturelayerutils:invalid-field","search field is invalid."));m(K)&&(g.num=f);D&&(g.geometry=D);e=v.text.trim();if(!e)return a.resolve();var z=r.prefix,C=r.suffix,e=
(""+(void 0===z?"":z)+e+(void 0===C?"":C)).replace(/\'/g,"''"),c=t(e,K,c,x,d);if(!c)return a.resolve();g.where=c}return K.queryFeatures(g).then(function(a){return E(a,A,r,w,b,B,n)})})};f.getSuggestions=function(b){var e=b.source,d=b.spatialReference,p=b.suggestTerm,l=b.maxSuggestions,f=b.sourceIndex,u=e.featureLayer,r=e.filter,w=c(e,b.view);return g(u).then(function(){if(!m(u))return a.resolve();var b=e.displayField||e.featureLayer.displayField||k(e.featureLayer),c=e.searchFields||[b],g=[];e.suggestionTemplate?
e.suggestionTemplate.replace(x,function(a,b){g.push(b);return a}):g.push(b);-1===g.indexOf(u.objectIdField)&&g.push(u.objectIdField);var v=!!u.getField(b),z=g&&1===g.length&&"*"===g[0]||q(u,g),C=q(u,c);if(!v)return a.reject(new h("searchfeaturelayerutils:invalid-field","displayField is invalid."));if(!z)return a.reject(new h("searchfeaturelayerutils:invalid-field","outField is invalid."));if(!C)return a.reject(new h("searchfeaturelayerutils:invalid-field","search field is invalid."));v=u.createQuery();
(z=e.suggestQueryParams)&&v.set(z);v.outSpatialReference=d;v.returnGeometry=!1;v.num=l;v.outFields=g;w&&(v.geometry=w);z=p.trim();if(!z)return a.resolve();var C=e.prefix,n=e.suffix,z=(""+(void 0===C?"":C)+z+(void 0===n?"":n)).replace(/\'/g,"''"),c=t(z,u,c,r,!1);if(!c)return a.resolve();v.where=c;return u.queryFeatures(v).then(function(a){return A(a,e,f,b)})})}})},"esri/widgets/Search/support/geometryUtils":function(){define("require exports ../../../core/Error ../../../core/promiseUtils ../../../geometry/Point ../../../geometry/Extent ../../../geometry/Polygon ../../../geometry/Polyline ../../../geometry/Multipoint ../../../geometry/support/scaleUtils ../../../views/MapView".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m){function k(a,b,c){return b&&b.map?(c?g.getExtentForScale(b,c):b.extent).clone().centerAt(a):new l({xmin:a.x-.25,ymin:a.y-.25,xmax:a.x+.25,ymax:a.y+.25,spatialReference:a.spatialReference})}Object.defineProperty(f,"__esModule",{value:!0});f.getPointWithElevation=function(a,b){return b?a?a.hasZ||b instanceof m?d.resolve(a):(b=b.get("map.ground"))&&b.layers.length?b.queryElevation(a).then(function(a){return a.geometry}):d.resolve(a):d.reject(new h("searchgeometryutils:missing-parameter",
"point is missing.")):d.reject(new h("searchgeometryutils:missing-parameter","view is missing."))};f.getPointFromGeometry=function(g){if(g instanceof a)return g;if(g instanceof l)return g.center;if(g instanceof e)return g.centroid;if(g instanceof c)return g.getPoint(0);if(g instanceof b)return g.getPoint(0,0)};f.createExtentFromGeometry=function(g,m,d){if(g){if(g instanceof l)return g;if(g instanceof c||g instanceof e||g instanceof b)return g.extent;if(g instanceof a)return k(g,m,d)}};f.scaleExtent=
function(a,b,c){if(a&&b)return k(a.center,b,c)}})},"esri/views/MapView":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/promise/all ../core/accessorSupport/decorators ../core/HandleRegistry ../core/promiseUtils ./MapViewBase ./DOMContainer ../geometry/ScreenPoint ./ui/2d/DefaultUI2D ./2d/engine/Stage ./2d/layers/support/GraphicsView2D ./2d/input/MapViewInputManager ./2d/navigation/MapViewNavigation ./2d/support/HighlightOptions ./BreakpointsOwner ./support/screenshotUtils".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r,t,v,w){return function(c){function g(a){a=c.call(this,a)||this;a._graphicsView=null;a._mapViewHandles=new e;a._stage=null;a.highlightOptions=new t;a.inputManager=new u({view:a});a.navigation=null;a.ui=null;a.rendering=!1;return a}h(g,c);Object.defineProperty(g.prototype,"interacting",{get:function(){return this.navigation&&this.navigation.interacting||!1},enumerable:!0,configurable:!0});g.prototype.hitTest=function(b,c){if(!this._setup)return null;var g;g=
null!=b&&b.x?b:new m({x:b,y:c});var e=this.toMap(g);b=[this._graphicsView];b.push.apply(b,this.allLayerViews.toArray().reverse());return a(b.map(function(a){return a&&a.hitTest?a.hitTest(g.x,g.y):null})).then(function(a){return{screenPoint:g,results:a.filter(function(a){return null!=a}).map(function(a){return{mapPoint:e,graphic:a}})}})};g.prototype.takeScreenshot=function(a){if(!this._setup)return b.reject("Map view cannot be used before it is ready");a=w.adjustScreenshotSettings(a,this);return this._stage.takeScreenshot(a)};
g.prototype.on=function(a,b,c){var g=this.inputManager&&this.inputManager.viewEvents.register(a,b,c);return g?g:this.inherited(arguments)};g.prototype.destroyLayerViews=function(){this.inherited(arguments);this._stage&&(this._stage.destroy(),this._stage=null)};g.prototype._startup=function(){var a=this;this.inherited(arguments);var b=new q(this.surface),c=new p({view:this,graphics:this.graphics}),g=new r({view:this,animationManager:this.animationManager});this._stage=b;this._graphicsView=c;this._set("navigation",
g);this._mapViewHandles.add([this.allLayerViews.on("change",function(){return a._updateStageChildren()}),b.on("post-render",function(){return a._set("rendering",a.allLayerViews.some(function(a){return!0===a.rendering}))}),this.watch("stationary",function(a){return b.stationary=a},!0),this.watch("state.viewpoint",function(c){return b.state=a.state},!0)]);b.state=this.state;this._updateStageChildren()};g.prototype._tearDown=function(){this._setup&&(this._graphicsView.destroy(),this._mapViewHandles.removeAll(),
this._stage.destroy(),this.navigation.destroy(),this._graphicsView=this._stage=null,this._set("navigation",null),this.inherited(arguments))};g.prototype._updateStageChildren=function(){var a=this;this._stage.removeAllChildren();this.allLayerViews.filter(function(a){return null!=a.container}).forEach(function(b,c){a._stage.addChildAt(b.container,c)});this._stage.addChild(this._graphicsView.container)};d([l.property({readOnly:!0})],g.prototype,"inputManager",void 0);d([l.property({readOnly:!0})],g.prototype,
"navigation",void 0);d([l.property({dependsOn:["navigation.interacting"],type:Boolean})],g.prototype,"interacting",null);d([l.property({type:k})],g.prototype,"ui",void 0);d([l.property({readOnly:!0})],g.prototype,"rendering",void 0);return g=d([l.subclass("esri.views.MapView")],g)}(l.declared(c,g,v))})},"esri/views/MapViewBase":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang ../core/accessorSupport/decorators ../core/HandleRegistry ../core/Logger ../core/promiseUtils ../Viewpoint ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils ./View ./ViewAnimation ./2d/FrameTask ./2d/PaddedViewState ./2d/MapViewConstraints ./2d/AnimationManager ./2d/viewpointUtils".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r,t,v,w,A,E,D){var x=b.getLogger("esri.views.MapView");return function(b){function f(a){var c=b.call(this,a)||this;c._frameTask=new v(c);c._mapViewBaseHandles=new e;c._setup=!1;c.fullOpacity=1;c.interacting=!1;c.initialExtent=null;c.resizeAlign="center";c.type="2d";c.constraints=new A;c.padding={top:0,right:0,bottom:0,left:0};var g=function(){this._set("updating",this.layerViewManager.factory.working||this.allLayerViews.some(function(a){return!0===a.updating}))}.bind(c),
k=c._mapViewBaseHandles;k.add([c.watch("viewpoint",function(a){return c._flipStationary()},!0),c.on("resize",function(a){return c._resizeHandler(a)}),c.watch("animationManager.animation",function(a){c.animation=a}),c.allLayerViews.on("change",function(){g();k.remove("layerViewsUpdating");k.add(c.allLayerViews.map(function(a){return a.watch("updating",g)}).toArray(),"layerViewsUpdating")})]);c.watch("ready",function(a){a?c._startup():c._tearDown()});return c}h(f,b);f.prototype.destroy=function(){this.destroyed||
(this._set("ready",!1),this._mapViewBaseHandles.removeAll(),this.layerViewManager.empty(),this._frameTask.destroy(),this._tearDown(),this._gotoTask=this._mapViewBaseHandles=this._frameTask=null)};Object.defineProperty(f.prototype,"animation",{set:function(a){var b=this,c=this._get("animation");a!==c&&(c&&c.stop(),!a||a.isFulfilled()?this._set("animation",null):(this._set("animation",a),c=function(){a===b._get("animation")&&(b._set("animation",null),b._frameTask.requestFrame())},a.then(c,c,function(a){b.state&&
(b.state.viewpoint=a)})))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"center",{get:function(){if(!this._setup)return this._get("center");var a=this.content.center;return new m({x:a[0],y:a[1],spatialReference:this.content.spatialReference})},set:function(a){if(null!=a)if(this._normalizeInput(a))if(this._setup){var b=this.viewpoint;D.centerAt(b,b,a);this.viewpoint=b}else this._set("center",a),this.notifyChange("initialExtentRequired");else x.error("#center","incompatible spatialReference "+
JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"constraints",{set:function(a){var b=this,c=this._get("constraints");c&&(this._mapViewBaseHandles.remove("constraints"),c.destroy());this._set("constraints",a);a&&(this._setup&&(a.view=this,this.state.viewpoint=a.fit(this.content.viewpoint)),this._mapViewBaseHandles.add(a.on("update",function(){b._setup&&b.state&&(b.state.viewpoint=
a.fit(b.content.viewpoint))}),"constraints"))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"extent",{get:function(){return this._setup?this.content.extent.clone():this._get("extent")},set:function(a){if(null!=a){var b=this._normalizeInput(a);b?b.width&&b.height?this._setup?(a=this.viewpoint,D.setExtent(a,a,b,this.size,{constraints:this.constraints}),this.viewpoint=a):(this._set("extent",b),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",
-1),this.notifyChange("initialExtentRequired")):x.error("#extent","invalid extent size"):x.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"initialExtentRequired",{get:function(){var a=this.extent,b=this.center,c=this.scale,g=this.viewpoint,e=this.zoom;return this.get("map.initialViewProperties.viewpoint")||a||b&&(0!==c||-1!==
e)||g?!1:!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"padding",{get:function(){return this._setup?this.state.padding:this._get("padding")},set:function(a){this._setup?(this.state.padding=a,this._set("padding",this.state.padding)):this._set("padding",a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"rotation",{get:function(){return this._setup?this.content.rotation:this._get("rotation")},set:function(a){if(!isNaN(a))if(this._setup){var b=this.viewpoint;
D.rotateTo(b,b,a);this.viewpoint=b}else this._set("rotation",a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"scale",{get:function(){return this._setup?this.content.scale:this._get("scale")},set:function(a){if(a&&!isNaN(a))if(this._setup){var b=this.viewpoint;D.scaleTo(b,b,a);this.viewpoint=b}else{this._set("scale",a);this._set("zoom",-1);if(a=this._get("extent"))this._set("extent",null),this._set("center",a.center);this.notifyChange("initialExtentRequired")}},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"stationary",{get:function(){return!this.animation&&!this.interacting&&!this._get("resizing")&&!this._stationaryTimer},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewpoint",{get:function(){if(!this._setup)return this._get("viewpoint");var a=this.content;return a&&a.viewpoint.clone()},set:function(a){if(null!=a){var b=this._normalizeInput(a);b?this._setup?(a=D.create(),D.copy(a,b),this.constraints.constrain(a,this.content.viewpoint),
this.state.viewpoint=a,this._frameTask.requestFrame(),this._set("viewpoint",a)):(this._set("viewpoint",b),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),this.notifyChange("initialExtentRequired")):!a.scale||isNaN(a.scale)?x.error("#viewpoint","invalid scale value of "+a.scale):a.targetGeometry?x.error("#viewpoint","incompatible spatialReference "+JSON.stringify(a.targetGeometry.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference)):
x.error("#viewpoint","geometry not defined")}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"zoom",{get:function(){return this._setup?this.constraints.scaleToZoom(this.scale):this._get("zoom")},set:function(a){if(null!=a){if(!this._setup){this.notifyChange("initialExtentRequired");this._set("zoom",a);this._set("scale",0);var b=this._get("extent");b&&(this._set("extent",null),this._set("center",b.center))}this.constraints.effectiveLODs&&(b=this.viewpoint,D.scaleTo(b,b,this.constraints.zoomToScale(a)),
this.viewpoint=b,this._set("zoom",this.constraints.scaleToZoom(this.scale)))}},enumerable:!0,configurable:!0});f.prototype.goTo=function(b,c){if(this._setup)return c=a.mixin({animate:!0},c),b=D.createAsync(b,this),this._gotoTask={},c.animate?this._gotoAnimated(b,c):this._gotoImmediate(b,c);x.error("#goTo()","MapView cannot be used before it is ready")};f.prototype.hitTest=function(a,b){return c.reject("Should be implemented by subclasses")};f.prototype.toMap=function(a,b,c){if(!this._setup)return null;
a&&null!=a.x&&(c=b,b=a.y,a=a.x);var g=[0,0];this.state.toMap(g,[a,b]);c=c||new m;c.x=g[0];c.y=g[1];c.spatialReference=this.spatialReference;return c};f.prototype.isTileInfoRequired=function(){return!0};f.prototype.toScreen=function(a,b,c,g){if(!this._setup)return null;a&&null!=a.x&&(g=b,b=a.y,a=a.x);g=c||g||new k;a=[a,b];this.state.toScreen(a,a);g.x=a[0];g.y=a[1];return g};f.prototype.pixelSizeAt=function(a,b){if(!this._setup)return NaN;a&&null!=a.x&&(b=a.y,a=a.x);return this.content.pixelSizeAt([a,
b])};f.prototype.requestLayerViewUpdate=function(a){this._setup&&this._frameTask.requestLayerViewUpdate(a)};f.prototype.getDefaultSpatialReference=function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null};f.prototype.isSpatialReferenceSupported=function(a,b){if(b||this._get("ready"))return!0;b=this._normalizeInput(this._get("center"),a);var c=this._normalizeInput(this._get("extent"),a),g=this._normalizeInput(this._get("viewpoint"),
a),e=this._userSpatialReference,k=null,m=null;(g=g&&g.targetGeometry)&&("extent"===g.type?k=g:"point"===g.type&&(m=g));g=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"),a);a=this._normalizeInput(this.initialExtent,a);a=c||k||g||a;return b||m||a&&a.center?!0:(e&&x.error("The view could not be initialized with the spatialReference "+e.wkid+".","Try specifying an extent or a center and scale"),!1)};f.prototype._gotoImmediate=function(a,b){var c=this,g=this._gotoTask;
!this.animation||"running"!==this.animation.state&&"waiting-for-target"!==this.animation.state?this.animation=new t({target:a}):this.animation.target=a;a.then(function(a){g===c._gotoTask&&(c.viewpoint=c.animation.target=a,c.animation.finish())});return this.animation};f.prototype._gotoAnimated=function(a,b){var c=this;!this.animation||"running"!==this.animation.state&&"waiting-for-target"!==this.animation.state?this.animation=new t({target:a}):this.animation.target=a;var g=this.animation;g.state=
"waiting-for-target";a.then(function(e){g.target===a&&c.animation===g&&(g.target=e,g.state="running",c.animationManager.animate(g,c.viewpoint,b),g.state===t.State.STOPPED&&g.stop())}).otherwise(function(){g.target===a&&c.animation===g&&(c.animation=null,g.finish())});return g};f.prototype._resizeHandler=function(a){var b=this.state;if(b){var c=this.content.viewpoint,g=this.content.size.concat();b.size=[a.width,a.height];D.resize(c,c,g,this.content.size,this.resizeAlign);c=this.constraints.constrain(c,
null);this.state.viewpoint=c}};f.prototype._startup=function(){if(!this._setup){var a=this.constraints,b=this._get("zoom"),c=this._get("scale"),e=this._normalizeInput(this._get("center")),k=this._normalizeInput(this._get("extent")),m=this._get("rotation"),d=this._normalizeInput(this._get("viewpoint"));a.view=this;a.effectiveLODs?-1!==b&&(c=a.zoomToScale(b)):b=-1;var p=null,l=null,h=0,b=d&&d.rotation,q=d&&d.targetGeometry;q&&("extent"===q.type?p=q:"point"===q.type&&(l=q,h=d.scale));d=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"));
q=this._normalizeInput(this.initialExtent);k=k||p||d||q;e=e||l||k&&k.center;c=c||h||k&&D.extentToScale(k,this.size);m=new g({targetGeometry:e,scale:c,rotation:m||b||0});a.fit(m);this._set("animationManager",new E);this._set("state",new w({padding:this._get("padding"),size:this.size,viewpoint:m}));this._set("content",this.state.content);this._setup=!0}};f.prototype._tearDown=function(){if(this._setup){this._setup=!1;this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=
null,this.notifyChange("stationary"));var a=this._get("content"),b=a.center,c=a.spatialReference,b=new m({x:b[0],y:b[1],spatialReference:c});this._set("viewpoint",null);this._set("extent",null);this._set("center",b);this._set("zoom",-1);this._set("rotation",a.rotation);this._set("scale",a.scale);this._set("spatialReference",c);this.constraints.view=null;this.animationManager.destroy();this._set("animationManager",null);this._set("state",null);this._set("content",null);this.animation=null}};f.prototype._flipStationary=
function(){var a=this;this._stationaryTimer&&clearTimeout(this._stationaryTimer);this._stationaryTimer=setTimeout(function(){a._stationaryTimer=null;a.notifyChange("stationary")},160);this.notifyChange("stationary")};f.prototype._normalizeInput=function(a,b){void 0===b&&(b=this.spatialReference);var c=a&&a.targetGeometry||a;return b?c?b.equals(c.spatialReference)?a:u.canProject(c,b)?a&&"esri.Viewpoint"===a.declaredClass?(a.targetGeometry=u.project(c,b),a):u.project(c,b):null:null:a};d([l.property()],
f.prototype,"animation",null);d([l.property({readOnly:!0})],f.prototype,"animationManager",void 0);d([l.property({value:null,type:m,dependsOn:["content.center"]})],f.prototype,"center",null);d([l.property({type:A})],f.prototype,"constraints",null);d([l.property({readOnly:!0})],f.prototype,"content",void 0);d([l.property({value:null,type:q,dependsOn:["content.extent"]})],f.prototype,"extent",null);d([l.property()],f.prototype,"fullOpacity",void 0);d([l.property({readOnly:!0})],f.prototype,"interacting",
void 0);d([l.property({type:q})],f.prototype,"initialExtent",void 0);d([l.property({dependsOn:["map.initialViewProperties.viewpoint"]})],f.prototype,"initialExtentRequired",null);d([l.property({value:{top:0,right:0,bottom:0,left:0},cast:function(b){return a.mixin({top:0,right:0,bottom:0,left:0},b)}})],f.prototype,"padding",null);d([l.property()],f.prototype,"resizeAlign",void 0);d([l.property({value:0,type:Number,dependsOn:["content.rotation"]})],f.prototype,"rotation",null);d([l.property({value:0,
type:Number,dependsOn:["content.scale"]})],f.prototype,"scale",null);d([l.property({type:p,dependsOn:["map.initialViewProperties.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],f.prototype,"spatialReference",void 0);d([l.property({readOnly:!0})],f.prototype,"state",void 0);d([l.property()],f.prototype,"stationary",null);d([l.property({readOnly:!0})],f.prototype,"type",void 0);d([l.property({value:null,type:g,dependsOn:["content.viewpoint"]})],f.prototype,"viewpoint",null);d([l.property({value:-1,
dependsOn:["content.scale"]})],f.prototype,"zoom",null);return f=d([l.subclass("esri.views.MapViewBase")],f)}(l.declared(r))})},"esri/views/2d/FrameTask":function(){define(["require","exports","../../core/Scheduler","./FrameBudget"],function(n,f,h,d){return function(){function a(a){var e=this;this.view=a;this._frameTaskHandle=null;this._budget=new d(6);this.budget=6;this.updateEnabled=this.stationary=!0;this.prepare=function(){e._updateParameters.state=e.view.state;e._updateParameters.stationary=
e.view.stationary;e._updateParameters.devicePixelRatio=window.devicePixelRatio;e._budget.reset(e.budget)};this.update=function(){if(e.updateEnabled){for(var a=e._budget,c=e.view,g=c.allLayerViews.toArray().filter(function(a){return a.isFulfilled()&&null==a.layerViews}),m=g.length,k=c.state,d=0;d<g.length;d++)if(c=g[d],c.attached){var p=e._layerViewsState[c.uid];if(null==p||!e.stationary&&!c.moving)c.moving=!0,c.moveStart();p!==k.id&&c.viewChange();e.stationary&&c.moving&&(c.moving=!1,c.moveEnd());
e._layerViewsState[c.uid]=k.id}k=e._layerViewsTrash;for(d=0;d<k.length;d++)c=k[d],e._detachLayerView(c);for(d=k.length=0;d<m;d++)c=g[d],c.isFulfilled()&&!c.attached&&e._attachLayerView(c);g=e._layerViewsToUpdate;m=g.slice();c=e._updateParameters;for(e._layerViewsToUpdate.length=0;!a.done&&0<m.length;)m.shift().processUpdate(c);0<m.length&&g.unshift.apply(g,m);0===g.length&&0===k.length&&e._frameTaskHandle.pause()}};a.watch("ready",function(a){a?e.start():e.stop()})}a.prototype.destroy=function(){this.stop()};
a.prototype.start=function(){var a=this;this._updateParameters={budget:this._budget,state:this.view.state,devicePixelRatio:window.devicePixelRatio,stationary:!0};this._layerViewsTrash=[];this._layerViewsToUpdate=[];this._layerViewsState={};this._allLayerViewsChangeHandle=this.view.allLayerViews.on("change",function(e){Array.prototype.push.apply(a._layerViewsTrash,e.removed);a.requestFrame()});this._stationaryHandle=this.view.watch("stationary",function(e){a.stationary=e;a.requestFrame()});this._frameTaskHandle=
h.addFrameTask(this)};a.prototype.stop=function(){var a=this;this._frameTaskHandle&&(this.view.allLayerViews.forEach(function(e){return a._detachLayerView(e)}),this._stationaryHandle.remove(),this._allLayerViewsChangeHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._allLayerViewsChangeHandle=this._frameTaskHandle=this._layerViewsTrash=this._layerViewsToUpdate=this._layerViewsState=null,this.stationary=!0)};a.prototype.requestLayerViewUpdate=function(a){this._layerViewsToUpdate.push(a);
this.requestFrame()};a.prototype.requestFrame=function(){this._frameTaskHandle&&this._frameTaskHandle.isPaused()&&this._frameTaskHandle.resume()};a.prototype._attachLayerView=function(a){a.attached||(a.attached=!0,a.moving=!1,a.attach())};a.prototype._detachLayerView=function(a){a.attached&&(a.detach(),a.attached=!1,a.moving=!1)};return a}()})},"esri/views/2d/FrameBudget":function(){define(["require","exports","../../core/now"],function(n,f,h){return function(){function d(a){void 0===a&&(a=Number.MAX_VALUE);
this._budget=this._begin=0;this.enabled=!0;this.reset(a)}d.now=function(){return h()};Object.defineProperty(d.prototype,"done",{get:function(){return this.enabled&&this.elapsed>=this._budget},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"elapsed",{get:function(){return h()-this._begin},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"remaining",{get:function(){return Math.max(this._budget-this.elapsed,0)},enumerable:!0,configurable:!0});d.prototype.reset=function(a){void 0===
a&&(a=Number.MAX_VALUE);this._begin=h();this._budget=this.enabled?a:Number.MAX_VALUE};return d}()})},"esri/views/2d/PaddedViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./viewpointUtils ./ViewState ./libs/gl-matrix/vec2 ./libs/gl-matrix/mat2d ./libs/gl-matrix/common ../../core/Accessor".split(" "),function(n,f,h,d,a,l,e,b,c,g,m){var k=function(b){function c(){var a=null!==b&&b.apply(this,
arguments)||this;a.left=0;a.top=0;a.right=0;a.bottom=0;return a}h(c,b);d([a.property()],c.prototype,"left",void 0);d([a.property()],c.prototype,"top",void 0);d([a.property()],c.prototype,"right",void 0);d([a.property()],c.prototype,"bottom",void 0);return c=d([a.subclass("esri.views.2d.PaddedViewState.Padding")],c)}(a.declared(m));return function(m){function p(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=m.apply(this,a)||this;a.content=new e;a.padding=new k;a.size=b.fromValues(0,
0);return a}h(p,m);Object.defineProperty(p.prototype,"clipRect",{get:function(){var a=this.worldScreenWidth;if(!a)return null;var e=g.toRadian(this.rotation),k=this.width*Math.abs(Math.cos(e))+this.height*Math.abs(Math.sin(e));if(a>k)return null;var m=b.clone(this.screenCenter),d=c.fromTranslation(c.create(),m);c.rotate(d,d,e);b.negate(m,m);c.translate(d,d,m);b.transformMat2d(m,this.paddedScreenCenter,d);return{top:-Math.round(k),left:Math.round(m[0]-.5*a),right:Math.round(m[0]+.5*a),bottom:+Math.round(k)}},
enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"padding",{set:function(a){this._set("padding",a||new k);this._updateContent()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"size",{set:function(a){this._set("size",a);this._updateContent()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"paddedScreenCenter",{get:function(){var a=this.content.size,c=this.padding,a=b.scale(b.create(),a,.5);a[0]+=c.left;a[1]+=c.top;return a},enumerable:!0,configurable:!0});
Object.defineProperty(p.prototype,"viewpoint",{set:function(a){var b=a.clone();this.content.viewpoint=a;l.addPadding(b,a,this._get("size"),this._get("padding"));this._set("viewpoint",l.addPadding(b.clone(),a,this._get("size"),this._get("padding")))},enumerable:!0,configurable:!0});p.prototype._updateContent=function(){var a=b.create(),c=this._get("size"),g=this._get("padding");if(c&&g){var e=this.content;b.set(a,g.left+g.right,g.top+g.bottom);b.subtract(a,c,a);e.size=a;if(a=e.viewpoint)this.viewpoint=
a}};d([a.shared({transform:{dependsOn:["padding"]}})],p.prototype,"properties",void 0);d([a.property({dependsOn:["worldScreenWidth","rotation","paddedScreenCenter","screenCenter"],readOnly:!0})],p.prototype,"clipRect",null);d([a.property()],p.prototype,"content",void 0);d([a.property({type:k})],p.prototype,"padding",null);d([a.property()],p.prototype,"size",null);d([a.property({dependsOn:["size","padding"],readOnly:!0})],p.prototype,"paddedScreenCenter",null);d([a.property()],p.prototype,"viewpoint",
null);return p=d([a.subclass("esri.views.2d.PaddedViewState")],p)}(a.declared(e))})},"esri/views/2d/viewpointUtils":function(){define("require exports ./libs/gl-matrix/common ./libs/gl-matrix/mat2d ./libs/gl-matrix/vec2 ../../Viewpoint ../../core/promiseUtils ../../core/Error ../../geometry/SpatialReference ../../geometry/Geometry ../../geometry/Point ../../geometry/Extent ../../geometry/support/webMercatorUtils ../../geometry/support/scaleUtils ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r){function t(b,c,g,e){return e&&g&&!e.equals(g)&&q.canProject(e,g)&&e.isWebMercator?(e.isWebMercator?(g=c[1],89.99999<g?g=89.99999:-89.99999>g&&(g=-89.99999),g=Math.sin(h.toRadian(g)),b=a.set(b,6378137*h.toRadian(c[0]),3189068.5*Math.log((1+g)/(1-g)))):(g=h.toDegree(c[0]/6378137),b=a.set(b,g-360*Math.floor((g+180)/360),h.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*c[1]/6378137))))),b):a.copy(b,c)}function v(a){return a.wkid?a:a.spatialReference||c.WGS84}function w(b,
c){return c.type?a.set(b,c.x,c.y):a.copy(b,c)}function A(a,b){return Math.max(a.width/b[0],a.height/b[1])*G(a.spatialReference)}function E(a,b,c){var e;if(!a)return null;if(Array.isArray(a)&&2===a.length&&"number"===typeof a[0]&&"number"===typeof a[1])return new m(a);if(a.reduce)return a.reduce(function(a,c){return E(c,b,a)},c);a instanceof g?e=a:a.geometry&&(e=a.geometry);if(!e)return null;a="point"===e.type?new k({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference}):e.extent;
if(!a)return null;e=q.canProject(a,b);if(!a.spatialReference.equals(b)&&e)a=q.project(a,b);else if(!e)return null;return c=c?c.union(a):a.clone()}function D(b,c){if(!b)return new l({targetGeometry:new m,scale:0,rotation:0});var e=c.spatialReference,k=c.size,d=c.viewpoint,p=c.constraints,h=null;"esri.Viewpoint"===b.declaredClass?h=b:b.viewpoint?h=b.viewpoint:b.target&&"esri.Viewpoint"===b.target.declaredClass&&(h=b.target);var q=null;if(h&&h.targetGeometry)q=h.targetGeometry;else if(b instanceof g)q=
b;else if(b||b&&(b.hasOwnProperty("center")||b.hasOwnProperty("extent")||b.hasOwnProperty("target")))q=E(b.center,e)||E(b.extent,e)||E(b.target,e)||E(b,e);!q&&d&&d.targetGeometry?q=d.targetGeometry:!q&&c.extent&&(q=c.extent);var f=v(q);e||(e=v(c.spatialReference||c.extent||q));if(!r.canProject(q,e)&&f&&!f.equals(e))return null;var u=w(a.create(),q.center?q.center:q),e=new m(t(u,u,f,e),e),f=null,f=h&&h.targetGeometry&&"point"===h.targetGeometry.type?h.scale:b.hasOwnProperty("scale")&&b.scale?b.scale:
b.hasOwnProperty("zoom")&&-1!==b.zoom&&p&&p.effectiveLODs?p.zoomToScale(b.zoom):Array.isArray(q)||"point"===q.type||"extent"===q.type&&0===q.width&&0===q.height?c.extent?A(c.extent,k):d.scale:A(q.extent,k);c=0;h?c=h.rotation:b.hasOwnProperty("rotation")?c=b.rotation:d&&(c=d.rotation);b=new l({targetGeometry:e,scale:f,rotation:c});p&&(b=p.fit(b),p.rotationEnabled||(b.rotation=0));return b}function x(a,b){var c=a.targetGeometry,g=b.targetGeometry;c.x=g.x;c.y=g.y;c.spatialReference=g.spatialReference;
a.scale=b.scale;a.rotation=b.rotation;return a}function B(b,c,g){return g?a.set(b,.5*(c[0]-g.right+g.left),.5*(c[1]-g.bottom+g.top)):a.scale(b,c,.5)}function H(a,b,c,g){f.getTransform(a,b,c,g);return d.invert(a,a)}function z(b,c,g){var e=h.toRadian(c.rotation)||0;c=Math.abs(Math.cos(e));e=Math.abs(Math.sin(e));return a.set(b,Math.round(g[1]*e+g[0]*c),Math.round(g[1]*c+g[0]*e))}function C(a){return a.scale*(1/(39.37*(p.getMetersPerUnitForSR(a.targetGeometry.spatialReference)||I)*96))}function G(a){return 39.37*
(p.getMetersPerUnitForSR(a)||I)*96}function y(a){return a.isWrappable?(a=u.getInfo(a),a.valid[1]-a.valid[0]):0}function F(a,b){return Math.round(y(a)/b)}Object.defineProperty(f,"__esModule",{value:!0});var I=6370997*Math.PI/180,J=180/Math.PI;f.extentToScale=A;f.create=D;f.copy=x;f.getAnchor=B;f.getExtent=function(){var b=a.create();return function(a,c,g){var e=c.targetGeometry;w(b,e);c=.5*C(c);a.xmin=b[0]-c*g[0];a.ymin=b[1]-c*g[1];a.xmax=b[0]+c*g[0];a.ymax=b[1]+c*g[1];a.spatialReference=e.spatialReference;
return a}}();f.setExtent=function(a,b,c,g,e){f.centerAt(a,b,c.center);a.scale=A(c,g);e&&e.constraints&&e.constraints.constrain(a);return a};f.getOuterExtent=function(){var b=a.create(),c=a.create();return function(a,g,e){w(b,g.targetGeometry);z(c,g,e);e=.5*C(g);a.set({xmin:b[0]-e*c[0],ymin:b[1]-e*c[1],xmax:b[0]+e*c[0],ymax:b[1]+e*c[1],spatialReference:g.targetGeometry.spatialReference});return a}}();f.getClippedExtent=function(){var b=a.create(),c=a.create();return function(a,g,e){var k=C(g),m=g.targetGeometry.spatialReference,
d=F(m,k);w(b,g.targetGeometry);z(c,g,e);m.isWrappable&&c[0]>d&&(c[0]=d);g=.5*k;a.set({xmin:b[0]-g*c[0],ymin:b[1]-g*c[1],xmax:b[0]+g*c[0],ymax:b[1]+g*c[1],spatialReference:m});return a}}();f.getOuterSize=z;f.getPaddingScreenTranslation=function(){var b=a.create();return function(c,g,e){return a.sub(c,a.scale(c,g,.5),B(b,g,e))}}();var L=function(){var b=d.create(),c=a.create();return function(g,e,k,m){var p=C(e);e=h.toRadian(e.rotation)||0;a.set(c,p,p);d.fromScaling(b,c);d.rotate(b,b,e);d.translate(b,
b,f.getPaddingScreenTranslation(c,k,m));d.translate(b,b,[0,m.top-m.bottom]);return a.set(g,b[4],b[5])}}();f.getResolution=C;f.getResolutionToScaleFactor=G;f.getMatrix=function(){var b=a.create(),c=a.create(),g=a.create();return function(e,k,m,p,l,h){a.negate(b,k);a.scale(c,m,.5*h);a.set(g,1/p*h,-1/p*h);d.identity(e);d.translate(e,e,c);l&&d.rotate(e,e,l);d.scale(e,e,g);d.translate(e,e,b);return e}}();f.getTransform=function(){var b=a.create();return function(a,c,g,e){var k=C(c),m=h.toRadian(c.rotation)||
0;w(b,c.targetGeometry);return f.getMatrix(a,b,g,k,m,e)}}();f.getTransformNoRotation=function(){var b=a.create();return function(a,c,g,e){var k=C(c);w(b,c.targetGeometry);return f.getMatrix(a,b,g,k,0,e)}}();f.getWorldWidth=y;f.getWorldScreenWidth=F;f.createAsync=function(a,c){if(a=D(a,c))return e.resolve(a);a=new b("viewpointUtils-createAsync:different-spatialReference","Target spatialReference cannot be projected and is different from out spatialReference");return e.reject(a)};f.angleBetween=function(){var b=
a.create(),c=a.create(),g=a.create();return function(e,k,m){a.subtract(b,e,k);a.normalize(b,b);a.subtract(c,e,m);a.normalize(c,c);a.cross(g,b,c);e=Math.acos(a.dot(b,c)/(a.length(b)*a.length(c)))*J;0>g[2]&&(e=-e);isNaN(e)&&(e=0);return e}}();f.addPadding=function(){var b=a.create();return function(a,c,g,e){var k=a.targetGeometry;x(a,c);L(b,c,g,e);k.x+=b[0];k.y+=b[1];return a}}();f.removePadding=function(){var b=a.create();return function(a,c,g,e){var k=a.targetGeometry;x(a,c);L(b,c,g,e);k.x-=b[0];
k.y-=b[1];return a}}();f.centerAt=function(){var b=a.create();return function(a,c,g){x(a,c);c=a.targetGeometry;var e=v(g),k=v(c);w(b,g);t(b,b,e,k);c.x=b[0];c.y=b[1];return a}}();f.pixelSizeAt=function(a,b,c){return C(b)};f.resize=function(){var b=a.create();return function(c,g,e,k,m){m||(m="center");a.sub(b,e,k);a.scale(b,b,.5);e=b[0];k=b[1];switch(m){case "center":a.set(b,0,0);break;case "left":a.set(b,-e,0);break;case "top":a.set(b,0,k);break;case "right":a.set(b,e,0);break;case "bottom":a.set(b,
0,-k);break;case "top-left":a.set(b,-e,k);break;case "bottom-left":a.set(b,-e,-k);break;case "top-right":a.set(b,e,k);break;case "bottom-right":a.set(b,e,-k)}f.translateBy(c,g,b);return c}}();f.rotateBy=function(a,b,c){x(a,b);a.rotation+=c;return a};f.rotateTo=function(a,b,c){x(a,b);a.rotation=c;return a};f.scaleBy=function(){var b=a.create();return function(c,g,e,k,m){x(c,g);0!==e&&(f.toMap(b,k,g,m),c.scale=g.scale*e,f.toScreen(b,b,c,m),f.translateBy(c,c,a.set(b,b[0]-k[0],k[1]-b[1])));return c}}();
f.scaleTo=function(a,b,c){x(a,b);a.scale=c;return a};f.scaleAndRotateBy=function(){var b=a.create();return function(c,g,e,k,m,d){x(c,g);0!==e&&(f.toMap(b,m,g,d),c.scale=g.scale*e,c.rotation+=k,f.toScreen(b,b,c,d),f.translateBy(c,c,a.set(b,b[0]-m[0],m[1]-b[1])));return c}}();f.padAndScaleAndRotateBy=function(){var b=a.create(),c=a.create();return function(g,e,k,m,d,p,l){f.getPaddingScreenTranslation(c,p,l);a.add(b,d,c);return m?f.scaleAndRotateBy(g,e,k,m,b,p):f.scaleBy(g,e,k,b,p)}}();f.toMap=function(){var b=
d.create();return function(c,g,e,k){return a.transformMat2d(c,g,H(b,e,k,1))}}();f.toScreen=function(){var b=d.create();return function(c,g,e,k){return a.transformMat2d(c,g,f.getTransform(b,e,k,1))}}();f.translateBy=function(){var b=a.create(),c=d.create();return function(g,e,k){x(g,e);var m=C(e),p=g.targetGeometry;d.fromRotation(c,h.toRadian(e.rotation)||0);d.scale(c,c,a.fromValues(m,m));a.transformMat2d(b,k,c);p.x+=b[0];p.y+=b[1];return g}}()})},"esri/views/2d/libs/gl-matrix/common":function(){define([],
function(){if(!n)var n=1E-6;if(!f)var f="undefined"!==typeof Float32Array?Float32Array:Array;if(!h)var h=Math.random;var d={GLMAT_EPSILON:n,GLMAT_ARRAY_TYPE:f,GLMAT_RANDOM:h,setMatrixArrayType:function(a){d.GLMAT_ARRAY_TYPE=a}},a=Math.PI/180,l=180/Math.PI;d.toRadian=function(e){return e*a};d.toDegree=function(a){return a*l};d.setMatrixArrayType(Array);return d})},"esri/views/2d/libs/gl-matrix/mat2d":function(){define(["./common"],function(n){var f=n.GLMAT_ARRAY_TYPE;n={create:function(){var h=new f(6);
h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=0;h[5]=0;return h},clone:function(h){var d=new f(6);d[0]=h[0];d[1]=h[1];d[2]=h[2];d[3]=h[3];d[4]=h[4];d[5]=h[5];return d},copy:function(h,d){h[0]=d[0];h[1]=d[1];h[2]=d[2];h[3]=d[3];h[4]=d[4];h[5]=d[5];return h},identity:function(h){h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=0;h[5]=0;return h},invert:function(h,d){var a=d[0],l=d[1],e=d[2],b=d[3],c=d[4];d=d[5];var g=a*b-l*e;if(!g)return null;g=1/g;h[0]=b*g;h[1]=-l*g;h[2]=-e*g;h[3]=a*g;h[4]=(e*d-b*c)*g;h[5]=(l*c-a*d)*g;return h},
determinant:function(h){return h[0]*h[3]-h[1]*h[2]},multiply:function(h,d,a){var l=d[0],e=d[1],b=d[2],c=d[3],g=d[4];d=d[5];var m=a[0],k=a[1],q=a[2],p=a[3],f=a[4];a=a[5];h[0]=l*m+b*k;h[1]=e*m+c*k;h[2]=l*q+b*p;h[3]=e*q+c*p;h[4]=l*f+b*a+g;h[5]=e*f+c*a+d;return h}};n.mul=n.multiply;n.rotate=function(h,d,a){var l=d[0],e=d[1],b=d[2],c=d[3],g=d[4];d=d[5];var m=Math.sin(a);a=Math.cos(a);h[0]=l*a+b*m;h[1]=e*a+c*m;h[2]=l*-m+b*a;h[3]=e*-m+c*a;h[4]=g;h[5]=d;return h};n.scale=function(h,d,a){var l=d[1],e=d[2],
b=d[3],c=d[4],g=d[5],m=a[0];a=a[1];h[0]=d[0]*m;h[1]=l*m;h[2]=e*a;h[3]=b*a;h[4]=c;h[5]=g;return h};n.translate=function(h,d,a){var l=d[0],e=d[1],b=d[2],c=d[3],g=d[4];d=d[5];var m=a[0];a=a[1];h[0]=l;h[1]=e;h[2]=b;h[3]=c;h[4]=l*m+b*a+g;h[5]=e*m+c*a+d;return h};n.fromRotation=function(h,d){var a=Math.sin(d);d=Math.cos(d);h[0]=d;h[1]=a;h[2]=-a;h[3]=d;h[4]=0;h[5]=0;return h};n.fromScaling=function(h,d){h[0]=d[0];h[1]=0;h[2]=0;h[3]=d[1];h[4]=0;h[5]=0;return h};n.fromTranslation=function(h,d){h[0]=1;h[1]=
0;h[2]=0;h[3]=1;h[4]=d[0];h[5]=d[1];return h};n.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"};n.frob=function(h){return Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2)+Math.pow(h[2],2)+Math.pow(h[3],2)+Math.pow(h[4],2)+Math.pow(h[5],2)+1)};return n})},"esri/views/2d/libs/gl-matrix/vec2":function(){define(["./common"],function(n){var f=n.GLMAT_ARRAY_TYPE,h=n.GLMAT_RANDOM,d={create:function(){var a=new f(2);a[0]=0;a[1]=0;return a},clone:function(a){var d=new f(2);
d[0]=a[0];d[1]=a[1];return d},fromValues:function(a,d){var e=new f(2);e[0]=a;e[1]=d;return e},copy:function(a,d){a[0]=d[0];a[1]=d[1];return a},set:function(a,d,e){a[0]=d;a[1]=e;return a},add:function(a,d,e){a[0]=d[0]+e[0];a[1]=d[1]+e[1];return a},subtract:function(a,d,e){a[0]=d[0]-e[0];a[1]=d[1]-e[1];return a}};d.sub=d.subtract;d.multiply=function(a,d,e){a[0]=d[0]*e[0];a[1]=d[1]*e[1];return a};d.mul=d.multiply;d.divide=function(a,d,e){a[0]=d[0]/e[0];a[1]=d[1]/e[1];return a};d.div=d.divide;d.min=function(a,
d,e){a[0]=Math.min(d[0],e[0]);a[1]=Math.min(d[1],e[1]);return a};d.max=function(a,d,e){a[0]=Math.max(d[0],e[0]);a[1]=Math.max(d[1],e[1]);return a};d.scale=function(a,d,e){a[0]=d[0]*e;a[1]=d[1]*e;return a};d.scaleAndAdd=function(a,d,e,b){a[0]=d[0]+e[0]*b;a[1]=d[1]+e[1]*b;return a};d.distance=function(a,d){var e=d[0]-a[0];a=d[1]-a[1];return Math.sqrt(e*e+a*a)};d.dist=d.distance;d.squaredDistance=function(a,d){var e=d[0]-a[0];a=d[1]-a[1];return e*e+a*a};d.sqrDist=d.squaredDistance;d.length=function(a){var d=
a[0];a=a[1];return Math.sqrt(d*d+a*a)};d.len=d.length;d.squaredLength=function(a){var d=a[0];a=a[1];return d*d+a*a};d.sqrLen=d.squaredLength;d.negate=function(a,d){a[0]=-d[0];a[1]=-d[1];return a};d.inverse=function(a,d){a[0]=1/d[0];a[1]=1/d[1];return a};d.normalize=function(a,d){var e=d[0],b=d[1],e=e*e+b*b;0<e&&(e=1/Math.sqrt(e),a[0]=d[0]*e,a[1]=d[1]*e);return a};d.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]};d.cross=function(a,d,e){d=d[0]*e[1]-d[1]*e[0];a[0]=a[1]=0;a[2]=d;return a};d.lerp=function(a,
d,e,b){var c=d[0];d=d[1];a[0]=c+b*(e[0]-c);a[1]=d+b*(e[1]-d);return a};d.random=function(a,d){d=d||1;var e=2*h()*Math.PI;a[0]=Math.cos(e)*d;a[1]=Math.sin(e)*d;return a};d.transformMat2=function(a,d,e){var b=d[0];d=d[1];a[0]=e[0]*b+e[2]*d;a[1]=e[1]*b+e[3]*d;return a};d.transformMat2d=function(a,d,e){var b=d[0];d=d[1];a[0]=e[0]*b+e[2]*d+e[4];a[1]=e[1]*b+e[3]*d+e[5];return a};d.transformMat3=function(a,d,e){var b=d[0];d=d[1];a[0]=e[0]*b+e[3]*d+e[6];a[1]=e[1]*b+e[4]*d+e[7];return a};d.transformMat4=function(a,
d,e){var b=d[0];d=d[1];a[0]=e[0]*b+e[4]*d+e[12];a[1]=e[1]*b+e[5]*d+e[13];return a};d.forEach=function(){var a=d.create();return function(d,e,b,c,g,m){e||(e=2);b||(b=0);for(c=c?Math.min(c*e+b,d.length):d.length;b<c;b+=e)a[0]=d[b],a[1]=d[b+1],g(a,a,m),d[b]=a[0],d[b+1]=a[1];return d}}();d.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};return d})},"esri/views/2d/ViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../geometry/Extent ./viewpointUtils ./libs/gl-matrix/vec2 ./libs/gl-matrix/mat2d".split(" "),
function(n,f,h,d,a,l,e,b,c,g){return function(m){function k(){var a=null!==m&&m.apply(this,arguments)||this;a.pixelRatio=1;a.size=[0,0];return a}h(k,m);q=k;Object.defineProperty(k.prototype,"center",{get:function(){var a=this.viewpoint.targetGeometry;return c.set(c.create(),a.x,a.y)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"extent",{get:function(){return b.getExtent(new e,this.viewpoint,this.size)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"height",
{get:function(){return this.size?this.size[1]:0},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"id",{get:function(){return this._get("id")+1},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"inverseTransform",{get:function(){return g.invert(g.create(),this.transform)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"latitude",{get:function(){return this.viewpoint.targetGeometry.latitude},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"longitude",{get:function(){return this.viewpoint.targetGeometry.longitude},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"resolution",{get:function(){return b.getResolution(this.viewpoint)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"rotation",{get:function(){return this.viewpoint.rotation},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"scale",{get:function(){return this.viewpoint.scale},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"screenCenter",{get:function(){return c.scale(c.create(),this.size,.5)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"spatialReference",{get:function(){return this.viewpoint.targetGeometry.spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"transform",{get:function(){return b.getTransform(g.create(),this.viewpoint,this.size,this.pixelRatio)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"transformNoRotation",{get:function(){return b.getTransformNoRotation(g.create(),
this.viewpoint,this.size,this.pixelRatio)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"clippedExtent",{get:function(){return b.getClippedExtent(new e,this.viewpoint,this.size)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"width",{get:function(){return this.size?this.size[0]:0},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"worldScreenWidth",{get:function(){return b.getWorldScreenWidth(this.spatialReference,this.resolution)},enumerable:!0,
configurable:!0});Object.defineProperty(k.prototype,"worldWidth",{get:function(){return b.getWorldWidth(this.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"wrappable",{get:function(){return!!this.spatialReference&&this.spatialReference.isWrappable},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"x",{get:function(){return this.center[0]},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"y",{get:function(){return this.center[1]},
enumerable:!0,configurable:!0});k.prototype.copy=function(a){this.viewpoint&&this.size?(this._set("viewpoint",b.copy(this.viewpoint,a.viewpoint)),this._set("size",c.copy(this.size,a.size))):(this.viewpoint=a.viewpoint.clone(),c.copy(this.size,a.size));this._set("pixelRatio",a.pixelRatio);return this};k.prototype.clone=function(){return new q({viewpoint:this.viewpoint.clone(),size:c.clone(this.size)})};k.prototype.toMap=function(a,b){return c.transformMat2d(a,b,this.inverseTransform)};k.prototype.toScreen=
function(a,b){return c.transformMat2d(a,b,this.transform)};k.prototype.pixelSizeAt=function(a){return b.pixelSizeAt(a,this.viewpoint,this.size)};d([a.property({dependsOn:["viewpoint"]})],k.prototype,"center",null);d([a.property({readOnly:!0,dependsOn:["viewpoint","size"]})],k.prototype,"extent",null);d([a.property({readOnly:!0,dependsOn:["size"]})],k.prototype,"height",null);d([a.property({value:0,readOnly:!0,dependsOn:["transform"]})],k.prototype,"id",null);d([a.property({readOnly:!0,dependsOn:["transform"]})],
k.prototype,"inverseTransform",null);d([a.property({readOnly:!0,dependsOn:["viewpoint"]})],k.prototype,"latitude",null);d([a.property({readOnly:!0,dependsOn:["viewpoint"]})],k.prototype,"longitude",null);d([a.property()],k.prototype,"pixelRatio",void 0);d([a.property({readOnly:!0,dependsOn:["viewpoint"]})],k.prototype,"resolution",null);d([a.property({readOnly:!0,dependsOn:["viewpoint"]})],k.prototype,"rotation",null);d([a.property({readOnly:!0,dependsOn:["viewpoint"]})],k.prototype,"scale",null);
d([a.property({readOnly:!0,dependsOn:["size"]})],k.prototype,"screenCenter",null);d([a.property()],k.prototype,"size",void 0);d([a.property({readOnly:!0,dependsOn:["viewpoint"]})],k.prototype,"spatialReference",null);d([a.property({readOnly:!0,dependsOn:["viewpoint","size","pixelRatio"]})],k.prototype,"transform",null);d([a.property({readOnly:!0,dependsOn:["viewpoint","size","pixelRatio"]})],k.prototype,"transformNoRotation",null);d([a.property()],k.prototype,"viewpoint",void 0);d([a.property({readOnly:!0,
dependsOn:["viewpoint","size"]})],k.prototype,"clippedExtent",null);d([a.property({readOnly:!0,dependsOn:["size"]})],k.prototype,"width",null);d([a.property({readOnly:!0,dependsOn:["worldWidth","resolution"]})],k.prototype,"worldScreenWidth",null);d([a.property({readOnly:!0,dependsOn:["spatialReference"]})],k.prototype,"worldWidth",null);d([a.property({readOnly:!0,dependsOn:["spatialReference"]})],k.prototype,"wrappable",null);d([a.property({readOnly:!0,dependsOn:["center"]})],k.prototype,"x",null);
d([a.property({readOnly:!0,dependsOn:["center"]})],k.prototype,"y",null);return k=q=d([a.subclass("esri.views.2d.ViewState")],k);var q}(a.declared(l))})},"esri/views/2d/MapViewConstraints":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Evented ../../layers/support/LOD ./constraints/ZoomConstraint ./constraints/RotationConstraint".split(" "),function(n,f,h,d,a,l,e,
b,c,g){return function(e){function k(){var a=null!==e&&e.apply(this,arguments)||this;a.enabled=!0;a.lods=null;a.minScale=0;a.maxScale=0;a.minZoom=-1;a.maxZoom=-1;a.rotationEnabled=!0;a.snapToZoom=!0;return a}h(k,e);k.prototype.initialize=function(){this.watch("_zoom, _rotation",this.emit.bind(this,"update"),!0)};k.prototype.destroy=function(){this.view=null;this._set("_zoom",null);this._set("_rotation",null)};Object.defineProperty(k.prototype,"_rotation",{get:function(){return new g({rotationEnabled:this.rotationEnabled})},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_defaultLODs",{get:function(){var a=this.get("view.defaultsFromMap.tileInfo"),b=this.get("view.spatialReference");return a&&b&&a.spatialReference.equals(b)?a.lods:null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_zoom",{get:function(){return new c({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})},enumerable:!0,
configurable:!0});k.prototype.canZoomInTo=function(a){var b=this.effectiveMaxScale;return 0===b||a>=b};k.prototype.canZoomOutTo=function(a){var b=this.effectiveMinScale;return 0===b||a<=b};k.prototype.constrain=function(a,b){if(!this.enabled)return a;this._zoom.constrain(a,b);this._rotation.constrain(a,b);return a};k.prototype.fit=function(a){if(!this.enabled||!this.snapToZoom)return a;this._zoom.fit(a);return a};k.prototype.zoomToScale=function(a){return this._zoom.zoomToScale(a)};k.prototype.scaleToZoom=
function(a){return this._zoom.scaleToZoom(a)};k.prototype.snapScale=function(a){return this._zoom.snapToClosestScale(a)};k.prototype.snapToNextScale=function(a){return this._zoom.snapToNextScale(a)};k.prototype.snapToPreviousScale=function(a){return this._zoom.snapToPreviousScale(a)};d([a.property({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],k.prototype,"effectiveLODs",void 0);d([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],k.prototype,"effectiveMinScale",void 0);d([a.property({readOnly:!0,
aliasOf:"_zoom.effectiveMaxScale"})],k.prototype,"effectiveMaxScale",void 0);d([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],k.prototype,"effectiveMinZoom",void 0);d([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],k.prototype,"effectiveMaxZoom",void 0);d([a.property()],k.prototype,"enabled",void 0);d([a.property({type:[b]})],k.prototype,"lods",void 0);d([a.property()],k.prototype,"minScale",void 0);d([a.property()],k.prototype,"maxScale",void 0);d([a.property()],k.prototype,
"minZoom",void 0);d([a.property()],k.prototype,"maxZoom",void 0);d([a.property()],k.prototype,"rotationEnabled",void 0);d([a.property()],k.prototype,"snapToZoom",void 0);d([a.property()],k.prototype,"view",void 0);d([a.property({type:g,dependsOn:["rotationEnabled"]})],k.prototype,"_rotation",null);d([a.property({dependsOn:["view.spatialReference","view.defaultsFromMap.tileInfo"]})],k.prototype,"_defaultLODs",null);d([a.property({readOnly:!0,type:c,dependsOn:"lods minZoom maxZoom minScale maxScale snapToZoom _defaultLODs".split(" ")})],
k.prototype,"_zoom",null);return k=d([a.subclass("esri.views.2d.MapViewConstraints")],k)}(a.declared(l,e))})},"esri/views/2d/constraints/ZoomConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../layers/support/LOD".split(" "),function(n,f,h,d,a,l,e){return function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._lodByScale={};a._scales=
[];a.effectiveLODs=null;a.effectiveMinZoom=-1;a.effectiveMaxZoom=-1;a.effectiveMinScale=0;a.effectiveMaxScale=0;a.enabled=!0;a.lods=null;a.minZoom=-1;a.maxZoom=-1;a.minScale=0;a.maxScale=0;a.snapToZoom=!0;return a}h(c,b);g=c;c.prototype.initialize=function(){var a=this,b=this.lods,c=this.minScale,g=this.maxScale,e=this.minZoom,d=this.maxZoom,h=-1,l=-1,f=!1,A=!1;0!==c&&0!==g&&c<g&&(g=[g,c],c=g[0],g=g[1]);if(b&&b.length){b=b.map(function(a){return a.clone()});b.sort(function(a,b){return b.scale-a.scale});
b.forEach(function(a,b){return a.level=b});for(var n,D=0,x=b;D<x.length;D++){var B=x[D];!f&&0<c&&c>=B.scale&&(h=B.level,f=!0);!A&&0<g&&g>=B.scale&&(l=n?n.level:-1,A=!0);n=B}-1===e&&(e=0===c?0:h);-1===d&&(d=0===g?b.length-1:l);e=Math.max(e,0);e=Math.min(e,b.length-1);d=Math.max(d,0);d=Math.min(d,b.length-1);e>d&&(c=[d,e],e=c[0],d=c[1]);c=b[e].scale;g=b[d].scale;b.splice(0,e);b.splice(d-e+1,b.length);b.forEach(function(b,c){a._lodByScale[b.scale]=b;a._scales[c]=b.scale});this._set("effectiveLODs",b);
this._set("effectiveMinZoom",e);this._set("effectiveMaxZoom",d)}this._set("effectiveMinScale",c);this._set("effectiveMaxScale",g)};c.prototype.constrain=function(a,b){if(!this.enabled||b&&a.scale===b.scale)return a;var c=this.effectiveMinScale,g=this.effectiveMaxScale,e=a.targetGeometry,d=b&&b.targetGeometry,k=0!==c&&a.scale>c;if(0!==g&&a.scale<g||k)c=k?c:g,d&&(b=(c-b.scale)/(a.scale-b.scale),e.x=d.x+(e.x-d.x)*b,e.y=d.y+(e.y-d.y)*b),a.scale=c;this.snapToZoom&&this.effectiveLODs&&(a.scale=this._getClosestScale(a.scale));
return a};c.prototype.fit=function(a){if(!this.effectiveLODs)return this.constrain(a,null);var b=a.scale,c=Math.round(this.scaleToZoom(b));a.scale=.95<Math.abs(c-Math.round(c))?this.snapToPreviousScale(b):this.zoomToScale(Math.round(c));return a};c.prototype.zoomToScale=function(a){if(!this.effectiveLODs)return 0;a-=this.effectiveMinZoom;a=Math.max(0,a);var b=this._scales;if(0>=a)return b[0];if(a>=b.length)return b[b.length-1];var c=Math.round(a);return b[c]+(c-a)*(b[Math.round(a-.5)]-b[c])};c.prototype.scaleToZoom=
function(a){if(!this.effectiveLODs)return-1;var b=this._scales,c=0,g=b.length-1,e,d;for(c;c<g;c++){e=b[c];d=b[c+1];if(e<=a)return c+this.effectiveMinZoom;if(d===a)return c+1+this.effectiveMinZoom;if(e>a&&d<a)return c+1-(a-d)/(e-d)+this.effectiveMinZoom}return c};c.prototype.snapToClosestScale=function(a){if(!this.effectiveLODs)return a;a=this.scaleToZoom(a);return this.zoomToScale(Math.round(a))};c.prototype.snapToNextScale=function(a,b){void 0===b&&(b=.5);if(!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));
return this.zoomToScale(a+1)};c.prototype.snapToPreviousScale=function(a,b){void 0===b&&(b=2);if(!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a-1)};c.prototype.clone=function(){return new g({enabled:this.enabled,lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})};c.prototype._getClosestScale=function(a){if(this._lodByScale[a])return this._lodByScale[a].scale;a=this._scales.reduce(function(b,c,g,e){return Math.abs(c-
a)<=Math.abs(b-a)?c:b},this._scales[0]);return this._lodByScale[a].scale};d([a.property({readOnly:!0})],c.prototype,"effectiveLODs",void 0);d([a.property({readOnly:!0})],c.prototype,"effectiveMinZoom",void 0);d([a.property({readOnly:!0})],c.prototype,"effectiveMaxZoom",void 0);d([a.property({readOnly:!0})],c.prototype,"effectiveMinScale",void 0);d([a.property({readOnly:!0})],c.prototype,"effectiveMaxScale",void 0);d([a.property()],c.prototype,"enabled",void 0);d([a.property({type:[e]})],c.prototype,
"lods",void 0);d([a.property()],c.prototype,"minZoom",void 0);d([a.property()],c.prototype,"maxZoom",void 0);d([a.property()],c.prototype,"minScale",void 0);d([a.property()],c.prototype,"maxScale",void 0);d([a.property()],c.prototype,"snapToZoom",void 0);return c=g=d([a.subclass("esri.views.2d.constraints.ZoomConstraint")],c);var g}(a.declared(l))})},"esri/views/2d/constraints/RotationConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),
function(n,f,h,d,a,l){return function(e){function b(){var a=null!==e&&e.apply(this,arguments)||this;a.enabled=!0;a.rotationEnabled=!0;return a}h(b,e);c=b;b.prototype.constrain=function(a,b){if(!this.enabled)return a;this.rotationEnabled||(a.rotation=0);return a};b.prototype.clone=function(){return new c({enabled:this.enabled,rotationEnabled:this.rotationEnabled})};d([a.property()],b.prototype,"enabled",void 0);d([a.property()],b.prototype,"rotationEnabled",void 0);return b=c=d([a.subclass("esri.views.2d.constraints.RotationConstraint")],
b);var c}(a.declared(l))})},"esri/views/2d/AnimationManager":function(){define("../../core/Accessor ../../core/Scheduler ../../core/now ../ViewAnimation ./unitBezier ./viewpointUtils".split(" "),function(n,f,h,d,a,l){var e=function(b,c,g,e){var d=b.targetGeometry,m=c.targetGeometry;e?"string"===typeof e&&(e=a.parse(e)||a.ease):e=a.ease;this.easing=e;this.duration=g;this.sCenterX=d.x;this.sCenterY=d.y;this.sScale=b.scale;this.sRotation=b.rotation;this.tCenterX=m.x;this.tCenterY=m.y;this.tScale=c.scale;
this.tRotation=c.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:-180>this.dRotation&&(this.dRotation+=360)};e.prototype.applyRatio=function(a,c){var b=this.easing(c),e,d;1<=c?(c=this.tCenterX,e=this.tCenterY,d=this.tRotation,b=this.tScale):(c=this.sCenterX+b*this.dCenterX,e=this.sCenterY+b*this.dCenterY,d=this.sRotation+b*this.dRotation,
b=this.sScale+b*this.dScale);a.targetGeometry.x=c;a.targetGeometry.y=e;a.scale=b;a.rotation=d};return n.createSubclass({constructor:function(){this._updateTask=f.addFrameTask({postRender:this._postRender.bind(this)});this._updateTask.pause()},getDefaults:function(){return{viewpoint:l.create()}},properties:{animation:null,duration:{value:200},transition:{value:null},easing:{value:a.ease},viewpoint:null},animate:function(a,c,g){this.stop();l.copy(this.viewpoint,c);this.transition=new e(this.viewpoint,
a.target,g&&g.duration||this.duration,g&&g.easing||this.easing);a.always(function(){this.animation===a&&this._updateTask&&(this._updateTask.pause(),this.updateFunction=this.animation=null)}.bind(this));this._startTime=h();this._updateTask.resume();return this.animation=a},animateContinous:function(a,c){this.stop();this.updateFunction=c;this.viewpoint=a;var b=new d({target:a.clone()});b.always(function(){this.animation===b&&this._updateTask&&(this._updateTask.pause(),this.updateFunction=this.animation=
null)}.bind(this));this._startTime=h();this._updateTask.resume();return this.animation=b},stop:function(){this.animation&&(this.animation.stop(),this.updateFunction=this.animation=null)},_postRender:function(a){var b=this.animation;b&&b.state!==d.STOPPED?(this.updateFunction?this.updateFunction(this.viewpoint,a.deltaTime):(a=(h()-this._startTime)/this.transition.duration,b=1<=a,this.transition.applyRatio(this.viewpoint,a),b&&this.animation.finish()),this.animation._dfd.progress(this.viewpoint)):this._updateTask.pause()}})})},
"esri/views/2d/unitBezier":function(){define([],function(){var n=function(h,d,a,l){function e(a,e){var d,k,m,p;e=null==e?1E-6:e;m=a;for(k=0;8>k;k++){p=((g*m+c)*m+b)*m-a;if(Math.abs(p)<e)return m;d=(3*g*m+2*c)*m+b;if(1E-6>Math.abs(d))break;m-=p/d}d=0;k=1;m=a;if(m<d)return d;if(m>k)return k;for(;d<k;){p=((g*m+c)*m+b)*m;if(Math.abs(p-a)<e)break;a>p?d=m:k=m;m=.5*(k-d)+d}return m}var b=3*h,c=3*(a-h)-b,g=1-b-c,m=3*d,k=3*(l-d)-m,q=1-m-k;return function(a,b){a=e(a,b);return((q*a+k)*a+m)*a}},f=/^cubic-bezier\((.*)\)/;
n.parse=function(h){var d=n[h]||null;!d&&(h=f.exec(h))&&(h=h[1].split(",").map(function(a){return parseFloat(a.trim())}),4!==h.length||h.some(function(a){return isNaN(a)})||(d=n.apply(n,h)));return d};n.ease=n(.25,.1,.25,1);n.linear=n(0,0,1,1);n.easeIn=n["ease-in"]=n(.42,0,1,1);n.easeOut=n["ease-out"]=n(0,0,.58,1);n.easeInOut=n["ease-in-out"]=n(.42,0,.58,1);return n})},"esri/views/ui/2d/DefaultUI2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI dojo/_base/lang".split(" "),
function(n,f,h,d,a,l,e){return function(b){function c(){return b.call(this)||this}h(c,b);c.prototype.getDefaults=function(){return e.mixin(this.inherited(arguments),{components:["attribution","zoom"]})};return c=d([a.subclass("esri.views.ui.2d.DefaultUI2D")],c)}(a.declared(l))})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/promiseUtils ../../../core/Scheduler ../FrameBudget ./DOMContainer ./StageGL ./Container".split(" "),function(n,
f,h,d,a,l,e,b,c){function g(a){if(a instanceof b)return a;if(a instanceof c){var e=0;for(a=a.children;e<a.length;e++){var d=g(a[e]);if(d)return d}}return null}return function(b){function c(c){var g=b.call(this)||this;g.element=c;g._budget=new l;g._renderParameters={budget:g._budget,state:g.state,devicePixelRatio:window.devicePixelRatio,stationary:!1};g._renderRequested=!1;g._taskHandle=a.addFrameTask({render:function(){return g.renderFrame()}});g._stationary=!0;g.attached=!0;g._taskHandle.pause();
return g}h(c,b);c.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._taskHandle=null};Object.defineProperty(c.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=a,this.requestRender())},enumerable:!0,configurable:!0});
c.prototype.start=function(){this._taskHandle.resume()};c.prototype.stop=function(){this._taskHandle.isPaused()||this._taskHandle.pause()};c.prototype.requestRender=function(){this._renderRequested=!0;this._taskHandle&&this._taskHandle.isPaused()&&this._taskHandle.resume()};c.prototype.takeScreenshot=function(a){var b=g(this);return b?b.takeScreenshot(a):d.reject("Could not find an object capable of capturing screenshot!")};c.prototype.renderFrame=function(){this._renderRequested&&(this._renderRequested=
!1,this._renderParameters.state=this._state,this._renderParameters.stationary=this.stationary,this._renderParameters.devicePixelRatio=window.devicePixelRatio,this.processRender(this._renderParameters));this._renderRequested||this._taskHandle.pause()};return c}(e)})},"esri/views/2d/engine/DOMContainer":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./Container"],function(n,f,h,d){return function(a){function d(){return null!==a&&a.apply(this,arguments)||this}h(d,a);
d.prototype.createElement=function(){var a=document.createElement("div");a.setAttribute("class","esri-display-object");return a};d.prototype.setElement=function(a){this.element=a};d.prototype.doRender=function(e){var b=this.element.style;this.visible?(b.display="block",b.opacity=""+this.opacity,a.prototype.doRender.call(this,e)):b.display="none"};d.prototype.prepareChildrenRenderParameters=function(a){return a};d.prototype.attachChild=function(a,b){var c=a.element;c||(c=a.createElement(),a.setElement(c));
return a.attach(b)};d.prototype.detachChild=function(a,b){a.detach(b);this.element.removeChild(a.element);a.setElement(null)};d.prototype.renderChildren=function(e){for(var b=this.children,c=this.element.childNodes,g=0,d=b.length,k=0;k<d;k++)if(b[k].attached){var h=b[k].element;c[g]!==h&&(null!=c[g+1]?this.element.insertBefore(h,c[g]):this.element.appendChild(h));g+=1}a.prototype.renderChildren.call(this,e)};return d}(d)})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper",
"./DisplayObject"],function(n,f,h,d){var a;(function(a){a[a.BEFORE=0]="BEFORE";a[a.ATTACHING=1]="ATTACHING";a[a.DETACHING=2]="DETACHING";a[a.RENDERING=3]="RENDERING";a[a.AFTER=4]="AFTER";a[a.DONE=5]="DONE"})(a||(a={}));return function(d){function e(){var b=null!==d&&d.apply(this,arguments)||this;b._childrenSet=new Set;b._childrenToAttach=[];b._childrenToDetach=[];b._renderPhase=a.DONE;b.children=[];return b}h(e,d);Object.defineProperty(e.prototype,"numChildren",{get:function(){return this.children.length},
enumerable:!0,configurable:!0});e.prototype.detach=function(a){var b=this.children;a=this.prepareChildrenRenderParameters(a);for(var g=b.length,e=0;e<g;e++){var d=b[e];d.attached&&(this.detachChild(d,a),d.attached=!1,d.parent=null)}};e.prototype.doRender=function(b){var c=this.prepareChildrenRenderParameters(b);this._renderPhase=a.BEFORE;this.beforeRenderChildren(b,c);this._renderPhase=a.ATTACHING;this.attachChildren(c)||this.requestRender();this._renderPhase=a.DETACHING;for(var g=this._childrenToDetach;0<
g.length;){var e=g.shift();this.detachChild(e,c);e.attached=!1;e.parent=null}this._renderPhase=a.RENDERING;this.renderChildren(c);this._renderPhase=a.AFTER;this.afterRenderChildren(b,c);this._renderPhase=a.DONE};e.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};e.prototype.addChildAt=function(b,c){void 0===c&&(c=this.numChildren);if(!b||this.contains(b))return b;var g=b.parent;g&&g!==this&&g.removeChild(b);c>=this.numChildren?this.children.push(b):this.children.splice(c,
0,b);this._childrenSet.add(b);c=this._childrenToDetach.indexOf(b);-1<c&&this._childrenToDetach.splice(c,1);this._childrenToAttach.push(b);this._renderPhase>=a.RENDERING&&this.requestRender();return b};e.prototype.contains=function(a){return this._childrenSet.has(a)};e.prototype.getChildIndex=function(a){return this.children.indexOf(a)};e.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};e.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};
e.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};e.prototype.removeChildAt=function(b){if(0>b||b>=this.children.length)return null;b=this.children.splice(b,1)[0];this._childrenSet["delete"](b);if(b.attached)this._childrenToDetach.push(b),this._renderPhase>=a.RENDERING&&this.requestRender();else{var c=this._childrenToAttach.indexOf(b);-1<c&&this._childrenToAttach.splice(c,1)}return b};e.prototype.requestChildRender=function(b){b&&b.parent===this&&
this._renderPhase>=a.RENDERING&&this.requestRender()};e.prototype.setChildIndex=function(b,c){var g=this.getChildIndex(b);-1<g&&(this.children.splice(g,1),this.children.splice(c,0,b),this._renderPhase>=a.RENDERING&&this.requestRender())};e.prototype.sortChildren=function(b){this._renderPhase>a.RENDERING&&this.requestRender();return this.children.sort(b)};e.prototype.attachChildren=function(a){var b=this._childrenToAttach;if(0===b.length)return!0;for(var g=0===b.length;!g;)g=b.shift(),this.attachChild(g,
a)&&(g.attached=!0,g.parent=this),g=0===b.length;return 0===b.length};e.prototype.renderChildren=function(a){for(var b=this.children,g=b.length,e=0;e<g;e++){var d=b[e];d.attached&&this.renderChild(d,a)}};e.prototype.beforeRenderChildren=function(a,c){};e.prototype.attachChild=function(a,c){return a.attach(c)};e.prototype.detachChild=function(a,c){a.detach(c)};e.prototype.renderChild=function(a,c){a.processRender(c)};e.prototype.afterRenderChildren=function(a,c){};return e}(d)})},"esri/views/2d/engine/StageGL":function(){define("require exports ../../../core/tsSupport/extendsHelper ../libs/gl-matrix/common ../libs/gl-matrix/vec2 ../libs/gl-matrix/mat2d ./webgl/BitBlitRenderer ../../support/screenshotUtils ../../../core/promiseUtils ../../webgl/RenderingContext ../../webgl/FramebufferObject ../../webgl/webgl-utils ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ./webgl/painter/WGLPainter ./Container ./webgl/shaders/glShaderSnippets".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r,t,v){function w(a){return{budget:a.budget,state:a.state,devicePixelRatio:a.devicePixelRatio,stationary:a.stationary}}var A={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"};return function(f){function t(){var b=null!==f&&f.apply(this,arguments)||this;b._clipData=new Float32Array(8);b._upperLeft=a.create();b._upperRight=a.create();b._lowerLeft=a.create();b._lowerRight=a.create();b._mat2=l.create();b._clipRendererInitialized=!1;return b}h(t,f);Object.defineProperty(t.prototype,
"glPainter",{get:function(){return this._painter},enumerable:!0,configurable:!0});t.prototype.createElement=function(){var a=document.createElement("canvas");a.setAttribute("class","esri-display-object");return a};t.prototype.setElement=function(a){this.element=a};t.prototype.attach=function(a){if(this.attached)return!0;this._resizeCanvas(a);var b=k.setupWebGL(this.element,{alpha:!0,antialias:!1,depth:!0,stencil:!0});this._renderingContext=new g(b[0]);this.attached=!0;this._cachedRenderParams=w(a);
this._painter||(this._painter=new r,this._painter.initialize(this._renderingContext));return f.prototype.attach.call(this,a)};t.prototype.detach=function(a){f.prototype.detach.call(this,a);this._renderingContext&&(this._renderingContext.dispose(),this._renderingContext=null);this._cachedRenderParams=null};t.prototype.beforeRenderChildren=function(b,c){var g=b.state,e=this._painter;if(e)if(c=this._renderingContext,c.enforceState(),e.update(g,b.devicePixelRatio),g.spatialReference&&(g.spatialReference._isWrappable?
g.spatialReference._isWrappable():g.spatialReference.isWrappable)){var k=g.width,e=g.height,p=g.rotation,k=Math.round(k*b.devicePixelRatio),e=Math.round(e*b.devicePixelRatio),h=d.toRadian(p),q=Math.abs(Math.cos(h)),f=Math.abs(Math.sin(h)),u=Math.round(g.worldScreenWidth);if(Math.round(k*q+e*f)<=u)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===k&&this._clipFBO.height===e||(this._clipFBO=new m(c,{colorTarget:0,depthStencilTarget:3,width:k,height:e}));var t=.5*k,r=.5*e,g=1/k,w=1/e;b=.5*
u*b.devicePixelRatio;var v=.5*(k*f+e*q),k=this._upperLeft,q=this._upperRight,f=this._lowerLeft,u=this._lowerRight;a.set(k,-b,-v);a.set(q,b,-v);a.set(f,-b,v);a.set(u,b,v);l.identity(this._mat2);l.translate(this._mat2,this._mat2,[t,r]);0!==p&&l.rotate(this._mat2,this._mat2,h);a.transformMat2d(k,k,this._mat2);a.transformMat2d(q,q,this._mat2);a.transformMat2d(f,f,this._mat2);a.transformMat2d(u,u,this._mat2);p=this._clipData;p.set([2*f[0]*g-1,2*(e-f[1])*w-1,2*u[0]*g-1,2*(e-u[1])*w-1,2*k[0]*g-1,2*(e-k[1])*
w-1,2*q[0]*g-1,2*(e-q[1])*w-1]);this._clipRendererInitialized||this._initializeClipRenderer(c);this._clipVBO.setData(p);this._boundFBO=c.getBoundFramebufferObject();c.bindFramebuffer(this._clipFBO);c.setDepthWriteEnabled(!0);c.setStencilWriteMask(255);c.setClearColor(0,0,0,0);c.setClearDepth(1);c.setClearStencil(0);c.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT|c.gl.STENCIL_BUFFER_BIT);c.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1};t.prototype.afterRenderChildren=function(a,
b){this._clipFrame&&this._clipRendererInitialized&&(a=this._renderingContext,a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),a.setStencilFunction(519,1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),
a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))};t.prototype.doRender=function(a){var b=this.element.style;this.visible?(b.display="block",b.opacity=""+this.opacity,this._resizeCanvas(a),f.prototype.doRender.call(this,a),this._cachedRenderParams=w(a)):b.display="none"};t.prototype.takeScreenshot=function(a){void 0===a&&(a={});var g=a.pixelRatio||1;this._cachedRenderParams.devicePixelRatio=g;var e=Math.round(g*this._cachedRenderParams.state.width),
d=Math.round(g*this._cachedRenderParams.state.height),k=0,p=0,h=e,q=d,l=e,f=d;if(l=a.area)k=Math.round(g*l.x),p=Math.round(g*l.y),h=Math.round(g*l.width),q=Math.round(g*l.height);void 0!==a.width&&void 0!==a.height?(l=a.width/a.height,q*l<h?(l*=q,k+=Math.floor((h-l)/2),h=Math.floor(l)):(l=h/l,p+=Math.floor((q-l)/2),q=Math.floor(l)),l=a.width,f=a.height):(l=h,f=q);g=document.createElement("canvas");g.width=l;g.height=f;var u=g.getContext("2d"),t=new Uint8Array(h*q*4),r=this._renderingContext,w=m.create(r,
{colorTarget:1,depthStencilTarget:3,width:e,height:d});r.bindFramebuffer(w);r.setViewport(0,0,e,d);this._cachedRenderParams.budget&&this._cachedRenderParams.budget.reset(Number.MAX_VALUE);var v=this._cachedRenderParams,n=this._renderingContext.gl;this._renderingContext.setClearColor(0,0,0,0);this._renderingContext.setClearDepth(1);this._renderingContext.setClearStencil(0);this._renderingContext.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT);v.context=this._renderingContext;this.beforeRenderChildren(v,
v);if(void 0!==a.rotation&&null!==a.rotation){var n=v.state,x=n.clone();x.viewpoint.rotation=a.rotation;v.state=x;this.renderChildren(v);v.state=n}else this.renderChildren(v);this.afterRenderChildren(v,v);w.readPixels(k,d-(p+q),h,q,6408,5121,t);r.bindFramebuffer();r=u.getImageData(0,0,l,f);if(0!==k||0!==p||h!==e||q!==d||l!==e||f!==d)b.resampleHermite(t,h,q,r.data,l,f,!0);else{p=q-1;q=0;w=4*h;for(x=n=k=d=e=h=v=void 0;q<p;){n=q*w;x=p*w;for(v=0;v<w;v+=4)h=t[n+v],e=t[n+v+1],d=t[n+v+2],k=t[n+v+3],t[n+
v]=t[x+v],t[n+v+1]=t[x+v+1],t[n+v+2]=t[x+v+2],t[n+v+3]=t[x+v+3],t[x+v]=h,t[x+v+1]=e,t[x+v+2]=d,t[x+v+3]=k;q++;p--}h=r.data;e=t.length;for(p=0;p<e;p++)h[p]=t[p]}t=r.data;q=t.length;for(p=0;p<q;p+=4)k=t[p+3],0<k&&(d=k/255,h=Math.floor(t[p+0]/d),e=Math.floor(t[p+1]/d),d=Math.floor(t[p+2]/d),t[p+0]=255>=h?h:255,t[p+1]=255>=e?e:255,t[p+2]=255>=d?d:255);u.putImageData(r,0,0);u=A[a.format?a.format.toLowerCase():"png"];t=1;void 0!==a.quality&&(t=a.quality/100);a=g.toDataURL(u,t);return c.resolve({dataURL:a,
x:0,y:0,width:l,height:f})};t.prototype.prepareChildrenRenderParameters=function(a){if(!this.attached||!this._renderingContext)return null;a=w(a);var b=this._renderingContext,c=b.gl;b.setDepthWriteEnabled(!0);b.setStencilWriteMask(255);b.setClearColor(0,0,0,0);b.setClearDepth(1);b.setClearStencil(0);b.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT);b.setViewport(0,0,this.element.width,this.element.height);b.setDepthWriteEnabled(!1);a.context=b;return a};t.prototype.attachChild=function(a,
b){return a.attach(b)};t.prototype.detachChild=function(a,b){return a.detach(b)};t.prototype.renderChild=function(a,b){return a.processRender(b)};t.prototype._resizeCanvas=function(a){var b=this.element,c=b.style,g=a.state,e=a.devicePixelRatio;a=Math.round(g.width*e);e=Math.round(g.height*e);if(b.width!==a||b.height!==e)b.width=a,b.height=e;c.width=g.width+"px";c.height=g.height+"px"};t.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new e;
var b={a_pos:0},c=new q(a,v.stencilVS,v.stencilFS,b);if(!c)return!1;var g=u.createVertex(a,35040,32),d=new Uint16Array([0,1,2,2,1,3]),d=u.createIndex(a,35044,d);a=new p(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:g},d);this._clipStencilProgram=c;this._clipVBO=g;this._clipVAO=a;return this._clipRendererInitialized=!0};return t}(t)})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ./shaders/glShaderSnippets".split(" "),
function(n,f,h,d,a,l){return function(){function e(){this._initialized=!1}e.prototype.render=function(a,c,g,e){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),c.setSamplingMode(g),a.bindTexture(c,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",e),a.drawArrays(5,0,4),a.bindVAO())};e.prototype._initialize=function(b){if(this._initialized)return!0;var c={a_pos:0,a_tex:1},
g=new h(b,l.bitblitVS,l.bitblitFS,c);if(!g)return!1;var e=new Int8Array(16);e[0]=-1;e[1]=-1;e[2]=0;e[3]=0;e[4]=1;e[5]=-1;e[6]=1;e[7]=0;e[8]=-1;e[9]=1;e[10]=0;e[11]=1;e[12]=1;e[13]=1;e[14]=1;e[15]=1;b=new d(b,c,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:a.createVertex(b,35044,e)});this._program=g;this._vertexArrayObject=b;return this._initialized=!0};return e}()})},"esri/views/2d/engine/webgl/shaders/glShaderSnippets":function(){define("require exports ../../../../webgl/ShaderSnippets dojo/text!./bitblit.vs.glsl dojo/text!./bitblit.fs.glsl dojo/text!./stencil.vs.glsl dojo/text!./stencil.fs.glsl dojo/text!./background.vs.glsl dojo/text!./background.fs.glsl dojo/text!./tileInfo.vs.glsl dojo/text!./tileInfo.fs.glsl".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m){function k(a,b){q+='\x3csnippet name\x3d"'+a+'"\x3e\x3c![CDATA[';q+=b;q+="]]\x3e\x3c/snippet\x3e"}var q="",q=q+'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',q=q+"\x3csnippets\x3e";k("bitblitVS",d);k("bitblitFS",a);k("stencilVS",l);k("stencilFS",e);k("backgroundVS",b);k("backgroundFS",c);k("tileInfoVS",g);k("tileInfoFS",m);q+="\x3c/snippets\x3e";n=new h;h.parse(q,n);return n})},"esri/views/webgl/ShaderSnippets":function(){define(["require","exports","dojox/xml/parser"],
function(n,f,h){return function(){function d(a){if(a)for(var d in a)this[d]=a[d]}d.parse=function(a,d){a=h.parse(a).getElementsByTagName("snippet");for(var e=/\$[a-zA-Z][a-zA-Z0-9]*(?:\([^\(\)]*\))?[ \t]*/,b=/[\$\s]+/g,c=/\(([^\(\)]*)\)/,g=0;g<a.length;g++){for(var m=a[g].getAttribute("name"),k=a[g].textContent;;){var q=k.match(e);if(null==q)break;var p=q[0].replace(b,""),l=p.match(c),f=void 0;l&&(f=l[1].split(",").map(function(a){return a.trim()}));p=p.replace(c,"");f=d._instantiate(p,f);k=k.replace(q[0],
f)}d[m]=k}};d.prototype._instantiate=function(a,d){a=this[a];for(d||(d=[]);;){var e=a.match(/\$(\d+)/);if(null==e)break;var b=parseInt(e[1],10);a=a.replace(e[0],d[b])}return a};return d}()})},"esri/views/webgl/webgl-utils":function(){define([],function(){var n=function(f,h){for(var d=["webgl","experimental-webgl","webkit-3d","moz-webgl"],a=null,l=0;l<d.length;++l){try{a=f.getContext(d[l],h)}catch(e){}if(a)break}return a};return{create3DContext:n,setupWebGL:function(f,h){function d(a){var d=f.parentNode;
d&&(d.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+a+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}if(!window.WebGLRenderingContext)return d('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'];
h=n(f,h);return h?[h]:(d('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'])},detectWebGL:function(){var f;try{f=window.WebGLRenderingContext}catch(d){f=[!1,0]}var h;try{h=n(document.createElement("canvas"))}catch(d){h=
[!1,1]}f?h?(f=h,f=[!0,{VERSION:f.getParameter(f.VERSION),SHADING_LANGUAGE_VERSION:f.getParameter(f.SHADING_LANGUAGE_VERSION),VENDOR:f.getParameter(f.VENDOR),RENDERER:f.getParameter(f.RENDERER),EXTENSIONS:f.getSupportedExtensions(),MAX_TEXTURE_SIZE:f.getParameter(f.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:f.getParameter(f.MAX_RENDERBUFFER_SIZE),MAX_VERTEX_TEXTURE_IMAGE_UNITS:f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]):f=[!1,1]:f=[!1,0];return f}}})},"esri/views/2d/engine/webgl/painter/WGLPainter":function(){define("require exports dojo/has ../../../../../core/libs/gl-matrix/mat4 ../../../../webgl/FramebufferObject ../Dispatcher ../TextureManager ../GeometryUtils ../MaterialManager ../enums ./WGLTextPainter ./WGLIconPainter ./WGLFillPainter ./WGLLinePainter ./WGLBackgroundPainter ./TileInfoRenderer ./WGLHighlightPainter ./WGLHeatmapPainter ../Utils".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r,t,v,w){var A=new Uint8Array(4*w.C_HITTEST_SEARCH_SIZE*w.C_HITTEST_SEARCH_SIZE),E=new Uint32Array(A.buffer),D=new l;return function(){function l(){this._textPainter=new m;this._iconPainter=new k;this._fillPainter=new q;this._linePainter=new p;this._backgroundPainter=new u;this._hlPainter=new t;this._heatmapPainter=new v;this._extrudeMatrix=new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._extrudeRotateVector=new Float32Array([0,0,
1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._state={rotation:0,width:0,height:0};this._cachedRotation=this._cachedHeight=this._cachedWidth=0;this._textureManager=new e;this._materialManager=new c}l.prototype.initialize=function(a){this._materialManager.initialize(a)};l.prototype.update=function(a,c){this._state=a;if(this._state.width!==this._cachedWidth||this._state.height!==this._cachedHeight||this._state.rotation!==this._cachedRotation)this._extrudeScaleVector[0]=2/a.width,this._extrudeScaleVector[1]=
-2/a.height,d.identity(this._extrudeMatrix),d.rotate(this._extrudeMatrix,this._extrudeMatrix,-a.rotation*b.C_DEG_TO_RAD,this._extrudeRotateVector),d.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),d.transpose(this._extrudeMatrix,this._extrudeMatrix),d.identity(this._extrudeNoRotationMatrix),d.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),d.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=
this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation};Object.defineProperty(l.prototype,"textureManager",{get:function(){return this._textureManager},enumerable:!0,configurable:!0});l.prototype.setHighlightOptions=function(a){this._hlPainter.setHighlightOptions(a)};l.prototype.drawHeatmap=function(a,b,c,e){var d=this;this._heatmapPainter.bindHeatmapSurface(a,b.displayWidth*e,b.displayHeight*e);this._drawClippingRects(a,b.children);a.setBlendingEnabled(!0);
a.setStencilWriteMask(0);a.setBlendFunctionSeparate(1,1,1,0);a.setStencilTestEnabled(!0);b.wglRendererInfo.symbolLevels.forEach(function(k){b.children.forEach(function(m){D.replayList(a,m.displayList,k,d,m,b.wglRendererInfo,g.WGLDrawPhase.GEOMETRY,c,e,!1)})});a.setStencilTestEnabled(!1);this._heatmapPainter.drawHeatmap(a,b.wglRendererInfo,.75);if(h("esri-feature-tiles-debug")){this._tileInforenderer||(this._tileInforenderer=new r);for(var k=this._tileInforenderer,m=0,p=b.children;m<p.length;m++){var q=
p[m];q.attached&&q.visible&&k.render(a,q)}}};l.prototype.draw=function(a,b,c,e,d){var k=this;this._drawClippingRects(a,b.children);a.setBlendingEnabled(!0);a.setStencilWriteMask(0);a.setBlendFunctionSeparate(1,771,1,771);a.setStencilTestEnabled(!0);b.wglRendererInfo.symbolLevels.forEach(function(m){b.children.forEach(function(p){p.displayList&&!p.displayList.empty&&D.replayList(a,p.displayList,m,k,p,b.wglRendererInfo,g.WGLDrawPhase.GEOMETRY,c,e,d)})});a.setStencilTestEnabled(!1);if(h("esri-feature-tiles-debug")){this._tileInforenderer||
(this._tileInforenderer=new r);for(var m=this._tileInforenderer,p=0,q=b.children;p<q.length;p++){var l=q[p];l.attached&&l.visible&&m.render(a,l)}}};l.prototype.highlight=function(a,b,c,e){var d=this,k=a.getViewport();this._hlPainter.setup(a,k.width,k.height);this._hlPainter.startMaskDraw(a);this._drawClippingRects(a,b.children);a.setBlendingEnabled(!0);a.setStencilWriteMask(0);a.setBlendFunctionSeparate(1,771,1,771);a.setStencilTestEnabled(!0);b.wglRendererInfo.symbolLevels.forEach(function(k){b.children.forEach(function(m){m.hlDisplayList&&
!m.hlDisplayList.empty&&D.replayList(a,m.hlDisplayList,k,d,m,b.wglRendererInfo,g.WGLDrawPhase.HIGHLIGHT,c,e,!1)})});this._hlPainter.draw(a)};l.prototype.hitTest=function(b,c,e,d,k){var m=this,p=w.C_HITTEST_SEARCH_SIZE,h=[0,0],q=[0,0];c=b.state;c.toMap(h,[0,0]);c.toMap(q,[p,p]);var l=d.children.filter(function(a){return!(h[0]>a.bounds[2]||q[0]<a.bounds[0]||h[1]<a.bounds[1]||q[1]>a.bounds[3])});if(0===l.length)return[];var f=b.context;this._hittestFBO||(this._hittestFBO=a.create(f,{colorTarget:0,depthStencilTarget:3,
width:p,height:p}));c=f.getViewport();e=f.getBoundFramebufferObject();f.bindFramebuffer(this._hittestFBO);f.setViewport(0,0,p,p);var u=f.gl;f.setClearColor(1,1,1,1);f.clear(u.COLOR_BUFFER_BIT);this._drawClippingRects(f,l);f.setBlendingEnabled(!1);f.setStencilWriteMask(0);f.setStencilTestEnabled(!0);d.wglRendererInfo.symbolLevels.forEach(function(a){l.forEach(function(c){c.displayList&&!c.displayList.empty&&D.replayList(f,c.displayList,a,m,c,d.wglRendererInfo,g.WGLDrawPhase.HITTEST,k,b.devicePixelRatio,
!1)})});f.setStencilTestEnabled(!1);f.setBlendingEnabled(!0);this._hittestFBO.readPixels(0,0,p,p,6408,5121,A);for(var p=p*p,u=new Set,t=0;t<p;t++){var r=E[t];4294967295!==r&&u.add(r)}f.bindFramebuffer(e);f.setViewport(c.x,c.y,c.width,c.height);var v=[];u.forEach(function(a){v.push(a)});return v};l.prototype.drawFill=function(a,b,c,g,e,d,k,m,p,h){this._fillPainter.draw(a,b,c,g,e,d,k,m,p,h,this._materialManager,this._textureManager)};l.prototype.drawLine=function(a,b,c,g,e,d,k,m,p){this._linePainter.draw(a,
b,c,g,e,d,k,m,p,this._materialManager,this._textureManager,this._extrudeMatrix)};l.prototype.drawIcon=function(a,b,c,g,e,d,k){this._iconPainter.draw(a,b,c,g,e,d,k,this._materialManager,this._textureManager,this._extrudeMatrix,this._extrudeNoRotationMatrix)};l.prototype.drawText=function(a,b,c,g,e,d,k){this._textPainter.draw(a,b,c,g,e,d,k,this._materialManager,this._textureManager,this._extrudeMatrix,this._extrudeNoRotationMatrix)};l.prototype._drawClippingRects=function(a,b){if(0!==b.length){a.setDepthWriteEnabled(!1);
a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);a.setStencilWriteMask(255);for(var c=b.length,g,e=c,d=0;d<c;d++)g=b[d],g.stencilRef=e,a.setStencilFunctionSeparate(1032,519,e,255),e--,this._backgroundPainter.draw(a,g);a.setColorMask(!0,!0,!0,!0)}};return l}()})},"esri/views/2d/engine/webgl/Dispatcher":function(){define(["require","exports","./enums"],function(n,
f,h){return function(){function d(){}d.prototype.replayList=function(a,d,e,b,c,g,m,k,h,p){var q=this;d=d.symbolLevels;d.length<=e||!(e=d[e])||(a.setStencilTestEnabled(!0),a.setStencilFunction(514,c.stencilRef,255),e.zLevels.forEach(function(e){e=e.geometryDPInfo;e.fill&&q._draw(a,e.fill,b,c,k,h,g,m,p);e.line&&q._draw(a,e.line,b,c,k,h,g,m,p);e.marker&&q._draw(a,e.marker,b,c,k,h,g,m,p);e.text&&q._draw(a,e.text,b,c,k,h,g,m,p)}))};d.prototype._draw=function(a,d,e,b,c,g,m,k,q){d.forEach(function(d){switch(d.geometryType){case h.WGLGeometryType.FILL:e.drawFill(a,
d.materialInfo,b,m,k,c,g,q,d.indexFrom,d.indexCount);break;case h.WGLGeometryType.LINE:e.drawLine(a,d.materialInfo,b,m,k,c,g,d.indexFrom,d.indexCount);break;case h.WGLGeometryType.MARKER:e.drawIcon(a,d.materialInfo,b,m,k,d.indexFrom,d.indexCount);break;case h.WGLGeometryType.TEXT:e.drawText(a,d.materialInfo,b,m,k,d.indexFrom,d.indexCount)}})};return d}()})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(n,f){Object.defineProperty(f,"__esModule",{value:!0});(function(h){h[h.FILL=
0]="FILL";h[h.LINE=1]="LINE";h[h.MARKER=2]="MARKER";h[h.TEXT=3]="TEXT";h[h.UNKNOWN=4]="UNKNOWN"})(f.WGLGeometryType||(f.WGLGeometryType={}));(function(h){h[h.SUCCEEDED=0]="SUCCEEDED";h[h.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(f.WGLGeometryTransactionStatus||(f.WGLGeometryTransactionStatus={}));(function(h){h[h.GEOMETRY=1]="GEOMETRY";h[h.TEXT=2]="TEXT";h[h.HITTEST=3]="HITTEST";h[h.HIGHLIGHT=4]="HIGHLIGHT"})(f.WGLDrawPhase||(f.WGLDrawPhase={}));(function(h){h[h.NONE=0]="NONE";h[h.OPACITY=
1]="OPACITY";h[h.COLOR=2]="COLOR";h[h.ROTATION=4]="ROTATION";h[h.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";h[h.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";h[h.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";h[h.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(f.WGLVVFlag||(f.WGLVVFlag={}))})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports dojo/Deferred ../../../../core/promiseUtils ../../../3d/support/imageUtils ./SpriteMosaic ./Utils ./CIMSymbolHelper ./SDFHelper ./GlyphSource ./GlyphMosaic".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m){var k=[];return function(){function q(){this._rasterizeQueue=new Map;this._spriteMosaic=new l(1024,1024,250);this._glyphSource=new g("https://basemaps.arcgis.com/v1/arcgis/rest/services/World_Basemap/VectorTileServer/resources/fonts/{fontstack}/{range}.pbf");this._glyphMosaic=new m(1024,1024,this._glyphSource)}Object.defineProperty(q.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"glyphs",
{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});q.prototype.processItems=function(a){var b=this;if(a.done)return!1;for(;this._spriteMosaic.hasItemsToProcess();)this._spriteMosaic.processNextItem();this._rasterizeQueue.forEach(function(c,g){if(a.done)return!1;var e=b._rasterizeJSON(g);c.resolve(e);k.push(g)});for(var c=0;c<k.length;c++)this._rasterizeQueue.delete(k[c]);k.length=0;return!0};q.prototype.rasterizeItem=function(a,b){void 0===b&&(b=null);return a?a.type&&"text"===
a.type?this._rasterizeTextSymbol(a,b).then(function(a){return{glyphMosaicItems:a}}):this._rasterizeSpriteSymbol(a).then(function(a){return{spriteMosaicItem:a}}):d.resolve(null)};q.prototype.bindSpritePage=function(a,b,c,g){g||(g=9729);this._spriteMosaic.bind(a,g,b,c)};q.prototype.bindGlyphsPage=function(a,b,c){this._glyphMosaic.bind(a,9729,b,c)};q.prototype._rasterizeTextSymbol=function(a,b){return this._glyphMosaic.getGlyphItems(a,b)};q.prototype._rasterizeSpriteSymbol=function(b){var c=this;return!e.isFillSymbol(b)&&
!e.isLineSymbol(b)||"solid"!==b.style&&"none"!==b.style?this._spriteMosaic.has(b)?d.resolve(this._spriteMosaic.getSpriteItem(b)):b.url?a.requestImage(b.url).then(function(a){return c._rasterizeResource(a).then(function(a){return c._addItemToMosaic(b,a.size,a.anchor,a.image,!e.isMarkerSymbol(b),a.sdf)})}):this._rasterizeResource(b).then(function(a){return c._addItemToMosaic(b,a.size,a.anchor,a.image,!e.isMarkerSymbol(b),a.sdf)}):d.resolve(null)};q.prototype._rasterizeResource=function(a){var b=this;
if(this._rasterizeQueue.has(a))return this._rasterizeQueue.get(a).promise;var c=new h(function(){b._rasterizeQueue.has(a)&&b._rasterizeQueue.delete(a)});if(a instanceof HTMLImageElement){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var g=this._rasterizationCanvas.getContext("2d");g.drawImage(a,0,0,a.width,a.height);for(var g=g.getImageData(0,0,a.width,a.height),g=new Uint8Array(g.data),
e=void 0,d=0;d<g.length;d+=4)e=g[d+3]/255,g[d]*=e,g[d+1]*=e,g[d+2]*=e;c.resolve({size:[a.width,a.height],anchor:[0,0],image:new Uint32Array(g.buffer),sdf:!1})}else g=this._rasterizeJSON(a),c.resolve(g);return c.promise};q.prototype._addItemToMosaic=function(a,b,c,g,e,d){return this._spriteMosaic.addSpriteItem(a,b,c,g,e,d)};q.prototype._rasterizeJSON=function(a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type){var g=b.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,
a.style);a=g[0];var e=g[1],g=g[2];return{size:[e,g],anchor:[0,0],image:new Uint32Array(a.buffer),sdf:!1}}if("simple-line"===a.type)return g=b.SymbolHelper.rasterizeSimpleLine(this._rasterizationCanvas,a.style),a=g[0],e=g[1],g=g[2],{size:[e,g],anchor:[0,0],image:new Uint32Array(a.buffer),sdf:!0};"simple-marker"===a.type?(a=b.CIMSymbolHelper.fromSimpleMarker(a),e=!0):e=c.SDFHelper.checkSDF(a);if(e)return e=(new c.SDFHelper).buildSDF(a),a=e[0],{size:[e[1],e[2]],anchor:[0,0],image:new Uint32Array(a.buffer),
sdf:!0};var d=b.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a);a=d[0];e=d[1];g=d[2];return{size:[e,g],anchor:[d[3],d[4]],image:new Uint32Array(a.buffer),sdf:!1}};return q}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ./Rect ./GeometryUtils ./RectangleBinPack ../../../webgl/Texture".split(" "),function(n,f,h,d,a,l){return function(){function e(b,c,g){void 0===g&&(g=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=
this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=b||0>=c)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=b;this._pageHeight=c;0<g&&(this._maxItemSize=g);this.pixelRatio=window.devicePixelRatio|1;this._binPack=new a(this._pageWidth,this._pageHeight);this._mosaicsData[0]=new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight));this._dirties.push(!0);
this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}e.prototype.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};e.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};e.prototype.getPage=function(a){return a<this._textures.length?this._textures[a]:null};e.prototype.has=function(a){return this._mosaicRects.has(a)};e.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};e.prototype.addSpriteItem=function(a,
c,g,e,d,h){if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var b=this._allocateImage(c[0],c[1]),k=b[0],m=b[1],b=b[2];if(0>=k.width||0>=k.height)return null;g={rect:k,width:c[0],height:c[1],anchorX:g[0],anchorY:g[1],sdf:h,pixelRatio:1,page:m};this._mosaicRects.set(a,g);this._copy({rect:k,spriteSize:c,spriteData:e,page:m,pageSize:b,repeat:d,sdf:h});return g};e.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};e.prototype.processNextItem=function(){var a=this._spriteCopyQueue.pop();
a&&this._copy(a)};e.prototype.getSpriteItems=function(a){for(var b={},g=0;g<a.length;g++){var e=a[g];b[e]=this.getSpriteItem(e)}return b};e.prototype.getMosaicItemPosition=function(a,c){c=(a=this.getSpriteItem(a))&&a.rect;if(!c)return null;c.width=a.width;c.height=a.height;return{size:[a.width,a.height],tl:[(c.x+1)/this._size[a.page][0],(c.y+1)/this._size[a.page][1]],br:[(c.x+1+a.width)/this._size[a.page][0],(c.y+1+a.height)/this._size[a.page][1]],page:a.page}};e.prototype.bind=function(a,c,g,e){void 0===
g&&(g=0);void 0===e&&(e=0);this._textures[g]||(this._textures[g]=new l(a,{pixelFormat:6408,dataType:5121,width:this._size[g][0],height:this._size[g][1]},new Uint8Array(this._mosaicsData[g].buffer)));var b=this._textures[g];b.setSamplingMode(c);this._dirties[g]&&(b.setData(new Uint8Array(this._mosaicsData[g].buffer)),b.generateMipmap());a.bindTexture(b,e);this._dirties[g]=!1};e._copyBits=function(a,c,g,e,d,h,p,l,f,t,v){var b=e*c+g;p=l*h+p;if(v)for(p-=h,v=-1;v<=t;v++,b=((v+t)%t+e)*c+g,p+=h)for(l=-1;l<=
f;l++)d[p+l]=a[b+(l+f)%f];else for(v=0;v<t;v++){for(l=0;l<f;l++)d[p+l]=a[b+l];b+=c;p+=h}};e.prototype._copy=function(a){if(!(a.page>=this._mosaicsData.length)){var b=a.spriteData,g=this._mosaicsData[a.page];g&&b||console.error("Source or target images are uninitialized!");e._copyBits(b,a.spriteSize[0],0,0,g,a.pageSize[0],a.rect.x+1,a.rect.y+1,a.spriteSize[0],a.spriteSize[1],a.repeat);this._dirties[a.page]=!0}};e.prototype._allocateImage=function(b,c){b+=2;c+=2;var g=Math.max(b,c);if(this._maxItemSize&&
this._maxItemSize<g){var g=Math.pow(2,Math.ceil(d.log2(b))),e=Math.pow(2,Math.ceil(d.log2(c)));b=new h(0,0,b,c);this._mosaicsData.push(new Uint32Array(g*e));this._dirties.push(!0);this._size.push([g,e]);this._textures.push(void 0);return[b,this._mosaicsData.length-1,[g,e]]}g=this._binPack.allocate(b+(b%4?4-b%4:0),c+(c%4?4-c%4:0));return 0>=g.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*
this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new a(this._pageWidth,this._pageHeight),this._allocateImage(b,c)):[g,this._currentPage,[this._pageWidth,this._pageHeight]]};e.prototype._dispose=function(){this._binPack=null;this._mosaicRects.clear()};return e}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(n,f){return function(){function h(d,a,h,e){void 0===d&&(d=0);void 0===
a&&(a=0);void 0===h&&(h=0);void 0===e&&(e=0);this.x=d;this.y=a;this.width=h;this.height=e}Object.defineProperty(h.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});return h}()})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(n,f){function h(a,d){a%=d;return 0<=a?a:a+d}Object.defineProperty(f,"__esModule",{value:!0});f.C_INFINITY=Number.POSITIVE_INFINITY;f.C_PI=Math.PI;f.C_2PI=2*f.C_PI;f.C_PI_BY_2=
f.C_PI/2;f.C_RAD_TO_256=128/f.C_PI;f.C_256_TO_RAD=f.C_PI/128;f.C_DEG_TO_256=256/360;f.C_DEG_TO_RAD=f.C_PI/180;f.C_SQRT2=1.414213562;f.C_SQRT2_INV=1/f.C_SQRT2;var d=1/Math.LN2;f.positiveMod=h;f.radToByte=function(a){return h(a*f.C_RAD_TO_256,256)};f.degToByte=function(a){return h(a*f.C_DEG_TO_256,256)};f.log2=function(a){return Math.log(a)*d};f.sqr=function(a){return a*a};f.clamp=function(a,d,e){return Math.min(Math.max(a,d),e)};f.interpolate=function(a,d,e){return a*(1-e)+d*e};f.between=function(a,
d,e){return a>=d&&a<=e||a>=e&&a<=d}})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(n,f,h){return function(){function d(a,d){this._height=this._width=0;this._free=[];this._width=a;this._height=d;this._free.push(new h(0,0,a,d))}d.prototype.allocate=function(a,d){for(var e=null,b=-1,c=0;c<this._free.length;++c){var g=this._free[c];a<=g.width&&d<=g.height&&(null===e||g.y<=e.y&&g.x<=e.x)&&(e=g,b=c)}if(null===e)return new h;this._free.splice(b,
1);e.width<e.height?(e.width>a&&this._free.push(new h(e.x+a,e.y,e.width-a,d)),e.height>d&&this._free.push(new h(e.x,e.y+d,e.width,e.height-d))):(e.width>a&&this._free.push(new h(e.x+a,e.y,e.width-a,e.height)),e.height>d&&this._free.push(new h(e.x,e.y+d,a,e.height-d)));return new h(e.x,e.y,a,d)};d.prototype.release=function(a){for(var d=0;d<this._free.length;++d){var e=this._free[d];if(e.y===a.y&&e.height===a.height&&e.x+e.width===a.x)e.width+=a.width;else if(e.x===a.x&&e.width===a.width&&e.y+e.height===
a.y)e.height+=a.height;else if(a.y===e.y&&a.height===e.height&&a.x+a.width===e.x)e.x=a.x,e.width+=a.width;else if(a.x===e.x&&a.width===e.width&&a.y+a.height===e.y)e.y=a.y,e.height+=a.height;else continue;this._free.splice(d,1);this.release(a)}this._free.push(a)};return d}()})},"esri/views/2d/engine/webgl/Utils":function(){define(["require","exports","./enums"],function(n,f,h){function d(a){for(var b={},c=0;c<a.length;c++){var g=a[c];b[g.name]=g.strideInBytes}return b}function a(a){if(a.type){switch(a.type){case "simple-marker":case "picture-marker":return!0;
case "CIMPointSymbol":return!0}return!1}}function l(a){if(a.type){switch(a.type){case "simple-fill":case "picture-fill":return!0;case "CIMPolygonSymbol":return!0}return!1}}function e(a){if(a.type){switch(a.type){case "simple-line":case "picture-line":return!0;case "CIMLineSymbol":return!0}return!1}}function b(a){if(a.type){switch(a.type){case "text":return!0;case "CIMTextSymbol":return!0}return!1}}function c(a){return a&&a.length||0}function g(a,b,c){var g=0;do{var e=a%128;a-=e;a/=128;0<a&&(e+=128);
b&&(b[c+g]=e);++g}while(0<a);return g}function m(a,b,c){for(var g=0,e=0,d=!0,k=1;d;){var m=b[c+g];++g;128<=m?(m-=128,d=!0):d=!1;e+=m*k;k*=128}a.n=e;return g}function k(a,b,c){void 0===b&&(b=0);void 0===c&&(c=!1);var g=a[b+3];a[b+0]*=g;a[b+1]*=g;a[b+2]*=g;c||(a[b+3]*=255);return a}function q(a){return"string"===typeof a}Object.defineProperty(f,"__esModule",{value:!0});f.C_HITTEST_SEARCH_SIZE=4;f.C_TILE_SIZE=512;f.C_VBO_GEOMETRY="geometry";f.C_VBO_PERINSTANCE="per_instance";f.C_VBO_PERINSTANCE_VV="per_instance_vv";
f.C_VBO_VISIBILITY="visibility";f.C_ICON_VERTEX_DEF=[{name:f.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];f.C_ICON_VERTEX_DEF_VV=[{name:f.C_VBO_GEOMETRY,strideInBytes:40,divisor:0}];f.C_ICON_HEATMAP=[{name:f.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}];f.C_FILL_VERTEX_DEF=[{name:f.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];f.C_FILL_VERTEX_DEF_VV=[{name:f.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];f.C_LINE_VERTEX_DEF=[{name:f.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];f.C_LINE_VERTEX_DEF_VV=[{name:f.C_VBO_GEOMETRY,
strideInBytes:44,divisor:0}];f.C_TEXT_VERTEX_DEF=[{name:f.C_VBO_GEOMETRY,strideInBytes:24,divisor:0},{name:f.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}];f.C_TEXT_VERTEX_DEF_VV=[{name:f.C_VBO_GEOMETRY,strideInBytes:40,divisor:0},{name:f.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}];f.C_ICON_STRIDE_SPEC=d(f.C_ICON_VERTEX_DEF);f.C_ICON_STRIDE_SPEC_VV=d(f.C_ICON_VERTEX_DEF_VV);f.C_ICON_STRIDE_SPEC_HEATMAP=d(f.C_ICON_HEATMAP);f.C_FILL_STRIDE_SPEC=d(f.C_FILL_VERTEX_DEF);f.C_FILL_STRIDE_SPEC_VV=d(f.C_FILL_VERTEX_DEF_VV);
f.C_LINE_STRIDE_SPEC=d(f.C_LINE_VERTEX_DEF);f.C_LINE_STRIDE_SPEC_VV=d(f.C_LINE_VERTEX_DEF_VV);f.C_TEXT_STRIDE_SPEC=d(f.C_TEXT_VERTEX_DEF);f.C_TEXT_STRIDE_SPEC_VV=d(f.C_TEXT_VERTEX_DEF_VV);f.getStrides=function(a,b,c){void 0===c&&(c=!1);switch(a){case h.WGLGeometryType.MARKER:return b?f.C_ICON_STRIDE_SPEC_VV:c?f.C_ICON_STRIDE_SPEC_HEATMAP:f.C_ICON_STRIDE_SPEC;case h.WGLGeometryType.FILL:return b?f.C_FILL_STRIDE_SPEC_VV:f.C_FILL_STRIDE_SPEC;case h.WGLGeometryType.LINE:return b?f.C_LINE_STRIDE_SPEC_VV:
f.C_LINE_STRIDE_SPEC;case h.WGLGeometryType.TEXT:return b?f.C_TEXT_STRIDE_SPEC_VV:f.C_TEXT_STRIDE_SPEC}return null};f.getSymbolGeometryType=function(c){return a(c)?h.WGLGeometryType.MARKER:e(c)?h.WGLGeometryType.LINE:l(c)?h.WGLGeometryType.FILL:b(c)?h.WGLGeometryType.TEXT:h.WGLGeometryType.UNKNOWN};f.isMarkerSymbol=a;f.isFillSymbol=l;f.isLineSymbol=e;f.isPictureSymbol=function(a){if(a.type)switch(a.type){case "picture-marker":case "picture-line":case "picture-fill":return!0}return!1};f.isTextSymbol=
b;f.isSameUniformValue=function(a,b){return!1};f.isSameMaterialInfo=function(a,b){if(a.materialKey!==b.materialKey||c(a.texBindingInfo)!==c(b.texBindingInfo)||c(a.materialParams)!==c(b.materialParams))return!1;for(var g=a.texBindingInfo.length,e=0;e<g;++e){var d=a.texBindingInfo[e],k=b.texBindingInfo[e];if(d.unit!==k.unit||d.pageId!==k.pageId||d.semantic!==k.semantic)return!1}a=a.materialParams.length;for(e=0;e<a;)return!1;return!0};f.i1616to32=function(a,b){return 65535&a|b<<16};f.i8888to32=function(a,
b,c,g){return a&255|(b&255)<<8|(c&255)<<16|g<<24};f.i8816to32=function(a,b,c){return a&255|(b&255)<<8|c<<16};f.numTo32=function(a){return a|0};f.serializeInteger=g;f.deserializeInteger=m;f.serializeString=function(a,b,c){for(var g=0,e=a.length,d=0;d<e;++d)b&&(b[c+g]=a.charCodeAt(d)),++g;b&&(b[c+g]=0);++g;return g};f.deserializeString=function(a,b,c){var g=0;a.s="";for(var e=!0;e;){var d=b[c+g];++g;0!==d?a.s+=String.fromCharCode(d):e=!1}return g};f.serializeUniform=function(a,b,c){return g(a,b,c)};
f.deserializeUniform=function(a,b,c){return m(a,b,c)};f.premultiplyAlpha=k;f.copyAndPremultiply=function(a){a=Array.isArray(a)?[a[0],a[1],a[2],a[3]]:[a.r,a.g,a.b,a.a];k(a);return a};f.nextHighestPowerOfTwo=function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a};f.isDefined=function(a){return null!==a&&void 0!==a};f.isNumber=function(a){return"number"===typeof a};f.isString=q;f.isStringOrNull=function(a){return null==a||q(a)};f.lerp=function(a,b,c){return a+(b-a)*c}})},"esri/views/2d/engine/webgl/CIMSymbolHelper":function(){define(["require",
"exports","../../../vectorTiles/GeometryUtils","./CIMSymbolDrawHelper","./SDFHelper"],function(n,f,h,d,a){Object.defineProperty(f,"__esModule",{value:!0});n=function(){function a(){}a.getEnvelope=function(a){if("CIMPointSymbol"!==a.type)return null;var b=new d.EnvDrawHelper;b.drawSymbol(a,{type:"point",x:0,y:0});return b.envelope()};a.rasterize=function(a,b){var c=this.getEnvelope(b);if(!c||0>=c.width||0>=c.height)return[null,0,0,0,0];var g=96/72,e=(c.x+.5*c.width)*g,k=-(c.y+.5*c.height)*g;a.width=
c.width*g+2;a.height=c.height*g+2;c=a.getContext("2d");g=d.Transformation.createScale(g,-g);g.translate(.5*a.width-e,.5*a.height-k);(new d.CanvasDrawHelper(c,g)).drawSymbol(b,{type:"point",x:0,y:0});b=c.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);for(c=0;c<b.length;c+=4)g=b[c+3]/255,b[c]*=g,b[c+1]*=g,b[c+2]*=g;return[b,a.width,a.height,e/a.width,k/a.height]};a.fromSimpleMarker=function(a){var b,c,g=a.style;if("circle"===g){b=Math.acos(.995);c=Math.ceil(h.C_PI/b/4);0===c&&(c=1);b=h.C_PI_BY_2/
c;c*=4;g=[];g.push([50,0]);for(var e=1;e<c;e++)g.push([50*Math.cos(e*b),-50*Math.sin(e*b)]);g.push([50,0]);b={rings:[g]};c={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===g?(b=10,b={rings:[[[b,50],[b,b],[50,b],[50,-b],[b,-b],[b,-50],[-b,-50],[-b,-b],[-50,-b],[-50,b],[-b,b],[-b,50],[b,50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===g?(b={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===g?(b={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,
-50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===g?(b=14.142135623730951,b={rings:[[[0,b],[50-b,50],[50,50-b],[b,0],[50,b-50],[50-b,-50],[0,-b],[b-50,-50],[-50,b-50],[-b,0],[-50,50-b],[b-50,50],[0,b]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===g&&(c=2/3*100,g=c-100,b={rings:[[[-57.735026918962575,g],[0,c],[57.735026918962575,g],[-57.735026918962575,g]]]},c={xmin:-57.735026918962575,ymin:g,xmax:57.735026918962575,ymax:c});var d;b&&c&&(d=[{type:"CIMSolidFill",enable:!0,color:a.color}],
a.outline&&d.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),d={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:b,symbol:{type:"CIMPolygonSymbol",symbolLayers:d}}]}]});return d};return a}();f.CIMSymbolHelper=n;n=function(){function d(){}d.rasterizeSimpleFill=function(a,b){"solid"!==b&&"none"!==b||console.error("Unexpected: style does not require rasterization");
a.width=8;a.height=8;var c=a.getContext("2d");c.strokeStyle="#FFFFFF";c.beginPath();if("vertical"===b||"cross"===b)c.moveTo(0,0),c.lineTo(0,8);if("horizontal"===b||"cross"===b)c.moveTo(0,0),c.lineTo(8,0);if("forward-diagonal"===b||"diagonal-cross"===b)c.moveTo(0,0),c.lineTo(8,8);if("backward-diagonal"===b||"diagonal-cross"===b)c.moveTo(8,0),c.lineTo(0,8);c.stroke();b=c.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);for(var g=0;g<b.length;g+=4)c=b[g+3]/255,b[g]*=c,b[g+1]*=c,b[g+2]*=c;
return[b,a.width,a.height]};d.rasterizeSimpleLine=function(e,b){var c;switch(b){case "dash":c=[3,2];break;case "dash-dot":c=[2,2,0,2];break;case "dot":c=[0,3];break;case "long-dash":c=[6,3];break;case "long-dash-dot":c=[6,3,0,3];break;case "long-dash-dot-dot":c=[2,2,0,2,0,2];break;case "short-dash":c=[2,2];break;case "short-dash-dot":c=[2,2,0,2];break;case "short-dash-dot-dot":c=[2,2,0,2,0,2];break;case "short-dot":c=[0,2];break;case "solid":throw Error("Unexpected: style does not require rasterization");
case "none":throw Error("Unexpected: style does not require rasterization");}b=e=0;for(var g=c;b<g.length;b++){var d=g[b];e+=d}e*=16;g=31*e;b=new Float32Array(g);for(d=0;d<g;++d)b[d]=257;for(var k=g=.5,h=!0,l=0;l<c.length;l++){for(var d=c[l],g=k,k=k+16*d,f=g;f<k;){for(var r=.5;31>r;){var d=(31-r+1.5)*e+f-.5,t=(r-15.5)*(r-15.5);b[d]=h?t:Math.min((f-g)*(f-g)+t,(f-k)*(f-k)+t);r++}f++}h=!h}c=b.length;g=new Uint8Array(4*c);for(d=0;d<c;++d)a.packFloat(Math.sqrt(b[d])/15,g,4*d);return[g,e,31]};return d}();
f.SymbolHelper=n})},"esri/views/2d/engine/webgl/CIMSymbolDrawHelper":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ./Rect ./GeometryUtils".split(" "),function(n,f,h,d,a,l){Object.defineProperty(f,"__esModule",{value:!0});var e=function(){function a(a){this._t=a}a.createIdentity=function(){return new a([1,0,0,0,1,0])};a.prototype.clone=function(){return new a(this._t.slice())};a.prototype.transform=function(a){var b=this._t;return[b[0]*
a[0]+b[1]*a[1]+b[2],b[3]*a[0]+b[4]*a[1]+b[5]]};a.createScale=function(b,g){return new a([b,0,0,0,g,0])};a.prototype.scale=function(a,b){var c=this._t;c[0]*=a;c[1]*=a;c[2]*=a;c[3]*=b;c[4]*=b;c[5]*=b;return this};a.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};a.createTranslate=function(b,g){return new a([0,0,b,0,0,g])};a.prototype.translate=function(a,b){var c=this._t;c[2]+=a;c[5]+=b;return this};a.createRotate=function(b){var c=Math.cos(b);b=Math.sin(b);
return new a([c,-b,0,b,c,0])};a.prototype.rotate=function(b){return this.multiply(a.createRotate(b))};a.prototype.multiply=function(a){var b=this._t;a=a._t;var c=b[1]*a[0]+b[4]*a[1],e=b[2]*a[0]+b[5]*a[1]+a[2],d=b[0]*a[3]+b[3]*a[4],h=b[1]*a[3]+b[4]*a[4],l=b[2]*a[3]+b[5]*a[4]+a[5];b[0]=b[0]*a[0]+b[3]*a[1];b[1]=c;b[2]=e;b[3]=d;b[4]=h;b[5]=l;return this};return a}();f.Transformation=e;n=function(){function a(a){this._transfos=[];this._sizeTransfos=[];this._transfos.push(a||e.createIdentity());this._sizeTransfos.push(a?
a.scaleRatio():1)}a.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)};a.prototype.transformSize=function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]};a.prototype.back=function(){return this._transfos[this._transfos.length-1]};a.prototype.push=function(a){var b=a.scaleRatio();a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*b)};a.prototype.pop=function(){this._transfos.splice(-1,
1);this._sizeTransfos.splice(-1,1)};a.prototype.drawSolidFill=function(a,b){};a.prototype.drawSolidStroke=function(a,b,e){};a.prototype.drawSymbol=function(a,b){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,b)}};a.prototype.drawMultiLayerSymbol=function(a,b){if(a&&(a=a.symbolLayers))for(var c=a.length;c--;){var g=a[c];if(g&&g.enable)switch(g.type){case "CIMSolidFill":this.drawSolidFill(b,g.color);break;case "CIMSolidStroke":this.drawSolidStroke(b,
g.color,g.width);break;case "CIMVectorMarker":this.drawVectorMarker(g,b)}}};a.prototype.drawVectorMarker=function(a,b){if(a){var c=a.markerGraphics;if(c){var g=a.size,d=a.frame,h=d?d.ymax-d.ymin:0,h=g&&h?g/h:1,f=e.createIdentity();d&&f.translate(.5*-(d.xmax+d.xmin),.5*-(d.ymax+d.ymin));var r=a.anchorPt;if(r){var t=r.x,r=r.y;"relative"===a.anchorPtUnits&&d&&(t*=(d.xmax-d.xmin)*h,r*=g);f.translate(-t,-r)}1!==h&&f.scale(h,h);a.rotation&&f.rotate(a.rotation*l.C_DEG_TO_RAD);f.translate(a.offsetX||0,a.offsetY||
0);f.translate(b.x,b.y);this.push(f);for(a=0;a<c.length;a++)(b=c[a])&&this.drawSymbol(b.symbol,b.geometry);this.pop()}}};return a}();f.CIMSymbolDrawHelper=n;d=function(b){function c(){var a=b.call(this)||this;a._xmin=a._ymin=Infinity;a._xmax=a._ymax=-Infinity;return a}h(c,b);c.prototype.envelope=function(){return new a(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};c.prototype._merge=function(a,b){a[0]-b<this._xmin&&(this._xmin=a[0]-b);a[0]+b>this._xmax&&(this._xmax=a[0]+b);a[1]-
b<this._ymin&&(this._ymin=a[1]-b);a[1]+b>this._ymax&&(this._ymax=a[1]+b)};c.prototype.drawSolidFill=function(a,b){b=0;for(a=a.rings;b<a.length;b++){var c=a[b],g=c?c.length:0;if(2<g){this._merge(this.transformPt(c[0]),0);for(var e=1;e<g;++e)this._merge(this.transformPt(c[e]),0)}}};c.prototype.drawSolidStroke=function(a,b,c){b=.5*this.transformSize(c);c=0;for(a=a.rings||a.paths;c<a.length;c++){var g=a[c],e=g?g.length:0;if(1<e){this._merge(this.transformPt(g[0]),b);for(var d=1;d<e;++d)this._merge(this.transformPt(g[d]),
b)}}};return c}(n);f.EnvDrawHelper=d;n=function(a){function b(b,c){c=a.call(this,c)||this;c._ctx=b;return c}h(b,a);b.prototype.drawSolidFill=function(a,b){var c=this._ctx;c.fillStyle="rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";c.beginPath();b=0;for(a=a.rings;b<a.length;b++){var g=a[b],e=g?g.length:0;if(2<e){var d=this.transformPt(g[0]);c.moveTo(d[0],d[1]);for(var h=1;h<e;++h)d=this.transformPt(g[h]),c.lineTo(d[0],d[1]);c.closePath()}}c.fill("evenodd")};b.prototype.drawSolidStroke=
function(a,b,c){var g=this._ctx;g.strokeStyle="rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";g.lineWidth=this.transformSize(c)+.5;g.beginPath();b=!!a.rings;c=0;for(a=a.rings||a.paths;c<a.length;c++){var e=a[c],d=e?e.length:0;if(1<d){var k=this.transformPt(e[0]);g.moveTo(k[0],k[1]);for(var h=1;h<d;++h)k=this.transformPt(e[h]),g.lineTo(k[0],k[1]);b&&g.closePath()}}g.stroke()};return b}(n);f.CanvasDrawHelper=n})},"esri/views/2d/engine/webgl/SDFHelper":function(){define(["require",
"exports","./Geometry","./Rect"],function(n,f,h,d){function a(a){return a-Math.floor(a)}function l(c,g,d){0>c?c=0:.9999991<c&&(c=.9999991);var k=a(c*e[0]),h=a(c*e[1]),m=a(c*e[2]);c=a(c*e[3]);g[d+0]=256*(k-k*b[0]);g[d+1]=256*(h-k*b[1]);g[d+2]=256*(m-h*b[2]);g[d+3]=256*(c-m*b[3])}Object.defineProperty(f,"__esModule",{value:!0});var e=[16777216,65536,256,1],b=[0,1/256,1/256,1/256];f.packFloat=l;n=function(){function a(){}a.checkSDF=function(a){return!0};a.prototype._extractGeometry=function(a){if(!a)return null;
a=a.symbolLayers;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;a=a.markerGraphics;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;var b=a.geometry;if(!b||!b.rings)return null;a=[];for(var c=0,b=b.rings;c<b.length;c++){for(var e=[],g=0,d=b[c];g<d.length;g++){var l=d[g];e.push(new h.Point(l[0],l[1]))}a.push(e)}return a};a.prototype._getEnvelope=function(a){for(var b=Infinity,c=-Infinity,e=Infinity,g=-Infinity,h=0;h<a.length;h++)for(var l=0,f=a[h];l<f.length;l++){var v=f[l];v.x<b&&
(b=v.x);v.x>c&&(c=v.x);v.y<e&&(e=v.y);v.y>g&&(g=v.y)}return new d(b,e,c-b,g-e)};a.prototype.buildSDF=function(a){a=this._extractGeometry(a);if(!a)return null;var b=this._getEnvelope(a);if(0>=b.width||0>=b.height)return null;for(var c=Math.floor(31.5),e=(128-2*(c+0+1))/Math.max(b.width,b.height),g=Math.round(b.width*e),d=Math.round(b.height*e),h=g+2*c,l=d+2*c,f=0;f<a.length;f++)for(var w=0,A=a[f];w<A.length;w++){var n=A[w];n.x-=b.x;n.y-=b.y;n.x*=e;n.y*=e;n.x+=c-.5;n.y+=c-.5}b=this._dist_map(a,h,l,
c);this._sign_dist_map(a,h,l,c,b);return[this._encodeDistMap(b,c),h,l,g,d,e]};a.prototype._dist_map=function(a,b,c,e){for(var g=b*c,d=new Float32Array(g),k=e*e+1,h=0;h<g;++h)d[h]=k;for(k=0;k<a.length;k++)for(var m=a[k],l=m.length,h=1;h<l;++h){var f=m[h-1],q=m[h],n=void 0,x=void 0;f.x<q.x?(n=f.x,x=q.x):(n=q.x,x=f.x);var B=void 0,H=void 0;f.y<q.y?(B=f.y,H=q.y):(B=q.y,H=f.y);var z=Math.floor(n)-e,x=Math.floor(x)+e,B=Math.floor(B)-e,H=Math.floor(H)+e;0>z&&(z=0);x>b&&(x=b);0>B&&(B=0);H>c&&(H=c);for(var n=
q.x-f.x,C=q.y-f.y,G=n*n+C*C;z<x;z++)for(var y=B;y<H;y++){var F=(z-f.x)*n+(y-f.y)*C,I=void 0,J=void 0;0>F?(I=f.x,J=f.y):F>G?(I=q.x,J=q.y):(F/=G,I=f.x+F*n,J=f.y+F*C);F=(z-I)*(z-I)+(y-J)*(y-J);I=(c-y-1)*b+z;F<d[I]&&(d[I]=F)}}for(h=0;h<g;++h)d[h]=Math.sqrt(d[h]);return d};a.prototype._sign_dist_map=function(a,b,c,e,d){for(var g=0;g<a.length;g++)for(var k=a[g],h=k.length,m=1;m<h;++m){var l=k[m-1],f=k[m],q=void 0,p=void 0;l.x<f.x?(q=l.x,p=f.x):(q=f.x,p=l.x);var n=void 0,B=void 0;l.y<f.y?(n=l.y,B=f.y):(n=
f.y,B=l.y);q=Math.floor(q);p=Math.floor(p)+1;n=Math.floor(n);B=Math.floor(B)+1;q<e&&(q=e);p>b-e&&(p=b-e);n<e&&(n=e);for(B>c-e&&(B=c-e);n<B;++n)if(l.y>n!==f.y>n){for(var H=(c-n-1)*b,z=q;z<p;++z)z<(f.x-l.x)*(n-l.y)/(f.y-l.y)+l.x&&(d[H+z]=-d[H+z]);for(z=e;z<q;++z)d[H+z]=-d[H+z]}}};a.prototype._encodeDistMap=function(a,b){b*=2;for(var c=a.length,e=new Uint8Array(4*c),d=0;d<c;++d)l(.5-a[d]/b,e,4*d);return e};return a}();f.SDFHelper=n})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require",
"exports"],function(n,f){Object.defineProperty(f,"__esModule",{value:!0});n=function(){function h(d,a){this.x=d;this.y=a}h.prototype.clone=function(){return new h(this.x,this.y)};h.prototype.equals=function(d,a){return d===this.x&&a===this.y};h.prototype.isEqual=function(d){return d.x===this.x&&d.y===this.y};h.prototype.setCoords=function(d,a){this.x=d;this.y=a};h.prototype.normalize=function(){var d=this.x,a=this.y,d=Math.sqrt(d*d+a*a);this.x/=d;this.y/=d};h.prototype.rightPerpendicular=function(){var d=
this.x;this.x=this.y;this.y=-d};h.prototype.move=function(d,a){this.x+=d;this.y+=a};h.prototype.assign=function(d){this.x=d.x;this.y=d.y};h.prototype.assignAdd=function(d,a){this.x=d.x+a.x;this.y=d.y+a.y};h.prototype.assignSub=function(d,a){this.x=d.x-a.x;this.y=d.y-a.y};h.prototype.rotate=function(d,a){var h=this.x,e=this.y;this.x=h*d-e*a;this.y=h*a+e*d};h.prototype.scale=function(d){this.x*=d;this.y*=d};h.prototype.length=function(){var d=this.x,a=this.y;return Math.sqrt(d*d+a*a)};h.distance=function(d,
a){var h=a.x-d.x;d=a.y-d.y;return Math.sqrt(h*h+d*d)};h.add=function(d,a){return new h(d.x+a.x,d.y+a.y)};h.sub=function(d,a){return new h(d.x-a.x,d.y-a.y)};return h}();f.Point=n})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["require","exports","../../../../core/promiseUtils","../../../../request","../../../../core/pbf"],function(n,f,h,d,a){var l=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=
b.getMessage(),e=void 0,d=void 0,h=void 0,f=void 0,l=void 0,t=void 0,v=void 0;c.next();)switch(c.tag()){case 1:e=c.getUInt32();break;case 2:d=c.getBytes();break;case 3:h=c.getUInt32();break;case 4:f=c.getUInt32();break;case 5:l=c.getSInt32();break;case 6:t=c.getSInt32();break;case 7:v=c.getUInt32();break;default:c.skip()}e&&(this._metrics[e]={width:h,height:f,left:l,top:t,advance:v},this._bitmaps[e]=d);break;default:b.skip()}break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};
a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),e=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function b(a){this._glyphInfo={};this._baseURL=a}b.prototype.getRange=function(b,e){var c=this._getFontStack(b);if(c.getRange(e))return h.resolve();var g=256*e,f=g+255;b=this._baseURL.replace("{fontstack}",b).replace("{range}",g+"-"+f);return d(b,
{callbackParamName:"callback",responseType:"array-buffer"}).then(function(b){c.addRange(e,new l(new a(new Uint8Array(b.data),new DataView(b.data))))})};b.prototype.getGlyph=function(a,b){if(a=this._getFontStack(a)){var c=Math.floor(b/256);if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}};b.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new e);return b};return b}()})},"esri/core/pbf":function(){define(["require","exports"],
function(n,f){return function(){function h(d,a,h,e){this._tag=0;this._dataType=99;this._data=d;this._dataView=a;this._pos=h||0;this._end=e||d.byteLength}h.prototype.clone=function(){return new h(this._data,this._dataView,this._pos,this._end)};h.prototype.next=function(d){for(;;){if(this._pos===this._end)return!1;var a=this._decodeVarint();this._tag=a>>3;this._dataType=a&7;if(!d||d===this._tag)break;this.skip()}return!0};h.prototype.empty=function(){return this._pos>=this._end};h.prototype.tag=function(){return this._tag};
h.prototype.getInt32=function(){return this._decodeVarint()};h.prototype.getInt64=function(){return this._decodeVarint()};h.prototype.getUInt32=function(){return this._decodeVarint()};h.prototype.getUInt64=function(){return this._decodeVarint()};h.prototype.getSInt32=function(){return this._decodeSVarint()};h.prototype.getSInt64=function(){return this._decodeSVarint()};h.prototype.getBool=function(){var d=0!==this._data[this._pos];this._skip(1);return d};h.prototype.getEnum=function(){return this._decodeVarint()};
h.prototype.getFixed64=function(){var d=this._dataView,a=this._pos,d=d.getUint32(a,!0)+4294967296*d.getUint32(a+4,!0);this._skip(8);return d};h.prototype.getSFixed64=function(){var d=this._dataView,a=this._pos,d=d.getUint32(a,!0)+4294967296*d.getInt32(a+4,!0);this._skip(8);return d};h.prototype.getDouble=function(){var d=this._dataView.getFloat64(this._pos,!0);this._skip(8);return d};h.prototype.getFixed32=function(){var d=this._dataView.getUint32(this._pos,!0);this._skip(4);return d};h.prototype.getSFixed32=
function(){var d=this._dataView.getInt32(this._pos,!0);this._skip(4);return d};h.prototype.getFloat=function(){var d=this._dataView.getFloat32(this._pos,!0);this._skip(4);return d};h.prototype.getString=function(){var d=this._getLength(),a=this._pos,a=this._toString(this._data,a,a+d);this._skip(d);return a};h.prototype.getBytes=function(){var d=this._getLength(),a=this._pos,a=this._toBytes(this._data,a,a+d);this._skip(d);return a};h.prototype.getMessage=function(){var d=this._getLength(),a=this._pos,
a=new h(this._data,this._dataView,a,a+d);this._skip(d);return a};h.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};h.prototype._skip=function(d){if(this._pos+d>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=d};h.prototype._decodeVarint=function(){var d=this._data,a=this._pos,h=0,e;if(10<=this._end-
a){if(e=d[a++],h|=e&127,0!==(e&128)&&(e=d[a++],h|=(e&127)<<7,0!==(e&128)&&(e=d[a++],h|=(e&127)<<14,0!==(e&128)&&(e=d[a++],h|=(e&127)<<21,0!==(e&128)&&(e=d[a++],h+=268435456*(e&127),0!==(e&128)&&(e=d[a++],h+=34359738368*(e&127),0!==(e&128)&&(e=d[a++],h+=4398046511104*(e&127),0!==(e&128)&&(e=d[a++],h+=562949953421312*(e&127),0!==(e&128)&&(e=d[a++],h+=72057594037927936*(e&127),0!==(e&128)&&(e=d[a++],h+=0x7fffffffffffffff*(e&127),0!==(e&128)))))))))))throw Error("Varint too long!");}else{for(var b=1;a!==
this._end;){e=d[a];if(0===(e&128))break;++a;h+=(e&127)*b;b*=128}if(a===this._end)throw Error("Varint overrun!");++a;h+=e*b}this._pos=a;return h};h.prototype._decodeSVarint=function(){var d=this._decodeVarint();return d%2?-(d+1)/2:d/2};h.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()};h.prototype._toString=function(d,a,h){var e="",b="";for(h=Math.min(this._end,h);a<h;++a){var c=d[a];c&128?b+="%"+c.toString(16):(e+=decodeURIComponent(b)+
String.fromCharCode(c),b="")}b.length&&(e+=decodeURIComponent(b));return e};h.prototype._toBytes=function(d,a,h){h=Math.min(this._end,h);return new Uint8Array(d.buffer,a,h-a)};return h}()})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/has ../../../webgl/Texture ./Rect ./RectangleBinPack".split(" "),function(n,f,h,d,a,l,e){var b;d("stable-symbol-rendering")&&(b=new Set);return function(){function c(a,b,c){this.height=this.width=0;this._dirties=
[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=b;this._glyphSource=c;this._binPack=new e(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(void 0)}c.prototype.getGlyphItems=function(a,c){var g=this,m=[],f=this._glyphSource,u=new Set;a=1/256;for(var r=0;r<c.length;r++)u.add(Math.floor(c[r]*
a));var t=[];u.forEach(function(a){if(256>=a){var b="Arial Regular"+a;g._rangePromises.has(b)?t.push(g._rangePromises.get(b)):(a=f.getRange("Arial Regular",a).always(function(){g._rangePromises["delete"](b)}),g._rangePromises.set(b,a),t.push(a))}});return h(t).then(function(a){a=g._glyphIndex["Arial Regular"];a||(a={},g._glyphIndex["Arial Regular"]=a);var h;if(d("stable-symbol-rendering")){b.clear();for(var k=0;k<c.length;k++)h=c[k],b.add(h);var q=[];u.forEach(function(a){q.push(a)});q.sort();h=[];
for(k=0;k<q.length;k++)for(var p=q[k],t=0;256>t;++t)h.push(256*p+t)}else h=c;k=0;for(p=h;k<p.length;k++)if(h=p[k],t=a[h]){if(!d("stable-symbol-rendering")||b.has(h))m[h]={rect:t.rect,metrics:t.metrics,page:t.page}}else{var v=f.getGlyph("Arial Regular",h);if(v&&v.metrics){var t=v.metrics,r=void 0;if(0===t.width)r=new l(0,0,0,0);else{var n=t.width+6,C=t.height+6,G=n%4?4-n%4:4,y=C%4?4-C%4:4;1===G&&(G=5);1===y&&(y=5);r=g._binPack.allocate(n+G,C+y);r.isEmpty&&(g._dirties[g._currentPage]||(g._glyphData[g._currentPage]=
null),g._currentPage=g._glyphData.length,g._glyphData.push(new Uint8Array(g.width*g.height)),g._dirties.push(!0),g._textures.push(void 0),g._binPack=new e(g.width-4,g.height-4),r=g._binPack.allocate(n+G,C+y));var G=g._glyphData[g._currentPage],v=v.bitmap,F=y=void 0;if(v)for(var I=0;I<C;I++)for(var y=n*I,F=g.width*(r.y+I+1)+r.x,J=0;J<n;J++)G[F+J+1]=v[y+J]}a[h]={rect:r,metrics:t,tileIDs:null,page:g._currentPage};if(!d("stable-symbol-rendering")||b.has(h))m[h]={rect:r,metrics:t,page:g._currentPage};
g._dirties[g._currentPage]=!0}}return m})};c.prototype.bind=function(b,c,e,d){this._textures[e]||(this._textures[e]=new a(b,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var g=this._textures[e];g.setSamplingMode(c);this._dirties[e]&&g.setData(this._glyphData[e]);b.bindTexture(g,d);this._dirties[e]=!1};c.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=
0};return c}()})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../webgl/ShaderVariations ./shaders/textShaderSnippets ./shaders/iconShaderSnippets ./shaders/fillShaderSnippets ./shaders/lineShaderSnippets ./MaterialInfoUtils ./enums".split(" "),function(n,f,h,d,a,l,e,b,c){return function(){function g(){this._programRep=new Map;this.isInitialize=!1}g.prototype.initialize=function(b){if(!this.isInitialize){var c=new h("icon",["iconVS","iconFS"],[],d,b);c.addDefine("ID",
"ID",[!1,!1],"ID");c.addDefine("HIGHLIGHT","HIGHLIGHT",[!1,!1],"HIGHLIGHT");c.addDefine("SDF","SDF",[!1,!1],"SDF");c.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!1,!1],"VV_SIZE_MIN_MAX_VALUE");c.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!1,!1],"VV_SIZE_SCALE_STOPS");c.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!1,!1],"VV_SIZE_FIELD_STOPS");c.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!1,!1],"VV_SIZE_UNIT_VALUE");c.addDefine("VV_COLOR","VV_COLOR",[!1,
!1],"VV_COLOR");c.addDefine("VV_ROTATION","VV_ROTATION",[!1,!1],"VV_ROTATION");c.addDefine("VV_OPACITY","VV_OPACITY",[!1,!1],"VV_OPACITY");c.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");c.addDefine("PATTERN","PATTERN",[!1,!1],"PATTERN");c.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");var g=new h("icon",["iconVS","iconFS"],[],a,b);g.addDefine("ID","ID",[!0,!0],"ID");g.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");g.addDefine("SDF","SDF",[!0,!0],"SDF");
g.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE");g.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS");g.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS");g.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE");g.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");g.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION");g.addDefine("VV_OPACITY","VV_OPACITY",
[!0,!1],"VV_OPACITY");g.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");g.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");g.addDefine("HEATMAP","HEATMAP",[!0,!0],"HEATMAP");var m=new h("fill",["fillVS","fillFS"],[],l,b);m.addDefine("ID","ID",[!0,!0],"ID");m.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");m.addDefine("SDF","SDF",[!1,!1],"SDF");m.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!1,!1],"VV_SIZE_MIN_MAX_VALUE");m.addDefine("VV_SIZE_SCALE_STOPS",
"VV_SIZE_SCALE_STOPS",[!1,!1],"VV_SIZE_SCALE_STOPS");m.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!1,!1],"VV_SIZE_FIELD_STOPS");m.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!1,!1],"VV_SIZE_UNIT_VALUE");m.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");m.addDefine("VV_ROTATION","VV_ROTATION",[!1,!1],"VV_ROTATION");m.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");m.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");m.addDefine("PATTERN",
"PATTERN",[!0,!0],"PATTERN");m.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");b=new h("line",["lineVS","lineFS"],[],e,b);b.addDefine("ID","ID",[!0,!0],"ID");b.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");b.addDefine("SDF","SDF",[!0,!0],"SDF");b.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE");b.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS");b.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS");
b.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE");b.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");b.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION");b.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");b.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");b.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");b.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");this._textShaderVariations=c;this._fillShaderVariations=m;
this._iconShaderVariations=g;this._lineShaderVariations=b;this.isInitialize=!0}};g.prototype.getProgram=function(a,e,g){a|=e===c.WGLDrawPhase.HITTEST?4:0;a|=e===c.WGLDrawPhase.HIGHLIGHT?8:0;if(this._programRep[a])return this._programRep[a];if(!this._iconShaderVariations||!this._fillShaderVariations||!this._lineShaderVariations)return null;e=b.getMaterialVariations(a);var d;switch(e.geometryType){case c.WGLGeometryType.MARKER:d=this._iconShaderVariations.getProgram(e.variations,null,null,g);break;
case c.WGLGeometryType.TEXT:d=this._textShaderVariations.getProgram(e.variations,null,null,g);break;case c.WGLGeometryType.FILL:d=this._fillShaderVariations.getProgram(e.variations,null,null,g);break;case c.WGLGeometryType.LINE:d=this._lineShaderVariations.getProgram(e.variations,null,null,g)}d&&(this._programRep[a]=d);return d};return g}()})},"esri/views/webgl/ShaderVariations":function(){define(["require","exports","./Program","./Util","./ShaderSourceVariator"],function(n,f,h,d,a){function l(a){return a.reduce(function(a,
c,e){c&&(a|=1<<e);return a},0)}return function(){function e(a,c,e,d,h,f){"string"===typeof a?this._initParams(a,c,e,d,h,f):this._initObject({programNamePrefix:a.programNamePrefix,shaderSnippetPrefixes:a.shaderSnippetPrefixes,baseDefines:a.baseDefines,snippets:a.snippets,rctx:a.rctx,vertexAttribLocs:a.vertexAttribLocs})}e.prototype._initObject=function(a){this._initParams(a.programNamePrefix,a.shaderSnippetPrefixes,a.baseDefines,a.snippets,a.rctx,a.vertexAttribLocs)};e.prototype._initParams=function(b,
c,e,d,h,f){this._defaultSnippets=d;this._defaultRctx=h;this._defaultVertexAttribLocs=f;this._sealed=!1;this._programCache=new Map;this._variationInfo=new Map;this._shaderSourceVariator=new a(b,c,e)};e.prototype.addDefine=function(a,c,e,d){this._shaderSourceVariator.addDefine(a,c,e,d)};e.prototype.addBinaryShaderSnippetSuffix=function(a,c,e){this._shaderSourceVariator.addBinaryShaderSnippetSuffix(a,c,e)};e.prototype.addNaryShaderSnippetSuffix=function(a,c){this._shaderSourceVariator.addNaryShaderSnippetSuffix(a,
c)};e.prototype.getProgram=function(a,c,e,m){c=c||this._defaultSnippets;e=e||this._defaultRctx;m=m||this._defaultVertexAttribLocs;if(!c)throw Error("No ShaderSnippets provided to getProgram nor to ShaderVariations constructor.");if(!e)throw Error("No RenderingContext provided to getProgram nor to ShaderVariations constructor.");if(!m)throw Error("No VertexAttributeLocations provided to getProgram nor to ShaderVariations constructor.");this._sealed=!0;var b=l(a);if(this._programCache[b])return this._programCache[b];
a=this._shaderSourceVariator.getShaderVariation(a);var g,f;g=a.shaderSnippetNames[0];f=c[g];d.assert(null!=f,"shader snippet '"+g+"' does not exist");g=a.shaderSnippetNames[1];c=c[g];d.assert(null!=c,"shader snippet '"+g+"' does not exist");e=new h(e,f,c,m,a.defines);return this._programCache[b]=e};e.prototype.getProgramByKey=function(a){if(this._programCache[a])return this._programCache[a];if(!this._variationInfo[a])return null;var b=this._variationInfo[a],e=this._defaultSnippets,m=this._defaultRctx,
k=this._defaultVertexAttribLocs,f,l;f=b.shaderSnippetNames[0];l=e[f];d.assert(null!=l,"shader snippet '"+f+"' does not exist");f=b.shaderSnippetNames[1];e=e[f];d.assert(null!=e,"shader snippet '"+f+"' does not exist");b=new h(m,l,e,k,b.defines);return this._programCache[a]=b};e.prototype.getProgramInfo=function(a){var b=this._shaderSourceVariator.getShaderVariation(a);a=l(a);this._variationInfo[a]||(this._variationInfo[a]=b);return{name:b.programName,key:a}};return e}()})},"esri/views/webgl/ShaderSourceVariator":function(){define(["require",
"exports","dojo/_base/lang","./Util"],function(n,f,h,d){return function(){function a(a,e,b){var c;"string"===typeof a?c=a:(c=a.programNamePrefix,e=a.shaderSnippetPrefixes,b=a.baseDefines);d.assert(e,"you must specify shader snippet prefixes");d.assert(2===e.length,"you must specify shader snippet prefixes for vertex and fragment shaders");b&&0!==b.length||(b=[]);this.programNamePrefix=c;this.shaderSnippetPrefixes=e;this.baseDefines=b;this.variables=[];this.sealed=!1}a.prototype.addDefine=function(a,
e,b,c){d.assert(!this.sealed,"you cannot add another variable after the first program has been generated");d.assert(a,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",a],shaderNameSuffixes:c||a,defineStr:e,affectsShaderTypes:b||[!0,!0]})};a.prototype.addBinaryShaderSnippetSuffix=function(a,e,b){d.assert(!this.sealed,"you cannot add another variable after the first program has been generated");d.assert(a,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",
a],shaderSnippetSuffixes:["",e],affectsShaderTypes:b||[!0,!0]})};a.prototype.addNaryShaderSnippetSuffix=function(a,e){d.assert(!this.sealed,"you cannot add another variable after the first program has been generated");var b=a.map(function(a){d.assert(null!=a.value,"value must always be specified");return a.value});this.variables.push({values:b,programNameSuffixes:a.map(function(a,e){return null!=a.programNameSuffix?a.programNameSuffix:b[e]}),shaderSnippetSuffixes:a.map(function(a,e){return null!=
a.shaderSnippetSuffix?a.shaderSnippetSuffix:b[e]}),affectsShaderTypes:e||[!0,!0]})};a.prototype.getShaderVariation=function(a){d.assert(a.length===this.variables.length,"you must specify a value for each variable");for(var e=this.programNamePrefix,b=h.clone(this.shaderSnippetPrefixes),c=h.clone(this.shaderSnippetPrefixes),g=h.clone(this.baseDefines),m=0;m<this.variables.length;m++){var k=this.variables[m],f=a[m],l=void 0;k.values?(l=k.values.indexOf(f),d.assert(0<=l,"invalid value "+f+" for variable "+
m)):l=f?1:0;e+=k.programNameSuffixes[l];for(f=0;2>f;f++)k.affectsShaderTypes[f]&&(k.shaderSnippetSuffixes&&(b[f]+=k.shaderSnippetSuffixes[l],c[f]+=k.shaderSnippetSuffixes[l]),k.defineStr&&l&&(g.push(k.defineStr),c[f]+=k.shaderNameSuffixes))}return{programName:e,shaderSnippetNames:b,shaderNames:c,defines:g}};return a}()})},"esri/views/2d/engine/webgl/shaders/textShaderSnippets":function(){define(["require","exports","../../../../webgl/ShaderSnippets","dojo/text!./textShaders.xml"],function(n,f,h,d){n=
new h;h.parse(d,n);return n})},"esri/views/2d/engine/webgl/shaders/iconShaderSnippets":function(){define(["require","exports","../../../../webgl/ShaderSnippets","dojo/text!./iconShaders.xml"],function(n,f,h,d){n=new h;h.parse(d,n);return n})},"esri/views/2d/engine/webgl/shaders/fillShaderSnippets":function(){define(["require","exports","../../../../webgl/ShaderSnippets","dojo/text!./fillShaders.xml"],function(n,f,h,d){n=new h;h.parse(d,n);return n})},"esri/views/2d/engine/webgl/shaders/lineShaderSnippets":function(){define(["require",
"exports","../../../../webgl/ShaderSnippets","dojo/text!./lineShaders.xml"],function(n,f,h,d){n=new h;h.parse(d,n);return n})},"esri/views/2d/engine/webgl/MaterialInfoUtils":function(){define(["require","exports","./MaterialKeyInfo","./enums","./MaterialInfo"],function(n,f,h,d,a){function l(a){var b=[];b[0]=a.sdf?!0:!1;b[1]=a.vvSizeMinMaxValue?!0:!1;b[2]=a.vvSizeScaleStops?!0:!1;b[3]=a.vvSizeFieldStops?!0:!1;b[4]=a.vvSizeUnitValue?!0:!1;b[5]=a.vvColor?!0:!1;b[6]=a.vvRotation?!0:!1;b[7]=a.vvOpacity?
!0:!1;b[8]=a.visibility?!0:!1;b[9]=a.pattern?!0:!1;b[10]=a.heatmap?!0:!1;return b.reduce(function(a,b,c){b&&(a|=1<<c+2);return a},0)}function e(a){if(a.geometryType===d.WGLGeometryType.UNKNOWN)return-1;var b=l(a)<<2;return a.geometryType+b}Object.defineProperty(f,"__esModule",{value:!0});f.createTextMaterialInfo=function(b,c){var g=a.pool.acquire(),m=h.pool.acquire();m.geometryType=d.WGLGeometryType.TEXT;m.sdf=!0;m.pattern=!1;m.visibility=!0;m.heatmap=!1;g.texBindingInfo.push({unit:2,pageId:c.page,
semantic:"u_texture"});b.vvFields?(m.vvOpacity=null!=b.vvFields.opacity,m.vvSizeMinMaxValue=null!=b.vvFields.size,m.vvColor=null!=b.vvFields.color,m.vvRotation=null!=b.vvFields.rotation):m.vvOpacity=m.vvSizeMinMaxValue=m.vvColor=m.vvRotation=!1;g.materialKey=e(m);g.materialKeyInfo=m;return g};f.createMaterialInfo=function(b,c,g,m){var k=a.pool.acquire(),f=h.pool.acquire();f.geometryType=g;(c=c.spriteMosaicItem)?(f.sdf=c.sdf,f.pattern=!0,k.texBindingInfo.push({unit:1,pageId:c.page,semantic:"u_texture"})):
(f.sdf=!1,f.pattern=!1);0===m?f.vvOpacity=f.vvSizeMinMaxValue=f.vvSizeScaleStops=f.vvSizeFieldStops=f.vvSizeUnitValue=f.vvColor=f.vvRotation=!1:(f.vvOpacity=0!==(m&d.WGLVVFlag.OPACITY),f.vvSizeMinMaxValue=0!==(m&d.WGLVVFlag.SIZE_MINMAX_VALUE),f.vvSizeScaleStops=0!==(m&d.WGLVVFlag.SIZE_SCALE_STOPS),f.vvSizeFieldStops=0!==(m&d.WGLVVFlag.SIZE_FIELD_STOPS),f.vvSizeUnitValue=0!==(m&d.WGLVVFlag.SIZE_UNIT_VALUE),f.vvColor=0!==(m&d.WGLVVFlag.COLOR),f.vvRotation=0!==(m&d.WGLVVFlag.ROTATION));f.visibility=
!1;f.heatmap=null!=b.heatmapInfo;k.materialKey=e(f);k.materialKeyInfo=f;return k};f.getMaterialKey=e;f.getMaterialVariations=function(a){var b=a&3;a>>=2;return{geometryType:b,variations:[0!==(a&1),0!==(a&2),0!==(a&4),0!==(a&8),0!==(a&16),0!==(a&32),0!==(a&64),0!==(a&128),0!==(a&256),0!==(a&512),0!==(a&1024),0!==(a&2048),0!==(a&4096)]}}})},"esri/views/2d/engine/webgl/MaterialKeyInfo":function(){define(["require","exports","../../../../core/ObjectPool","./enums"],function(n,f,h,d){return function(){function a(){this.heatmap=
this.pattern=this.visibility=this.vvOpacity=this.vvRotation=this.vvColor=this.vvSizeUnitValue=this.vvSizeFieldStops=this.vvSizeScaleStops=this.vvSizeMinMaxValue=this.sdf=!1}a.prototype.copy=function(a){this.geometryType=a.geometryType;this.sdf=a.sdf;this.vvSizeMinMaxValue=a.vvSizeMinMaxValue;this.vvSizeScaleStops=a.vvSizeScaleStops;this.vvSizeFieldStops=a.vvSizeFieldStops;this.vvSizeUnitValue=a.vvSizeUnitValue;this.vvColor=a.vvColor;this.vvRotation=a.vvRotation;this.vvOpacity=a.vvOpacity;this.visibility=
a.visibility;this.pattern=a.pattern;this.heatmap=a.heatmap};a.prototype.release=function(){this.geometryType=d.WGLGeometryType.UNKNOWN;this.heatmap=this.pattern=this.visibility=this.vvOpacity=this.vvRotation=this.vvColor=this.vvSizeUnitValue=this.vvSizeFieldStops=this.vvSizeScaleStops=this.vvSizeMinMaxValue=this.sdf=!1};a.pool=new h(a);return a}()})},"esri/views/2d/engine/webgl/MaterialInfo":function(){define(["require","exports","../../../../core/ObjectPool","./MaterialKeyInfo","./Utils"],function(n,
f,h,d,a){return function(){function f(){this.texBindingInfo=[];this.materialParams=[]}f.prototype.release=function(){this.materialKey=null;this.texBindingInfo.length=0;this.materialParams.length=0;this.materialKeyInfo&&d.pool.release(this.materialKeyInfo)};f.prototype.copy=function(a){var b=this;a.materialParams.forEach(function(a,e){b.materialParams[e]={name:a.name,value:a.value}});a.texBindingInfo.forEach(function(a,e){b.texBindingInfo[e]={unit:a.unit,pageId:a.pageId,semantic:a.semantic}});this.materialKeyInfo&&
(d.pool.release(this.materialKeyInfo),this.materialKeyInfo=null);a.materialKeyInfo&&(this.materialKeyInfo=d.pool.acquire(),this.materialKeyInfo.copy(a.materialKeyInfo));this.materialKey=a.materialKey};f.serialize=function(e,b,c){var d=0,d=d+a.serializeInteger(e.materialKey,b,c+d),d=d+f._serializeTexBindingInfo(e.texBindingInfo,b,c+d);return d+=f._serializeMaterialParams(e.materialParams,b,c+d)};f.deserialize=function(e,b,c){var g=0;e.materialInfo=f.pool.acquire();var h={n:0},g=g+a.deserializeInteger(h,
b,c+g);e.materialInfo.materialKey=h.n;g+=f._deserializeTexBindingInfo(e.materialInfo.texBindingInfo,b,c+g);g+=f._deserializeMaterialParams(e.materialInfo.materialParams,b,c+g);e.materialInfo.materialKeyInfo=d.pool.acquire();return g};f._serializeTexBindingInfo=function(e,b,c){for(var d=0,h=e.length,d=d+a.serializeInteger(h,b,c+d),k=0;k<h;++k)b&&(b[c+d]=e[k].unit),++d,d+=a.serializeInteger(e[k].pageId,b,c+d),d+=a.serializeString(e[k].semantic,b,c+d);return d};f._serializeMaterialParams=function(e,
b,c){for(var d=0,h=e.length,d=d+a.serializeInteger(h,b,c+d),k=0;k<h;++k)d+=a.serializeString(e[k].name,b,c+d),d+=a.serializeUniform(e[k].value,b,c+d);return d};f._deserializeTexBindingInfo=function(e,b,c){var d=0,h={n:void 0},d=d+a.deserializeInteger(h,b,c+d);e.length=h.n;for(var k={n:void 0},f={s:void 0},l=0;l<h.n;++l)e[l]={unit:void 0,pageId:void 0,semantic:void 0},e[l].unit=b[c+d],++d,d+=a.deserializeInteger(k,b,c+d),e[l].pageId=k.n,d+=a.deserializeString(f,b,c+d),e[l].semantic=f.s;return d};f._deserializeMaterialParams=
function(e,b,c){var d=0,h={n:void 0},d=d+a.deserializeInteger(h,b,c+d);e.length=h.n;for(var k={s:void 0},f={n:void 0},l=0;l<h.n;++l)e[l]={name:void 0,value:void 0},d+=a.deserializeString(k,b,c+d),e[l].name=k.s,d+=a.deserializeUniform(f,b,c+d),e[l].value=f.n;return d};f.pool=new h(f);return f}()})},"esri/views/2d/engine/webgl/painter/WGLTextPainter":function(){define(["require","exports","../../../../webgl/VertexArrayObject","../Utils"],function(n,f,h,d){return function(){function a(){this._attributeLocations=
{a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_texFontSize:4,a_visible:5};this._attributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_texFontSize:4,a_visible:5,a_vv:6};this._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:20,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,
stride:20,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5120,offset:0,stride:1,normalized:!1,divisor:0}]};this._vertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:36,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:36,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:36,normalized:!0,divisor:0},{name:"a_offsetAndNormal",
count:4,type:5120,offset:12,stride:36,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:36,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:20,stride:36,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5120,offset:0,stride:1,normalized:!1,divisor:0}]};this._glyphsTextureSize=new Float32Array(2)}a.prototype.draw=function(a,e,b,c,d,h,k,f,p,u,r){if(b.canDisplay){var g=e.materialKeyInfo,m=g.vvSizeMinMaxValue||g.vvSizeScaleStops||g.vvSizeFieldStops||
g.vvSizeUnitValue||g.vvColor||g.vvRotation||g.vvOpacity;if(d=f.getProgram(e.materialKey,d,m?this._attributeLocationsVV:this._attributeLocations))a.bindProgram(d),m=this._getVAO(a,b,m),a.bindVAO(m),e=e.texBindingInfo[0],p.bindGlyphsPage(a,e.pageId,e.unit),d.setUniform1i(e.semantic,e.unit),p=p.glyphs,this._glyphsTextureSize[0]=p.width/4,this._glyphsTextureSize[1]=p.height/4,u=c.vvMaterialParameters.vvRotationEnabled&&"geographic"===c.vvMaterialParameters.vvRotationType?u:r,d.setUniformMatrix4fv("u_transformMatrix",
b.tileTransform.transform),d.setUniformMatrix4fv("u_extrudeMatrix",u),d.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),d.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),d.setUniform1f("u_pixelRatio",1),d.setUniform1f("u_opacity",1),g.vvSizeMinMaxValue&&d.setUniform4fv("u_vvSizeInfo",c.vvSizeMinMaxValue),g.vvColor&&(d.setUniform1fv("u_vvColorValues",c.vvColorValues),d.setUniform4fv("u_vvColors",c.vvColors)),g.vvOpacity&&(d.setUniform1fv("u_vvOpacityValues",c.vvOpacityValues),
d.setUniform1fv("u_vvOpacities",c.vvOpacities)),a.drawElements(4,k,5125,4*h),a.bindVAO(null)}};a.prototype._getVAO=function(a,e,b){if(e.iconGeometry.vao)return e.iconGeometry.vao;var c=e.iconGeometry.vertexBufferMap[d.C_VBO_GEOMETRY],g=e.iconGeometry.vertexBufferMap[d.C_VBO_VISIBILITY],f=e.iconGeometry.indexBuffer;if(!c||!f)return null;e.iconGeometry.vao=b?new h(a,this._attributeLocationsVV,this._vertexAttributeLayoutVV,{geometry:c,visibility:g},f):new h(a,this._attributeLocations,this._vertexAttributeLayout,
{geometry:c,visibility:g},f);return e.iconGeometry.vao};return a}()})},"esri/views/2d/engine/webgl/painter/WGLIconPainter":function(){define(["require","exports","../../../../webgl/VertexArrayObject","../../../../webgl/Texture","../Utils"],function(n,f,h,d,a){return function(){function f(){this._iconAttributeLocations={a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5};this._iconAttributeLocationsVV={a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,
a_sizeAndOutlineWidth:5,a_vv:6};this._iconAttributeLocationsHeatmap={a_pos:0,a_vertexOffsetAndTex:1,a_id:2,a_color:3,a_outlineColor:4,a_sizeAndOutlineWidth:5,a_weight:6};this._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:24,
normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}]};this._iconVertexAttributesWithVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:40,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,stride:40,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:40,normalized:!0,divisor:0},{name:"a_color",
count:4,type:5121,offset:12,stride:40,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:40,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:40,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:24,stride:40,normalized:!1,divisor:0}]};this._iconVertexAttributesWithHeatmap={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:28,normalized:!1,divisor:0},{name:"a_vertexOffsetAndTex",count:4,type:5120,offset:4,
stride:28,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:8,stride:28,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:28,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:16,stride:28,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:20,stride:28,normalized:!1,divisor:0},{name:"a_weight",count:1,type:5126,offset:24,stride:28,normalized:!1,divisor:0}]};this._spritesTextureSize=new Float32Array(2)}f.prototype.draw=
function(a,b,c,g,h,k,f,l,u,r,t){if(c.canDisplay){var e=b.materialKeyInfo,m=e.heatmap,q=e.vvSizeMinMaxValue||e.vvSizeScaleStops||e.vvSizeFieldStops||e.vvSizeUnitValue||e.vvColor||e.vvRotation||e.vvOpacity;if(h=l.getProgram(b.materialKey,h,q?this._iconAttributeLocationsVV:this._iconAttributeLocations)){a.bindProgram(h);q=this._getVAO(a,c,q,m);a.bindVAO(q);if(m){u=g.heatmapParameters;if(u.intensityKernel&&!u.refreshIntensityKernel)u=u.intensityKernel;else{u.intensityKernel&&(u.intensityKernel.dispose(),
u.intensityKernel=null);l=u.radius;b=u.kernelSize;for(var p=u.blurRadius,n=l*l,m=[],q=-1;++q<b;)m[q]=Math.exp(-Math.pow(q-p,2)/(2*n))/(l/2*Math.sqrt(2*Math.PI));l=[];for(var x,B=0;B<b;B++)for(n=m[B],q=0;q<b;q++)x=B*b+q,p=m[q],l[4*x+0]=n*p,l[4*x+1]=0,l[4*x+2]=0,l[4*x+3]=1;b=new d(a,{target:3553,pixelFormat:6408,internalFormat:34836,dataType:5126,samplingMode:a.extensions.textureFloatLinear?9729:9728,wrapMode:33071,width:b,height:b},new Float32Array(l));u.intensityKernel=b;u.refreshIntensityKernel=
!1;u=b}a.bindTexture(u,1);h.setUniform1i("u_texture",1);this._spritesTextureSize[0]=Math.round(g.heatmapParameters.radius);this._spritesTextureSize[1]=Math.round(g.heatmapParameters.radius)}else m=b.texBindingInfo[0],b=m.pageId,u.bindSpritePage(a,b,m.unit),h.setUniform1i(m.semantic,m.unit),u=u.sprites,this._spritesTextureSize[0]=u.getWidth(b)/4,this._spritesTextureSize[1]=u.getHeight(b)/4;r=g.vvMaterialParameters.vvRotationEnabled&&"geographic"===g.vvMaterialParameters.vvRotationType?r:t;h.setUniformMatrix4fv("u_transformMatrix",
c.tileTransform.transform);h.setUniformMatrix4fv("u_extrudeMatrix",r);h.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord);h.setUniform2fv("u_mosaicSize",this._spritesTextureSize);h.setUniform1f("u_opacity",1);e.vvSizeMinMaxValue&&h.setUniform4fv("u_vvSizeMinMaxValue",g.vvSizeMinMaxValue);e.vvSizeScaleStops&&h.setUniform1f("u_vvSizeScaleStopsValue",g.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(h.setUniform1fv("u_vvSizeFieldStopsValues",g.vvSizeFieldStopsValues),h.setUniform1fv("u_vvSizeFieldStopsSizes",
g.vvSizeFieldStopsSizes));e.vvSizeUnitValue&&h.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",g.vvSizeUnitValueToPixelsRatio);e.vvColor&&(h.setUniform1fv("u_vvColorValues",g.vvColorValues),h.setUniform4fv("u_vvColors",g.vvColors));e.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",g.vvOpacityValues),h.setUniform1fv("u_vvOpacities",g.vvOpacities));a.drawElements(4,f,5125,4*k);a.bindVAO(null)}}};f.prototype._getVAO=function(d,b,c,g){if(b.iconGeometry.vao)return b.iconGeometry.vao;var e=b.iconGeometry.vertexBufferMap[a.C_VBO_GEOMETRY],
k=b.iconGeometry.indexBuffer;if(!e||!k)return null;b.iconGeometry.vao=c?new h(d,this._iconAttributeLocationsVV,this._iconVertexAttributesWithVV,{geometry:e},k):g?new h(d,this._iconAttributeLocationsHeatmap,this._iconVertexAttributesWithHeatmap,{geometry:e},k):new h(d,this._iconAttributeLocations,this._iconVertexAttributes,{geometry:e},k);return b.iconGeometry.vao};return f}()})},"esri/views/2d/engine/webgl/painter/WGLFillPainter":function(){define(["require","exports","../../../../webgl/VertexArrayObject",
"../Utils"],function(n,f,h,d){return function(){function a(){this._isInitialized=!1;this._fillAttributeLocations={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4};this._fillAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4,a_vv:5};this._spritesTextureSize=new Float32Array(2)}a.prototype.draw=function(a,e,b,c,g,h,k,f,p,u,r,t){if(b.canDisplay){this._initialize();var m=e.materialKeyInfo,l=m.vvColor||m.vvOpacity;if(g=r.getProgram(e.materialKey,g,l?this._fillAttributeLocationsVV:this._fillAttributeLocations))a.bindProgram(g),
l=this._getVAO(a,b,l),a.bindVAO(l),0<e.texBindingInfo.length&&(e=e.texBindingInfo[0],l=e.pageId,r=t.sprites,this._spritesTextureSize[0]=r.getWidth(l),this._spritesTextureSize[1]=r.getHeight(l),g.setUniform1f("u_zoomFactor",b.coordRange/d.C_TILE_SIZE/Math.pow(2,h-b.key.level)/k),t.bindSpritePage(a,l,e.unit,f?9728:9729),g.setUniform1i(e.semantic,e.unit),g.setUniform2fv("u_mosaicSize",this._spritesTextureSize)),g.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),g.setUniform2fv("u_normalized_origin",
b.tileTransform.displayCoord),g.setUniform1f("u_opacity",1),m.vvColor&&(g.setUniform1fv("u_vvColorValues",c.vvColorValues),g.setUniform4fv("u_vvColors",c.vvColors)),m.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",c.vvOpacityValues),g.setUniform1fv("u_vvOpacities",c.vvOpacities)),a.drawElements(4,u,5125,4*p),a.bindVAO(null)}};a.prototype._initialize=function(){if(this._isInitialized)return!0;this._fillVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,
divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}]};this._fillVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,
divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_vv",count:2,type:5126,offset:24,stride:32,normalized:!1,divisor:0}]};this._isInitialized=!0};a.prototype._getVAO=function(a,e,b){if(e.fillGeometry.vao)return e.fillGeometry.vao;var c=e.fillGeometry.vertexBufferMap[d.C_VBO_GEOMETRY],g=e.fillGeometry.indexBuffer;
if(!c||!g)return null;e.fillGeometry.vao=b?new h(a,this._fillAttributeLocationsVV,this._fillVertexAttributeLayoutVV,{geometry:c},g):new h(a,this._fillAttributeLocations,this._fillVertexAttributeLayout,{geometry:c},g);return e.fillGeometry.vao};return a}()})},"esri/views/2d/engine/webgl/painter/WGLLinePainter":function(){define(["require","exports","../../../../webgl/VertexArrayObject","../Utils"],function(n,f,h,d){return function(){function a(){this._lineAttributeLocations={a_pos:0,a_id:1,a_color:2,
a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6};this._lineAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6,a_vv:7};this._lineVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},
{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:32,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:32,normalized:!1,divisor:0}]};this._lineVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:44,normalized:!1,divisor:0},{name:"a_id",count:4,
type:5121,offset:4,stride:44,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:44,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:44,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:44,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:44,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:44,normalized:!1,divisor:0},{name:"a_vv",
count:3,type:5126,offset:32,stride:44,normalized:!1,divisor:0}]};this._spritesTextureSize=new Float32Array(2)}a.prototype.draw=function(a,e,b,c,g,h,k,f,p,u,r,t){var m=e.materialKeyInfo,l=m.vvSizeMinMaxValue||m.vvSizeScaleStops||m.vvSizeFieldStops||m.vvSizeUnitValue||m.vvColor||m.vvOpacity;if(g=u.getProgram(e.materialKey,g,l?this._lineAttributeLocationsVV:this._lineAttributeLocations)){a.bindProgram(g);l=this._getVAO(a,b,l);a.bindVAO(l);l=1/k;if(0<e.texBindingInfo.length){e=e.texBindingInfo[0];u=e.pageId;
var q=r.sprites;this._spritesTextureSize[0]=q.getWidth(u);this._spritesTextureSize[1]=q.getHeight(u);r.bindSpritePage(a,u,e.unit);g.setUniform1i(e.semantic,e.unit);g.setUniform2fv("u_mosaicSize",this._spritesTextureSize);g.setUniform1f("u_zoomFactor",Math.pow(2,h-b.key.level)/k);g.setUniform1f("u_tileCoordRatio",d.C_TILE_SIZE/b.coordRange)}g.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);g.setUniformMatrix4fv("u_extrudeMatrix",t);g.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);
g.setUniform1f("u_opacity",1);g.setUniform1f("u_blur",0+l);g.setUniform1f("u_antialiasing",l);m.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",c.vvSizeMinMaxValue);m.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",c.vvSizeScaleStopsValue);m.vvSizeFieldStops&&(g.setUniform1fv("u_vvSizeFieldStopsValues",c.vvSizeFieldStopsValues),g.setUniform1fv("u_vvSizeFieldStopsSizes",c.vvSizeFieldStopsSizes));m.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",c.vvSizeUnitValueToPixelsRatio);
m.vvColor&&(g.setUniform1fv("u_vvColorValues",c.vvColorValues),g.setUniform4fv("u_vvColors",c.vvColors));m.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",c.vvOpacityValues),g.setUniform1fv("u_vvOpacities",c.vvOpacities));a.setFaceCullingEnabled(!0);a.setFrontFace(2305);a.setCullFace(1029);a.drawElements(4,p,5125,4*f);a.setFaceCullingEnabled(!1);a.bindVAO(null)}};a.prototype._getVAO=function(a,e,b){if(e.lineGeometry.vao)return e.lineGeometry.vao;var c=e.lineGeometry.vertexBufferMap[d.C_VBO_GEOMETRY],
g=e.lineGeometry.indexBuffer;if(!c||!g)return null;e.lineGeometry.vao=b?new h(a,this._lineAttributeLocationsVV,this._lineVertexAttributeLayoutVV,{geometry:c},g):new h(a,this._lineAttributeLocations,this._lineVertexAttributeLayout,{geometry:c},g);return e.lineGeometry.vao};return a}()})},"esri/views/2d/engine/webgl/painter/WGLBackgroundPainter":function(){define("require exports ../../../../../core/libs/gl-matrix/vec4 ../../../../webgl/Program ../../../../webgl/VertexArrayObject ../../../../webgl/BufferObject ../shaders/glShaderSnippets".split(" "),
function(n,f,h,d,a,l,e){return function(){function b(){this._color=h.create();this._initialized=!1;this._color.set([1,0,0,1])}b.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};b.prototype.draw=function(a,b,d){this._initialized||this._initialize(a);d&&(this._color[0]=d[0],this._color[1]=d[1],this._color[2]=d[2],this._color[3]=d[3]);a.bindVAO(this._solidVertexArrayObject);
a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._solidProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._solidProgram.setUniform1f("u_coord_range",b.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()};b.prototype._initialize=function(b){if(this._initialized)return!0;var c={a_pos:0},h=new d(b,e.backgroundVS,
e.backgroundFS,c);if(!h)return!1;var k={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},f=new Int8Array([0,0,1,0,0,1,1,1]),f=l.createVertex(b,35044,f);b=new a(b,c,k,{geometry:f});this._solidProgram=h;this._vertexAttributes=k;this._solidVertexArrayObject=b;return this._initialized=!0};return b}()})},"esri/core/libs/gl-matrix/vec4":function(){define(["./common"],function(n){var f={create:function(){var h=new n.ARRAY_TYPE(4);h[0]=0;h[1]=0;h[2]=0;h[3]=0;return h},
clone:function(h){var d=new n.ARRAY_TYPE(4);d[0]=h[0];d[1]=h[1];d[2]=h[2];d[3]=h[3];return d},fromValues:function(h,d,a,f){var e=new n.ARRAY_TYPE(4);e[0]=h;e[1]=d;e[2]=a;e[3]=f;return e},copy:function(h,d){h[0]=d[0];h[1]=d[1];h[2]=d[2];h[3]=d[3];return h},set:function(h,d,a,f,e){h[0]=d;h[1]=a;h[2]=f;h[3]=e;return h},add:function(h,d,a){h[0]=d[0]+a[0];h[1]=d[1]+a[1];h[2]=d[2]+a[2];h[3]=d[3]+a[3];return h},subtract:function(h,d,a){h[0]=d[0]-a[0];h[1]=d[1]-a[1];h[2]=d[2]-a[2];h[3]=d[3]-a[3];return h}};
f.sub=f.subtract;f.multiply=function(h,d,a){h[0]=d[0]*a[0];h[1]=d[1]*a[1];h[2]=d[2]*a[2];h[3]=d[3]*a[3];return h};f.mul=f.multiply;f.divide=function(h,d,a){h[0]=d[0]/a[0];h[1]=d[1]/a[1];h[2]=d[2]/a[2];h[3]=d[3]/a[3];return h};f.div=f.divide;f.ceil=function(h,d){h[0]=Math.ceil(d[0]);h[1]=Math.ceil(d[1]);h[2]=Math.ceil(d[2]);h[3]=Math.ceil(d[3]);return h};f.floor=function(h,d){h[0]=Math.floor(d[0]);h[1]=Math.floor(d[1]);h[2]=Math.floor(d[2]);h[3]=Math.floor(d[3]);return h};f.min=function(h,d,a){h[0]=
Math.min(d[0],a[0]);h[1]=Math.min(d[1],a[1]);h[2]=Math.min(d[2],a[2]);h[3]=Math.min(d[3],a[3]);return h};f.max=function(h,d,a){h[0]=Math.max(d[0],a[0]);h[1]=Math.max(d[1],a[1]);h[2]=Math.max(d[2],a[2]);h[3]=Math.max(d[3],a[3]);return h};f.round=function(h,d){h[0]=Math.round(d[0]);h[1]=Math.round(d[1]);h[2]=Math.round(d[2]);h[3]=Math.round(d[3]);return h};f.scale=function(h,d,a){h[0]=d[0]*a;h[1]=d[1]*a;h[2]=d[2]*a;h[3]=d[3]*a;return h};f.scaleAndAdd=function(h,d,a,f){h[0]=d[0]+a[0]*f;h[1]=d[1]+a[1]*
f;h[2]=d[2]+a[2]*f;h[3]=d[3]+a[3]*f;return h};f.distance=function(h,d){var a=d[0]-h[0],f=d[1]-h[1],e=d[2]-h[2];h=d[3]-h[3];return Math.sqrt(a*a+f*f+e*e+h*h)};f.dist=f.distance;f.squaredDistance=function(h,d){var a=d[0]-h[0],f=d[1]-h[1],e=d[2]-h[2];h=d[3]-h[3];return a*a+f*f+e*e+h*h};f.sqrDist=f.squaredDistance;f.length=function(h){var d=h[0],a=h[1],f=h[2];h=h[3];return Math.sqrt(d*d+a*a+f*f+h*h)};f.len=f.length;f.squaredLength=function(h){var d=h[0],a=h[1],f=h[2];h=h[3];return d*d+a*a+f*f+h*h};f.sqrLen=
f.squaredLength;f.negate=function(h,d){h[0]=-d[0];h[1]=-d[1];h[2]=-d[2];h[3]=-d[3];return h};f.inverse=function(h,d){h[0]=1/d[0];h[1]=1/d[1];h[2]=1/d[2];h[3]=1/d[3];return h};f.normalize=function(h,d){var a=d[0],f=d[1],e=d[2];d=d[3];var b=a*a+f*f+e*e+d*d;0<b&&(b=1/Math.sqrt(b),h[0]=a*b,h[1]=f*b,h[2]=e*b,h[3]=d*b);return h};f.dot=function(h,d){return h[0]*d[0]+h[1]*d[1]+h[2]*d[2]+h[3]*d[3]};f.lerp=function(h,d,a,f){var e=d[0],b=d[1],c=d[2];d=d[3];h[0]=e+f*(a[0]-e);h[1]=b+f*(a[1]-b);h[2]=c+f*(a[2]-
c);h[3]=d+f*(a[3]-d);return h};f.random=function(h,d){d=d||1;h[0]=n.RANDOM();h[1]=n.RANDOM();h[2]=n.RANDOM();h[3]=n.RANDOM();f.normalize(h,h);f.scale(h,h,d);return h};f.transformMat4=function(h,d,a){var f=d[0],e=d[1],b=d[2];d=d[3];h[0]=a[0]*f+a[4]*e+a[8]*b+a[12]*d;h[1]=a[1]*f+a[5]*e+a[9]*b+a[13]*d;h[2]=a[2]*f+a[6]*e+a[10]*b+a[14]*d;h[3]=a[3]*f+a[7]*e+a[11]*b+a[15]*d;return h};f.transformQuat=function(h,d,a){var f=d[0],e=d[1],b=d[2],c=a[0],g=a[1],m=a[2];a=a[3];var k=a*f+g*b-m*e,q=a*e+m*f-c*b,p=a*b+
c*e-g*f,f=-c*f-g*e-m*b;h[0]=k*a+f*-c+q*-m-p*-g;h[1]=q*a+f*-g+p*-c-k*-m;h[2]=p*a+f*-m+k*-g-q*-c;h[3]=d[3];return h};f.forEach=function(){var h=f.create();return function(d,a,f,e,b,c){a||(a=4);f||(f=0);for(e=e?Math.min(e*a+f,d.length):d.length;f<e;f+=a)h[0]=d[f],h[1]=d[f+1],h[2]=d[f+2],h[3]=d[f+3],b(h,h,c),d[f]=h[0],d[f+1]=h[1],d[f+2]=h[2],d[f+3]=h[3];return d}}();f.str=function(h){return"vec4("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"};f.exactEquals=function(h,d){return h[0]===d[0]&&h[1]===d[1]&&h[2]===
d[2]&&h[3]===d[3]};f.equals=function(h,d){var a=h[0],f=h[1],e=h[2];h=h[3];var b=d[0],c=d[1],g=d[2];d=d[3];return Math.abs(a-b)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(f-c)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(c))&&Math.abs(e-g)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(h-d)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))};return f})},"esri/views/2d/engine/webgl/painter/TileInfoRenderer":function(){define("require exports ../../../../webgl/Program ../../../../webgl/VertexArrayObject ../../../../webgl/BufferObject ../../../../webgl/Texture ../GeometryUtils ../shaders/glShaderSnippets".split(" "),
function(n,f,h,d,a,l,e,b){return function(){function c(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}c.prototype.render=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",
b.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",
0),this._tileInfoProgram.setUniform1f("u_coord_ratio",b.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())};c.prototype._initialize=function(c){if(this._initialized)return!0;var e={a_pos:0},g=new h(c,b.backgroundVS,b.backgroundFS,e),f=new h(c,b.tileInfoVS,b.tileInfoFS,e),l={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},u=
new Int8Array([0,0,1,0,1,1,0,1]),u=a.createVertex(c,35044,u),u=new d(c,e,l,{geometry:u}),r=new Int8Array([0,0,1,0,0,1,1,1]),r=a.createVertex(c,35044,r);c=new d(c,e,l,{geometry:r});this._outlineProgram=g;this._tileInfoProgram=f;this._vertexAttributes=l;this._outlineVertexArrayObject=u;this._tileInfoVertexArrayObject=c;return this._initialized=!0};c.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id",
"canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=b.key.id,d=this._canvas.getContext("2d");d.font="24px sans-serif";d.textAlign="left";d.textBaseline="middle";var g=d.measureText(c),g=Math.pow(2,Math.ceil(e.log2(g.width+2)));g>this._maxWidth&&(this._maxWidth=g);d.clearRect(0,0,this._maxWidth,32);d.fillStyle="blue";d.fillText(c,0,16);b.texture=new l(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},
this._canvas);return b.texture};return c}()})},"esri/views/2d/engine/webgl/painter/WGLHighlightPainter":function(){define(["require","exports","dojo/has","./highlight/HighlightRenderer","./highlight/HighlightSurfaces"],function(n,f,h,d,a){return function(){function f(){this._hlRenderer=new d;this._hlSurfaces=new a;this._height=this._width=void 0}f.prototype.setup=function(a,b,c){this._width=b;this._height=c;b=Math.round(.7*b);c=Math.round(.7*c);this._hlRenderer.setup(a,b,c);this._hlSurfaces.setup(a,
b,c)};f.prototype.setHighlightOptions=function(a){this._hlRenderer.setHighlightOptions({fillColor:a.fillColor,outlineColor:a.outlineColor,outlineWidth:.7*a.outlineWidth,outerHaloWidth:.7*a.outerHaloWidth,innerHaloWidth:.7*a.innerHaloWidth,outlinePosition:.7*a.outlinePosition})};f.prototype.startMaskDraw=function(a){a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.setClearStencil(0);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.STENCIL_BUFFER_BIT);a.setViewport(0,0,.7*this._width,
.7*this._height)};f.prototype.draw=function(a){a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);h("esri-feature-highlight-debug")?(a.bindFramebuffer(null),a.clear(a.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex)):(a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),
this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex),a.setBlendingEnabled(!0),a.bindFramebuffer(null),a.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex))};return f}()})},"esri/views/2d/engine/webgl/painter/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl/BufferObject ../../../../../webgl/VertexArrayObject ../../../../../webgl/Texture ../../../../../webgl/enums ../../../../../webgl/ShaderVariations ../../shaders/hlShaderSnippets".split(" "),
function(n,f,h,d,a,l,e,b){var c=[void 0,void 0,void 0,1],g=[3,4],m=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return function(){function f(){this._height=this._width=void 0;this._highlightOptions={fillColor:[.2,.6,.9,.75],outlineColor:[.2,.6,.9,.9],outlinePosition:0,outlineWidth:3.4,innerHaloWidth:2,outerHaloWidth:3.3};this._resources=null}f.prototype._initialize=function(f,k,m){this._width=k;this._height=m;k=new h(f,34962,35044,(new Int8Array([-128,-128,0,0,127,-128,255,
0,-128,127,0,255,127,127,255,255])).buffer);m=new d(f,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!0},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!0}]},{geometry:k});var l=(new e("hl",["texturedVS","highlightFS"],[],b,f,{a_position:0,a_texcoord:1})).getProgram([]),q=(new e("hl",["texturedVS","blurFS"],[],b,f,{a_position:0,a_texcoord:1})).getProgram([]);l.setUniform1i("u_texture",g[0]);l.setUniform1i("u_shade",g[1]);
l.setUniform4fv("u_sigmas",c);q.setUniform1i("u_texture",g[0]);q.setUniform4fv("u_sigmas",c);f=new a(f,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:256,height:1,samplingMode:9728});this._resources={quadGeometry:k,quadVAO:m,highlightProgram:l,blurProgram:q,shadeTex:f}};f.prototype.setHighlightOptions=function(a){function b(a,b,c){m[0]=(1-c)*a[0]+c*b[0];m[1]=(1-c)*a[1]+c*b[1];m[2]=(1-c)*a[2]+c*b[2];m[3]=(1-c)*a[3]+c*b[3]}this._highlightOptions=a;if(this._resources){var d=a.outlinePosition-
a.outlineWidth/2-a.outerHaloWidth,e=a.outlinePosition-a.outlineWidth/2,g=a.outlinePosition+a.outlineWidth/2,h=a.outlinePosition+a.outlineWidth/2+a.innerHaloWidth,f=Math.sqrt(Math.PI/2)*c[3],k=Math.abs(d)>f?Math.round(10*(Math.abs(d)-f))/10:0,f=Math.abs(h)>f?Math.round(10*(Math.abs(h)-f))/10:0;k&&!f?console.warn("The outer rim of the highlight is "+k+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!k&&
f?console.warn("The inner rim of the highlight is "+f+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):k&&f&&console.warn("The highlight is "+Math.max(k,f)+"px away from the edge of the feature; consider reducing some width values.");for(var k=new Uint8Array(1024),m=[void 0,void 0,void 0,void 0],l=0;256>l;++l)f=d+l/255*(h-d),f<d?(k[4*l+0]=0,k[4*l+1]=0,k[4*l+2]=0,k[4*l+3]=0):f<e?b([0,0,0,0],a.outlineColor,
(f-d)/(e-d)):f<g?(m[0]=a.outlineColor[0],m[1]=a.outlineColor[1],m[2]=a.outlineColor[2],m[3]=a.outlineColor[3]):f<h?b(a.outlineColor,a.fillColor,(f-g)/(h-g)):(k[4*l+0]=a.fillColor[0],k[4*l+1]=a.fillColor[1],k[4*l+2]=a.fillColor[2],k[4*l+3]=a.fillColor[3]),k[4*l+0]=255*m[0]*m[3],k[4*l+1]=255*m[1]*m[3],k[4*l+2]=255*m[2]*m[3],k[4*l+3]=255*m[3];this._resources.highlightProgram.setUniform2fv("u_minMaxDistance",[d,h]);this._resources.shadeTex.updateData(0,0,0,256,1,k)}};f.prototype.setup=function(a,b,c){this._resources?
(this._width=b,this._height=c):(this._initialize(a,b,c),this.setHighlightOptions(this._highlightOptions))};f.prototype._teardown=function(){this._resources.quadGeometry.dispose();this._resources.quadVAO.dispose();this._resources.highlightProgram.dispose();this._resources.blurProgram.dispose();this._resources.shadeTex.dispose();this._resources=null};f.prototype.dispose=function(){this._resources&&this._teardown()};f.prototype.preBlur=function(a,b){a.bindTexture(b,g[0]);a.bindProgram(this._resources.blurProgram);
this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",m);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};f.prototype.finalBlur=function(a,b){a.bindTexture(b,g[0]);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",k);a.bindVAO(this._resources.quadVAO);
a.drawArrays(5,0,4);a.bindVAO()};f.prototype.renderHighlight=function(a,b){a.bindTexture(b,g[0]);a.bindTexture(this._resources.shadeTex,g[1]);a.bindProgram(this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};return f}()})},"esri/views/2d/engine/webgl/shaders/hlShaderSnippets":function(){define(["require","exports","../../../../webgl/ShaderSnippets","dojo/text!./hlShaders.xml"],function(n,f,h,d){n=new h;h.parse(d,n);return n})},"esri/views/2d/engine/webgl/painter/highlight/HighlightSurfaces":function(){define(["require",
"exports","../../../../../webgl/FramebufferObject","../../../../../webgl/Texture"],function(n,f,h,d){function a(a,e,b){e=new d(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:e,height:b,samplingMode:9729});a=h.createWithAttachments(a,e,{colorTarget:0,depthStencilTarget:2});return[e,a]}return function(){function d(){this._height=this._width=void 0;this._resources=null}d.prototype._initialize=function(d,b,c){this._width=b;this._height=c;var e=a(d,b,c),h=e[0],e=e[1];d=a(d,b,c);this._resources=
{sharedBlur1Tex:h,sharedBlur1Fbo:e,sharedBlur2Tex:d[0],sharedBlur2Fbo:d[1]}};d.prototype.setup=function(a,b,c){!this._resources||this._width===b&&this._height===c||this._teardown();this._resources||this._initialize(a,b,c)};d.prototype._teardown=function(){this._resources.sharedBlur1Tex.dispose();this._resources.sharedBlur1Fbo.dispose();this._resources.sharedBlur2Tex.dispose();this._resources.sharedBlur2Fbo.dispose();this._resources=null};d.prototype.dispose=function(){this._resources&&this._teardown()};
Object.defineProperty(d.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},
enumerable:!0,configurable:!0});return d}()})},"esri/views/2d/engine/webgl/painter/WGLHeatmapPainter":function(){define("require exports ../../../../webgl/Program ../../../../webgl/VertexArrayObject ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/FramebufferObject dojo/text!../shaders/heatmap.vs.glsl dojo/text!../shaders/heatmap.fs.glsl dojo/_base/lang".split(" "),function(n,f,h,d,a,l,e,b,c,g){return function(){function f(){this._initWGLExtensions=this._initialized=!1}f.prototype.bindHeatmapSurface=
function(a,b,c){if(!this._initWGLExtensions){var d=a.extensions;if(!d.textureFloatLinear||!d.colorBufferFloat)throw Error("Required WebGL extensions needed for the heatmap drawing are not available!");this._initWGLExtensions=!0}b=Math.round(b/4);c=Math.round(c/4);this._intensityFBO&&this._intensityFBO.width===b&&this._intensityFBO.height===c||(this._intensityFBO&&this._intensityFBO.dispose(),d=new l(a,{target:3553,internalFormat:34836,pixelFormat:6408,dataType:5126,samplingMode:a.extensions.textureFloatLinear?
9729:9728,wrapMode:33071,width:b,height:c}),this._intensityFBO=e.createWithAttachments(a,d,{colorTarget:0,depthStencilTarget:3,width:b,height:c,multisampled:!1}));this._boundFBO=a.getBoundFramebufferObject();a.bindFramebuffer(this._intensityFBO);this._prevVP=a.getViewport();a.setViewport(0,0,b,c);a.setStencilWriteMask(255);a.setClearColor(0,0,0,0);a.setClearStencil(0);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.STENCIL_BUFFER_BIT)};f.prototype.drawHeatmap=function(a,b,c){a.bindFramebuffer(this._boundFBO);
this._boundFBO=null;a.setViewport(this._prevVP.x,this._prevVP.y,this._prevVP.width,this._prevVP.height);this._initialized||(this._initialized=this._initialize(a));a.setBlendFunctionSeparate(1,771,1,771);a.setBlendingEnabled(!0);a.bindVAO(this._vertexArrayObject);a.bindProgram(this._program);a.bindTexture(this._intensityFBO.colorTexture,2);this._program.setUniform1i("u_texture",2);this._program.setUniform1f("u_opacity",c);b=b.heatmapParameters;this._updateGradient(a,b);this._program.setUniform2f("u_minmax",
b.minPixelIntensity,b.maxPixelIntensity);a.setActiveTexture(5);a.bindTexture(this._gradientTex,5);this._program.setUniform1i("u_gradient",5);a.drawArrays(5,0,4);a.bindVAO()};f.prototype._initialize=function(e){if(this._initialized)return!0;var g={a_pos:0,a_tex:1},f=new h(e,b,c,g);if(!f)return!1;var k=new Int8Array(16);k[0]=-1;k[1]=-1;k[2]=0;k[3]=0;k[4]=1;k[5]=-1;k[6]=1;k[7]=0;k[8]=-1;k[9]=1;k[10]=0;k[11]=1;k[12]=1;k[13]=1;k[14]=1;k[15]=1;e=new d(e,g,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,
stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:a.createVertex(e,35044,k)});this._program=f;this._vertexArrayObject=e;return this._initialized=!0};f.prototype._updateGradient=function(a,b){if(!this._gradientTex||b.color.refreshColorRamp){this._gradientTex&&(this._gradientTex.dispose(),this._gradientTex=null);this._gradientTex=new l(a,{target:3553,internalFormat:6408,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,
width:1,height:512});a=document.createElement("CANVAS");a.width=1;a.height=512;for(var c=a.getContext("2d"),d=b.color,e=[],h=0;h<d.values.length;++h)e.push({ratio:d.values[h],color:"rgba("+Math.floor(255*d.colors[4*h+0])+", "+Math.floor(255*d.colors[4*h+1])+", "+Math.floor(255*d.colors[4*h+2])+", "+d.colors[4*h+3]+")"});d=c.createLinearGradient(0,0,0,512);for(h=0;h<e.length;h++){var f=e[h];d.addColorStop(f.ratio,f.color)}c.fillStyle=d;c.fillRect(0,0,1,512);this._gradientTex.setData(a);this._heatmapColorParameters=
g.clone(b.color);b.color.refreshColorRamp=!1}};return f}()})},"esri/views/2d/layers/support/GraphicsView2D":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Collection ../../../../core/HandleRegistry ../../../../core/promiseUtils ../../../../Graphic ../../../layers/GraphicsView ../../engine/graphics/GFXSurface ../../engine/graphics/GFXGroup ../../engine/graphics/GFXObject".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q){return function(g){function f(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=g.apply(this,a)||this;c._frontGroup=new k;c._handles=new e;c._objects=new Map;c.container=new m;c.container.addChild(c._frontGroup);c.watch("graphics",function(){return c._reset()},!0);return c}h(f,g);f.prototype.hitTest=function(a,c){if(!this.view||!this.view.position)return null;a+=this.view.position[0]-window.pageXOffset;c+=this.view.position[1]-window.pageYOffset;
return(a=this.container.hitTest(a,c))?b.resolve(a.graphic):null};f.prototype._reset=function(){var a=this;this._handles.remove("graphics");this._objects.forEach(function(b,c){a._frontGroup.removeChild(b)});this._objects.clear();this.graphics&&(this.graphics.forEach(this._add,this),this._handles.add(this.graphics.on("change",function(b){return a._graphicsChangeHandler(b)}),"graphics"))};f.prototype._add=function(a){if(!this._objects.has(a)){var b=new q;b.graphic=a;b.renderingInfo={symbol:a.symbol};
this._objects.set(a,b);this._frontGroup.addChild(b)}};f.prototype._remove=function(a){var b=this._objects.get(a);b&&(this._objects.delete(a),this._frontGroup.removeChild(b))};f.prototype._graphicsChangeHandler=function(a){for(var b=a.removed,c=0,d=a.added;c<d.length;c++)a=d[c],this._add(a);for(c=0;c<b.length;c++)a=b[c],this._remove(a)};d([a.cast(l.ofType(c))],f.prototype,"graphics",void 0);d([a.property()],f.prototype,"view",void 0);return f=d([a.subclass("esri.views.2d.layers.support.GraphicsView2D")],
f)}(a.declared(g))})},"esri/views/2d/engine/graphics/GFXSurface":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../libs/gl-matrix/mat2d ../../libs/gl-matrix/common ../../libs/gfx ../../viewpointUtils ../Container ./Projector ../cssUtils".split(" "),function(n,f,h,d,a,l,e,b,c,g,m){var k=a.identity(a.create());return function(c){function f(){var b=null!==c&&c.apply(this,arguments)||this;b._transform=a.create();b._projector=new g;
b._prevStateId=null;return b}h(f,c);f.prototype.createElement=function(){var a=document.createElement("div");a.setAttribute("class","esri-display-object");return a};f.prototype.setElement=function(a){this.surface&&(this.surface.destroy(),this.surface=null);if(this.element=a)this.surface=e.createSurface(this.element,400,400)};f.prototype.doRender=function(d){var e=this.element.style;if(this.visible){e.display="block";e.opacity=""+this.opacity;var g=this._transform,h=d.state,f=this._prevStateId!==h.id;
if(this.renderRequested||f){if(d.stationary)f&&(this._prevStateId=h.id),b.getMatrix(g,h.center,h.size,h.resolution,l.toRadian(h.rotation),1),this.surface.setDimensions(h.size[0],h.size[1]),this._projector.update(g,h.resolution),this.children.forEach(function(a){a.g&&a.g.setTransform(k)}),c.prototype.doRender.call(this,d);else{var q=a.invert(a.create(),g);a.multiply(q,h.transform,q);this.children.forEach(function(a){a.g&&a.g.setTransform(q)})}m.clip(e,h.clipRect);e.transform=m.cssMatrix3d(a.fromRotation(a.create(),
l.toRadian(h.rotation)));this.surface.rawNode.style.transform=m.cssMatrix(a.fromRotation(a.create(),l.toRadian(-h.rotation)))}}else e.display="none"};f.prototype.hitTest=function(a,b){if(!this.attached)return null;var c=this.surface.rawNode,c=c.parentElement||c.parentNode;c.style.zIndex="9000";a=document.elementFromPoint(a,b);c.style.zIndex="";return a&&a.gfxObject||null};f.prototype.prepareChildrenRenderParameters=function(a){return d({},a,{projector:this._projector,surface:this.surface})};f.prototype.beforeRenderChildren=
function(a,b){this.surface.openBatch()};f.prototype.attachChild=function(a,b){return a.attach(b)};f.prototype.detachChild=function(a,b){return a.detach()};f.prototype.renderChild=function(a,b){return a.processRender(b)};f.prototype.afterRenderChildren=function(a,b){this.surface.closeBatch()};return f}(c)})},"esri/views/2d/libs/gfx":function(){define("require exports ./gfx/svg ./gfx/Circle ./gfx/Group ./gfx/Path ./gfx/Image ./gfx/Rect ./gfx/Shape ./gfx/Surface ./gfx/Text".split(" "),function(n,f,h,
d,a,l,e,b,c,g,m){Object.defineProperty(f,"__esModule",{value:!0});f.createSurface=h.createSurface;f.Circle=d.default;f.Group=a.default;f.Path=l.default;f.Image=e.default;f.Rect=b.default;f.Shape=c.default;f.Surface=g.default;f.Text=m.default})},"esri/views/2d/libs/gfx/svg":function(){define(["require","exports","dojo/dom","./Surface"],function(n,f,h,d){function a(a,d){return document.createElementNS?document.createElementNS(a,d):document.createElement(d)}Object.defineProperty(f,"__esModule",{value:!0});
f.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};f.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};f._createElementNS=a;f._setAttributeNS=function(a,d,b,c){return a.setAttributeNS?a.setAttributeNS(d,b,c):a.setAttribute(b,c)};f._createTextNode=function(a){return document.createTextNode(a)};f._createFragment=
function(){return document.createDocumentFragment()};f.getRef=function(a){return a&&"none"!==a?a.match(/^url\(#.+\)$/)?h.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?h.byId(a.slice(1)):null:null};f.createSurface=function(l,e,b){var c=new d.default;c.rawNode=a(f.xmlns.svg,"svg");c.rawNode.setAttribute("overflow","hidden");e&&c.rawNode.setAttribute("width",0>e?0:e);b&&c.rawNode.setAttribute("height",0>b?0:b);e=a(f.xmlns.svg,"defs");c.rawNode.appendChild(e);c.defNode=e;c._parent=h.byId(l);c._parent.appendChild(c.rawNode);
return c}})},"esri/views/2d/libs/gfx/Surface":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/has dojo/_base/array dojo/dom-construct dojox/gfx/_base ./svg ./Container ./Circle ./Group ./Path ./Image ./Rect ./Text".split(" "),function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u){Object.defineProperty(f,"__esModule",{value:!0});var r=navigator.userAgent,t=534<function(){var a=/WebKit\/(\d*)/.exec(r);return a?parseInt(a[1],10):0}();n=function(c){function f(){var a=null!==c&&c.apply(this,
arguments)||this;a.rawNode=null;a._parent=null;a._nodes=[];a._events=[];return a}h(f,c);f.prototype.destroy=function(){a.forEach(this._nodes,l.destroy);this._nodes=[];a.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(d("ie"))for(;this._parent.lastChild;)l.destroy(this._parent.lastChild);else this._parent.innerHTML="";this.defNode=this._parent=null};f.prototype.setDimensions=function(a,b){if(!this.rawNode)return this;a=0>a?0:a;b=0>b?0:b;this.rawNode.setAttribute("width",
a);this.rawNode.setAttribute("height",b);t&&(this.rawNode.style.width=a,this.rawNode.style.height=b);return this};f.prototype.getDimensions=function(){return this.rawNode?{width:e.normalizedLength(this.rawNode.getAttribute("width")),height:e.normalizedLength(this.rawNode.getAttribute("height"))}:null};f.prototype.getEventSource=function(){return this.rawNode};f.prototype._getRealMatrix=function(){return null};f.prototype.createShape=function(a){switch(a.type){case e.defaultPath.type:return this.createPath(a);
case e.defaultRect.type:return this.createRect(a);case e.defaultCircle.type:return this.createCircle(a);case e.defaultImage.type:return this.createImage(a);case e.defaultText.type:return this.createText(a)}console.error("[gfx] unknown shape",a);return null};f.prototype.createGroup=function(){return this.createObject(m.default)};f.prototype.createRect=function(a){return this.createObject(p.default,a)};f.prototype.createCircle=function(a){return this.createObject(g.default,a)};f.prototype.createImage=
function(a){return this.createObject(q.default,a)};f.prototype.createText=function(a){return this.createObject(u.default,a)};f.prototype.createPath=function(a){return this.createObject(k.default,a)};f.prototype.createObject=function(a,c){if(!this.rawNode)return null;var d=new a;a=b._createElementNS(b.xmlns.svg,a.nodeType);d.setRawNode(a);d.setShape(c);this.add(d);return d};return f}(c.default);f.default=n})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(n,f,h,d,a,l,e,b,c){var g=f.getObject("dojox.gfx",!0),m=g._base={};g._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+b+" ")};g._addClass=function(a,b){var c=a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};g._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};m._getFontMeasurements=function(){var c=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},e,g;d("ie")&&(g=a.doc.documentElement.style.fontSize||"",g||(a.doc.documentElement.style.fontSize="100%"));var h=b.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},a.body());for(e in c)h.style.fontSize=e,c[e]=16*Math.round(12*h.offsetHeight/16)/12/1E3;
d("ie")&&(a.doc.documentElement.style.fontSize=g);a.body().removeChild(h);return c};var k=null;m._getCachedFontMeasurements=function(a){if(a||!k)k=m._getFontMeasurements();return k};var q=null,p={};m._getTextBox=function(d,e,g){var h,f,k=arguments.length,m;q||(q=b.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},a.body()));h=q;h.className="";f=h.style;f.borderWidth="0";f.margin="0";f.padding="0";f.outline="0";if(1<k&&e)for(m in e)m in p||(f[m]=e[m]);2<k&&g&&(h.className=
g);h.innerHTML=d;h.getBoundingClientRect?(f=h.getBoundingClientRect(),f={l:f.left,t:f.top,w:f.width||f.right-f.left,h:f.height||f.bottom-f.top}):f=c.getMarginBox(h);h.innerHTML="";return f};m._computeTextLocation=function(a,b,c,d){var e={};switch(a.align){case "end":e.x=a.x-b;break;case "middle":e.x=a.x-b/2;break;default:e.x=a.x}e.y=a.y-c*(d?.75:1);return e};m._computeTextBoundingBox=function(a){if(!g._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var c=a.getFont()||g.defaultFont;
a=a.getTextWidth();c=g.normalizedLength(c.size);b=m._computeTextLocation(b,a,c,!0);return{x:b.x,y:b.y,width:a,height:c}};m._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var u=0;m._getUniqueId=function(){var a;do a=n._scopeName+"xUnique"+ ++u;while(e.byId(a));return a};var r=d("pointer-events")?"touchAction":d("MSPointer")?"msTouchAction":null;m._fixMsTouchAction=r?function(a){a.rawNode.style[r]="none"}:function(){};f.mixin(g,{defaultPath:{type:"path",path:""},
defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},
defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a=
{};return function(b){var c=a[b];if(c)return new c;c=a[b]=new Function;c.prototype=g["default"+b];return new c}}(),normalizeColor:function(a){return a instanceof h?a:new h(a)},normalizeParameters:function(a,b){var c;if(b){var d={};for(c in a)c in b&&!(c in d)&&(a[c]=b[c])}return a},makeParameters:function(a,b){var c=null;if(!b)return f.delegate(a);var d={};for(c in a)c in d||(d[c]=f.clone(c in b?b[c]:a[c]));return d},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);
else{var d=c.indexOf(".");0<=d&&5<c.length-d&&(c=a.toFixed(4))}return 0>a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=g.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var c=a[3].indexOf("/");b.size=0>c?a[3]:a[3].substring(0,c);var d=4;0>c&&("/"==a[4]?d=6:"/"==a[4].charAt(0)&&(d=5));d<a.length&&(b.family=a.slice(d).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/
2.54,px_in_pt:function(){return g._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*g.px_in_pt()},px2pt:function(a){return a/g.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=g.px_in_pt(),c=parseFloat(a);switch(a.slice(-2)){case "px":return c;case "pt":return c*b;case "in":return 72*c*b;case "pc":return 12*c*b;case "mm":return c*g.mm_in_pt*b;case "cm":return c*g.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,
pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?g[a]:a;b&&(l.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){g[a]=b[a]}),"string"==typeof a?g.renderer=a:l.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return g.renderer=g[a]&&g[a].Surface===g.Surface?a:null}))}});return g})},
"esri/views/2d/libs/gfx/Container":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/matrix ./Shape ./svg".split(" "),function(n,f,h,d,a,l){Object.defineProperty(f,"__esModule",{value:!0});n=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.children=[];b._batch=0;return b}h(b,a);b.prototype.openBatch=function(){this._batch||(this.fragment=l._createFragment());++this._batch;return this};b.prototype.closeBatch=function(){this._batch=0<this._batch?
--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),this.fragment=null);return this};b.prototype.add=function(a){if(this===a.getParent())return this;this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode);var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);a._setParent(this,this._getRealMatrix());return this};b.prototype.remove=function(a,b){void 0===b&&(b=!1);if(this!==a.getParent())return this;this.rawNode===a.rawNode.parentNode&&
this.rawNode.removeChild(a.rawNode);this.fragment&&this.fragment===a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode);for(var c=0;c<this.children.length;++c)if(this.children[c]===a){b||(a.parent=null,a.parentMatrix=null);this.children.splice(c,1);break}return this};b.prototype.clear=function(a){void 0===a&&(a=!1);for(var b=this.rawNode;b.lastChild;)b.removeChild(b.lastChild);var c=this.defNode;if(c){for(;c.lastChild;)c.removeChild(c.lastChild);b.appendChild(c)}for(c=0;c<this.children.length;++c)b=
this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this};b.prototype.getBoundingBox=function(){if(!this.children)return null;var a=null;this.children.forEach(function(b){var c=b.getBoundingBox();c&&((b=b.getTransform())&&(c=d.multiplyRectangle(b,c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height,width:0,height:0})});a&&(a.width=a.endX-a.x,
a.height=a.endY-a.y);return a};b.prototype._moveChildToFront=function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]===a){this.children.splice(b,1);this.children.push(a);break}return this};b.prototype._moveChildToBack=function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]===a){this.children.splice(b,1);this.children.unshift(a);break}return this};return b}(a.default);f.default=n})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(n,f){var h=
n.matrix={},d={};h._degToRad=function(a){return d[a]||(d[a]=Math.PI*a/180)};h._radToDeg=function(a){return a/Math.PI*180};h.Matrix2D=function(a){if(a)if("number"==typeof a)this.xx=this.yy=a;else if(a instanceof Array){if(0<a.length){for(var d=h.normalize(a[0]),e=1;e<a.length;++e){var b=d,c=h.normalize(a[e]),d=new h.Matrix2D;d.xx=b.xx*c.xx+b.xy*c.yx;d.xy=b.xx*c.xy+b.xy*c.yy;d.yx=b.yx*c.xx+b.yy*c.yx;d.yy=b.yx*c.xy+b.yy*c.yy;d.dx=b.xx*c.dx+b.xy*c.dy+b.dx;d.dy=b.yx*c.dx+b.yy*c.dy+b.dy}f.mixin(this,d)}}else f.mixin(this,
a)};f.extend(h.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});f.mixin(h,{identity:new h.Matrix2D,flipX:new h.Matrix2D({xx:-1}),flipY:new h.Matrix2D({yy:-1}),flipXY:new h.Matrix2D({xx:-1,yy:-1}),translate:function(a,d){return 1<arguments.length?new h.Matrix2D({dx:a,dy:d}):new h.Matrix2D({dx:a.x,dy:a.y})},scale:function(a,d){return 1<arguments.length?new h.Matrix2D({xx:a,yy:d}):"number"==typeof a?new h.Matrix2D({xx:a,yy:a}):new h.Matrix2D({xx:a.x,yy:a.y})},rotate:function(a){var d=Math.cos(a);a=Math.sin(a);
return new h.Matrix2D({xx:d,xy:-a,yx:a,yy:d})},rotateg:function(a){return h.rotate(h._degToRad(a))},skewX:function(a){return new h.Matrix2D({xy:Math.tan(a)})},skewXg:function(a){return h.skewX(h._degToRad(a))},skewY:function(a){return new h.Matrix2D({yx:Math.tan(a)})},skewYg:function(a){return h.skewY(h._degToRad(a))},reflect:function(a,d){1==arguments.length&&(d=a.y,a=a.x);var e=a*a,b=d*d,c=e+b,g=2*a*d/c;return new h.Matrix2D({xx:2*e/c-1,xy:g,yx:g,yy:2*b/c-1})},project:function(a,d){1==arguments.length&&
(d=a.y,a=a.x);var e=a*a,b=d*d,c=e+b,g=a*d/c;return new h.Matrix2D({xx:e/c,xy:g,yx:g,yy:b/c})},normalize:function(a){return a instanceof h.Matrix2D?a:new h.Matrix2D(a)},isIdentity:function(a){return 1==a.xx&&0==a.xy&&0==a.yx&&1==a.yy&&0==a.dx&&0==a.dy},clone:function(a){var d=new h.Matrix2D,e;for(e in a)"number"==typeof a[e]&&"number"==typeof d[e]&&d[e]!=a[e]&&(d[e]=a[e]);return d},invert:function(a){a=h.normalize(a);var d=a.xx*a.yy-a.xy*a.yx;return a=new h.Matrix2D({xx:a.yy/d,xy:-a.xy/d,yx:-a.yx/
d,yy:a.xx/d,dx:(a.xy*a.dy-a.yy*a.dx)/d,dy:(a.yx*a.dx-a.xx*a.dy)/d})},_multiplyPoint:function(a,d,e){return{x:a.xx*d+a.xy*e+a.dx,y:a.yx*d+a.yy*e+a.dy}},multiplyPoint:function(a,d,e){a=h.normalize(a);return"number"==typeof d&&"number"==typeof e?h._multiplyPoint(a,d,e):h._multiplyPoint(a,d.x,d.y)},multiplyRectangle:function(a,d){var e=h.normalize(a);d=d||{x:0,y:0,width:0,height:0};if(h.isIdentity(e))return{x:d.x,y:d.y,width:d.width,height:d.height};a=h.multiplyPoint(e,d.x,d.y);var b=h.multiplyPoint(e,
d.x,d.y+d.height),c=h.multiplyPoint(e,d.x+d.width,d.y);d=h.multiplyPoint(e,d.x+d.width,d.y+d.height);var e=Math.min(a.x,b.x,c.x,d.x),g=Math.min(a.y,b.y,c.y,d.y);return{x:e,y:g,width:Math.max(a.x,b.x,c.x,d.x)-e,height:Math.max(a.y,b.y,c.y,d.y)-g}},multiply:function(a){for(var d=h.normalize(a),e=1;e<arguments.length;++e){var b=d,c=h.normalize(arguments[e]),d=new h.Matrix2D;d.xx=b.xx*c.xx+b.xy*c.yx;d.xy=b.xx*c.xy+b.xy*c.yy;d.yx=b.yx*c.xx+b.yy*c.yx;d.yy=b.yx*c.xy+b.yy*c.yy;d.dx=b.xx*c.dx+b.xy*c.dy+b.dx;
d.dy=b.yx*c.dx+b.yy*c.dy+b.dy}return d},_sandwich:function(a,d,e){return h.multiply(h.translate(d,e),a,h.translate(-d,-e))},scaleAt:function(a,d,e,b){switch(arguments.length){case 4:return h._sandwich(h.scale(a,d),e,b);case 3:return"number"==typeof e?h._sandwich(h.scale(a),d,e):h._sandwich(h.scale(a,d),e.x,e.y)}return h._sandwich(h.scale(a),d.x,d.y)},rotateAt:function(a,d,e){return 2<arguments.length?h._sandwich(h.rotate(a),d,e):h._sandwich(h.rotate(a),d.x,d.y)},rotategAt:function(a,d,e){return 2<
arguments.length?h._sandwich(h.rotateg(a),d,e):h._sandwich(h.rotateg(a),d.x,d.y)},skewXAt:function(a,d,e){return 2<arguments.length?h._sandwich(h.skewX(a),d,e):h._sandwich(h.skewX(a),d.x,d.y)},skewXgAt:function(a,d,e){return 2<arguments.length?h._sandwich(h.skewXg(a),d,e):h._sandwich(h.skewXg(a),d.x,d.y)},skewYAt:function(a,d,e){return 2<arguments.length?h._sandwich(h.skewY(a),d,e):h._sandwich(h.skewY(a),d.x,d.y)},skewYgAt:function(a,d,e){return 2<arguments.length?h._sandwich(h.skewYg(a),d,e):h._sandwich(h.skewYg(a),
d.x,d.y)}});n.Matrix2D=h.Matrix2D;return h})},"esri/views/2d/libs/gfx/Shape":function(){define("require exports dojox/gfx/_base dojo/_base/lang dojo/_base/Color dojo/dom dojo/dom-attr ./svg ./Surface ../gl-matrix/mat2d".split(" "),function(n,f,h,d,a,l,e,b,c,g){Object.defineProperty(f,"__esModule",{value:!0});n=function(){function f(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null}f.prototype.destroy=function(){if(this.fillStyle&&"type"in
this.fillStyle){var a=this.rawNode.getAttribute("fill");(a=b.getRef(a))&&a.parentNode.removeChild(a)}this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null};f.prototype.getNode=function(){return this.rawNode};f.prototype.getShape=function(){return this.shape};f.prototype.getTransform=function(){return this.matrix};f.prototype.getFill=function(){return this.fillStyle};f.prototype.getStroke=function(){return this.strokeStyle};f.prototype.getParent=function(){return this.parent};
f.prototype.getBoundingBox=function(){return this.bbox};f.prototype.setTransform=function(a){this.matrix=this.matrix?g.copy(this.matrix,a):g.clone(a);return this._applyTransform()};f.prototype.setFill=function(a){if(!a)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var b;if("object"===typeof a&&"type"in a){switch(a.type){case "linear":b=h.makeParameters(h.defaultLinearGradient,a);a=this._setFillObject(b,"linearGradient");a.setAttribute("x1",
b.x1.toFixed(8));a.setAttribute("y1",b.y1.toFixed(8));a.setAttribute("x2",b.x2.toFixed(8));a.setAttribute("y2",b.y2.toFixed(8));break;case "radial":b=h.makeParameters(h.defaultRadialGradient,a);a=this._setFillObject(b,"radialGradient");a.setAttribute("cx",b.cx.toFixed(8));a.setAttribute("cy",b.cy.toFixed(8));a.setAttribute("r",b.r.toFixed(8));break;case "pattern":b=h.makeParameters(h.defaultPattern,a),a=this._setFillObject(b,"pattern"),a.setAttribute("x",b.x.toFixed(8)),a.setAttribute("y",b.y.toFixed(8)),
a.setAttribute("width",b.width.toFixed(8)),a.setAttribute("height",b.height.toFixed(8))}this.fillStyle=b;return this}this.fillStyle=b=h.normalizeColor(a);this.rawNode.setAttribute("fill",b.toCss());this.rawNode.setAttribute("fill-opacity",b.a);this.rawNode.setAttribute("fill-rule","evenodd");return this};f.prototype.setStroke=function(c){var e=this.rawNode;if(!c)return this.strokeStyle=null,e.setAttribute("stroke","none"),e.setAttribute("stroke-opacity",0),this;if("string"===typeof c||d.isArray(c)||
c instanceof a)c={color:c};c=this.strokeStyle=h.makeParameters(h.defaultStroke,c);c.color=h.normalizeColor(c.color);if(c){var g=0>c.width?0:c.width;e.setAttribute("stroke",c.color.toCss());e.setAttribute("stroke-opacity",c.color.a);e.setAttribute("stroke-width",g);e.setAttribute("stroke-linecap",c.cap);"number"===typeof c.join?(e.setAttribute("stroke-linejoin","miter"),e.setAttribute("stroke-miterlimit",c.join)):e.setAttribute("stroke-linejoin",c.join);var f=c.style.toLowerCase();f in b.dasharray&&
(f=b.dasharray[f]);if(f instanceof Array){for(var f=d._toArray(f),k=0;k<f.length;++k)f[k]*=g;if("butt"!==c.cap){for(k=0;k<f.length;k+=2)f[k]-=g,1>f[k]&&(f[k]=1);for(k=1;k<f.length;k+=2)f[k]+=g}f=f.join(",")}e.setAttribute("stroke-dasharray",f);e.setAttribute("dojoGfxStrokeStyle",c.style)}return this};f.prototype._getParentSurface=function(){for(var a=this.parent;a&&!(a instanceof c.default);a=a.parent);return a};f.prototype._setFillObject=function(a,c){var d=b.xmlns.svg;this.fillStyle=a;var e=this._getParentSurface().defNode,
g=this.rawNode.getAttribute("fill");if(g=b.getRef(g))if(g.tagName.toLowerCase()!==c.toLowerCase()){var f=g.id;g.parentNode.removeChild(g);g=b._createElementNS(d,c);g.setAttribute("id",f);e.appendChild(g)}else for(;g.childNodes.length;)g.removeChild(g.lastChild);else g=b._createElementNS(d,c),g.setAttribute("id",h._base._getUniqueId()),e.appendChild(g);if("pattern"===c)g.setAttribute("patternUnits","userSpaceOnUse"),d=b._createElementNS(d,"image"),d.setAttribute("x",0),d.setAttribute("y",0),d.setAttribute("width",
(0>a.width?0:a.width).toFixed(8)),d.setAttribute("height",(0>a.height?0:a.height).toFixed(8)),b._setAttributeNS(d,b.xmlns.xlink,"xlink:href",a.src),g.appendChild(d);else for(g.setAttribute("gradientUnits","userSpaceOnUse"),c=0;c<a.colors.length;++c){var e=a.colors[c],f=b._createElementNS(d,"stop"),k=e.color=h.normalizeColor(e.color);f.setAttribute("offset",e.offset.toFixed(8));f.setAttribute("stop-color",k.toCss());f.setAttribute("stop-opacity",k.a);g.appendChild(f)}this.rawNode.setAttribute("fill",
"url(#"+g.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return g};f.prototype._applyTransform=function(){var a=this.matrix;a?this.rawNode.setAttribute("transform","matrix("+a[0].toFixed(8)+","+a[1].toFixed(8)+","+a[2].toFixed(8)+","+a[3].toFixed(8)+","+a[4].toFixed(8)+","+a[5].toFixed(8)+")"):this.rawNode.removeAttribute("transform");return this};f.prototype.setRawNode=function(a){a=this.rawNode=a;"image"!==this.shape.type&&a.setAttribute("fill",
"none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this};f.prototype.setShape=function(a){this.shape=h.makeParameters(this.shape,a);for(var b in this.shape)if("type"!==b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}this.bbox=null;return this};
f.prototype._moveToFront=function(){this.rawNode.parentNode.appendChild(this.rawNode);return this};f.prototype._moveToBack=function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this};f.prototype._removeClipNode=function(){var a,b=e.get(this.rawNode,"clip-path");b&&(a=l.byId(b.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);return a};f.prototype.moveToFront=function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());
return this};f.prototype.moveToBack=function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this};f.prototype.removeShape=function(a){this.parent&&this.parent.remove(this,a);return this};f.prototype._setParent=function(a,b){this.parent=a;return this._updateParentMatrix(b)};f.prototype._updateParentMatrix=function(a){this.parentMatrix=a?g.clone(a):null;return this._applyTransform()};f.prototype._getRealMatrix=function(){for(var a=g.clone(this.matrix||g.create()),b=
this.parent;b;)b.matrix&&a&&g.multiply(a,b.matrix,a),b=b.parent;return a};return f}();f.default=n})},"esri/views/2d/libs/gfx/Circle":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./Shape","dojox/gfx/_base"],function(n,f,h,d,a){Object.defineProperty(f,"__esModule",{value:!0});n=function(d){function e(b){var c=d.call(this)||this;c.shape=a.getDefault("Circle");c.rawNode=b;return c}h(e,d);e.prototype.getBoundingBox=function(){if(!this.bbox){var a=this.shape;this.bbox=
{x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox};e.nodeType="circle";return e}(d.default);f.default=n})},"esri/views/2d/libs/gfx/Group":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./Container dojox/gfx/_base ./svg ./Circle ./Path ./Image ./Rect ./Text".split(" "),function(n,f,h,d,a,l,e,b,c,g,m){Object.defineProperty(f,"__esModule",{value:!0});n=function(d){function f(){return null!==d&&d.apply(this,arguments)||this}h(f,d);f.prototype.setRawNode=function(a){this.rawNode=
a;this.rawNode.__gfxObject__=this};f.prototype.destroy=function(){d.prototype.clear.call(this,!0);d.prototype.destroy.call(this)};f.prototype.createShape=function(b){switch(b.type){case a.defaultPath.type:return this.createPath(b);case a.defaultRect.type:return this.createRect(b);case a.defaultCircle.type:return this.createCircle(b);case a.defaultImage.type:return this.createImage(b);case a.defaultText.type:return this.createText(b)}console.error("[gfx] unknown shape",b);return null};f.prototype.createGroup=
function(){return this.createObject(f)};f.prototype.createRect=function(a){return this.createObject(g.default,a)};f.prototype.createCircle=function(a){return this.createObject(e.default,a)};f.prototype.createImage=function(a){return this.createObject(c.default,a)};f.prototype.createText=function(a){return this.createObject(m.default,a)};f.prototype.createPath=function(a){return this.createObject(b.default,a)};f.prototype.createObject=function(a,b){if(!this.rawNode)return null;var c=new a;a=l._createElementNS(l.xmlns.svg,
a.nodeType);c.setRawNode(a);c.setShape(b);this.add(c);return c};f.nodeType="g";return f}(d.default);f.default=n})},"esri/views/2d/libs/gfx/Path":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang dojox/gfx/_base dojox/gfx/matrix ./Shape".split(" "),function(n,f,h,d,a,l,e){Object.defineProperty(f,"__esModule",{value:!0});n=function(b){function c(c){var e=b.call(this)||this;e.segments=[];e.tbbox=null;e.absolute=!0;e.last={};e.segmented=!1;e._validSegments={m:2,
l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0};e._2PI=2*Math.PI;e.rawNode=c;e.shape=d.clone(a.defaultPath);return e}h(c,b);c.prototype.setAbsoluteMode=function(a){this._confirmSegmented();this.absolute="string"===typeof a?"absolute"===a:a;return this};c.prototype.getAbsoluteMode=function(){this._confirmSegmented();return this.absolute};c.prototype.getBoundingBox=function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-
this.bbox.t}:null};c.prototype._getRealBBox=function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var a=this.bbox,b=this._getRealMatrix();this.bbox=null;for(var c=this.segments.length,d=0;d<c;++d)this._updateWithSegment(this.segments[d],b);b=this.bbox;this.bbox=a;return this.tbbox=b?[{x:b.l,y:b.t},{x:b.r,y:b.t},{x:b.r,y:b.b},{x:b.l,y:b.b}]:null};c.prototype.getLastPosition=function(){this._confirmSegmented();return"x"in this.last?this.last:null};c.prototype._applyTransform=function(){this.tbbox=
null;b.prototype._applyTransform.call(this);return this};c.prototype._updateBBox=function(a,b,c){c&&(b=l.multiplyPoint(c,a,b),a=b.x,b=b.y);this.bbox&&"l"in this.bbox?(this.bbox.l>a&&(this.bbox.l=a),this.bbox.r<a&&(this.bbox.r=a),this.bbox.t>b&&(this.bbox.t=b),this.bbox.b<b&&(this.bbox.b=b)):this.bbox={l:a,b:b,r:a,t:b}};c.prototype._updateWithSegment=function(b,c){var d=b.args,e=d.length,g;switch(b.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(g=0;g<e;g+=2)this._updateBBox(d[g],
d[g+1],c);this.last.x=d[e-2];this.last.y=d[e-1];this.absolute=!0;break;case "H":for(g=0;g<e;++g)this._updateBBox(d[g],this.last.y,c);this.last.x=d[e-1];this.absolute=!0;break;case "V":for(g=0;g<e;++g)this._updateBBox(this.last.x,d[g],c);this.last.y=d[e-1];this.absolute=!0;break;case "m":g=0;"x"in this.last||(this._updateBBox(this.last.x=d[0],this.last.y=d[1],c),g=2);for(;g<e;g+=2)this._updateBBox(this.last.x+=d[g],this.last.y+=d[g+1],c);this.absolute=!1;break;case "l":case "t":for(g=0;g<e;g+=2)this._updateBBox(this.last.x+=
d[g],this.last.y+=d[g+1],c);this.absolute=!1;break;case "h":for(g=0;g<e;++g)this._updateBBox(this.last.x+=d[g],this.last.y,c);this.absolute=!1;break;case "v":for(g=0;g<e;++g)this._updateBBox(this.last.x,this.last.y+=d[g],c);this.absolute=!1;break;case "c":for(g=0;g<e;g+=6)this._updateBBox(this.last.x+d[g],this.last.y+d[g+1],c),this._updateBBox(this.last.x+d[g+2],this.last.y+d[g+3],c),this._updateBBox(this.last.x+=d[g+4],this.last.y+=d[g+5],c);this.absolute=!1;break;case "s":case "q":for(g=0;g<e;g+=
4)this._updateBBox(this.last.x+d[g],this.last.y+d[g+1],c),this._updateBBox(this.last.x+=d[g+2],this.last.y+=d[g+3],c);this.absolute=!1;break;case "A":for(g=0;g<e;g+=7)this._updateBBox(d[g+5],d[g+6],c);this.last.x=d[e-2];this.last.y=d[e-1];this.absolute=!0;break;case "a":for(g=0;g<e;g+=7)this._updateBBox(this.last.x+=d[g+5],this.last.y+=d[g+6],c);this.absolute=!1}b=[b.action];for(g=0;g<e;++g)b.push(a.formatNumber(d[g],!0));if("string"===typeof this.shape.path)this.shape.path+=b.join("");else for(g=
0,e=b.length;g<e;++g)this.shape.path.push(b[g]);"string"===typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)};c.prototype._pushSegment=function(a,b){this.tbbox=null;var c=this._validSegments[a.toLowerCase()];"number"===typeof c&&(c?b.length>=c&&(a={action:a,args:b.slice(0,b.length-b.length%c)},this.segments.push(a),this._updateWithSegment(a)):(a={action:a,args:[]},this.segments.push(a),this._updateWithSegment(a)))};c.prototype._collectArgs=function(a,b){for(var c=0;c<b.length;++c){var d=
b[c];"boolean"===typeof d?a.push(d?1:0):"number"===typeof d?a.push(d):d instanceof Array?this._collectArgs(a,d):"x"in d&&"y"in d&&a.push(d.x,d.y)}};c.prototype._confirmSegmented=function(){if(!this.segmented){var a=this.shape.path;this.shape.path=[];this._setPath(a);this.shape.path=this.shape.path.join("");this.segmented=!0}};c.prototype._setPath=function(b){b=d.isArray(b)?b:b.match(a.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(b){for(var c="",e=[],g=b.length,f=0;f<
g;++f){var h=b[f],l=parseFloat(h);isNaN(l)?(c&&this._pushSegment(c,e),e=[],c=h):e.push(l)}this._pushSegment(c,e)}};c.prototype.setShape=function(a){b.prototype.setShape.call(this,"string"===typeof a?{path:a}:a);this.segmented=!1;this.segments=[];this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this};c.nodeType="path";return c}(e.default);f.default=n})},"esri/views/2d/libs/gfx/Image":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojox/gfx/_base ./Shape ./svg".split(" "),
function(n,f,h,d,a,l){Object.defineProperty(f,"__esModule",{value:!0});n=function(a){function b(b){var c=a.call(this)||this;c.shape=d.getDefault("Image");c.rawNode=b;return c}h(b,a);b.prototype.setShape=function(a){this.shape=d.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)if("type"!==b&&"src"!==b){var c=this.shape[b];if("width"===b||"height"===b)c=0>c?0:c;a.setAttribute(b,c)}a.setAttribute("preserveAspectRatio","none");l._setAttributeNS(a,l.xmlns.xlink,"xlink:href",
this.shape.src);a.__gfxObject__=this;return this};b.prototype.getBoundingBox=function(){return this.shape};b.prototype.setStroke=function(){return this};b.prototype.setFill=function(){return this};b.nodeType="image";return b}(a.default);f.default=n})},"esri/views/2d/libs/gfx/Rect":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","dojox/gfx/_base","./Shape"],function(n,f,h,d,a){Object.defineProperty(f,"__esModule",{value:!0});n=function(a){function e(b){var c=a.call(this)||
this;c.shape=d.getDefault("Rect");c.rawNode=b;return c}h(e,a);e.prototype.getBoundingBox=function(){return this.shape};e.prototype.setShape=function(a){this.shape=d.makeParameters(this.shape,a);this.bbox=null;for(var b in this.shape)if("type"!==b&&"r"!==b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this};e.nodeType="rect";return e}(a.default);
f.default=n})},"esri/views/2d/libs/gfx/Text":function(){define("require exports ../../../../core/tsSupport/extendsHelper dojo/has dojox/gfx/_base ./Shape ./svg".split(" "),function(n,f,h,d,a,l,e){Object.defineProperty(f,"__esModule",{value:!0});n=d("android");var b=d("chrome")||n&&4<=n?"auto":"optimizeLegibility";d=function(c){function d(b){var d=c.call(this)||this;d.fontStyle=null;d.shape=a.getDefault("Text");d.rawNode=b;return d}h(d,c);d.prototype.getFont=function(){return this.fontStyle};d.prototype.setFont=
function(b){this.fontStyle="string"===typeof b?a.splitFontString(b):a.makeParameters(a.defaultFont,b);this._setFont();return this};d.prototype._setFont=function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-variant",a.variant);this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)};d.prototype.setShape=function(c){this.shape=a.makeParameters(this.shape,
c);this.bbox=null;c=this.rawNode;var d=this.shape;c.setAttribute("x",d.x);c.setAttribute("y",d.y);c.setAttribute("text-anchor",d.align);c.setAttribute("text-decoration",d.decoration);c.setAttribute("rotate",d.rotated?90:0);c.setAttribute("kerning",d.kerning?"auto":0);c.setAttribute("text-rendering",b);c.firstChild?c.firstChild.nodeValue=d.text:c.appendChild(e._createTextNode(d.text));return this};d.prototype.getTextWidth=function(){var a=this.rawNode,b=a.parentNode,a=a.cloneNode(!0);a.style.visibility=
"hidden";var c=0,d=a.firstChild.nodeValue;b.appendChild(a);if(""!==d)for(;!c;)c=a.getBBox?parseInt(a.getBBox().width,10):68;b.removeChild(a);return c};d.prototype.getBoundingBox=function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(k){a={x:0,y:0,width:0,height:0}}return a};d.nodeType="text";return d}(l.default);f.default=d})},"esri/views/2d/engine/graphics/Projector":function(){define(["require","exports"],function(n,f){function h(d,b,c,g,f){void 0===g&&(g=0);void 0===f&&
(f=d.length);for(var e=d[g],m=d[f-1],p=0,n=0,r,t=g+1;t<f-1;t++){var v=d[t];r=v[0];var v=v[1],w=e[0],A=e[1],E=m[0],D=m[1];w===E?r=a(r-w):(E=(D-A)/(E-w),r=a(E*r-v+(A-E*w))/l(E*E+1));r>p&&(n=t,p=r)}p>b?(h(d,b,c,g,n+1),h(d,b,c,n,f)):(c(e[0],e[1]),c(m[0],m[1]))}var d=Math.round,a=Math.abs,l=Math.sqrt;return function(){function a(){this._transform=null}a.prototype.update=function(a,c){this._transform=a;this._resolution=c};a.prototype.toScreenPoint=function(a,c,d){this.transformPoint(c.x+d*this._resolution,
c.y,function(b,c){a.x=b;a.y=c});return a};a.prototype.toScreenPath=function(a,c){var b=this,d=null!=a.paths;a=d?a.paths:a.rings;var e="",f=function(a,d){a+=c*b._resolution;b.transformPoint(a,d,function(a,b){isNaN(a)||isNaN(b)||(e+=a,e+=",",e+=b,e+=" ")})};if(a)for(var l=a.length,n=0;n<l;n++)e+="M ",h(a[n],this._resolution,f),d||(e+="Z ");return e};a.prototype.transformPoint=function(a,c,e){var b=this._transform,g=b[1],f=b[3],h=b[5];e(d(b[0]*a+b[2]*c+b[4]),d(g*a+f*c+h))};return a}()})},"esri/views/2d/engine/cssUtils":function(){define(["require",
"exports","dojo/has"],function(n,f,h){function d(a){return"matrix3d(\n                    "+a[0].toFixed(10)+", "+a[1].toFixed(10)+", 0, 0,\n                    "+a[2].toFixed(10)+", "+a[3].toFixed(10)+", 0, 0,\n                    0, 0, 1, 0,\n                    "+Math.round(a[4]).toFixed(10)+", "+Math.round(a[5]).toFixed(10)+", 0, 1\n                  )"}function a(a){return"translate("+Math.round(a[0])+"px, "+Math.round(a[1])+"px)"}function l(a){return"rotateZ( "+a+" deg)"}Object.defineProperty(f,
"__esModule",{value:!0});n=h("ff");var e=h("ie"),b=h("webkit");h=h("opera");var c=b&&"-webkit-transform"||n&&"-moz-transform"||h&&"-o-transform"||e&&"-ms-transform"||"transform";f.clip=function(a,b){a.clip=b?"rect( "+b.top+"px, "+b.right+"px, "+b.bottom+"px, "+b.left+"px)":""};f.setTransform=function(b,e){var g=null;2===e.length&&(g=a(e));6===e.length&&(g=d(e));b.transform=b[c]=g};f.setOrigin=function(a,b){a.transformOrigin=b[0]+"px "+b[1]+"px 0"};f.cssMatrix=function(a){return"matrix(\n                  "+
a[0].toFixed(10)+", "+a[1].toFixed(10)+",\n                  "+a[2].toFixed(10)+", "+a[3].toFixed(10)+",\n                  "+a[4]+", "+a[5]+"\n                )"};f.cssMatrix3d=d;f.translate=a;f.rotate=function(a){return l(a.toFixed(3))};f.rotateZ=l})},"esri/views/2d/engine/graphics/GFXGroup":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","dojo/_base/lang","../Container"],function(n,f,h,d,a){return function(a){function e(){return null!==a&&a.apply(this,arguments)||
this}h(e,a);e.prototype.attach=function(b){this.g=b.surface.createGroup();return a.prototype.attach.call(this,b)};e.prototype.detach=function(b){a.prototype.detach.call(this,b);this.g.destroy();this.g=null};e.prototype.prepareChildrenRenderParameters=function(a){return d.mixin({},a,{surface:this.g})};e.prototype.detachChild=function(a,c){return a.detach(c)};e.prototype.attachChild=function(a,c){return a.attach(c)};e.prototype.renderChild=function(a,c){return a.processRender(c)};return e}(a)})},"esri/views/2d/engine/graphics/GFXObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../geometry/Extent ../../../../geometry/support/webMercatorUtils ../../../../geometry/support/spatialReferenceUtils ../DisplayObject ./gfxUtils".split(" "),
function(n,f,h,d,a,l,e,b){var c=new Set,g=[];return function(e){function f(){var a=null!==e&&e.apply(this,arguments)||this;a._prevStateId=null;a.visible=!0;return a}h(f,e);Object.defineProperty(f.prototype,"graphic",{get:function(){return this._graphic},set:function(a){this._geometry=(this._graphic=a)&&a.geometry||null;this._projected=null;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"geometry",{get:function(){return this._geometry},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"isPolygonMarkerSymbol",{get:function(){var a=this.renderingInfo.symbol.type,b=this.geometry;return b&&"polygon"===b.type&&("simple-marker"===a||"picture-marker"===a||"text"===a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"renderingInfo",{get:function(){return this._renderingInfo},set:function(a){this._renderingInfo=a;this.requestRender()},enumerable:!0,configurable:!0});f.prototype.detach=function(){this._removeShape();this._drawInfo=this._projected=
null};f.prototype.doRender=function(a){var c=a.surface,d=a.state,e=a.projector,g=this._prevStateId!==d.id;if(this.renderRequested||g)if(g&&a.stationary&&(this._prevStateId=d.id),g=this.visible&&this._projectGeometry(this.geometry,a.state.spatialReference),a=this._getScreenOffsets([],a.state),b.isShapeInvalid(this.renderingInfo.symbol,this._shape)&&this._removeShape(),a.length){var f=this._shape,h=g.type;if(!f||this._showRedraw(a,d))"point"===h?(f=b.drawPoint(e,c,g,f,this.renderingInfo,d.rotation,
a),b.stylePoint(f,this.renderingInfo)):"multipoint"===h?(f=b.drawMarkers(e,c,g,f,this.renderingInfo,d.rotation,a),b.styleMarkers(f,this.renderingInfo)):(f=b.drawShape(e,c,g,f,a),b.styleShape(f,this.renderingInfo)),this._shape=f,f.getNode().gfxObject=this}else this._removeShape()};f.prototype._getScreenOffsets=function(a,b){var d=b.clippedExtent,e=this._projected.outExtent,f=b.spatialReference;a.length=0;if(!e)return a;if(f.isWrappable){var f=l.getInfo(f),h=e.cache._partwise,d=d._getParts(f);g.length=
0;if(h&&h.length)for(e=0;e<h.length;e++)g.push.apply(g,h[e]._getParts(f));else g.push.apply(g,e._getParts(f));b=b.worldScreenWidth;a.length=0;c.clear();e=g.length;for(f=0;f<e;f++)for(var k=g[f],h=k.extent,k=k.frameIds,m=k.length,q=d.length,p=0;p<q;p++){var n=d[p];if(n.extent.intersects(h))for(var B=m,H=0;H<B;H++){var z=(n.frameIds[0]-k[H])*b;c.has(z)||(a.push(z),c.add(z))}}a.sort()}else d.intersects(e)&&a.push(0);return a};f.prototype._projectGeometry=function(b,c){var d=this._projected;b=this.isPolygonMarkerSymbol?
b.centroid:b;if(d&&d.inGeometry===b&&d.outSpatialReference===c)return d.outGeometry;b&&b.spatialReference.equals(c)?this._projected={inGeometry:b,outGeometry:b,outSpatialReference:c,outExtent:this._getExtent(b)}:a.canProject(b,c)?this._projected={inGeometry:b,outGeometry:a.project(b,c),outSpatialReference:c,outExtent:this._getExtent(b)}:this._projected={inGeometry:b,outGeometry:null,outSpatialReference:c,outExtent:null};return this._projected.outGeometry};f.prototype._getExtent=function(a){var b=
a.extent;if(!b){var c=b=void 0;"esri.geometry.Point"===a.declaredClass?(b=a.x,c=a.y):"esri.geometry.Multipoint"===a.declaredClass&&(b=a.points[0][0],c=a.points[0][1]);b=new d(b,c,b,c,a.spatialReference)}return b};f.prototype._removeShape=function(){var a=this._shape;a&&(a.removeShape(),a.getNode().gfxObject=null,a.destroy());this._shape=this._drawInfo=null};f.prototype._showRedraw=function(a,b){return!0};return f}(e)})},"esri/views/2d/engine/graphics/gfxUtils":function(){define("require exports dojo/_base/lang ../../libs/gl-matrix/mat2d ../../libs/gl-matrix/mat2dExtras ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../symbols/SimpleMarkerSymbol ../../../../symbols/support/gfxUtils ../../../../Color".split(" "),
function(n,f,h,d,a,l,e,b,c,g){function m(a,b){b.toRgba?(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a):(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]);return a}function k(a,b,c){null!=c&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=c);return a}function q(a,b,c){var d=b[0]/b[1];a[0]=a[1]=1;isNaN(c)||(1<d?(a[0]=c/b[0],a[1]=c/d/b[1]):(a[1]=c/b[1],a[0]=c*d/b[0]));return a}function p(e,g,f,h,k,m,p){var n=k.symbol;f=e.toScreenPoint(D,f,p[0]);p=[f.x,f.y];e=f.x;f=f.y;var w=k.heading,C=k.size&&k.size[0],z,y;d.identity(x);"number"===
typeof C&&(y=isFinite(C)&&C);y=(C=y&&isFinite(y)&&!isNaN(y))?l.pt2px(y):NaN;m&&a.rotategAt(x,x,m,p);w&&a.rotategAt(x,x,w,p);m=l.pt2px(n.xoffset);var w=l.pt2px(n.yoffset),G;if(0!==m||0!==w)G=[m,-w];m=null;0!==n.angle&&(m=d.create(),a.rotategAt(m,m,n.angle,p));var B;if("simple-marker"===n.type)switch(z=n.style,k=Math.round,y=C?y:l.pt2px(n.size),C=void 0,z){case b.STYLE_SQUARE:case b.STYLE_CROSS:case b.STYLE_X:case b.STYLE_DIAMOND:C=isNaN(y)?16:.5*y;z=t(g,h,A(z,e,f,k(e-C),k(e+C),k(f-C),k(f+C)));break;
case b.STYLE_PATH:z=B=t(g,h,n.path);B=B.getBoundingBox();n=q(d.create(),[B.width,B.height],y);1===n[0]&&1===n[3]||a.scaleAt(x,x,n,p);B=[-(B.x+.5*B.width)+e,-(B.y+.5*B.height)+f];break;default:C=isNaN(y)?16:.5*y,z=r(g,h,{cx:e,cy:f,r:C})}else if("picture-marker"===n.type){p=z=null;var w=l.pt2px(n.width),E=l.pt2px(n.height);C?(p=y,z=w/E*p):(z=w,p=E);G&&(null!=G[0]&&(G[0]=G[0]/w*z),null!=G[1]&&(G[1]=G[1]/E*p));z=u(g,h,{x:e-.5*z,y:f-.5*p,width:z,height:p,src:n.url});(y=z.getNode())&&(null!=k.opacity?y.setAttribute("opacity",
k.opacity.toString()):y.setAttribute("opacity","1"))}else if("text"===n.type){if(k=n.font&&n.font.clone())k.size=C?y:l.pt2px(k.size);z=v(g,h,{type:"text",text:n.text,x:e,y:f,align:c.getSVGAlign(n),decoration:n.decoration||k&&k.decoration,rotated:n.rotated,kerning:n.kerning});k&&z.setFont(k);y=z.getNode();g=c.getSVGBaseline(n);n=c.getSVGBaselineShift(n);y&&(y.setAttribute("dominant-baseline",g),n&&y.setAttribute("baseline-shift",n))}G&&d.translate(x,x,G);m&&d.multiply(x,x,m);B&&d.translate(x,x,B);
z.setTransform(x);return z}function u(a,b,c){return b?b.setShape(c):a.createImage(c)}function r(a,b,c){return b?b.setShape(c):a.createCircle(c)}function t(a,b,c){c=Array.isArray(c)?c.join(" "):c;return b?b.setShape(c):a.createPath(c)}function v(a,b,c){return b?b.setShape(c):a.createText(c)}function w(a,b){b=b&&b.shape&&b.shape.type;var c=a&&a.type;a=a&&a.style;c&&(a=B[c]||a);H[a]&&(a="path");return!(!b||!a||b===a)}function A(a,c,d,e,g,f,h,k){switch(a){case b.STYLE_SQUARE:return["M",e+","+f,g+","+
f,g+","+h,e+","+h,"Z"];case b.STYLE_CROSS:return["M",c+","+f,c+","+h,"M",e+","+d,g+","+d];case b.STYLE_X:return["M",e+","+f,g+","+h,"M",e+","+h,g+","+f];case b.STYLE_DIAMOND:return["M",c+","+f,g+","+d,c+","+h,e+","+d,"Z"];case b.STYLE_TARGET:return["M",e+","+f,g+","+f,g+","+h,e+","+h,e+","+f,"M",e-k+","+d,e+","+d,"M",c+","+(f-k),c+","+f,"M",g+k+","+d,g+","+d,"M",c+","+(h+k),c+","+h]}}function E(a,d){var e=d.symbol;if("picture-marker"!==e.type){var g=c.getFill(e);if("simple-marker"===e.type){var f=
e.style,l=(e=c.getStroke(e))&&e.color,f=f===b.STYLE_X||f===b.STYLE_CROSS,q=d.opacity;(d=d.color||m([0,0,0,0],f?l:g))&&null!=q&&(d=k([0,0,0,0],d,q));d&&(f?d!==l&&(e=e?h.mixin({},e):{},e.color=d):d!==g&&(g=d));a.setFill(g).setStroke(e)}else"text"===e.type&&(q=d.opacity,(d=d.color||m([0,0,0,0],g))&&null!=q&&(d=k([0,0,0,0],d,q)),d&&d!==g&&(g=d),a.setFill(g))}}Object.defineProperty(f,"__esModule",{value:!0});f.getScalingVector=q;var D={x:0,y:0},x=d.create();f.drawPoint=p;f.drawMarkers=function(a,b,c,d,
e,g,f){var h=e.symbol;c=c.points;b=d||b.createGroup();d=[0];b.children[0]&&w(h,b.children[0])&&b.clear();for(var k=0,m=c.length,h=0;h<m;h++)for(var l=c[h],q=f.length,n=0;n<q;n++)d[0]=f[n],b.add(p(a,b,{x:l[0],y:l[1]},b.children[k++],e,g,d));a=b.children.length;if(c.length*f.length<a)for(f=c.length*f.length,h=a-1;h>=f;h--)b.children[h].removeShape();return b};f.drawShape=function(a,b,c,d,g){var f=[];"extent"===c.type&&(c=e.fromExtent(c));if("polyline"===c.type||"polygon"===c.type){for(var h=g.length,
k=0;k<h;k++)f=f.concat(a.toScreenPath(c,g[k]));d=t(b,d,f)}return d};f.drawRect=function(a,b,c){return b?b.setShape(c):a.createRect(c)};f.drawImage=u;f.drawCircle=r;f.drawPath=t;f.drawText=v;var B={"picture-marker":"image","picture-fill":"path","simple-fill":"path","simple-line":"path",text:"text"},H={square:1,cross:1,x:1,diamond:1,target:1};f.isShapeInvalid=w;f.smsToPath=A;f.stylePoint=E;f.styleMarkers=function(a,b){for(var c=a.children.length,d=0;d<c;d++)E(a.children[d],b)};f.styleShape=function(a,
b){var d=b.symbol,e=b.size,f=b.color,q=b.opacity,p=c.getStroke(d),n=c.getFill(d),r=!1,t;"simple-line"===d.type?(r=!0,t="none"!==d.style):t=d.outline&&"none"!==d.outline.style;var w,v,u;e&&(u=isFinite(e[0])&&e[0]);null!=e&&(u=l.pt2px(u));b="picture-fill"===d.type;!f&&null==q||b||(r?(w=f||p&&p.color&&m([0,0,0,0],p.color))&&null!=q&&(w=k(w,w,q)):n&&(v=f||m([0,0,0,0],n))&&null!=q&&(v=k(v,v,q)));!t||null==e&&!w?a.setStroke(p):a.setStroke(h.mixin({},p,null!=u?{width:u}:null,w&&{color:w}));d=f&&new g(f)||
d.color;n&&"pattern"===n.type&&d&&!b?c.getPatternUrlWithColor(n.src,d.toCss(!0)).then(function(b){n.src=b;a.setFill(n)}):a.setFill(v||n);a.rawNode.setAttribute("vector-effect","non-scaling-stroke")}})},"esri/views/2d/libs/gl-matrix/mat2dExtras":function(){define(["require","exports","./mat2d","./vec2","./common"],function(n,f,h,d,a){Object.defineProperty(f,"__esModule",{value:!0});var l=function(){var a=h.create(),b=d.create();return function(c,e,f){h.fromTranslation(a,f);h.multiply(c,a,e);d.negate(b,
f);h.translate(c,c,b);return c}}();f.rotategAt=function(){var d=h.create();return function(b,c,e,f){h.fromRotation(d,a.toRadian(e));l(d,d,f);h.multiply(b,d,c);return b}}();f.scaleAt=function(){var a=h.create();return function(b,c,d,e){h.fromScaling(a,d);l(a,a,e);h.multiply(b,a,c);return b}}()})},"esri/symbols/support/gfxUtils":function(){define("require exports dojo/_base/lang dojox/gfx/_base ../../Color ../../core/screenUtils ../../request ../../core/promiseUtils ../../core/LRUMap".split(" "),function(n,
f,h,d,a,l,e,b,c){function g(a){if(!a)return null;var b,c=a.constructor,d=l.pt2px(a.width);switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":b=g(a.outline);break;case "simple-line":a.style!==c.STYLE_NULL&&0!==d&&(b={color:a.color,style:u(a.style),width:d,cap:a.cap,join:a.join===c.JOIN_MITER?l.pt2px(a.miterLimit):a.join});break;default:b=null}return b}Object.defineProperty(f,"__esModule",{value:!0});var m=n.toUrl("../../symbols/patterns/"),k={left:"start",center:"middle",right:"end",
justify:"start"},q={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},p=new c(1E3);f.getSVGAlign=function(a){return a=(a=a.horizontalAlignment)&&k[a.toLowerCase()]||"middle"};f.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&q[a.toLowerCase()]||"alphabetic"};f.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};f.getFill=function(a){var b=a.style,c=null;if(a){var e=a.constructor;switch(a.type){case "simple-marker":b!==
e.STYLE_CROSS&&b!==e.STYLE_X&&(c=a.color);break;case "simple-fill":b===e.STYLE_SOLID?c=a.color:b!==e.STYLE_NULL&&(c=h.mixin({},d.defaultPattern,{src:m+b+".png",width:8,height:8}));break;case "picture-fill":c=h.mixin({},d.defaultPattern,{src:a.url,width:l.pt2px(a.width)*a.xscale,height:l.pt2px(a.height)*a.yscale,x:l.pt2px(a.xoffset),y:l.pt2px(a.yoffset)});break;case "text":c=a.color}}return c};f.getPatternUrlWithColor=function(a,c){var d=a+"-"+c;return p.has(d)?b.resolve(p.get(d)):e(a,{responseType:"image",
allowImageDataAccess:!0}).then(function(a){a=a.data;var b=a.naturalWidth,e=a.naturalHeight,g=document.createElement("canvas");g.width=b;g.height=e;var f=g.getContext("2d");f.fillStyle=c;f.fillRect(0,0,b,e);f.globalCompositeOperation="destination-in";f.drawImage(a,0,0);a=g.toDataURL();p.set(d,a);return a})};f.getStroke=g;var u=function(){var a={};return function(b){if(a[b])return a[b];var c=b.replace(/-/g,"");return a[b]=c}}();f.defaultThematicColor=new a([128,128,128])})},"esri/views/2d/input/MapViewInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/watchUtils ../../../core/Accessor ../../../core/HandleRegistry ../../../core/accessorSupport/decorators ../../input/InputManager ../../input/BrowserEventSource ../../input/ViewEvents ../../input/handlers/PreventContextMenu ../input/handlers/DoubleClickZoom ../input/handlers/DragPan ../input/handlers/DragRotate ../input/handlers/KeyPan ../input/handlers/KeyZoom ../input/handlers/KeyRotate ../input/handlers/MouseWheelZoom ../input/handlers/PinchAction".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r,t,v,w,A){var E={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},D={zoomIn:["\x3d","+"],zoomOut:["-","_"]},x={dragRotate:"Alt",clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};return function(f){function l(){var a=null!==f&&f.apply(this,arguments)||this;a._handles=new e;return a}h(l,f);l.prototype.initialize=function(){var b=this;this.viewEvents=new m.ViewEvents(this.view);
this._handles.add([a.whenNot(this.view,"ready",function(){return b._disconnect()}),a.when(this.view,"ready",function(){return b._connect()})])};l.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect();this.viewEvents.destroy();this.viewEvents=null};l.prototype._disconnect=function(){this._inputManager&&(this.viewEvents.disconnect(),this._source.destroy(),this._inputManager.destroy(),this._inputManager=this._source=null)};l.prototype._connect=
function(){var a=new g.BrowserEventSource(this.view.surface),b=new c.InputManager(a);b.installHandlers("prevent-context-menu",[new k.PreventContextMenu]);b.installHandlers("navigation",[new A.PinchRotateAndZoom(this.view),new w.MouseWheelZoom(this.view),new q.DoubleClickZoom(this.view),new p.DragPan(this.view,"primary"),new r.KeyPan(this.view,E),new t.KeyZoom(this.view,D),new v.KeyRotate(this.view,x),new u.DragRotate(this.view,"secondary"),new q.DoubleClickZoom(this.view,["Ctrl"]),new u.DragRotate(this.view,
"primary",[x.dragRotate])]);this.viewEvents.connect(b);this._source=a;this._inputManager=b};d([b.property()],l.prototype,"view",void 0);return l=d([b.subclass("esri.views.2d.input.MapViewInputManager")],l)}(b.declared(l))})},"esri/views/2d/input/handlers/DoubleClickZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(n,f,h,d,a){Object.defineProperty(f,"__esModule",{value:!0});n=function(d){function e(a,
c){var b=d.call(this,"esri.views.2d.input.handlers.DoubleClickZoom",!0)||this;b.view=a;b.registerIncoming("double-click",c,function(a){return b._handleDoubleClick(a,c)});return b}h(e,d);e.prototype._handleDoubleClick=function(b,c){a.eventMatchesPointerType(b.data.native,"primary")&&(b.stopPropagation(),c?this.view.navigation.zoomOut([b.data.x,b.data.y]):this.view.navigation.zoomIn([b.data.x,b.data.y]))};return e}(d.InputHandler);f.DoubleClickZoom=n})},"esri/views/2d/input/handlers/DragPan":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(n,f,h,d,a){Object.defineProperty(f,"__esModule",{value:!0});n=function(d){function e(a,c,e){var b=d.call(this,"esri.views.2d.input.handlers.DragPan - "+c,!0)||this;b.view=a;b.pointerType=c;b.registerIncoming("drag",e,function(a){return b._handleDrag(a)});b.registerIncoming("pointer-down",function(a){return b.stopMomentumNavigation()});return b}h(e,d);e.prototype._handleDrag=
function(b){var c=b.data,d=this.view.navigation;if(1<c.pointers.length||d.pinch.zoomMomentum||d.pinch.rotateMomentum)this.stopMomentumNavigation();else if(a.eventMatchesPointerType(c.pointers[0].startEvent.native,this.pointerType)){d=d.pan;switch(c.action){case "start":d.begin(this.view,c);break;case "update":d.update(this.view,c);break;case "end":d.end(this.view,c)}b.stopPropagation()}};e.prototype.stopMomentumNavigation=function(){this.view.navigation.pan.stopMomentumNavigation()};return e}(d.InputHandler);
f.DragPan=n})},"esri/views/2d/input/handlers/DragRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(n,f,h,d,a){Object.defineProperty(f,"__esModule",{value:!0});n=function(d){function e(a,c,e){var b=d.call(this,"esri.views.2d.input.handlers.DragRotate - "+c,!0)||this;b.view=a;b.pointerType=c;b.registerIncoming("drag",e,function(a){return b._handleDrag(a)});return b}h(e,d);e.prototype._handleDrag=
function(b){var c=b.data;if(!(1<c.pointers.length)&&a.eventMatchesPointerType(c.pointers[0].startEvent.native,this.pointerType)){var d=this.view.navigation.rotate;switch(c.action){case "start":d.begin(this.view,c);break;case "update":d.update(this.view,c);break;case "end":d.end(this.view,c)}b.stopPropagation()}};return e}(d.InputHandler);f.DragRotate=n})},"esri/views/2d/input/handlers/KeyPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],
function(n,f,h,d){Object.defineProperty(f,"__esModule",{value:!0});n=function(a){function d(d,b,c){var e=a.call(this,"esri.views.2d.input.handlers.KeyPan",!0)||this;e.view=d;e.keys=b;e._keyMap=(f={},f[b.left]="left",f[b.right]="right",f[b.up]="up",f[b.down]="down",f);e.registerIncoming("key-down",c,function(a){return e._handleKeyDown(a)});e.registerIncoming("key-up",c,function(a){return e._handleKeyUp(a)});return e;var f}h(d,a);d.prototype._handleKeyDown=function(a){a.data.repeat||this._handleKey(a,
!0)};d.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};d.prototype._handleKey=function(a,b){var c=this._keyMap[a.data.key];if(null!=c){if(b)switch(c){case "left":this.view.navigation.continousPanLeft();break;case "right":this.view.navigation.continousPanRight();break;case "up":this.view.navigation.continousPanUp();break;case "down":this.view.navigation.continousPanDown()}else this.view.navigation.stop();a.stopPropagation()}};return d}(d.InputHandler);f.KeyPan=n})},"esri/views/2d/input/handlers/KeyZoom":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(n,f,h,d){Object.defineProperty(f,"__esModule",{value:!0});var a;(function(a){a[a.IN=0]="IN";a[a.OUT=1]="OUT"})(a||(a={}));n=function(d){function e(b,c,e){var g=d.call(this,"esri.views.2d.input.handlers.KeyZoom",!0)||this;g.view=b;g.keys=c;g._keysToZoomAction={};g.registerIncoming("key-down",e,function(a){return g._handleKeyDown(a)});c.zoomIn.forEach(function(b){return g._keysToZoomAction[b]=a.IN});c.zoomOut.forEach(function(b){return g._keysToZoomAction[b]=
a.OUT});return g}h(e,d);e.prototype._handleKeyDown=function(a){this._handleKey(a)};e.prototype._handleKey=function(b){var c=b.modifiers;0<c.size&&!c.has("Shift")||(c=this._keysToZoomAction[b.data.key],c===a.IN?(this.view.navigation.zoomIn(),b.stopPropagation()):c===a.OUT&&(this.view.navigation.zoomOut(),b.stopPropagation()))};return e}(d.InputHandler);f.KeyZoom=n})},"esri/views/2d/input/handlers/KeyRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],
function(n,f,h,d){Object.defineProperty(f,"__esModule",{value:!0});n=function(a){function d(d,b,c){var e=a.call(this,"esri.views.2d.input.handlers.KeyRotate",!0)||this;e.view=d;e.keys=b;e._keyToDirection=(f={},f[b.clockwiseOption1]="clockwise",f[b.clockwiseOption2]="clockwise",f[b.counterClockwiseOption1]="counterClockwise",f[b.counterClockwiseOption2]="counterClockwise",f[b.resetOption1]="reset",f[b.resetOption2]="reset",f);e.registerIncoming("key-down",c,function(a){return e._handleKeyDown(a)});
e.registerIncoming("key-up",c,function(a){return e._handleKeyUp(a)});return e;var f}h(d,a);d.prototype._handleKeyDown=function(a){a.data.repeat||this._handleKey(a,!0)};d.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};d.prototype._handleKey=function(a,b){var c=a.modifiers;0<c.size&&!c.has("Shift")||!this.view.constraints.rotationEnabled||!(c=this._keyToDirection[a.data.key])||(b?"clockwise"===c?this.view.navigation.continousRotateClockwise():"counterClockwise"===c?this.view.navigation.continousRotateCounterclockwise():
this.view.navigation.resetRotation():this.view.navigation.stop(),a.stopPropagation())};return d}(d.InputHandler);f.KeyRotate=n})},"esri/views/2d/input/handlers/MouseWheelZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(n,f,h,d){Object.defineProperty(f,"__esModule",{value:!0});n=function(a){function d(d,b){var c=a.call(this,"esri.views.2d.input.handlers.MouseWheelZoom",!0)||this;c.view=d;c._canZoom=!0;c.registerIncoming("mouse-wheel",
b,function(a){return c._handleMouseWheel(a)});return c}h(d,a);d.prototype._handleMouseWheel=function(a){var b=this;if(this._canZoom){var c=a.data;if(c=this.view.navigation.zoom(1/Math.pow(.6,1/60*c.deltaY),[c.x,c.y]))this._canZoom=!1,c.always(function(){b._canZoom=!0});a.stopPropagation()}};return d}(d.InputHandler);f.MouseWheelZoom=n})},"esri/views/2d/input/handlers/PinchAction":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(n,
f,h,d){Object.defineProperty(f,"__esModule",{value:!0});n=function(a){function d(d){var b=a.call(this,"esri.views.2d.input.handlers.PinchZoom",!0)||this;b.view=d;b.registerIncoming("drag",function(a){return b._handleDrag(a)});b.registerIncoming("pointer-down",function(a){return b.stopMomentumNavigation()});return b}h(d,a);d.prototype._handleDrag=function(a){var b=a.data;if(!(2>b.pointers.length)){var c=this.view.navigation.pinch;switch(b.action){case "start":c.begin(this.view,b);break;case "update":c.update(this.view,
b);break;case "end":c.end(this.view,b)}a.stopPropagation()}};d.prototype.stopMomentumNavigation=function(){this.view.navigation.pinch.stopMomentumNavigation()};return d}(d.InputHandler);f.PinchRotateAndZoom=n})},"esri/views/2d/navigation/MapViewNavigation":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../Viewpoint ../../../geometry/Point ./actions/Pan ./actions/Rotate ./actions/Pinch ./ZoomBox ../viewpointUtils".split(" "),
function(n,f,h,d,a,l,e,b,c,g,m,k,q){var p=new e({targetGeometry:new b}),u=[0,0];return function(b){function e(a){a=b.call(this)||this;a.animationManager=null;return a}h(e,b);e.prototype.initialize=function(){this.pan=new c({navigation:this});this.rotate=new g({navigation:this});this.pinch=new m({navigation:this});this.zoomBox=new k({view:this.view,navigation:this})};e.prototype.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};e.prototype.begin=function(){this._set("interacting",
!0)};e.prototype.end=function(){this._set("interacting",!1)};e.prototype.zoom=function(a,b){void 0===b&&(b=this._getDefaultAnchor());this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>a?this.zoomIn(b):this.zoomOut(b);this.setViewpoint(b,a,0)};e.prototype.zoomIn=function(a){void 0===a&&(a=this._getDefaultAnchor());this.begin();var b=this.view,c=b.scale,d=b.constraints.snapToNextScale(c);a=b.goTo(this._scaleAndRotateViewpoint(p,a,d/c,0));this.end();
return a};e.prototype.zoomOut=function(a){void 0===a&&(a=this._getDefaultAnchor());this.begin();var b=this.view,c=b.scale,d=b.constraints.snapToPreviousScale(c);a=b.goTo(this._scaleAndRotateViewpoint(p,a,d/c,0));this.end();return a};e.prototype.setViewpoint=function(a,b,c){this.begin();this.view.state.viewpoint=this._scaleAndRotateViewpoint(p,a,b,c);this.end()};e.prototype.animateViewpoint=function(a,b,c){return this.view.goTo(this._scaleAndRotateViewpoint(p,a,b,c))};e.prototype.continousRotateClockwise=
function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){q.rotateBy(a,a,-1)})};e.prototype.continousRotateCounterclockwise=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){q.rotateBy(a,a,1)})};e.prototype.resetRotation=function(){this.view.rotation=0};e.prototype.continousPanLeft=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){q.translateBy(a,a,[-10,0])})};e.prototype.continousPanRight=
function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){q.translateBy(a,a,[10,0])})};e.prototype.continousPanUp=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){q.translateBy(a,a,[0,10])})};e.prototype.continousPanDown=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){q.translateBy(a,a,[0,-10])})};e.prototype.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();
this.end()};e.prototype._getDefaultAnchor=function(){var a=this.view.size;u[0]=.5*a[0];u[1]=.5*a[1];return u};e.prototype._scaleAndRotateViewpoint=function(a,b,c,d){var e=this.view,g=e.size,f=e.padding,h=e.constraints,k=e.viewpoint,m=e.scale*c,e=h.canZoomInTo(m),h=h.canZoomOutTo(m);return 1>c&&!e||1<c&&!h?k:q.padAndScaleAndRotateBy(a,k,c,d,b,g,f)};d([a.property()],e.prototype,"animationManager",void 0);d([a.property({type:Boolean,readOnly:!0})],e.prototype,"interacting",void 0);d([a.property()],e.prototype,
"pan",void 0);d([a.property()],e.prototype,"pinch",void 0);d([a.property()],e.prototype,"rotate",void 0);d([a.property()],e.prototype,"view",void 0);d([a.property()],e.prototype,"zoomBox",void 0);return e=d([a.subclass("esri.views.2d.navigation.MapViewNavigation")],e)}(a.declared(l))})},"esri/views/2d/navigation/actions/Pan":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor ../../viewpointUtils ../../../navigation/Momentum ../../../3d/lib/glMatrix".split(" "),
function(n,f,h,d,a,l,e,b,c){return function(g){function f(a){var c=g.call(this)||this;c.animationTime=0;c.momentumEstimator=new b.ScreenspaceMomentumEstimator(.05,600,6,.92);c.momentum=null;c.momentumVelocityX=0;c.momentumVelocityY=0;c.momentumFinished=!1;c.viewpoint=e.create();c.watch("momentumFinished",function(a){a&&c.navigation.stop()});return c}h(f,g);f.prototype.begin=function(a,b){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(b)};f.prototype.update=function(a,b){this.addToEstimator(b);
var c=b.pointers[0];b=c.currentEvent.x;var d=c.currentEvent.y;b=(c=c.previousEvent)?c.x-b:-b;d=c?d-c.y:d;a.viewpoint=e.translateBy(this.viewpoint,a.viewpoint,[b||0,d||0])};f.prototype.end=function(a,b){this.addToEstimator(b);this.momentum=this.momentumEstimator.evaluateMomentum();this.animationTime=0;this.momentum&&(this.momentumVelocityX=(this.momentum.dataNewest[0]-this.momentum.dataOldest[0])/this.momentum.dataTimeDelta,this.momentumVelocityY=(this.momentum.dataNewest[1]-this.momentum.dataOldest[1])/
this.momentum.dataTimeDelta,this.onAnimationUpdate(a));this.navigation.end()};f.prototype.addToEstimator=function(a){var b=a.pointers[0],d=b.currentEvent.x,b=b.currentEvent.y;this.momentumEstimator.add(d,b,c.vec3.createFrom(d,b,0),.001*a.currentState.timestamp)};f.prototype.onAnimationUpdate=function(a){var b=this;this.navigation.animationManager.animateContinous(a.viewpoint,function(c,d){b.momentumFinished=!b.momentum||b.momentum.isFinished(b.animationTime);d*=.001;if(!b.momentumFinished){var g=
b.momentum.velocityFactor(b.animationTime);a.viewpoint=e.translateBy(c,c,[-(g*b.momentumVelocityX*d),g*b.momentumVelocityY*d])}b.animationTime+=d})};f.prototype.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};d([a.property()],f.prototype,"momentumFinished",void 0);d([a.property()],f.prototype,"viewpoint",void 0);d([a.property()],f.prototype,"navigation",void 0);return f=d([a.subclass("esri.views.2d.navigation.actions.Pan")],
f)}(a.declared(l))})},"esri/views/2d/navigation/actions/Rotate":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor ../../viewpointUtils ../../libs/gl-matrix/vec2".split(" "),function(n,f,h,d,a,l,e,b){return function(c){function g(a){a=c.call(this)||this;a.animationTime=0;a.viewpoint=e.create();return a}h(g,c);g.prototype.begin=function(a,b){this.navigation.begin()};
g.prototype.update=function(a,c){var d=c.pointers[0];c=b.create();b.set(c,d.currentEvent.x+a.padding.left,a.height-d.currentEvent.y+a.padding.top);var d=d.previousEvent,g=b.create();b.set(g,d.x+a.padding.left,a.height-d.y+a.padding.top);c=e.angleBetween(a.state.paddedScreenCenter,c,g);a.viewpoint=e.rotateBy(this.viewpoint,a.content.viewpoint,c)};g.prototype.end=function(a,b){this.navigation.end()};d([a.property()],g.prototype,"viewpoint",void 0);d([a.property()],g.prototype,"navigation",void 0);return g=
d([a.subclass("esri.views.2d.actions.Rotate")],g)}(a.declared(l))})},"esri/views/2d/navigation/actions/Pinch":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Accessor ../../viewpointUtils ../../../navigation/Momentum ../../libs/gl-matrix/vec2".split(" "),function(n,f,h,d,a,l,e,b,c){return function(g){function f(a){var c=g.call(this,a)||this;c.animationTime=0;c.momentumFinished=
!1;c.rotateMomentumEstimator=new b.RotationMomentumEstimator(.05,6,.15,.95);c.rotateMomentum=null;c.rotationDirection=1;c.zoomMomentumEstimator=new b.ZoomMomentumEstimator(.05);c.zoomMomentum=null;c.zoomDirection=1;c.viewpoint=e.create();c.watch("momentumFinished",function(a){a&&c.navigation.stop()});return c}h(f,g);f.prototype.begin=function(a,b){this.navigation.begin();this.rotateMomentumEstimator.reset();this.zoomMomentumEstimator.reset();this.addToRotateEstimator(b,0);this.addToZoomEstimator(b,
b.startState.radius/b.currentState.radius)};f.prototype.update=function(a,b){var c=b.currentState,d=c.angle,e=c.radius,c=c.center,g=b.previousState,f=g.radius,h=g.angle,g=b.startState.radius/e;f&&(e/=f,d=180*(d-h)/Math.PI,this.rotationDirection=0<=d?1:-1,this.zoomDirection=1<=e?1:-1,a.constraints.rotationEnabled||(d=0),this.addToRotateEstimator(b,d),this.addToZoomEstimator(b,g),this.center=c,this.navigation.setViewpoint([c.x,c.y],1/e,d))};f.prototype.end=function(a,b){this.addToRotateEstimator(b,
0);this.addToZoomEstimator(b,b.startState.radius/b.currentState.radius);this.rotateMomentum=this.rotateMomentumEstimator.evaluateMomentum();this.zoomMomentum=this.zoomMomentumEstimator.evaluateMomentum();this.animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(a);this.navigation.end()};f.prototype.addToRotateEstimator=function(a,b){this.rotateMomentumEstimator.add(b,.001*a.currentState.timestamp)};f.prototype.addToZoomEstimator=function(a,b){this.zoomMomentumEstimator.add(b,
.001*a.currentState.timestamp)};f.prototype.canZoomIn=function(a){var b=a.scale;a=a.constraints.effectiveMaxScale;return 0===a||b>a};f.prototype.canZoomOut=function(a){var b=a.scale;a=a.constraints.effectiveMinScale;return 0===a||b<a};f.prototype.onAnimationUpdate=function(a){var b=this;this.navigation.animationManager.animateContinous(a.viewpoint,function(d,g){var f=!b.canZoomIn(a)&&1<b.zoomDirection||!b.canZoomOut(a)&&1>b.zoomDirection;b.momentumFinished=!b.rotateMomentum||b.rotateMomentum.isFinished(b.animationTime)||
f;g*=.001;b.notifyChange("momentumFinished");if(!b.momentumFinished){var f=Math.abs(b.rotateMomentum.valueDelta(b.animationTime,g))*b.rotationDirection*2,h=b.zoomMomentum?Math.abs(b.zoomMomentum.valueDelta(b.animationTime,g)):1,k=c.create(),m=c.create();c.set(k,b.center.x,b.center.y);e.getPaddingScreenTranslation(m,a.size,a.padding);c.add(k,k,m);e.scaleAndRotateBy(d,a.viewpoint,h,f,k,a.size)}b.animationTime+=g})};f.prototype.stopMomentumNavigation=function(){if(this.rotateMomentum||this.zoomMomentum)this.rotateMomentum&&
(this.rotateMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this.zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};d([a.property()],f.prototype,"viewpoint",void 0);d([a.property()],f.prototype,"navigation",void 0);return f=d([a.subclass("esri.views.2d.navigation.actions.Pinch")],f)}(a.declared(l))})},"esri/views/2d/navigation/ZoomBox":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor".split(" "),
function(n,f,h,d,a,l){return function(e){function b(a){a=e.call(this,a)||this;a._container=null;a._overlay=null;a._backgroundShape=null;a._boxShape=null;a._box={x:0,y:0,width:0,height:0};a._redraw=a._redraw.bind(a);return a}h(b,e);b.prototype.destroy=function(){this.view=null};Object.defineProperty(b.prototype,"view",{set:function(a){var b=this;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._destroyOverlay();this._set("view",a);a&&(a.on("drag",["Shift"],function(a){return b._handleDrag(a,
1)}),a.on("drag",["Shift","Ctrl"],function(a){return b._handleDrag(a,-1)}))},enumerable:!0,configurable:!0});b.prototype._start=function(a,b,d,e){this._createContainer();this._createOverlay();this.navigation.begin()};b.prototype._update=function(a,b,d,e){this._box.x=a;this._box.y=b;this._box.width=d;this._box.height=e;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};b.prototype._end=function(a,b,d,e,f){var c=this.view;a=c.toMap(a+.5*d,b+.5*e);d=Math.min(d/c.width,e/c.height);-1===f&&
(d=1/d);this._destroyOverlay();this.navigation.end();c.goTo({center:a,scale:c.scale*d})};b.prototype._updateBox=function(a,b,d,e){var c=this._boxShape;c.setAttributeNS(null,"x",""+a);c.setAttributeNS(null,"y",""+b);c.setAttributeNS(null,"width",""+d);c.setAttributeNS(null,"height",""+e);c.setAttributeNS(null,"class","esri-zoom-box__outline")};b.prototype._updateBackground=function(a,b,d,e){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,b,d,e,this.view.width,this.view.height))};b.prototype._createContainer=
function(){var a=document.createElement("div");a.className="esri-zoom-box__container";this.view.root.appendChild(a);this._container=a};b.prototype._createOverlay=function(){var a=this.view.width,b=this.view.height,d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M 0 0 L "+a+" 0 L "+a+" "+b+" L 0 "+b+" Z");d.setAttributeNS(null,"class","esri-zoom-box__overlay-background");a=document.createElementNS("http://www.w3.org/2000/svg","rect");b=document.createElementNS("http://www.w3.org/2000/svg",
"svg");b.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");b.setAttributeNS(null,"class","esri-zoom-box__overlay");b.appendChild(d);b.appendChild(a);this._container.appendChild(b);this._backgroundShape=d;this._boxShape=a;this._overlay=b};b.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};b.prototype._toSVGPath=
function(a,b,d,e,f,h){d=a+d;e=b+e;return"M 0 0 L "+f+" 0 L "+f+" "+h+" L 0 "+h+" ZM "+a+" "+b+" L "+a+" "+e+" L "+d+" "+e+" L "+d+" "+b+" Z"};b.prototype._handleDrag=function(a,b){var c=a.x,d=a.y,e=a.origin.x,g=a.origin.y,f;c>e?(f=e,e=c-e):(f=c,e-=c);d>g?(c=g,d-=g):(c=d,d=g-d);switch(a.action){case "start":this._start(f,c,e,d);break;case "update":this._update(f,c,e,d);break;case "end":this._end(f,c,e,d,b)}a.stopPropagation()};b.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var a=
this._box,b=a.x,d=a.y,e=a.width,a=a.height;this._updateBox(b,d,e,a);this._updateBackground(b,d,e,a);this._rafId=requestAnimationFrame(this._redraw)}};d([a.property()],b.prototype,"navigation",void 0);d([a.property()],b.prototype,"view",null);return b=d([a.subclass("esri.views.2d.navigation.ZoomBox")],b)}(a.declared(l))})},"esri/views/2d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../Color".split(" "),
function(n,f,h,d,a,l,e){return function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.color=new e([0,255,255]);a.haloOpacity=1;a.fillOpacity=.5;return a}h(c,b);d([a.property({type:e})],c.prototype,"color",void 0);d([a.property()],c.prototype,"haloOpacity",void 0);d([a.property()],c.prototype,"fillOpacity",void 0);return c=d([a.subclass("esri.views.2d.support.HighlightOptions")],c)}(a.declared(l))})},"esri/widgets/Search/LocatorSearchSource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/lang ../../tasks/Locator ./SearchSource ./support/locatorUtils ../../core/accessorSupport/decorators".split(" "),
function(n,f,h,d,a,l,e,b,c,g){return function(b){function f(){var a=null!==b&&b.apply(this,arguments)||this;a.categories=null;a.countryCode=null;a.localSearchOptions=null;a.locationToAddressDistance=1500;a.locator=null;a.searchTemplate="";a.singleLineFieldName=null;return a}h(f,b);m=f;f.prototype.castLocator=function(a){return"string"===typeof a?new e({url:a}):a};f.prototype.clone=function(){return new m({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,
minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?l.clone(this.outFields):null,placeholder:this.placeholder,popup:this.popup,popupEnabled:this.popupEnabled,popupOpenOnSelect:this.popupOpenOnSelect,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,searchExtent:this.searchExtent?this.searchExtent.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,
categories:this.categories?l.clone(this.categories):null,countryCode:this.countryCode,localSearchOptions:this.localSearchOptions?l.clone(this.localSearchOptions):null,locationToAddressDistance:this.locationToAddressDistance,locator:this.locator,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})};f.prototype.getResults=function(b){return c.getResults(a({source:this},b))};f.prototype.getSuggestions=function(b){return c.getSuggestions(a({source:this},
b))};d([g.property()],f.prototype,"categories",void 0);d([g.property()],f.prototype,"countryCode",void 0);d([g.property()],f.prototype,"localSearchOptions",void 0);d([g.property()],f.prototype,"locationToAddressDistance",void 0);d([g.property()],f.prototype,"locator",void 0);d([g.cast("locator")],f.prototype,"castLocator",null);d([g.property()],f.prototype,"searchTemplate",void 0);d([g.property()],f.prototype,"singleLineFieldName",void 0);return f=m=d([g.subclass("esri.widgets.Search.LocatorSearchSource")],
f);var m}(g.declared(b))})},"esri/tasks/Locator":function(){define("dojo/_base/array dojo/_base/lang ../request ./Task ../geometry/SpatialReference ./support/AddressCandidate".split(" "),function(n,f,h,d,a,l){return d.createSubclass({declaredClass:"esri.tasks.Locator",properties:{categories:{value:null,type:[String]},countryCode:{value:null,type:String},outSpatialReference:{value:null,type:a},url:{}},addressToLocations:function(a,b){var c,d=a.outFields,e=a.searchExtent,k=a.countryCode,l=a.magicKey,
n=a.distance,u=a.categories,r=a.maxLocations,t=a.forStorage;a.location&&this.normalization&&(c=a.location.clone().normalize());e&&(e=e.shiftCentralMeridian());a=a.address;var v=this.outSpatialReference;a={query:this._encode(f.mixin({},this.parsedUrl.query,a,{f:"json",outSR:v&&JSON.stringify(v.toJSON()),outFields:d&&d.join(",")||null,searchExtent:e&&JSON.stringify(e.toJSON()),category:u&&u.join(",")||null,countryCode:k||null,magicKey:l||null,distance:n||null,location:c||null,maxLocations:r||null,forStorage:t||
null})),callbackParamName:"callback"};if(this.requestOptions||b)a=f.mixin({},this.requestOptions,b,a);return h(this.parsedUrl.path+"/findAddressCandidates",a).then(this._handleAddressToLocationsResponse)},suggestLocations:function(a,b){a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.clone().normalize());a.searchExtent&&(a.searchExtent=a.searchExtent.shiftCentralMeridian());a={query:this._encode(f.mixin({},this.parsedUrl.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,
searchExtent:a.searchExtent&&JSON.stringify(a.searchExtent.toJSON()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||null,location:a.location||null,distance:a.distance||null},{f:"json"})),callbackParamName:"callback"};if(this.requestOptions||b)a=f.mixin({},this.requestOptions,b,a);return h(this.parsedUrl.path+"/suggest",a).then(this._handleSuggestLocationsResponse)},addressesToLocations:function(a,b){var c=this.outSpatialReference,d=[],e=a.categories,k=a.countryCode;
n.forEach(a.addresses,function(a,b){d.push({attributes:a})});a={query:this._encode(f.mixin({},this.parsedUrl.query,{category:e&&e.join(",")||null,sourceCountry:k||null},{addresses:JSON.stringify({records:d})},{f:"json",outSR:c&&JSON.stringify(c.toJSON())})),callbackParamName:"callback"};if(this.requestOptions||b)a=f.mixin({},this.requestOptions,b,a);return h(this.parsedUrl.path+"/geocodeAddresses",a).then(this._handleAddressesToLocationsResponse)},locationToAddress:function(a,b,c){a&&this.normalization&&
(a=a.clone().normalize());var d=this.outSpatialReference;a={query:this._encode(f.mixin({},this.parsedUrl.query,{outSR:d&&JSON.stringify(d.toJSON()),location:a&&JSON.stringify(a.toJSON()),distance:b,f:"json"})),callbackParamName:"callback"};if(this.requestOptions||c)a=f.mixin({},this.requestOptions,c,a);return h(this.parsedUrl.path+"/reverseGeocode",a).then(this._handleLocationToAddressResponse)},_handleAddressToLocationsResponse:function(a){a=a.data;var b=a.spatialReference,c,d;return(a.candidates||
[]).map(function(a){c=a.extent;d=a.location;c&&(c.spatialReference=b);d&&(d.spatialReference=b);return l.fromJSON(a)})},_handleSuggestLocationsResponse:function(a){return a.data.suggestions||[]},_handleAddressesToLocationsResponse:function(a){a=a.data;var b=a.spatialReference,c;return(a.locations||[]).map(function(a){if(c=a.location)c.spatialReference=b;return l.fromJSON(a)})},_handleLocationToAddressResponse:function(a){a=a.data;var b=a.address||{};return l.fromJSON({address:b.Match_addr||"",attributes:b,
location:a.location,score:100})}})})},"esri/tasks/support/AddressCandidate":function(){define(["../../core/JSONSupport","../../geometry/Extent","../../geometry/Point"],function(n,f,h){return n.createSubclass({declaredClass:"esri.tasks.support.AddressCandidate",properties:{address:null,attributes:null,extent:{value:null,type:f},location:{value:null,type:h},score:null}})})},"esri/widgets/Search/support/locatorUtils":function(){define(["require","exports","../../../Graphic","../../../core/promiseUtils",
"./geometryUtils"],function(n,f,h,d,a){function l(a){var b=a.source,c=a.spatialReference,d=a.location,e=a.distance,f=a.sourceIndex,h=a.view;a=b.locator;var k=b.zoomScale,l=h&&h.scale;c&&(a.outSpatialReference=c);return a.locationToAddress(d,e).then(function(a){return g([a],f,h,l,k)})}function e(b,c){var d=b.filter,e=b.searchExtent;b=b.withinViewEnabled;var f=c&&c.extent;return(c=a.createExtentFromGeometry(d&&d.geometry,c,c&&c.scale))||e||(b&&f?f:void 0)}function b(a){var b=a.source,c=a.suggestResult,
f=a.spatialReference,h=a.view,k=a.maxResults,l=a.sourceIndex,n=b&&b.zoomScale;a=c.text.trim();if(!a)return d.resolve();a=""+(!c.key&&b.prefix?b.prefix:"")+a+(!c.key&&b.suffix?b.suffix:"");var A={},E=b.locator,D=h&&h.scale,x=e(b,h);if(!E)return d.resolve();b.categories&&(A.categories=b.categories);f&&(E.outSpatialReference=f);if(f=m(h,b,D))A.location=f.location,A.distance=f.distance;A.maxLocations=k;x&&(A.searchExtent=x);b.countryCode&&(A.countryCode=b.countryCode);c.key&&(A.magicKey=c.key);A.address=
{};A.address[b.singleLineFieldName||"Single Line Input"]=a;b.outFields&&(A.outFields=b.outFields);return E.addressToLocations(A).then(function(a){return g(a,l,h,D,n)})}function c(a,b){return a.map(function(a){return{text:a.text,key:a.magicKey,sourceIndex:b}})}function g(b,c,d,e,f){return b.map(function(b){var g=b.extent,k=b.location,l=b.address;b=new h({geometry:k,attributes:b.attributes});g=a.createExtentFromGeometry(g||k,d,e);g=f?a.scaleExtent(g,d,f):g;k=k?k.x+","+k.y:null;return{extent:g,feature:b,
name:l||k,sourceIndex:c}})}function m(a,b,c){var d=b.localSearchOptions;if(a&&d&&d.hasOwnProperty("distance")&&d.hasOwnProperty("minScale")&&(b=d.minScale,d=d.distance,!b||c&&c<=b))return{location:a.get("extent.center"),distance:d}}Object.defineProperty(f,"__esModule",{value:!0});f.getResults=function(a){return a.location?l(a):b(a)};f.getSuggestions=function(a){var b=a.source,f=a.spatialReference,g=a.view,h=a.suggestTerm,k=a.maxSuggestions,l=a.sourceIndex;a={};var n=b.locator,A=g&&g.scale,E=e(b,g);
if(!n)return d.resolve();b.categories&&(a.categories=b.categories);n.outSpatialReference=f;if(f=m(g,b,A))a.location=f.location,a.distance=f.distance;h=h.trim();if(!h)return d.resolve();f=b.prefix;g=b.suffix;a.text=""+(void 0===f?"":f)+h+(void 0===g?"":g);E&&(a.searchExtent=E);a.maxSuggestions=k;b.countryCode&&(a.countryCode=b.countryCode);return n.suggestLocations(a).then(function(a){return c(a,l)})}})},"esri/widgets/Search/SearchResultRenderer":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../Widget ../support/widget ./SearchViewModel dojo/i18n!./nls/Search".split(" "),
function(n,f,h,d,a,l,e,b,c){return function(f){function g(a){a=f.call(this)||this;a.showMoreResultsOpen=!1;a.viewModel=null;return a}h(g,f);g.prototype.render=function(){var a=this,b=this.get("viewModel.selectedResult"),d=this.get("viewModel.results"),b=b&&b.name||"",f=1<this._countResults(d),g=f&&d.map(function(b){return a._moreResultsList(b)}),d=f?e.tsx("div",{key:"esri-search-renderer__more-results-button",class:"esri-search-result-renderer__more-results-item"},e.tsx("a",{href:"#",bind:this,onclick:this._showMoreResultsClick,
onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?c.hideMoreResults:c.showMoreResults)):null,f=f?e.tsx("div",{key:"esri-search-renderer__more-results-container",class:"esri-search-result-renderer__more-results-list"},g):null,g=(h={},h["esri-search-result-renderer__more-results--show-more-results"]=this.showMoreResultsOpen,h);return e.tsx("div",{class:"esri-search-result-renderer esri-widget"},e.tsx("div",{key:"esri-search-renderer__container",class:"esri-search-result-renderer__more-results",
classes:g},e.tsx("div",{key:"esri-search-renderer__result-name",class:"esri-search-result-renderer__more-results-item"},b),e.tsx("div",{key:"esri-search-renderer__more-results"},d,f)));var h};g.prototype._showMoreResultsClick=function(a){a.preventDefault();this.showMoreResultsOpen=!this.showMoreResultsOpen;(a=this.get("viewModel.view.popup"))&&a.reposition()};g.prototype._selectResultClick=function(a){a.preventDefault();a=a.currentTarget["data-result"];this.viewModel&&this.viewModel.select(a)};g.prototype._moreResultsList=
function(a){var b=this,c=a.results,d=c.length,f=!!d,g=this.get("viewModel.selectedResult"),d=1===d&&c[0]===g,g=this._getSourceName(a.source,a.sourceIndex),g=1<this.get("viewModel.results").length&&!d?e.tsx("div",{key:"esri-search-result-renderer__header-"+a.sourceIndex,class:"esri-search-result-renderer__more-results-list-header"},g):null,c=f&&c.map(function(a,c){return b._moreResultsListItem(a,c)}),c=f&&!d?e.tsx("ul",{key:"esri-search-result-renderer__list-"+a.sourceIndex},c):null;return f?e.tsx("div",
{key:"esri-search-result-renderer__results-"+a.sourceIndex},g,c):null};g.prototype._moreResultsListItem=function(a,b){var c=this.get("viewModel.selectedResult");return a!==c?e.tsx("li",{key:"esri-search-result-renderer__list-item-"+b},e.tsx("a",{href:"#",tabindex:"0",bind:this,"data-result":a,onclick:this._selectResultClick,onkeydown:this._selectResultClick},a.name)):null};g.prototype._getSourceName=function(a,d){return d===b.ALL_INDEX?c.all:a.name};g.prototype._countResults=function(a){return a?
a.reduce(function(a,b){return a+b.results.length},0):0};d([e.renderable(),a.property()],g.prototype,"showMoreResultsOpen",void 0);d([a.property(),e.renderable(["viewModel.results","viewModel.selectedResult"])],g.prototype,"viewModel",void 0);d([e.accessibleHandler()],g.prototype,"_showMoreResultsClick",null);d([e.accessibleHandler()],g.prototype,"_selectResultClick",null);return g=d([a.subclass("esri.widgets.Search.SearchResultRenderer")],g)}(a.declared(l))})},"widgets/Search/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/promise/all jimu/portalUtils esri/request".split(" "),
function(n,f,h,d,a,l,e){return{map:null,layerInfosObj:null,appConfig:null,_esriLocatorRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,setMap:function(a){this.map=a},setLayerInfosObj:function(a){this.layerInfosObj=a},setAppConfig:function(a){this.appConfig=a},getConfigInfo:function(b){if(b&&b.sources&&0<b.sources.length){var c=null;return this.searchLayer(this.map)&&b.upgradeFromGeocoder?(c=this.map.itemInfo.itemData.applicationProperties.viewing.search,c=f.map(c.layers,
n.hitch(this,function(a,b){b.hintText=a;return this._getQueryTypeGeocoder(b)},c.hintText)),a(c).then(n.hitch(this,function(a){b.sources=[].concat(a).concat(b.sources);return b}))):b}return d(this._getSoucesFromPortalAndWebmap()).then(n.hitch(this,function(a){return{allPlaceholder:"",showInfoWindowOnSelect:!0,sources:a}}))},_getSoucesFromPortalAndWebmap:function(){var b=[],c=null;this.searchLayer(this.map)&&(c=this.map.itemInfo.itemData.applicationProperties.viewing.search,f.forEach(c.layers,n.hitch(this,
function(a,c){c.hintText=a;b.push(this._getQueryTypeGeocoder(c))},c.hintText)));return l.getPortalSelfInfo(this.appConfig.portalUrl).then(n.hitch(this,function(c){if((c=c.helperServices&&c.helperServices.geocode)&&0<c.length)for(var d=0,e=c.length;d<e;d++){var f=c[d];f&&b.push(this._processSingleLine(f))}return a(b).then(n.hitch(this,function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d&&(d&&"query"===d.type||(d={name:d.name||this._getGeocodeName(d.url),url:d.url,singleLineFieldName:d.singleLineFieldName,
placeholder:d.placeholder||d.name||this._getGeocodeName(d.url),maxResults:6,searchInCurrentMapExtent:!1,type:"locator"}),b.push(d))}return b}))}))},_getQueryTypeGeocoder:function(){return null},_isEsriLocator:function(a){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(a)},_processSingleLine:function(a){if(a.singleLineFieldName)return a;if(this._isEsriLocator(a.url))return a.singleLineFieldName="SingleLine",a;var b=new h;e(a.url,{query:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(n.hitch(this,
function(c){c.singleLineAddressField&&c.singleLineAddressField.name?(a.singleLineFieldName=c.singleLineAddressField.name,b.resolve(a)):(console.warn(a.url+"has no singleLineFieldName"),b.resolve(null))}),n.hitch(this,function(a){console.error(a);b.resolve(null)}));return b.promise},_getGeocodeName:function(a){if("string"!==typeof a)return"geocoder";a=a.split("/");return a[a.length-2]||"geocoder"},getGeocoderName:function(a){return this._getGeocodeName(a)},hasAppSearchInfo:function(a){return a.itemInfo&&
a.itemInfo.itemData&&a.itemInfo.itemData.applicationProperties&&a.itemInfo.itemData.applicationProperties.viewing&&a.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(a){if(!a||!this.hasAppSearchInfo(a))return!1;a=a.itemInfo.itemData.applicationProperties.viewing.search;return a.enabled&&0!==a.layers.length?!0:!1}}})},"widgets/Search/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},
"url:esri/views/2d/engine/webgl/shaders/bitblit.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_tex;\r\n\r\nvarying mediump vec2 v_uv;\r\n\r\nvoid main(void) {\r\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\r\n  v_uv \x3d a_tex;\r\n}\r\n","url:esri/views/2d/engine/webgl/shaders/bitblit.fs.glsl":"\tuniform lowp sampler2D u_tex;\r\n\tuniform lowp float u_opacity;\r\n\r\n\tvarying mediump vec2 v_uv;\r\n\r\n\tvoid main() {\r\n\t\tlowp vec4 color \x3d texture2D(u_tex, v_uv);\r\n\r\n    // Note: output in pre-multiplied alpha for correct alpha compositing\r\n\t\tgl_FragColor \x3d color *  u_opacity;\r\n\t}\r\n",
"url:esri/views/2d/engine/webgl/shaders/stencil.vs.glsl":"attribute vec2 a_pos;\r\n\r\nvoid main() {\r\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\r\n}\r\n","url:esri/views/2d/engine/webgl/shaders/stencil.fs.glsl":"void main() {\r\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n}\r\n","url:esri/views/2d/engine/webgl/shaders/background.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_coord_range;\r\nuniform mediump float u_depth;\r\n\r\nvoid main() {\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\r\n}\r\n",
"url:esri/views/2d/engine/webgl/shaders/background.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main() {\r\n  gl_FragColor \x3d u_color;\r\n}","url:esri/views/2d/engine/webgl/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_coord_ratio;\r\nuniform mediump vec2 u_delta; // in tile coordinates\r\nuniform mediump vec2 u_dimensions; // in tile coordinates\r\n\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main() {\r\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\r\n\r\n  v_tex \x3d a_pos;\r\n}\r\n",
"url:esri/views/2d/engine/webgl/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main(void) {\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d 0.75 * color;\r\n}\r\n","url:esri/views/2d/engine/webgl/shaders/textShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  Add your GLSL snippets to this file. You should start from\r\n  importing your old GLSL files. For instance, if you have a\r\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\r\n  and then copy and paste the GLSL source as the content. You will then convert your\r\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\r\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\r\n--\x3e\r\n\x3csnippets\x3e\r\n\r\n  \x3csnippet name\x3d"textVS"\x3e\r\n    \x3c![CDATA[\r\n      precision mediump float;\r\n\r\n      attribute vec2 a_pos;           // 2 * 2 (2 x signed 16)\r\n      attribute vec4 a_id;            // 4 (4 x unsigned byte)\r\n      attribute vec4 a_color;         // 4 (4 x unsigned byte)\r\n      attribute vec4 a_vertexOffset; // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\r\n      attribute vec4 a_texFontSize; // 4 (4 x unsigned byte) texture coordinatesm and font size\r\n\r\n      attribute lowp float  a_visible; // --\x3e a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\r\n\r\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n      // relative to the tile\'s upper left corner\r\n      // the extrusion vector.\r\n      uniform highp mat4 u_transformMatrix;\r\n      // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\r\n      uniform highp mat4 u_extrudeMatrix;\r\n      // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\r\n      uniform highp vec2 u_normalized_origin;\r\n      // the size of the mosaic given in pixels\r\n      uniform vec2 u_mosaicSize;\r\n      uniform float u_pixelRatio;\r\n\r\n      // the opacity of the layer\r\n      uniform mediump float u_opacity;\r\n\r\n      varying mediump vec4 v_color;\r\n      varying mediump float v_antialiasingWidth;\r\n\r\n      // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\n      varying mediump vec2 v_tex;\r\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n      // opacity of the layer given by the painter\r\n      varying lowp float v_transparency;\r\n\r\n      // the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n      // by 16 and then at the shader devide by the same number\r\n      const float offsetPrecision \x3d 1.0 / 32.0;\r\n      const float sdfFontSize \x3d 24.0;\r\n\r\n      void main()\r\n      {\r\n        float fontScale \x3d a_texFontSize.z / sdfFontSize;\r\n        // we need to scale the extrude matrix by the font-scale in order to get the right text size\r\n        mat4 extrudeMatrix \x3d fontScale * u_extrudeMatrix;\r\n\r\n        // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n        gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\r\n\r\n        v_transparency *\x3d u_opacity;\r\n        v_tex \x3d a_texFontSize.xy / u_mosaicSize;\r\n        v_color \x3d a_color;\r\n        v_antialiasingWidth \x3d 0.1 * sdfFontSize / a_texFontSize.z / u_pixelRatio;\r\n      }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"textFS"\x3e\r\n    \x3c![CDATA[\r\n      precision lowp float;\r\n\r\n      uniform lowp sampler2D u_texture;\r\n\r\n      varying mediump vec4 v_color;\r\n      varying mediump float v_antialiasingWidth;\r\n      varying mediump vec2 v_tex;\r\n      varying lowp float v_transparency;\r\n\r\n      // 0.75 is the value of the edge of the geometry in the SDF glyphs\r\n      const float glyphEdgeDistance \x3d 0.75;\r\n\r\n      void main()\r\n      {\r\n        // read the distance from the SDF texture\r\n        lowp float dist \x3d texture2D(u_texture, v_tex).a;\r\n        // use a smooth-step in order to calculate the geometry of the shape given by the distance field\r\n        lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\r\n\r\n        gl_FragColor \x3d alpha * v_color;\r\n      }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/2d/engine/webgl/shaders/iconShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  Add your GLSL snippets to this file. You should start from\r\n  importing your old GLSL files. For instance, if you have a\r\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\r\n  and then copy and paste the GLSL source as the content. You will then convert your\r\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\r\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\r\n--\x3e\r\n\x3csnippets\x3e\r\n\r\n  \x3csnippet name\x3d"rgba2floatFunc"\x3e\r\n    \x3c![CDATA[\r\n    float rgba2float(vec4 rgba) {\r\n      return dot(rgba,  vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0));\r\n    }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"iconVVUniformsVS"\x3e\r\n    \x3c![CDATA[\r\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\r\n    attribute vec4 a_vv;\r\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\r\n\r\n  #ifdef VV_COLOR\r\n    uniform float u_vvColorValues[8];\r\n    uniform vec4 u_vvColors[8];\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    uniform vec4 u_vvSizeMinMaxValue;\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_SCALE_STOPS\r\n    uniform float u_vvSizeScaleStopsValue;\r\n  #endif // VV_SIZE_SCALE_STOPS\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    uniform float u_vvSizeFieldStopsValues[6];\r\n    uniform float u_vvSizeFieldStopsSizes[6];\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    uniform float u_vvOpacityValues[8];\r\n    uniform float u_vvOpacities[8];\r\n  #endif // VV_OPACITY\r\n\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"iconVVFunctions"\x3e\r\n    \x3c![CDATA[\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    float getVVMinMaxSize(float sizeValue) {\r\n      // we need to multiply by 8 in order to translate to tile coordinates\r\n      float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\r\n      return clamp(u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\r\n    }\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    const int VV_SIZE_N \x3d 6;\r\n    float getVVStopsSize(float sizeValue) {\r\n      if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\r\n        return u_vvSizeFieldStopsSizes[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\r\n        if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\r\n          float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\r\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\r\n    }\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    float getVVUnitValue(float sizeValue) {\r\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\r\n    }\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    const int VV_OPACITY_N \x3d 8;\r\n    float getVVOpacity(float opacityValue) {\r\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\r\n        return u_vvOpacities[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\r\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\r\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\r\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvOpacities[VV_OPACITY_N - 1];\r\n    }\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_ROTATION\r\n    mat4 getVVRotation(float rotationValue) {\r\n      // YF TODO: if the symbol has rotation we need to combine the symbo\'s rotation with the VV one\r\n      float angle \x3d C_DEG_TO_RAD * rotationValue;\r\n\r\n      float sinA \x3d sin(angle);\r\n      float cosA \x3d cos(angle);\r\n\r\n      return mat4(cosA, sinA, 0, 0,\r\n                  -sinA,  cosA, 0, 0,\r\n                  0,     0, 1, 0,\r\n                  0,     0, 0, 1);\r\n    }\r\n  #endif // VV_ROTATION\r\n\r\n  #ifdef VV_COLOR\r\n    const int VV_COLOR_N \x3d 8;\r\n\r\n    vec4 getVVColor(float colorValue) {\r\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\r\n        return u_vvColors[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\r\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\r\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvColors[VV_COLOR_N - 1];\r\n    }\r\n  #endif // VV_COLOR\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n\r\n  \x3csnippet name\x3d"iconVS"\x3e\r\n  \x3c![CDATA[\r\n    precision mediump float;\r\n\r\n    //const float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\r\n    const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\r\n    const float C_OFFSET_PRECISION \x3d 1.0 / 64.0;\r\n\r\n    // per-vertex attributes (4 bytes)\r\n    attribute vec4 a_vertexOffsetAndTex;\r\n\r\n    // per quad (instance) attributes (20 bytes \x3d\x3d\x3e equivalent of 5 bytes per vertex)\r\n    attribute vec2 a_pos;\r\n    attribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\r\n    attribute vec4 a_color;\r\n    attribute vec4 a_outlineColor;\r\n    attribute vec4 a_sizeAndOutlineWidth;\r\n\r\n    // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n    // relative to the tile\'s upper left corner\r\n    // the extrusion vector.\r\n    uniform highp mat4 u_transformMatrix;\r\n    // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\r\n    uniform highp mat4 u_extrudeMatrix;\r\n    // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\r\n    uniform highp vec2 u_normalized_origin;\r\n\r\n    // the size of the mosaic given in pixels\r\n    uniform vec2 u_mosaicSize;\r\n\r\n    // the opacity of the layer given by the painter\r\n    uniform mediump float u_opacity;\r\n\r\n    // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\n    varying mediump vec2 v_tex;\r\n    // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n    // opacity of the layer given by the painter\r\n    varying lowp float v_transparency;\r\n    // the of the icon given in pixels\r\n    varying mediump vec2 v_size;\r\n\r\n    // icon color. If is a picture-marker it is used to tint the texture color\r\n    varying lowp vec4 v_color;\r\n\r\n #ifdef SDF\r\n    varying lowp vec4 v_outlineColor;\r\n    varying mediump float v_outlineWidth;\r\n #endif // SDF\r\n\r\n #ifdef ID\r\n    varying highp vec4 v_id;\r\n #endif // ID\r\n\r\n #ifdef HEATMAP\r\n    attribute float a_heatmapWeight;\r\n    varying mediump float v_heatmapWeight;\r\n #endif // HEATMAP\r\n\r\n    // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\r\n    $iconVVUniformsVS\r\n    $iconVVFunctions\r\n\r\n    void main()\r\n    {\r\n      vec2 a_offset \x3d a_vertexOffsetAndTex.xy;\r\n      vec2 a_tex \x3d a_vertexOffsetAndTex.zw;\r\n      vec2 a_size \x3d a_sizeAndOutlineWidth.xy;\r\n\r\n      // default values (we need them for the variations to come)\r\n      float a_angle \x3d 0.0;\r\n      float delta_z \x3d 0.0;\r\n      float depth \x3d 0.0;\r\n      v_transparency \x3d 1.0;\r\n\r\n  #if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n      // vv size override the original symbol\'s size\r\n      vec2 size \x3d vec2(getVVMinMaxSize(a_vv.x));\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_SCALE_STOPS\r\n      vec2 size \x3d vec2(u_vvSizeScaleStopsValue);\r\n  #endif // VV_SIZE_SCALE_STOPS\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n      vec2 size \x3d vec2(getVVStopsSize(a_vv.x));\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n      vec2 size \x3d vec2(getVVUnitValue(a_vv.x));\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n      vec2 offset \x3d C_OFFSET_PRECISION * a_offset * size;\r\n      v_size \x3d size;\r\n  #else\r\n  #ifdef HEATMAP\r\n      // reconstruct the kernel size\r\n      a_size \x3d 9.0 * a_size + 1.0;\r\n  #endif // HEATMAP\r\n\r\n      vec2 offset \x3d C_OFFSET_PRECISION * a_offset * a_size;\r\n      v_size \x3d a_size;\r\n  #endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n  #ifdef SDF\r\n    offset *\x3d 2.0;\r\n  #endif // SDF\r\n\r\n  #ifdef VV_ROTATION\r\n      gl_Position \x3d vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * getVVRotation(a_vv.w) * vec4(offset, delta_z, 0.0);\r\n  #else\r\n      gl_Position \x3d vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offset, delta_z, 0.0);\r\n  #endif // VV_ROTATION\r\n\r\n  #ifdef VV_OPACITY\r\n      v_transparency \x3d getVVOpacity(a_vv.z);\r\n  #else\r\n      v_transparency \x3d u_opacity;\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n      v_color \x3d getVVColor(a_vv.y);\r\n  #else\r\n      v_color \x3d a_color;\r\n  #endif // VV_COLOR\r\n\r\n      // output the texture coordinates and the transparency\r\n      v_tex \x3d a_tex / u_mosaicSize;\r\n\r\n #ifdef SDF\r\n      v_outlineColor \x3d a_outlineColor;\r\n      v_outlineWidth \x3d a_sizeAndOutlineWidth.z;\r\n #endif // SDF\r\n\r\n #ifdef ID\r\n      v_id \x3d a_id;\r\n #endif // ID\r\n\r\n #ifdef HEATMAP\r\n    v_heatmapWeight \x3d a_heatmapWeight;\r\n #endif // HEATMAP\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"iconFS"\x3e\r\n   \x3c![CDATA[\r\n    precision mediump float;\r\n\r\n    uniform lowp sampler2D u_texture;\r\n\r\n    varying lowp vec2 v_tex;\r\n    varying lowp float v_transparency;\r\n    varying mediump vec2 v_size;\r\n    varying lowp vec4 v_color;\r\n\r\n #ifdef SDF\r\n    varying lowp vec4 v_outlineColor;\r\n    varying mediump float v_outlineWidth;\r\n\r\n    // we need the conversion function from RGBA to float\r\n    $rgba2floatFunc\r\n #endif // SDF\r\n\r\n #ifdef ID\r\n    varying highp vec4 v_id;\r\n #endif // ID\r\n\r\n #ifdef HEATMAP\r\n    varying mediump float v_heatmapWeight;\r\n #endif // HEATMAP\r\n\r\n    const float softEdgeRatio \x3d 1.0; // use blur here if needed\r\n\r\n    void main()\r\n    {\r\n #ifdef SDF\r\n      lowp vec4 fillPixelColor \x3d v_color;\r\n\r\n      // calculate the distance from the edge [-0.5, 0.5]\r\n      float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\r\n\r\n      // Work around loss of precision for \'d \x3d 0.0\'.\r\n      // \'0\' gets normalised to 0.5 * 256 \x3d 128 before float packing, but can only\r\n      // be stored in the texture as 128 / 255 \x3d 0.502.\r\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603110\r\n      const float diff \x3d (128.0/255.0 - 0.5);\r\n\r\n      // adjust all values, not just those close to 0, to avoid discontinuities in\r\n      // the outlines of other shapes e.g. circles\r\n      d \x3d d - diff;\r\n\r\n      // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\r\n      float size \x3d max(v_size.x, v_size.y);\r\n      float dist \x3d d * size * softEdgeRatio;\r\n\r\n      // set the fragment\'s transparency according to the distance from the edge\r\n      fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\r\n\r\n      // count for the outline\r\n      // therefore tint the entire icon area.\r\n      if (v_outlineWidth \x3e 0.25) {\r\n        lowp vec4 outlinePixelColor \x3d v_outlineColor;\r\n\r\n        // outlines can\'t be larger than the size of the symbol\r\n        float clampedOutlineSize \x3d min(v_outlineWidth, size);\r\n\r\n        outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\r\n\r\n        // finally combine the outline and the fill colors (outline draws on top of fill)\r\n        gl_FragColor \x3d v_transparency * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\r\n      }\r\n      else {\r\n        gl_FragColor \x3d v_transparency * fillPixelColor;\r\n      }\r\n #else // not an SDF\r\n      lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\r\n\r\n #ifdef HEATMAP\r\n      texColor.r *\x3d v_heatmapWeight;\r\n #endif // HEATMAP\r\n\r\n      gl_FragColor \x3d v_transparency * texColor;\r\n #endif // SDF\r\n\r\n #ifdef HIGHLIGHT\r\n      gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\r\n #endif // HIGHLIGHT\r\n\r\n #ifdef ID\r\n      if (gl_FragColor.a \x3c 1.0 / 255.0) {\r\n        discard;\r\n      }\r\n      gl_FragColor \x3d v_id;\r\n #endif // ID\r\n    }\r\n   ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n\r\n',
"url:esri/views/2d/engine/webgl/shaders/fillShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  // YF TODO: (doc)\r\n--\x3e\r\n\x3csnippets\x3e\r\n  \x3csnippet name\x3d"fillVVUniformsVS"\x3e\r\n    \x3c![CDATA[\r\n  #if defined(VV_COLOR)|| defined(VV_OPACITY)\r\n    attribute vec4 a_vv;\r\n  #endif // VV_COLOR || VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n    uniform float u_vvColorValues[8];\r\n    uniform vec4 u_vvColors[8];\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef VV_OPACITY\r\n    uniform float u_vvOpacityValues[8];\r\n    uniform float u_vvOpacities[8];\r\n  #endif // VV_OPACITY\r\n\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"fillVVFunctions"\x3e\r\n    \x3c![CDATA[\r\n  #ifdef VV_OPACITY\r\n    const int VV_OPACITY_N \x3d 8;\r\n\r\n    float getVVOpacity(float opacityValue) {\r\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\r\n        return u_vvOpacities[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\r\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\r\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\r\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvOpacities[VV_OPACITY_N - 1];\r\n    }\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n    const int VV_COLOR_N \x3d 8;\r\n\r\n    vec4 getVVColor(float colorValue) {\r\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\r\n        return u_vvColors[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\r\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\r\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvColors[VV_COLOR_N - 1];\r\n    }\r\n  #endif // VV_COLOR\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"fillVS"\x3e\r\n    \x3c![CDATA[\r\n      precision mediump float;\r\n\r\n      attribute vec2 a_pos;\r\n      attribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\r\n      attribute vec4 a_color;\r\n      attribute vec4 a_tlbr;\r\n      attribute vec4 a_aux;\r\n\r\n      uniform highp mat4 u_transformMatrix;\r\n      uniform highp vec2 u_normalized_origin;\r\n\r\n      varying lowp vec4 v_color;\r\n      varying lowp float v_opacity;\r\n\r\n      // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\r\n      $fillVVUniformsVS\r\n      $fillVVFunctions\r\n\r\n  #ifdef PATTERN\r\n    uniform mediump float u_zoomFactor;\r\n    uniform mediump vec2 u_mosaicSize;\r\n\r\n    varying mediump vec4 v_tlbr;\r\n    varying mediump vec2 v_tileTextureCoord;\r\n  #endif // PATTERN\r\n\r\n  #ifdef ID\r\n    varying highp vec4 v_id;\r\n  #endif // ID\r\n\r\n      void main()\r\n      {\r\n  #ifdef VV_OPACITY\r\n        v_opacity \x3d getVVOpacity(a_vv.y);\r\n  #else\r\n        v_opacity \x3d 1.0;\r\n  #endif\r\n\r\n    #ifdef VV_COLOR\r\n       v_color \x3d getVVColor(a_vv.x);\r\n  #else\r\n       v_color \x3d a_color;\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef ID\r\n      v_id \x3d a_id;\r\n  #endif // ID\r\n\r\n  #ifdef PATTERN\r\n       // calculate the pattern matrix\r\n       mat3 patternMatrix \x3d mat3(1.0, 0.0, 0.0,\r\n                                 0.0, 1.0, 0.0,\r\n                                 0.0, 0.0, 1.0);\r\n       patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux.x);\r\n       patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux.y);\r\n\r\n       // calculate the texture coordinates of the current vertex. It will of course get interpolated.\r\n       // The pattern matrix is a 3x3 scale matrix which \'tiles\' the texture inside the tile, translating from\r\n       // tile coordinates to texture coordinates.\r\n       v_tileTextureCoord \x3d (patternMatrix * vec3(a_pos, 1.0)).xy;\r\n       v_tlbr \x3d vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\r\n  #endif // PATTERN\r\n\r\n        gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\r\n      }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"fillFS"\x3e\r\n    \x3c![CDATA[\r\n      precision lowp float;\r\n      uniform lowp float u_opacity;\r\n\r\n  #ifdef PATTERN\r\n      uniform lowp sampler2D u_texture;\r\n\r\n      varying mediump vec4 v_tlbr;\r\n      varying mediump vec2 v_tileTextureCoord;\r\n  #endif // PATTERN\r\n\r\n  #ifdef ID\r\n    varying highp vec4 v_id;\r\n  #endif // ID\r\n\r\n      varying lowp vec4 v_color;\r\n      varying lowp float v_opacity;\r\n\r\n      void main()\r\n      {\r\n  #ifdef PATTERN\r\n         // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\r\n         mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\r\n         // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\r\n         // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\r\n         // we need to only sample from area that has our sprite in the mosaic.\r\n         mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\r\n         // sample the sprite mosaic\r\n         lowp vec4 color \x3d texture2D(u_texture, samplePos);\r\n         gl_FragColor \x3d u_opacity * v_opacity * v_color * color;\r\n  #else\r\n        gl_FragColor \x3d u_opacity * v_opacity * v_color;\r\n  #endif // PATTERN\r\n\r\n  #ifdef HIGHLIGHT\r\n        gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\r\n  #endif // HIGHLIGHT\r\n\r\n  #ifdef ID\r\n      if (gl_FragColor.a \x3c 1.0 / 255.0) {\r\n        discard;\r\n      }\r\n      gl_FragColor \x3d v_id;\r\n  #endif // ID\r\n      }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/2d/engine/webgl/shaders/lineShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  // YF TODO: (doc)\r\n--\x3e\r\n\x3csnippets\x3e\r\n  \x3csnippet name\x3d"lineVVUniformsVS"\x3e\r\n    \x3c![CDATA[\r\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY)\r\n    attribute vec3 a_vv;\r\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n    uniform float u_vvColorValues[8];\r\n    uniform vec4 u_vvColors[8];\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    uniform vec4 u_vvSizeMinMaxValue;\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_SCALE_STOPS\r\n    uniform float u_vvSizeScaleStopsValue;\r\n  #endif\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    uniform float u_vvSizeFieldStopsValues[6];\r\n    uniform float u_vvSizeFieldStopsSizes[6];\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    uniform float u_vvOpacityValues[8];\r\n    uniform float u_vvOpacities[8];\r\n  #endif // VV_OPACITY\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"lineVVFunctions"\x3e\r\n    \x3c![CDATA[\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    float getVVMinMaxSize(float sizeValue) {\r\n      float f \x3d (sizeValue - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\r\n      return clamp(mix(u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w, f), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\r\n    }\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    const int VV_SIZE_N \x3d 6;\r\n    float getVVStopsSize(float sizeValue) {\r\n      if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\r\n        return u_vvSizeFieldStopsSizes[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\r\n        if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\r\n          float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\r\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\r\n    }\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    float getVVUnitValue(float sizeValue) {\r\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\r\n    }\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    const int VV_OPACITY_N \x3d 8;\r\n    float getVVOpacity(float opacityValue) {\r\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\r\n        return u_vvOpacities[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\r\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\r\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\r\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvOpacities[VV_OPACITY_N - 1];\r\n    }\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n    const int VV_COLOR_N \x3d 8;\r\n\r\n    vec4 getVVColor(float colorValue) {\r\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\r\n        return u_vvColors[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\r\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\r\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvColors[VV_COLOR_N - 1];\r\n    }\r\n  #endif // VV_COLOR\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"lineVS"\x3e\r\n    \x3c![CDATA[\r\n     precision mediump float;\r\n\r\n     attribute vec2 a_pos;\r\n     attribute vec4 a_id;\r\n     attribute vec4 a_color;\r\n     attribute vec4 a_offsetAndNormal;\r\n     attribute vec2 a_accumulatedDistanceAndHalfWidth;\r\n     attribute vec4 a_tlbr;\r\n     attribute vec4 a_segmentDirection;\r\n\r\n     // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n     // relative to the tile\'s upper left corner\r\n     // the extrusion vector.\r\n     uniform highp mat4 u_transformMatrix;\r\n     // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\r\n     uniform highp mat4 u_extrudeMatrix;\r\n     // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\r\n     uniform highp vec2 u_normalized_origin;\r\n     uniform lowp float u_opacity; // the layer\'s opacity\r\n     uniform mediump float u_tileCoordRatio;\r\n     uniform mediump float u_antialiasing;\r\n\r\n     // the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\r\n     varying mediump vec2 v_normal;\r\n     // the accumulated distance along the line. We need this information in order to render the dashes.\r\n     varying highp float v_accumulatedDistance;\r\n     varying mediump float v_lineHalfWidth;\r\n     varying lowp vec4 v_color;\r\n     varying lowp float v_transparency;\r\n\r\n#ifdef SDF\r\n     const float scale \x3d 1.0 / 15.5;\r\n#else\r\n     const float scale \x3d 1.0 / 31.0;\r\n#endif\r\n\r\n\r\n#ifdef PATTERN\r\n     uniform mediump vec2 u_mosaicSize;\r\n\r\n     varying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\r\n     varying mediump vec2 v_patternSize;\r\n#endif // PATTERN\r\n\r\n#ifdef ID\r\n     varying highp vec4 v_id;\r\n#endif // ID\r\n\r\n     // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\r\n     $lineVVUniformsVS\r\n     $lineVVFunctions\r\n\r\n     void main()\r\n     {\r\n     // size VV block\r\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n#ifdef VV_SIZE_MIN_MAX_VALUE\r\n       mediump float lineHalfWidth \x3d 0.5 * getVVMinMaxSize(a_vv.x);\r\n#endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n#ifdef VV_SIZE_SCALE_STOPS\r\n       mediump float lineHalfWidth \x3d 0.5 * u_vvSizeScaleStopsValue;\r\n#endif // VV_SIZE_SCALE_STOPS\r\n\r\n#ifdef VV_SIZE_FIELD_STOPS\r\n        mediump float lineHalfWidth \x3d 0.5 * getVVStopsSize(a_vv.x);\r\n#endif // VV_SIZE_FIELD_STOPS\r\n\r\n#ifdef VV_SIZE_UNIT_VALUE\r\n  mediump float lineHalfWidth \x3d 0.5 * getVVUnitValue(a_vv.x);\r\n#endif // VV_SIZE_UNIT_VALUE\r\n\r\n#else // no VV\r\n       mediump float lineHalfWidth \x3d a_accumulatedDistanceAndHalfWidth.y * scale;\r\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n#ifdef HIGHLIGHT\r\n       // TODO: Decide what to do here. Do we want the\r\n       // highlight of line features to be slighly larger\r\n       // than the feature itself, when the line is too\r\n       // thin?\r\n       // lineHalfWidth \x3d max(lineHalfWidth, 3.0);\r\n#endif\r\n\r\n#ifdef VV_OPACITY\r\n      v_transparency \x3d u_opacity * getVVOpacity(a_vv.z);\r\n#else\r\n    v_transparency \x3d u_opacity;\r\n#endif // VV_OPACITY\r\n\r\n #ifdef VV_COLOR\r\n    v_color \x3d getVVColor(a_vv.y);\r\n#else\r\n    v_color \x3d a_color;\r\n#endif // VV_COLOR\r\n\r\n       // make sure to clip the vertices in case that the width of the line is 0 (or negative)\r\n       float z \x3d 2.0 * step(lineHalfWidth, 0.0);\r\n\r\n       // add the antialiasing factor to the line width. Limit the line width to 0.5 pixels (otherwise it does not look good)\r\n       lineHalfWidth \x3d max(lineHalfWidth, 0.5) + u_antialiasing;\r\n\r\n       v_lineHalfWidth \x3d lineHalfWidth;\r\n\r\n       // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n       // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n       mediump vec2 dist \x3d lineHalfWidth * a_offsetAndNormal.xy * scale;\r\n\r\n       // transform the vertex\r\n       gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, z, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n\r\n       // the accumulated distance will be used to calculate the dashes (or the no-data...)\r\n       v_accumulatedDistance \x3d a_accumulatedDistanceAndHalfWidth.x + dot(scale * a_segmentDirection.xy, dist / u_tileCoordRatio);\r\n       v_normal \x3d a_offsetAndNormal.zw * scale;\r\n\r\n#ifdef PATTERN\r\n      v_tlbr \x3d vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\r\n      v_patternSize \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\r\n#endif // PATTERN\r\n\r\n#ifdef ID\r\n      v_id \x3d a_id;\r\n#endif // ID\r\n     }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"lineFS"\x3e\r\n    \x3c![CDATA[\r\n       precision lowp float;\r\n\r\n       uniform lowp float u_blur;\r\n       uniform mediump float u_antialiasing;\r\n\r\n       varying mediump vec2 v_normal;\r\n       varying highp float v_accumulatedDistance;\r\n       varying mediump float v_lineHalfWidth;\r\n       varying lowp vec4 v_color;\r\n       varying lowp float v_transparency;\r\n\r\n#if defined(PATTERN) || defined(SDF)\r\n      uniform sampler2D u_texture;\r\n\r\n      varying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\r\n      varying mediump vec2 v_patternSize;\r\n      uniform mediump float u_zoomFactor;\r\n      uniform mediump float u_tileCoordRatio;\r\n#endif // PATTERN\r\n\r\n#ifdef SDF\r\n      const float sdfPatternHalfWidth \x3d 15.5; // YF: assumed that the width will be set to 32\r\n\r\n      float rgba2float(vec4 rgba) {\r\n        return dot(rgba,  vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0));\r\n      }\r\n#endif // SDF\r\n\r\n#ifdef ID\r\n     varying highp vec4 v_id;\r\n#endif // ID\r\n\r\n       void main()\r\n       {\r\n          // add an antialiasing factor as long as we are under two pixels\r\n          mediump float antialiasingFactor \x3d u_antialiasing * step(v_lineHalfWidth, 2.0);\r\n\r\n         // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\r\n         // and any value in between will be inside the line (the sign represent the direction - right or left).\r\n         // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\r\n         mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\r\n\r\n         // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\r\n         lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist - 0.5 * antialiasingFactor) / (u_blur + 2.0 * antialiasingFactor), 0.0, 1.0);\r\n\r\n#if defined(SDF)\r\n         mediump float lineWidthRatio \x3d v_lineHalfWidth / sdfPatternHalfWidth;\r\n         mediump float relativeTexX \x3d mod((u_zoomFactor * u_tileCoordRatio * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\r\n         mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\r\n\r\n          // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\r\n         mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\r\n\r\n         // calculate the distance from the edge [-0.5, 0.5]\r\n         mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\r\n\r\n         // the distance is a proportional to the line width\r\n         float dist \x3d d * v_lineHalfWidth;\r\n\r\n         lowp vec4 fillPixelColor \x3d v_transparency * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\r\n        gl_FragColor \x3d fillPixelColor;\r\n#elif defined(PATTERN)\r\n         // we need to calculate the relative portion of the line texture along the line given the accumulated distance along the line\r\n         // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\r\n         mediump float relativeTexX \x3d mod((u_zoomFactor * u_tileCoordRatio * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\r\n\r\n         // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\r\n         // which range from -1.0 to 1.0. On the line\'s centerline, the value of the interpolated normal is 0.0, however the relative\r\n         // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\r\n         // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\r\n         //              | -\x3e line-width / 2\r\n         //      - - - - - - - - - - - - - -\r\n         //              | -\x3e line-width / 2\r\n         //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\r\n\r\n         mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\r\n\r\n         // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\r\n         mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\r\n\r\n         // get the color from the texture\r\n         lowp vec4 color \x3d texture2D(u_texture, texCoord);\r\n\r\n         gl_FragColor \x3d v_transparency * alpha * v_color * color;\r\n#else // solid line (no texture, no pattern)\r\n         // output the fragment color\r\n         gl_FragColor \x3d v_transparency * alpha * v_color;\r\n#endif // SDF\r\n\r\n#ifdef HIGHLIGHT\r\n         gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\r\n#endif // HIGHLIGHT\r\n\r\n #ifdef ID\r\n         if (gl_FragColor.a \x3c 1.0 / 255.0) {\r\n           discard;\r\n         }\r\n         gl_FragColor \x3d v_id;\r\n #endif // ID\r\n       }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/2d/engine/webgl/shaders/hlShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  Highlight generation and rendering shaders.\r\n\r\n  These shader sources are loaded by hlShaderSnippets.ts which in turn\r\n  is used by HighlightRenderer to instantiate the programs needed for\r\n  generating and rendering the highlights.\r\n\r\n  These shaders are intended to be used with full screen quads.\r\n--\x3e\r\n\x3csnippets\x3e\r\n  \x3c!--\r\n    Vertex shader: texturedVS\r\n\r\n    Identity vertex shader that outputs an untransformed 2-D vertex\r\n    and passes its texture coordinates unchanged to the interpolator.\r\n  --\x3e\r\n  \x3csnippet name\x3d"texturedVS"\x3e\r\n    \x3c![CDATA[\r\n    // Vertex position.\r\n    attribute mediump vec2 a_position;\r\n\r\n    // Texture coordinates.\r\n    attribute mediump vec2 a_texcoord;\r\n\r\n    // Texture coordinates to be interpolated.\r\n    varying mediump vec2 v_texcoord;\r\n\r\n    void main(void) {\r\n      // Pass the position unchanged.\r\n      gl_Position \x3d vec4(a_position, 0.0, 1.0);\r\n\r\n      // Pass the texture coordinates unchanged.\r\n      v_texcoord \x3d a_texcoord;\r\n    }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3c!--\r\n    Fragment shader: blurFS\r\n\r\n    A gaussian blur shader. It blurs the alpha channel of its input\r\n    according to 4 different sigma and stores the results into the\r\n    four channel of the target framebuffer.\r\n\r\n    It is intended to be called twice; the first time to perform an\r\n    horizontal blur, and a second time to perform a vertical blur.\r\n\r\n    This shader is used to turn the highlight mask into a highlight\r\n    map. The highlight map is an approximation of the signed distance\r\n    field of the mask.\r\n  --\x3e\r\n  \x3csnippet name\x3d"blurFS"\x3e\r\n    \x3c![CDATA[\r\n    // Interpolated texture coordinates.\r\n    varying mediump vec2 v_texcoord;\r\n\r\n    // Blur direction information. There are two possible\r\n    // configurations that the host code can use.\r\n    //  - [1, 0, 1/WIDTH, 0] Used when blurring horizontally. In this\r\n    //    case u_direction[0] \x3d 1 is expressed in pixel and is fed to\r\n    //    the gauss function to produce the value of the gaussian weight\r\n    //    for that pixel, while u_direction[2] \x3d 1/WIDTH is in texel units\r\n    //    and is used to sample the right texel from the texture map.\r\n    //  - [0, 1, 0, 1/HEIGHT] Used when blurring vertically. In this\r\n    //    case u_direction[1] \x3d 1 is expressed in pixel and is fed to\r\n    //    the gauss function to produce the value of the gaussian weight\r\n    //    for that pixel, while u_direction[3] \x3d 1/HEIGHT is in texel units\r\n    //    and is used to sample the right texel from the texture map.\r\n    uniform mediump vec4 u_direction;\r\n\r\n    // Source to destination channel selection matrix.\r\n    uniform mediump mat4 u_channelSelector;\r\n\r\n    // The highlight map is obtained by blurring the alpha channel of the highlight\r\n    // mask accroding to these 4 values of the gaussian\'s sigma parameter.\r\n    uniform mediump vec4 u_sigmas;\r\n\r\n    // This is the highlight mask if we have not blurred horizontally yet, otherwise\r\n    // it is the horizontally blurred highlight map and blurring it one more time\r\n    // vertically will complete the process.\r\n    uniform sampler2D u_texture;\r\n\r\n    // The gaussian kernel. Note that it lacks the normalization constant, because\r\n    // we want to store it unnormalized in the highlight map (i.e. having a peak\r\n    // value of 1). Note also that we are using the SIMD (single instruction, multiple\r\n    // data) capabilities of the GPU to compute four different gaussian kernels, one\r\n    // for each sigma.\r\n    mediump vec4 gauss(mediump vec2 dir) {\r\n      return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\r\n    }\r\n\r\n    mediump vec4 selectChannel(mediump vec4 sample) {\r\n      return u_channelSelector * sample;\r\n    }\r\n\r\n    // Sample the input texture and accumulated its gaussian weighted value and the\r\n    // total weight.\r\n    void accumGauss(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\r\n      // Computes the gaussian weights, one for each sigma.\r\n      // Note that u_direction.xy is [1, 0] when blurring horizontally and [0, 1] when blurring vertically.\r\n      mediump vec4 w \x3d gauss(i * u_direction.xy);\r\n\r\n      // Accumumates the values.\r\n      // Note that u_direction.xy is [1/WIDTH, 0] when blurring horizontally and [0, 1/HEIGHT] when blurring vertically.\r\n      tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\r\n\r\n      // Accumulates the weights.\r\n      weight +\x3d w;\r\n    }\r\n\r\n    void main(void) {\r\n      // Initialize accumulated values and weights to zero.\r\n      mediump vec4 tot \x3d vec4(0.0, 0.0, 0.0, 0.0);\r\n      mediump vec4 weight \x3d vec4(0.0, 0.0, 0.0, 0.0);\r\n\r\n      // Accumulates enough samples. These will be taken\r\n      // horizontally or vertically depending on the value\r\n      // of u_direction.\r\n      accumGauss(-5.0, tot, weight);\r\n      accumGauss(-4.0, tot, weight);\r\n      accumGauss(-3.0, tot, weight);\r\n      accumGauss(-2.0, tot, weight);\r\n      accumGauss(-1.0, tot, weight);\r\n      accumGauss(0.0, tot, weight);\r\n      accumGauss(1.0, tot, weight);\r\n      accumGauss(2.0, tot, weight);\r\n      accumGauss(3.0, tot, weight);\r\n      accumGauss(4.0, tot, weight);\r\n      accumGauss(5.0, tot, weight);\r\n\r\n      // Compute blurred values.\r\n      mediump vec4 rgba \x3d tot / weight;\r\n\r\n      // Return the values. Note that each channel will contain\r\n      // the result of a different blur operation, one for each\r\n      // of the four chosen sigma.\r\n      gl_FragColor \x3d vec4(rgba);\r\n    }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3c!--\r\n    Fragment shader: highlightFS\r\n\r\n    Takes as input the highlight map, estimated the signed distance field,\r\n    and shades the fragments according to their estimated distance from the\r\n    edge of the highlighted feature.\r\n\r\n    A shade texture is used to turn distance values into colors; the shade\r\n    texture is basically a color gradient and is recomputed on the host\r\n    every time that the user alters the highlight options.\r\n  --\x3e\r\n  \x3csnippet name\x3d"highlightFS"\x3e\r\n    \x3c![CDATA[\r\n    // Interpolated texture coordinates.\r\n    varying mediump vec2 v_texcoord;\r\n\r\n    // The highlight map. Each channel is a blurred\r\n    // version of the alpha channel of the highlight mask.\r\n    //  - Channel 0 (red) corresponds to a gaussian blur with sigma \x3d u_sigmas[0];\r\n    //  - Channel 1 (green) corresponds to a gaussian blur with sigma \x3d u_sigmas[1];\r\n    //  - Channel 2 (blue) corresponds to a gaussian blur with sigma \x3d u_sigmas[2];\r\n    //  - Channel 3 (alpha) corresponds to a gaussian blur with sigma \x3d u_sigmas[3];\r\n    // As of today, only channel 3 is used for distance estimation.\r\n    // But the availability of different amounts of blur leaves the\r\n    // door open to multi-scale approaches.\r\n    uniform sampler2D u_texture;\r\n\r\n    // The highlight map was obtained by blurring the alpha channel of the highlight\r\n    // mask accroding to these 4 values of the gaussian\'s sigma parameter.\r\n    uniform mediump vec4 u_sigmas;\r\n\r\n    // A 1-D texture used to shade the highlight.\r\n    uniform sampler2D u_shade;\r\n\r\n    // The 1-D shade texture is spreaded between u_minMaxDistance[0] and u_minMaxDistance[1].\r\n    uniform mediump vec2 u_minMaxDistance;\r\n\r\n    // Signed distance estimation.\r\n    mediump float distance() {\r\n      // Use the largest sigma and the corresponding distance value stored in the\r\n      // last channel of the highlight map.\r\n      mediump float sigma \x3d u_sigmas[3];\r\n      mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\r\n\r\n      // Estimates the distance by linearization and local inversion around\r\n      // the inflection point. The inflection point is in x \x3d 0.\r\n      const mediump float y0 \x3d 0.5;                           // Value of the convolution at the inflection point.\r\n      mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);  // Slope of the convolution at the inflection point.\r\n      mediump float d \x3d (y - y0) / m0;                        // Inversion of a local linearization.\r\n\r\n      // Return the estimated distance.\r\n      return d;\r\n    }\r\n\r\n    // Shading based on estimated distance.\r\n    mediump vec4 shade(mediump float d) {\r\n      // Maps the sampled distance from the [A, D] range (see HighlightRenderer::setHighlightOptions) to [0, 1].\r\n      mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\r\n\r\n      // Force to [0, 1]; it should not be necessary because the shade texture uses the CLAMP address mode, so\r\n      // this should happen anyway internally to the sampler, but in practice it is needed to avoid weird\r\n      // banding artifacts.\r\n      // We don\'t really know if we need this or not.\r\n      mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\r\n\r\n      // Sample the 1-D shade texture on its center line (i.e. on t\x3d0.5).\r\n      return texture2D(u_shade, vec2(mappedDistance, 0.5));\r\n    }\r\n\r\n    void main(void) {\r\n      // Estimate the distance.\r\n      mediump float d \x3d distance();\r\n\r\n      // Shade the distance.\r\n      gl_FragColor \x3d shade(d);\r\n    }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/2d/engine/webgl/shaders/heatmap.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_tex;\r\n\r\nuniform mediump vec2 u_minmax;\r\n\r\nvarying mediump vec2 v_uv;\r\nvarying mediump float v_slope;\r\n\r\nvoid main(void) {\r\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\r\n  v_uv \x3d a_tex;\r\n  v_slope \x3d 1.0 / (u_minmax.y - u_minmax.x);\r\n}\r\n","url:esri/views/2d/engine/webgl/shaders/heatmap.fs.glsl":"\tprecision mediump float;\r\n\r\n\tuniform lowp sampler2D u_texture;\r\n\tuniform lowp float u_opacity;\r\n\tuniform mediump vec2 u_minmax;\r\n\tuniform lowp sampler2D u_gradient;\r\n\r\n\tvarying mediump vec2 v_uv;\r\n  varying mediump float v_slope;\r\n\r\n\tvec4 getColor(float intensity) {\r\n\t  float normalizedIntensity \x3d clamp((intensity - u_minmax.x) * v_slope, 0.0, 1.0);\r\n\r\n\t\treturn texture2D(u_gradient, vec2(0.5, normalizedIntensity));\r\n  }\r\n\r\n\tvoid main() {\r\n\t// sample the intnsity value\r\n\t\tlowp vec4 color \x3d texture2D(u_texture, v_uv);\r\n\r\n    // interpolate the color from the ramp using the intensity value\r\n\t\tgl_FragColor \x3d getColor(color.r) *  u_opacity;\r\n\t}\r\n",
"url:widgets/Search/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchNode" class\x3d"search-node"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchResultsNode" class\x3d"searchResults arcgisSearch esri-search"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Search/css/style.css":".jimu-widget-search{min-height: 32px;}.jimu-widget-search .search-node.default-width-for-openAtStart{width: 300px;}.jimu-widget-search .result-item-selected{background: #eee;}.jimu-widget-search .esri-search .esri-search-button:hover,.jimu-widget-search .esri-search .esri-search-button:focus {background-color: #485566; color: white;}.jimu-widget-search .esri-search .show-all-results{position: absolute; height: 25px; color: #686868; line-height: 25px; display: none; width: 237px; margin: auto; background-color: #fff; padding: 0 12px; cursor: pointer;}.jimu-widget-search .searchResults .esri-menu{border-radius: 0; color: #686868; font-size: 12px; padding: 0; top: 33px; visibility: visible;}.jimu-widget-search .searchMenu {position: absolute; top: 100%; left: 0; z-index: 1000; display: none; float: left; padding: 5px 0; margin: 2px 0 0; font-size: 14px; line-height: 16px; background-color: #fff; -webkit-background-clip: padding-box; background-clip: padding-box; border: 1px solid #57585A; -webkit-border-radius: 4px; border-radius: 4px; overflow: auto; max-height: 300px;}.jimu-widget-search .searchMenu ul {margin: 0; padding: 0; list-style: none;}.jimu-widget-search .esri-search .esri-menu li.active{background-color: #d9dde0; color: #686868; font-size: 14px;}.jimu-widget-search .esri-search .esri-menu li{padding: 0 12px; line-height: 25px; cursor: pointer;}.jimu-widget-search .esri-search .esri-menu li:hover,.jimu-widget-search .esri-search .esri-menu li:focus {background-color: #eee;}.jimu-widget-search .esri-search .esri-menu .menu-header{background-color: #d9dde0; color: #686868; font-size: 14px; min-height: 30px; padding: 0 12px; line-height: 30px;}",
"*now":function(n){n(['dojo/i18n!*preload*widgets/Search/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/when dojo/on dojo/query dojo/keys dojo/Deferred dojo/promise/all jimu/BaseWidget jimu/utils esri/widgets/Search esri/widgets/Search/SearchViewModel esri/tasks/Locator esri/core/lang esri/symbols/PictureMarkerSymbol ./utils dojo/NodeList-dom".split(" "),function(n,f,h,d,a,l,e,b,c,g,m,k,q,p,u,r,t,v){return n([m],{name:"Search",baseClass:"jimu-widget-search",searchDijit:null,searchResults:null,postCreate:function(){this.listenWidgetIds.push("framework")},
startup:function(){this.inherited(arguments);this.config&&this.config.sources||(this.config.sources=[]);v.setAppConfig(this.appConfig);a(v.getConfigInfo(this.config)).then(f.hitch(this,function(a){return g(this._convertConfig(a)).then(function(a){return h.filter(a,function(a){return a})})})).then(f.hitch(this,function(a){this.domNode&&(a=new p({activeSourceIndex:1===a.length?0:"all",allPlaceholder:k.stripHTML(r.isDefined(this.config.allPlaceholder)?this.config.allPlaceholder:""),autoSelect:!0,buttonModeEnabled:!1,
labelEnabled:!1,popupEnabled:!0,highlightEnabled:r.isDefined(this.config.showInfoWindowOnSelect)?!!this.config.showInfoWindowOnSelect:!0,showPopupOnSelect:r.isDefined(this.config.showInfoWindowOnSelect)?!!this.config.showInfoWindowOnSelect:!0,view:this.sceneView,sources:a,theme:"arcgisSearch"}),this.searchDijit=new q({viewModel:a,container:this.searchNode}),this.searchDijit.startup(),this._resetSearchDijitStyle(),this.own(this.searchDijit.viewModel.watch("activeSourceIndex",f.hitch(this,"_onSourceIndexChange"))),
this.own(l(this.searchDijit.domNode,"click",f.hitch(this,"_onSearchDijitClick"))),this.own(l(this.searchDijit._inputNode,"keyup",f.hitch(this,function(a){a.keyCode!==b.ENTER&&this._onClearSearch()}))),this.own(l(this.searchDijit.viewModel,"search-results",f.hitch(this,"_onSearchResults"))),this.own(l(this.searchDijit.viewModel,"suggest-results",f.hitch(this,"_onSuggestResults"))),this.own(l(this.searchDijit.viewModel,"select-result",f.hitch(this,"_onSelectResult"))),this.own(l(this.searchResultsNode,
"li:click",f.hitch(this,"_onSelectSearchResult"))),this.own(l(this.searchResultsNode,".show-all-results:click",f.hitch(this,"_showResultMenu"))),this.own(l(window.document,"click",f.hitch(this,function(a){d.isDescendant(a.target,this.searchResultsNode)||(this._hideResultMenu(),this._resetSelectorPosition(".show-all-results"))}))),this.own(l(this.searchDijit.viewModel,"clear-search",f.hitch(this,"_onClearSearch"))),this.own(this.sceneView.popup.viewModel.watch("visible",f.hitch(this,function(a,b){!a&&
b&&(this.searchDijit.viewModel.clearGraphics(),e("li",this.searchResultsNode).removeClass("result-item-selected"))}))),this.fetchData("framework"))}))},onReceiveData:function(a,b,c){"framework"===a&&"framework"===b&&c&&c.searchString&&(this.searchDijit.viewModel.set("value",c.searchString),this.searchDijit.viewModel.search())},setPosition:function(){this._resetSearchDijitStyle();this.inherited(arguments)},resize:function(){this._resetSearchDijitStyle()},_resetSearchDijitStyle:function(){},_convertConfig:function(a){return h.map(a.sources,
f.hitch(this,function(a){var b=new c;a&&a.url&&"locator"===a.type?b.resolve({locator:new u(a.url||""),outFields:["*"],singleLineFieldName:a.singleLineFieldName||"",name:k.stripHTML(a.name||""),placeholder:k.stripHTML(a.placeholder||""),highlightSymbol:new t({url:this.folderUrl+"css/images/search-pointer.png",size:36,width:36,height:36,xoffset:9,yoffset:18}),countryCode:a.countryCode||"",maxSuggestions:a.maxSuggestions||6,maxResults:a.maxResults||6,zoomScale:a.zoomScale||5E4,useMapExtent:!!a.searchInCurrentMapExtent}):
b.resolve(null);return b}))},_captureSelect:function(a){var b=this.searchDijit.viewModel.activeSourceIndex;"all"===b&&(b=this._getSourceIndexOfResult(a));isFinite(b)&&r.isDefined(b)&&(b=this.searchDijit.viewModel.sources[b])&&"featureLayer"in b&&(b=this._getFormatedAttrs(f.clone(a.feature.attributes),b.featureLayer.fields,b.featureLayer.typeIdField,b.featureLayer.types),a.feature.attributes=b);return[a]},_getSourceIndexOfResult:function(a){if(this.searchResults)for(var b in this.searchResults)if(-1<
h.indexOf(this.searchResults[b],a))return parseInt(b,10);return null},_formatContent:function(a,b,c,d){var e="";if(d&&d.attributes&&b&&b.url){var g={};h.forEach(b.fields,f.hitch(this,function(a){a.name in d.attributes&&(g[a.alias||a.name]=d.attributes[a.name])}));b=d.attributes[c];var e=e+('\x3cdiv class\x3d"esriViewPopup"\x3e\x3cdiv class\x3d"mainSection"\x3e'+(r.isDefined(b)?'\x3cdiv class\x3d"header"\x3e'+a+": "+b+"\x3c/div\x3e":"")+'\x3cdiv class\x3d"hzLine"\x3e\x3c/div\x3e\x3cdiv\x3e\x3ctable class\x3d"attrTable" cellpading\x3d"0" cellspacing\x3d"0"\x3e\x3ctbody\x3e'),
k;for(k in g)g.hasOwnProperty(k)&&(e+='\x3ctr valign\x3d"top"\x3e\x3ctd class\x3d"attrName"\x3e'+k+'\x3c/td\x3e\x3ctd class\x3d"attrValue"\x3e'+g[k]+"\x3c/td\x3e\x3c/tr\x3e");e+='\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d"break"\x3e\x3c/div\x3e\x3c/div\x3e'}return e},_getFormatedAttrs:function(a,b,c,d){var e={};h.forEach(b,f.hitch(this,function(f,g){if(a[f.name]){var h=!(!f.domain||"codedValue"!==f.domain.type),l="esriFieldTypeDate"===f.type,m=c&&f.name===c,n=f.name;if("esriFieldTypeString"===
b[g].type)e[n]=k.fieldFormatter.getFormattedUrl(a[f.name]);else if("esriFieldTypeDate"===b[g].type)e[n]=k.fieldFormatter.getFormattedDate(a[f.name]);else if("esriFieldTypeDouble"===b[g].type||"esriFieldTypeSingle"===b[g].type||"esriFieldTypeInteger"===b[g].type||"esriFieldTypeSmallInteger"===b[g].type)e[n]=k.fieldFormatter.getFormattedNumber(a[f.name]);h?e[n]=k.fieldFormatter.getCodedValue(f.domain,a[f.name]):m?e[n]=k.fieldFormatter.getTypeName(a[f.name],d):h||l||m||(e[n]=n in e?e[n]:a[f.name],e[n]=
this.getCodeValueFromTypes(f,c,d,a,e))}}));return e},getCodeValueFromTypes:function(a,b,c,d,e){var g=null;b&&c&&0<c.length&&(c=(c=h.filter(c,f.hitch(this,function(a){return a.name===d[b]})))&&c[0]||null)&&c.domains&&c.domains[a.name]&&c.domains[a.name].codedValues&&(g=k.fieldFormatter.getCodedValue(c.domains[a.name],d[a.name]));a=a.name;return(e=null!==g?g:e[a])||isFinite(e)?e:""},_resetSelectorPosition:function(a){var b=d.getMarginBox(window.jimuConfig.layoutId);e(a,this.domNode).forEach(f.hitch(this,
function(c){var g=d.position(c),h=f.getObject("viewModel.sources.length",!1,this.searchDijit);if(1<h&&".esri-source-menu"===a){var k=e(a+" li[data-index]",this.domNode)[0],k=r.isDefined(k)?d.getMarginBox(k).h:30;g.h=k*(h+1)}if("none"!==d.getStyle(c,"display")){var h=d.position(this.searchDijit.domNode),k=h.y-2,l=b.h-h.y-h.h;l>g.y+g.h||k>g.h?d.setStyle(c,"top",(l>g.y+g.h?h.h:-g.h-2)+"px"):(d.setStyle(c,"height",Math.max(l,k)+"px"),d.setStyle(c,"top",(l>k?h.h:-k-2)+"px"))}}))},_onSourceIndexChange:function(){this.searchDijit.viewModel.value&&
this.searchDijit.viewModel.search(this.searchDijit.viewModel.value)},_onSearchDijitClick:function(){this._resetSelectorPosition(".esri-source-menu")},_onSearchResults:function(a){var b=this.searchDijit.viewModel.get("sources"),c=this.searchDijit.viewModel.get("activeSourceIndex"),e=this.searchDijit.viewModel.get("value"),f="",g=a.results;if(g&&0<a.numResults){d.removeClass(this.searchDijit._containerNode,"showSuggestions");this.searchResults=g;var f=f+('\x3cdiv class\x3d"show-all-results jimu-ellipsis" title\x3d"'+
this.nls.showAll+'"\x3e'+this.nls.showAllResults+"\x3cstrong \x3e"+e+"\x3c/strong\x3e\x3c/div\x3e"),f=f+'\x3cdiv class\x3d"searchMenu esri-menu" role\x3d"menu"\x3e',h;for(h in g)if(g[h]&&g[h].length){a=b[parseInt(h,10)].name;1<b.length&&"all"===c&&(f+='\x3cdiv title\x3d"'+a+'" class\x3d"menu-header"\x3e'+a+"\x3c/div\x3e");f+="\x3cul\x3e";a=new RegExp("("+e+")","gi");for(var k=b[h].maxResults,l=0,m=g[h].length;l<m&&l<k;l++)var n=r.isDefined(g[h][l].name)?g[h][l].name:this.nls.untitled,f=f+('\x3cli title\x3d"'+
n+'" data-index\x3d"'+l+'" data-source-index\x3d"'+h+'" role\x3d"menuitem" tabindex\x3d"0"\x3e'+n.toString().replace(a,"\x3cstrong \x3e$1\x3c/strong\x3e")+"\x3c/li\x3e");f+="\x3c/url\x3e"}this.searchResultsNode.innerHTML=f+"\x3c/div\x3e";this._showResultMenu();this._resetSelectorPosition(".searchMenu")}else this._onClearSearch()},_onSuggestResults:function(){this._resetSelectorPosition(".searchMenu");this._hideResultMenu()},_onSelectSearchResult:function(a){for(a=a.target;!d.hasAttr(a,"data-source-index")||
!d.getAttr(a,"data-index");)a=a.parentNode;var b=null,b=d.getAttr(a,"data-source-index");a=parseInt(d.getAttr(a,"data-index"),10);"all"!==b&&(b=parseInt(b,10));this.searchResults&&this.searchResults[b]&&this.searchResults[b][a]&&(b=this.searchResults[b][a],this.searchDijit.viewModel.select(b))},_onSelectResult:function(a){var b=a.result;if(b&&b.name){var c=a.sourceIndex;a=this.searchResults[c];for(var g=0,h=0,l=a.length;h<l;h++)if(k.isEqual(a[h],b)){g=h;break}e("li",this.searchResultsNode).forEach(f.hitch(this,
function(a){d.removeClass(a,"result-item-selected");var e=d.getAttr(a,"title"),f=d.getAttr(a,"data-index"),h=d.getAttr(a,"data-source-index");e===b.name&&f===g.toString()&&h===c.toString()&&d.addClass(a,"result-item-selected")}))}},_onClearSearch:function(){d.setStyle(this.searchResultsNode,"display","none");this.searchResultsNode.innerHTML="";this.searchResults=null},_hideResultMenu:function(){e(".show-all-results",this.searchResultsNode).style("display","block");e(".searchMenu",this.searchResultsNode).style("display",
"none")},_showResultMenu:function(){d.setStyle(this.searchResultsNode,"display","block");e(".show-all-results",this.searchResultsNode).style("display","none");e(".searchMenu",this.searchResultsNode).style("display","block");var a=e(".esri-input-container",this.searchDijit.domNode)[0];if(a){var a=d.getMarginBox(a),b={width:a.w+"px"};if(window.isRTL){var c=d.getMarginBox(this.searchDijit.domNode);b.right=c.w-a.l-a.w+"px"}else b.left=a.l+"px";e(".show-all-results",this.searchResultsNode).style(b);e(".searchMenu",
this.searchResultsNode).style(b)}},destroy:function(){v.setAppConfig(null);var a=this.sceneView.popup.viewModel;a&&(a.visible=!1);this.searchDijit&&this.searchDijit.viewModel&&(this.searchDijit.viewModel.set("view",null),this.searchDijit.viewModel.clear());this.inherited(arguments)}})});