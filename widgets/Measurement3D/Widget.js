// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Measurement3D/ButtonGroup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/query dojo/dom-class dojo/on dijit/_WidgetBase".split(" "),function(y,p,m,a,l,g,h){return y([h],{baseClass:"jimu-button-group",CSS:{ACTIVE:"jimu-state-active"},buttons:[],activeButton:null,postCreate:function(){this.inherited(arguments);this._initUI()},buttonClicked:function(d){this.activeButton===d?(l.remove(d,this.CSS.ACTIVE),this.activeButton=null):(a("button",this.domNode).removeClass(this.CSS.ACTIVE),
l.add(d,this.CSS.ACTIVE),this.activeButton=d);this.onChange(this.activeButton)},getActiveButton:function(){return this.activeButton},getActiveButtonValue:function(){var a=this.getActiveButton();return a&&a.getAttribute("data-value")},_initUI:function(){m.forEach(this.buttons,function(a){this._createButton(a)},this)},_createButton:function(a){var q=document.createElement("button");q.type="button";q.title=a.label;q.setAttribute("data-value",a.value);a.icon&&q.appendChild(a.icon);q.appendChild(document.createTextNode(a.content||
a.value));this.domNode.appendChild(q);this.own(g(q,"click",p.hitch(this,function(a){this.buttonClicked(a.target)})))},onChange:function(){}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(y,p,m,a,l){return y(l,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);a.forEach(this.views,p.hitch(this,
function(a){1===a.nodeType?(m.place(a,this.domNode),m.addClass(a,"view"),m.setStyle(a,"display","none")):a.domNode&&(m.place(a.domNode,this.domNode),m.addClass(a.domNode,"view"),m.setStyle(a.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var a="",l=this.getSelectedView();l&&(a=l.label);return a},getViewByLabel:function(a){for(var g=0;g<this.views.length;g++)if(a===
this.views[g].label)return this.views[g];return null},addView:function(a){this.views.push(a);1===a.nodeType?(m.place(a,this.domNode),m.addClass(a,"view")):a.domNode&&(m.place(a.domNode,this.domNode),m.addClass(a.domNode,"view"))},removeView:function(g){var l=this.views.length;this.views=a.filter(this.views,function(a){return g!==a});l!==this.views.length&&(1===g.nodeType?m.destroy(g):g.domNode&&g.destroyRecursive())},switchView:function(a){var g,d;g="number"===typeof a?this.views[a]:"string"===typeof a?
this.getViewByLabel(a):a;this.views.forEach(p.hitch(this,function(a){a&&(1===a.nodeType?d=a:a.domNode&&(d=a.domNode),a===g?(m.setStyle(d,"display","block"),a.domNode&&!a._started&&(a.startup(),a._started=!0)):m.setStyle(d,"display","none"))}));this._currentView=g;this.onViewSwitch(g)},onViewSwitch:function(){}})})},"esri/widgets/DirectLineMeasurement3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./DirectLineMeasurement3D/nls/DirectLineMeasurement3D ../core/accessorSupport/decorators ./Widget ./DirectLineMeasurement3D/DirectLineMeasurement3DViewModel ./support/widget".split(" "),
function(y,p,m,a,l,g,h,d,q){return function(e){function c(a){a=e.call(this)||this;a.view=null;a.visible=null;a.viewModel=new d;a.unitOptions=null;a.unit=null;return a}m(c,e);c.prototype.render=function(){var a=this,c=this.viewModel.isSupported,e=this.viewModel.active,f="disabled"===this.viewModel.state,d="ready"===this.viewModel.state,g="measuring"===this.viewModel.state||"measured"===this.viewModel.state,h=this.viewModel.measurement,d=e&&d?q.tsx("section",{key:"esri-direct-line-measurement-3d__hint",
class:"esri-direct-line-measurement-3d__hint"},q.tsx("p",{class:"esri-direct-line-measurement-3d__hint-text"},l.hint)):null,z=c?null:q.tsx("section",{key:"esri-direct-line-measurement-3d__unsupported",class:"esri-direct-line-measurement-3d__panel--error"},q.tsx("p",null,l.unsupported)),k=function(k,b,c){switch(b.state){case "available":return q.tsx("div",{key:c+"-enabled",class:"esri-direct-line-measurement-3d__measurement-item"},q.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},
k),q.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-value"},b.text));case "unavailable":return q.tsx("div",{key:c+"-disabled",class:a.classes("esri-direct-line-measurement-3d__measurement-item","esri-direct-line-measurement-3d__measurement-item--disabled")},q.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},k))}},h=g?q.tsx("section",{key:"esri-direct-line-measurement-3d__measurement",class:"esri-direct-line-measurement-3d__measurement"},k(l.direct,
h.directDistance,"direct"),k(l.horizontal,h.horizontalDistance,"horizontal"),k(l.vertical,h.verticalDistance,"vertical")):null,t=this.id+"__units",k=q.tsx("label",{class:"esri-direct-line-measurement-3d__units-label",for:t},l.unit),t=q.tsx("div",{class:"esri-direct-line-measurement-3d__units-select-wrapper"},q.tsx("select",{class:"esri-direct-line-measurement-3d__units-select esri-select",id:t,onchange:this._changeUnit,bind:this},this.viewModel.unitOptions.map(function(k){return k===a.viewModel.unit?
q.tsx("option",{key:k,value:k,selected:!0},l.units[k]):q.tsx("option",{key:k,value:k},l.units[k])}))),k=q.tsx("section",{key:"esri-direct-line-measurement-3d__units",class:"esri-direct-line-measurement-3d__units"},k,t),k=g?q.tsx("div",{key:"settings",class:"esri-direct-line-measurement-3d__settings"},k):null,c=!c||e&&!g?null:q.tsx("div",{class:"esri-direct-line-measurement-3d__actions"},q.tsx("button",{disabled:f,class:this.classes("esri-button esri-button--secondary","esri-direct-line-measurement-3d__clear-button",
f&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement},l.newMeasurement)),c=this.visible?q.tsx("div",{class:"esri-direct-line-measurement-3d__container"},z,d,k,h,c):null;return q.tsx("div",{key:"",class:"esri-direct-line-measurement-3d esri-widget esri-widget--panel",role:"presentation"},c)};c.prototype._newMeasurement=function(){this.viewModel.newMeasurement()};c.prototype._changeUnit=function(a){a=a.target;if(a=a.options[a.selectedIndex])this.unit=a.value};a([g.aliasOf("viewModel.view")],
c.prototype,"view",void 0);a([g.aliasOf("viewModel.visible"),q.renderable()],c.prototype,"visible",void 0);a([g.aliasOf("viewModel.active"),q.renderable()],c.prototype,"active",void 0);a([g.property({type:d}),q.renderable(["viewModel.state","viewModel.unitOptions","viewModel.unit","viewModel.measurement"])],c.prototype,"viewModel",void 0);a([g.aliasOf("viewModel.unitOptions")],c.prototype,"unitOptions",void 0);a([g.aliasOf("viewModel.unit")],c.prototype,"unit",void 0);a([q.accessibleHandler()],c.prototype,
"_newMeasurement",null);a([q.accessibleHandler()],c.prototype,"_changeUnit",null);return c=a([g.subclass("esri.widgets.DirectLineMeasurement3D")],c)}(g.declared(h))})},"esri/widgets/DirectLineMeasurement3D/DirectLineMeasurement3DViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/Logger ../../core/unitUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool ../support/InteractiveToolViewModel".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c){var b="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" "),n=g.getLogger("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel");return function(c){function f(a){a=c.call(this,a)||this;a.supportedViewType="3d";a._handles=new l;a._userUnitOptions=null;a._userUnit=null;return a}m(f,c);f.prototype.initialize=function(){var a=this;this._handles.add([d.init(this,"unit",function(b){a.tool&&(a.tool.unit=b)})])};f.prototype.destroy=
function(){this._handles.destroy();this._handles=null};Object.defineProperty(f.prototype,"state",{get:function(){return this.isDisabled?"disabled":this.tool.state},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"measurement",{get:function(){if(!this.tool)return null;var a=this.tool.model,b=a.measurementMode,c="geodesic"===b,a=a.validMeasurement;return{mode:b,directDistance:{text:c?null:this.tool.triangleView.directLabel,state:a&&!c?"available":"unavailable"},horizontalDistance:{text:this.tool.triangleView.horizontalLabel,
state:a?"available":"unavailable"},verticalDistance:{text:this.tool.triangleView.verticalLabel,state:a?"available":"unavailable"}}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"defaultUnit",{get:function(){return this.defaultUnitFromPortal||this.defaultUnitFromSpatialReference||"metric"},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"defaultUnitFromSpatialReference",{get:function(){return h.getDefaultUnitSystem(this.view&&this.view.spatialReference)},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"defaultUnitFromPortal",{get:function(){var a=this.get("view.map.portalItem.portal");if(!a)return null;switch(a.user&&a.user.units||a.units){case "metric":return"metric";case "english":return"imperial";default:return null}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"unitOptions",{get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(a){this._userUnitOptions=a;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"unit",{get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},set:function(a){this._userUnit=a?this._findSelectableUnit(a,this._userUnit):null;this.notifyChange("unit")},enumerable:!0,configurable:!0});f.prototype.newMeasurement=function(){this.tool&&this.tool.newMeasurement()};f.prototype.clearMeasurement=function(){this.tool&&this.tool.clearMeasurement()};
f.prototype.createToolParams=function(){return{toolConstructor:e,constructorArguments:{unit:this.unit}}};f.prototype.logUnsupportedError=function(){n.error("DirectLineMeasurement3D widget is not implemented for MapView")};f.prototype.logError=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];n.error.apply(n,a)};f.prototype._findSelectableUnit=function(a,b){var c=this.unitOptions;return-1!==c.indexOf(a)?a:b?this._findSelectableUnit(b):c[0]};f.prototype._filteredOrAllUnits=function(a){if(!a)return b.slice();
a=a.filter(function(a){return-1!==b.indexOf(a)});return 0===a.length?b.slice():a};a([q.property({dependsOn:["view.ready","isDisabled","tool.state"],readOnly:!0})],f.prototype,"state",null);a([q.property({dependsOn:"view.ready tool.triangleView tool.model.directDistance tool.model.horizontalDistance tool.model.verticalDistance tool.model.geodesicDistance tool.model.measurementMode".split(" "),readOnly:!0})],f.prototype,"measurement",null);a([q.property()],f.prototype,"tool",void 0);a([q.property({readOnly:!0,
dependsOn:["defaultUnitFromPortal","defaultUnitFromSpatialReference"]})],f.prototype,"defaultUnit",null);a([q.property({readOnly:!0,dependsOn:["view.spatialReference"]})],f.prototype,"defaultUnitFromSpatialReference",null);a([q.property({readOnly:!0,dependsOn:["view.map.portalItem.portal.units","view.map.portalItem.portal.user.units"]})],f.prototype,"defaultUnitFromPortal",null);a([q.property({dependsOn:["view.spatialReference"]})],f.prototype,"unitOptions",null);a([q.property({dependsOn:["unitOptions",
"defaultUnit"]})],f.prototype,"unit",null);return f=a([q.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],f)}(q.declared(c))})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/restHelper ../../../../../core/Handles ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./DirectLineMeasurement3DController ./DirectLineMeasurement3DModel ./DirectLineMeasurement3DView ../../../../interactive/InteractiveToolBase ../../../../interactive/interactiveToolUtils".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n){return function(b){function f(a){var c=b.call(this,a)||this;c.startManipulator=null;c.endManipulator=null;c.model=new e({sceneView:a.view});return c}m(f,b);f.prototype.normalizeCtorArgs=function(a){return l(a,["view"])};f.prototype.initialize=function(){var a=this;this._view=new c(this.model);this._controller=new q(this.model,this._view);this._handles=new g;this._handles.add([h.init(this,"state",function(){"measured"===a.state&&n.setActive(a,!1)},!0)]);var b=this._view.createManipulators();
this._controller.setup(b);this.manipulators.add(b.start);this.manipulators.add(b.end);this.startManipulator=b.start;this.endManipulator=b.end};f.prototype.destroy=function(){this._view.destroy();this._view=null;this._controller.destroy();this._controller=null;this._handles.destroy();this._handles=null};Object.defineProperty(f.prototype,"state",{get:function(){return this.model.isMeasuring?"measured"===this.model.state?"measured":"measuring":"ready"},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"isSupported",{get:function(){return"3d"===this.get("view.type")},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"cursor",{get:function(){return!this.model.active||"drawing"!==this.model.state&&"initial"!==this.model.state?null:"crosshair"},enumerable:!0,configurable:!0});f.prototype.newMeasurement=function(){this.model.reset();n.setActive(this,!0)};f.prototype.clearMeasurement=function(){this.model.reset();n.setActive(this,!1)};f.prototype.activate=function(){this.model.active=
!0};f.prototype.deactivate=function(){this.model.active=!1;"measured"!==this.model.state&&this.model.reset()};f.prototype.onDetach=function(){this.model.reset()};f.prototype.onShow=function(){this._view.show();this._updateManipulatorVisibility()};f.prototype.onHide=function(){this._view.hide()};f.prototype.onInputEvent=function(a){this._controller.handleInputEvent(a,{start:this.startManipulator,end:this.endManipulator});this._updateManipulatorVisibility()};f.prototype._updateManipulatorVisibility=
function(){this.startManipulator.visible=null!=this.model.startPoint;this.endManipulator.visible=null!=this.model.endPoint};a([d.property({dependsOn:["model.isMeasuring","model.state"],readOnly:!0})],f.prototype,"state",null);a([d.property({dependsOn:["view.type"],readOnly:!0})],f.prototype,"isSupported",null);a([d.property({dependsOn:["model.active","model.state"],readOnly:!0})],f.prototype,"cursor",null);a([d.property({constructOnly:!0})],f.prototype,"model",void 0);a([d.aliasOf("model.sceneView")],
f.prototype,"view",void 0);a([d.aliasOf("model.mode")],f.prototype,"mode",void 0);a([d.aliasOf("model.unit")],f.prototype,"unit",void 0);a([d.aliasOf("model.directDistance")],f.prototype,"directDistance",void 0);a([d.aliasOf("model.validMeasurement")],f.prototype,"validMeasurement",void 0);a([d.aliasOf("model.horizontalDistance")],f.prototype,"horizontalDistance",void 0);a([d.aliasOf("model.verticalDistance")],f.prototype,"verticalDistance",void 0);a([d.aliasOf("model.geodesicDistance")],f.prototype,
"geodesicDistance",void 0);a([d.aliasOf("model.geodesicAngle")],f.prototype,"geodesicAngle",void 0);a([d.aliasOf("model.triangleView")],f.prototype,"triangleView",void 0);return f=a([d.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],f)}(d.declared(b.InteractiveToolBase))})},"esri/core/tsSupport/restHelper":function(){define([],function(){return function(y,p){var m={},a;for(a in y)Object.prototype.hasOwnProperty.call(y,a)&&0>p.indexOf(a)&&
(m[a]=y[a]);if(null!=y&&"function"===typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(y);l<a.length;l++)0>p.indexOf(a[l])&&(m[a[l]]=y[a[l]])}return m}})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../geometry ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../layers/graphics/dehydratedFeatures ./DirectLineMeasurement3DView".split(" "),
function(y,p,m,a,l,g,h,d,q,e){y=function(){function a(a,b){this._handles=new g;this._cachedPickRequest=new e.PickRequest;this._cachedPickResult=new e.PickResult;this._isAnyPointerDown=!1;this.model=a;this.view=b;this.model.reset()}a.prototype.destroy=function(){this._handles.destroy();this._handles=null};a.prototype.setup=function(a){var b=this,f=a.start,e=a.end;f.on("drag",function(){var a=f.mapPoint,e=f.surfaceType;h.isSome(a)&&h.isSome(e)&&(a=q.clonePoint(a,c),b.model.startPoint=a,b.model.startPointSurfaceLocation=
b._surfaceLocation(a,e))});e.on("drag",function(){var a=e.mapPoint,f=e.surfaceType;h.isSome(a)&&h.isSome(f)&&(a=q.clonePoint(a,c),b.model.endPoint=a,b.model.endPointSurfaceLocation=b._surfaceLocation(a,f))});[f,e].forEach(function(c){b._handles.add([c.watch("grabbing",function(){var c=a.start.grabbing||a.end.grabbing;c&&"measured"===b.model.state&&(b.model.state="editing");c||(b.model.finishedMeasurement({cameraAboveGround:b.view.cameraAboveGround}),"editing"===b.model.state&&(b.model.state="measured"))},
!0)])})};a.prototype.handleInputEvent=function(a,b){switch(a.type){case "immediate-click":this._handleImmediateClick(a,b);break;case "pointer-move":this._handlePointerMove(a,b);break;case "pointer-down":this._handlePointerDown(a);break;case "pointer-up":this._handlePointerUp(a);break;case "key-down":this._handleKeyDown(a)}};a.prototype._handlePointerMove=function(a,b){this._clearCachedPickRequest();var c=d.createScreenPointFromEvent(a);"mouse"===a.pointerType&&(this._hoverAt(c),"drawing"===this.model.state&&
(b.end.attemptDragTo({screenPoint:c}),a.stopPropagation()))};a.prototype._handlePointerDown=function(a){this._isAnyPointerDown=!0};a.prototype._handlePointerUp=function(a){this._isAnyPointerDown=!1};a.prototype._handleImmediateClick=function(a,b){this._clearCachedPickRequest();if("mouse"!==a.pointerType||0===a.button){var c=d.createScreenPointFromEvent(a),e=!1;if(this.model.active)switch(this.model.state){case "initial":b.start.attemptDragTo({screenPoint:c})&&(b.start.interactive=!1,b.end.interactive=
!1,this.model.state="drawing",e=!0);break;case "drawing":b.end.attemptDragTo({screenPoint:c})&&(b.start.interactive=!0,b.end.interactive=!0,this.model.finishedMeasurement({cameraAboveGround:this.view.cameraAboveGround}),e=!0)}e&&a.stopPropagation();"mouse"===a.pointerType&&this._hoverAt(c)}};a.prototype._handleKeyDown=function(a){"Escape"===a.key&&"drawing"===this.model.state&&(this.model.clearMeasurement(),a.stopPropagation())};a.prototype._hoverAt=function(a){var b=this._isAnyPointerDown&&"drawing"!==
this.model.state&&"editing"!==this.model.state;this.view.requiresCursorPoint&&!b?(a=this._pick(a),a.mapPoint&&(this.model.cursorPoint=a.mapPoint)):this.model.cursorPoint=null};a.prototype._pick=function(a){var b=this._cachedPickRequest.screenPoint;if(b&&b.x===a.x&&b.y===a.y)return this._cachedPickResult;this._cachedPickRequest.screenPoint=a;return this._cachedPickResult=this.view.pick(this._cachedPickRequest)};a.prototype._clearCachedPickRequest=function(){this._cachedPickRequest.screenPoint=null};
a.prototype._surfaceLocation=function(a,b){return"ground"===b?"on-the-surface":a.z>=this.view.getElevation(a)?"above-the-surface":"below-the-surface"};return a}();var c=new l.Point;return y})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DView":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ./LaserLineRenderer ../support/Label ../support/LabelSegment ../support/labelUtils ../support/PathSegmentInterpolator ../support/viewUtils ../../../support/mathUtils ../../../support/projectionUtils ../../../support/stack ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryData ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/Layer ../../../webgl-engine/lib/Object3D ../../../webgl-engine/materials/ColorMaterial ../../../webgl-engine/materials/MeasurementArrowMaterial ../../../webgl-engine/materials/RibbonLineMaterial ../../../webgl-engine/parts/Model ../../../../interactive/manipulatorUtils".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n,u,f,x,B,v,z,k,t,r,w,C,K,G,H,E,I,D,N){y=[1,.5,0,.75];var F={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,triangleColor:y,triangleLineWidth:3,triangleCornerSize:32,triangleSubdivisions:128,arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],
arrowStripeLength:16,arrowSubdivisions:128,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:y,guideLineWidth:2,guideLineColor:y,guideStippleLengthPixels:6,labelDistance:25};y=function(){function a(a,k){void 0===k&&(k={});this._visible=!1;this._laserLineRenderer=null;this._directDistanceLabel=new n;this._horizontalDistanceLabel=new n;this._verticalDistanceLabel=new n;this._handles=new l;this._listenerHandles=null;this._cursorPosition=c.vec3f64.create();this._startPosition=c.vec3f64.create();
this._endPosition=c.vec3f64.create();this._centerPosition=c.vec3f64.create();this._cornerPosition=c.vec3f64.create();this._arrowLabelSegment=new u;this._horizontalLabelSegment=new u;this._verticalLabelSegment=new u;this._geodesicProjectionLabelSegment=new u;this._origin=c.vec3f64.create();this._originTransform=d.mat4f64.create();this._lastDraggedHandle=null;this._model=a;this._sceneView=a.sceneView;this._params=B.copyParameter(F,k);this._layer=new K("point-to-point-measurement",{isPickable:!1});this._createMaterials();
this._createObjects();this._intersector=new C(this._sceneView.viewingMode)}a.prototype.destroy=function(){this.hide();this._handles.destroy();this._handles=null};Object.defineProperty(a.prototype,"requiresCursorPoint",{get:function(){return"initial"===this._model.state&&this._model.active},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"cameraAboveGround",{get:function(){return this._sceneView.state.camera.aboveGround},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"visible",{get:function(){return this._visible},set:function(a){a?this.show():this.hide()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"testData",{get:function(){return{labels:{direct:this._directDistanceLabel,horizontal:this._horizontalDistanceLabel,vertical:this._verticalDistanceLabel},laserLineRenderer:this._laserLineRenderer}},enumerable:!0,configurable:!0});a.prototype.createManipulators=function(){var a=this,k=function(){var k=N.createSphereManipulator(a._sceneView,a._params.handleColor,
a._params.handleOpacity);k.visible=!1;k.hideOnGrab=!0;k.radius=a._params.handleRadius;return k},b=k(),c=k();this._model.startPoint&&(b.mapPoint=this._model.startPoint,b.visible=!0);this._model.endPoint&&(c.mapPoint=this._model.endPoint,c.visible=!0);var f=function(){var k=a._lastDraggedHandle;b.grabbing&&!c.grabbing&&(k="start");c.grabbing&&!b.grabbing&&(k="end");b.grabbing||c.grabbing||(k=null);var f=k!==a._lastDraggedHandle;a._lastDraggedHandle=k;f&&a.visible&&a._updateLaserLine()};this._handles.add([b.watch("grabbing",
function(){f()}),c.watch("grabbing",function(){f()})]);return{start:b,end:c}};a.prototype.show=function(){if(!this._visible){this._visible=!0;var a=this._sceneView._stage;this._laserLineRenderer=new b(this._sceneView.renderCoordsHelper,{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,globalAlpha:this._params.laserLineGlobalAlpha});a.addRenderPlugin(this._laserLineRenderer.renderSlots,
this._laserLineRenderer);this._addToStage(a);this._directDistanceLabel.addToView(this._sceneView);this._horizontalDistanceLabel.addToView(this._sceneView);this._verticalDistanceLabel.addToView(this._sceneView);this._initializeListeners();this._updateCursorPosition();this._updateStartPosition();this._updateEndPosition();this._updateLaserLine();this._updateView()}};a.prototype.hide=function(){if(this._visible){this._visible=!1;var a=this._sceneView._stage;a.removeRenderPlugin(this._laserLineRenderer);
this._laserLineRenderer=null;this._removeFromStage(a);this._directDistanceLabel.removeFromView(this._sceneView);this._horizontalDistanceLabel.removeFromView(this._sceneView);this._verticalDistanceLabel.removeFromView(this._sceneView);this._destroyListeners();this._sceneView.cursor=null}};a.prototype.pick=function(k){var b=this._sceneView.spatialReference;k=g.screenPointObjectToArray(k.screenPoint);k=this._sceneView.sceneIntersectionHelper.intersectToolIntersectorScreen(k,this._intersector).results.min;
var f=c.vec3f64.create();if(!k.getIntersectionPoint(f))return new a.PickResult;b=this._sceneView.renderCoordsHelper.fromRenderCoords(f,b);return new a.PickResult("TerrainRenderer"===k.intersector?"ground":"feature",f,b)};a.prototype.getElevation=function(a){return this._sceneView.basemapTerrain.ready?this._sceneView.basemapTerrain.getElevation(a)||0:0};a.prototype.overlappingHandles=function(a,k){return B.pointToPointScreenDistance(a,k,this._sceneView)<=this._params.handleRadius};a.prototype._createMaterials=
function(){this._triangleLineMaterial=new I({width:this._params.triangleLineWidth,color:this._params.triangleColor,polygonOffset:!0},"triangle-line");this._triangleLineMaterial.renderOccluded=4;this._triangleCornerMaterial=new H({color:this._params.triangleColor,transparent:!0,writeDepth:!1,polygonOffset:!0},"triangle-corner");this._triangleCornerMaterial.renderOccluded=4;this._arrowMaterial=new E({outlineColor:this._params.arrowOutlineColor,stripeEvenColor:this._params.arrowStripeEvenColor,stripeOddColor:this._params.arrowStripeOddColor,
polygonOffset:!0},"arrow");this._arrowMaterial.renderOccluded=4;this._geodesicProjectionLineMaterial=new I({width:this._params.geodesicProjectionLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0},"geodesic-line");this._geodesicProjectionLineMaterial.renderOccluded=4;this._geodesicGuideLineMaterial=new I({width:this._params.guideLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0,stippleLength:0},"geodesic-guide");this._geodesicGuideLineMaterial.renderOccluded=
4};a.prototype._createObjects=function(){this._triangleLineObject=new G;this._layer.addObject(this._triangleLineObject);this._triangleCornerObject=new G;this._layer.addObject(this._triangleCornerObject);this._arrowObject=new G;this._layer.addObject(this._arrowObject);this._geodesicProjectionLineObject=new G;this._layer.addObject(this._geodesicProjectionLineObject);this._geodesicProjectionStartGuideObject=new G;this._layer.addObject(this._geodesicProjectionStartGuideObject);this._geodesicProjectionEndGuideObject=
new G;this._layer.addObject(this._geodesicProjectionEndGuideObject)};a.prototype._addToStage=function(a){a.add(D.ContentType.LAYER,this._layer);a.add(D.ContentType.MATERIAL,this._triangleLineMaterial);a.add(D.ContentType.MATERIAL,this._triangleCornerMaterial);a.add(D.ContentType.MATERIAL,this._arrowMaterial);a.add(D.ContentType.MATERIAL,this._geodesicProjectionLineMaterial);a.add(D.ContentType.MATERIAL,this._geodesicGuideLineMaterial);a.add(D.ContentType.OBJECT,this._triangleLineObject);a.add(D.ContentType.OBJECT,
this._triangleCornerObject);a.add(D.ContentType.OBJECT,this._arrowObject);a.add(D.ContentType.OBJECT,this._geodesicProjectionLineObject);a.add(D.ContentType.OBJECT,this._geodesicProjectionStartGuideObject);a.add(D.ContentType.OBJECT,this._geodesicProjectionEndGuideObject);a.addToViewContent([this._layer.id])};a.prototype._removeFromStage=function(a){a.removeFromViewContent([this._layer.id]);a.remove(D.ContentType.LAYER,this._layer.id);a.remove(D.ContentType.MATERIAL,this._triangleLineMaterial.id);
a.remove(D.ContentType.MATERIAL,this._triangleCornerMaterial.id);a.remove(D.ContentType.MATERIAL,this._arrowMaterial.id);a.remove(D.ContentType.MATERIAL,this._geodesicProjectionLineMaterial.id);a.remove(D.ContentType.MATERIAL,this._geodesicGuideLineMaterial.id);a.remove(D.ContentType.OBJECT,this._triangleLineObject.id);a.remove(D.ContentType.OBJECT,this._triangleCornerObject.id);a.remove(D.ContentType.OBJECT,this._arrowObject.id);a.remove(D.ContentType.OBJECT,this._geodesicProjectionLineObject.id);
a.remove(D.ContentType.OBJECT,this._geodesicProjectionStartGuideObject.id);a.remove(D.ContentType.OBJECT,this._geodesicProjectionEndGuideObject.id)};a.prototype._getLabelPositions=function(a,b,c,r,w){var t=this._model.triangleView.collapsed,e=g.castRenderScreenPointArray3(k.sv3d.get()),d=g.castRenderScreenPointArray3(k.sv3d.get());w.projectPoint(c,e);w.projectPoint(b,d);e={direct:t?"top":"bottom",horizontal:"top",vertical:e[0]<d[0]?"left":"right"};t||(d=k.sv2d.get(),t=k.sv2d.get(),B.screenSpaceTangent(a,
c,d,w),B.screenSpaceTangent(a,b,t,w),q.vec2.dot(d,t)>=A?e.direct=v.sign(d[1])===v.sign(t[1])?f.mirrorPosition(e.vertical):e.vertical:(a=g.castRenderScreenPointArray(k.sv2d.get()),B.screenSpaceTangent(c,b,a,w),q.vec2.dot(a,t)>=A&&(e.direct=v.sign(a[0])===v.sign(t[0])?f.mirrorPosition(e.horizontal):e.horizontal)));"below-the-surface"===r&&(b=function(a){return"top"===a?"bottom":"top"},e.direct=b(e.direct),e.horizontal=b(e.horizontal),e.vertical=b(e.vertical));return e};a.prototype._updateView=function(){var a;
if(this._sceneView.ready){var k=this._sceneView._stage.getCamera(),b=this._sceneView.renderCoordsHelper,c=this._model.triangleView;if(c.visible){var f="camera-dependent"===this._model.measurementSurfaceLocation?this._sceneView.state.camera.aboveGround?"above-the-surface":"below-the-surface":this._model.measurementSurfaceLocation,w=this._startPosition;a=this._endPosition;var t="above-the-surface"===f?1:-1,r=t*(b.getAltitude(a)-b.getAltitude(w));0>r&&(a=[a,w],w=a[0],a=a[1]);var A=this._cornerPosition;
b.worldUpAtPosition(w,A);e.vec3.scale(A,A,t*Math.abs(r));e.vec3.add(A,A,w);b=this._centerPosition;B.midpoint([w,a,A],b);e.vec3.copy(this._origin,b);h.mat4.identity(this._originTransform);h.mat4.translate(this._originTransform,this._originTransform,this._origin);c.collapsed?(this._triangleLineObject.removeAllGeometries(),this._triangleCornerObject.removeAllGeometries()):this._updateTriangleObjects(this._triangleLineObject,this._triangleCornerObject,w,a,A,this._origin,this._originTransform,k,c.mode,
this._horizontalLabelSegment,this._verticalLabelSegment);this._updateArrowObject(this._arrowObject,this._startPosition,this._endPosition,this._origin,this._originTransform,c.stripeLength,k,c.mode,this._arrowLabelSegment);b=this._requiresGeodesicGuides(this._startPosition,this._endPosition,k,c.mode);this._updateGeodesicProjectionLineObject(this._geodesicProjectionLineObject,this._startPosition,this._endPosition,this._origin,this._originTransform,b,this._geodesicProjectionLabelSegment);this._updateGeodesicProjectionGuideObjects(k,
b);t=this._params.labelDistance;f=this._getLabelPositions(w,a,A,f,k);this._updateAuxiliaryMeasureLabels(c,k,f);"geodesic"!==c.mode?this._updateLabel(this._directDistanceLabel,this._arrowLabelSegment,t,f.direct,c.directLabel,c.visible,16,k):(this._updateLabel(this._horizontalDistanceLabel,b?this._geodesicProjectionLabelSegment:this._arrowLabelSegment,t,f.horizontal,c.horizontalLabel,c.visible,16,k),this._directDistanceLabel.visible=!1)}else this._triangleLineObject.removeAllGeometries(),this._triangleCornerObject.removeAllGeometries(),
this._arrowObject.removeAllGeometries(),this._geodesicProjectionLineObject.removeAllGeometries(),this._geodesicProjectionStartGuideObject.removeAllGeometries(),this._geodesicProjectionEndGuideObject.removeAllGeometries(),this._directDistanceLabel.visible=!1,this._horizontalDistanceLabel.visible=!1,this._verticalDistanceLabel.visible=!1}};a.prototype._updateAuxiliaryMeasureLabels=function(a,k,b){if(a.collapsed)this._horizontalDistanceLabel.visible=!1,this._verticalDistanceLabel.visible=!1;else{var c=
this._params.labelDistance;this._updateLabel(this._horizontalDistanceLabel,this._horizontalLabelSegment,c,b.horizontal,a.horizontalLabel,!0,12,k);this._updateLabel(this._verticalDistanceLabel,this._verticalLabelSegment,c,b.vertical,a.verticalLabel,!0,12,k)}};a.prototype._updateTriangleObjects=function(a,b,c,f,r,A,d,g,q,C,l){q=[e.vec3.subtract(k.sv3d.get(),c,A),e.vec3.subtract(k.sv3d.get(),r,A),e.vec3.subtract(k.sv3d.get(),f,A)];C.update(r,f);l.update(c,r);C=new t(w.createPolylineGeometry(q),"triangle-line");
a.removeAllGeometries();a.addGeometry(C,this._triangleLineMaterial,d);a=k.sv3d.get();C=k.sv3d.get();e.vec3.subtract(a,r,c);e.vec3.normalize(a,a);e.vec3.subtract(C,f,r);e.vec3.normalize(C,C);c=.33*Math.min(e.vec3.distance(r,c),e.vec3.distance(r,f));g=this._params.triangleCornerSize*g.computeScreenPixelSizeAt(r);r=new t(this._quadGeometryData(r,a,C,Math.min(c,g),A),"triangle-corner");b.removeAllGeometries();b.addGeometry(r,this._triangleCornerMaterial,d)};a.prototype._updateArrowObject=function(a,k,
b,c,f,r,w,t,e){this._createInterpolatedLineGeometry(a,this._arrowMaterial,"arrow",k,b,c,f,t,this._arrowLabelSegment);a=w.computeScreenPixelSizeAt(e.origin);this._arrowMaterial.setParameterValues({width:this._params.arrowWidth*a,stripeLength:r})};a.prototype._getSegmentInterpolator=function(a,k){var b=this._sceneView.renderCoordsHelper.spatialReference;return z.canProject(this._sceneView.spatialReference,z.SphericalECEFSpatialReference)?new x.Spherical(a,k,b,b):new x.Linear(a,k)};a.prototype._updateGeodesicProjectionLineObject=
function(a,b,c,f,r,w,t){w?(w=this._sceneView.renderCoordsHelper,b=e.vec3.copy(k.sv3d.get(),b),c=e.vec3.copy(k.sv3d.get(),c),w.setAltitude(0,b),w.setAltitude(0,c),this._createInterpolatedLineGeometry(a,this._geodesicProjectionLineMaterial,"geodesicProjectionLine",b,c,f,r,"geodesic",t)):a.removeAllGeometries()};a.prototype._requiresGeodesicGuides=function(a,k,b,c){return"geodesic"===c&&this._model.geodesicDistanceExceeded?this._requiresGeodesicGuideAt(a,b)||this._requiresGeodesicGuideAt(k,b):!1};a.prototype._requiresGeodesicGuideAt=
function(a,k){var b=this._sceneView.renderCoordsHelper;k=k.computeScreenPixelSizeAt(a);return 10<=b.getAltitude(a)/k};a.prototype._updateGeodesicProjectionGuideObjects=function(a,b){if(b){b=this._sceneView.renderCoordsHelper;var c=e.vec3.copy(k.sv3d.get(),this._startPosition),f=e.vec3.copy(k.sv3d.get(),this._endPosition);b.setAltitude(0,c);b.setAltitude(0,f);this._createInterpolatedLineGeometry(this._geodesicProjectionStartGuideObject,this._geodesicGuideLineMaterial,"geodesicGuideLine",c,this._startPosition,
this._origin,this._originTransform,"euclidean");this._createInterpolatedLineGeometry(this._geodesicProjectionEndGuideObject,this._geodesicGuideLineMaterial,"geodesicGuideLine",f,this._endPosition,this._origin,this._originTransform,"euclidean");a=Math.min(a.computeScreenPixelSizeAt(this._startPosition),a.computeScreenPixelSizeAt(c),a.computeScreenPixelSizeAt(this._endPosition),a.computeScreenPixelSizeAt(f));this._geodesicGuideLineMaterial.setParameterValues({stippleLength:this._params.guideStippleLengthPixels*
a})}else this._geodesicProjectionStartGuideObject.removeAllGeometries(),this._geodesicProjectionEndGuideObject.removeAllGeometries()};a.prototype._createInterpolatedLineGeometry=function(a,b,c,f,r,A,d,C,g){var q=this._sceneView.renderCoordsHelper,l=[],h=[],z=function(a,b){var c=k.sv3d.get();e.vec3.subtract(c,a,A);l.push(c);h.push(b)};if("euclidean"===C){var u=k.sv3d.get();B.midpoint([f,r],u);C=k.sv3d.get();q.worldUpAtPosition(u,C);z(f,C);z(r,C);g&&g.update(f,r)}else{f=this._getSegmentInterpolator(f,
r);r=this._params.arrowSubdivisions+1&-2;for(var n=u=null,m=0;m<r;++m){var v=m/(r-1),x=k.sv3d.get();C=k.sv3d.get();f.eval(v,x);q.worldUpAtPosition(x,C);m===r/2-1?u=x:m===r/2&&(n=x);z(x,C)}g&&g.update(u,n)}c=new t(w.createPolylineGeometry(l,h),c);a.removeAllGeometries();a.addGeometry(c,b,d)};a.prototype._quadGeometryData=function(a,b,c,f,w){var t=k.sv3d.get(),A=[],d=k.sv3d.get();e.vec3.scale(d,c,f);c=k.sv3d.get();e.vec3.scale(c,b,-f);for(b=0;4>b;++b)e.vec3.copy(t,a),e.vec3.subtract(t,t,w),b&1&&e.vec3.add(t,
t,d),b&2&&e.vec3.add(t,t,c),A.push(t[0],t[1],t[2]);return new r({position:{size:3,data:A}},{position:new Uint32Array([0,1,2,1,2,3])})};a.prototype._updateLabel=function(a,b,c,r,t,w,A,e){var d=g.castScreenPointArray(k.sv2d.get()),C=g.castScreenPointArray(k.sv2d.get());b=f.computeLabelPositionFromSegment(e,b,c,r,d,C);a.updatePosition(d,C);a.text=t;a.visible=b&&w;a.fontSize=A};a.prototype._updateCursorPosition=function(){this._model.cursorPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.cursorPoint,
this._cursorPosition);this._updateLaserLine()};a.prototype._updateStartPosition=function(){this._model.startPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.startPoint,this._startPosition)};a.prototype._updateEndPosition=function(){this._model.endPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.endPoint,this._endPosition)};a.prototype._getFocusPosition=function(){var a=this._model,k=a.triangleView.visible&&a.triangleView.collapsed&&"euclidean"===a.measurementMode;
switch(a.state){case "drawing":return k?this._startPosition:a.endPoint?this._endPosition:this._startPosition;case "editing":return k?"start"===this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return a.cursorPoint?this._cursorPosition:null}};a.prototype._getFocusSpherePosition=function(){return"drawing"===this._model.state||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition};a.prototype._updateLaserLine=
function(){var a=this._model,k=this._getFocusPosition(),b=this._params.laserLineEnabled&&!!k&&"measured"!==a.state&&a.active;b?(this._laserLineRenderer.focusPlaneActive=b&&"euclidean"===a.measurementMode,this._laserLineRenderer.focusSphereActive=b&&!!a.startPoint&&"geodesic"===a.measurementMode,this._laserLineRenderer.focusPosition=k,this._laserLineRenderer.focusSpherePosition=this._getFocusSpherePosition(),this._laserLineRenderer.segmentActive=b&&a.triangleView.visible&&!a.triangleView.collapsed,
this._laserLineRenderer.segmentStartPosition=this._startPosition,this._laserLineRenderer.segmentEndPosition=this._endPosition):(this._laserLineRenderer.focusPlaneActive=!1,this._laserLineRenderer.focusSphereActive=!1,this._laserLineRenderer.segmentActive=!1)};a.prototype._initializeListeners=function(){var a=this;this._listenerHandles=new l;this._listenerHandles.add([this._model.watch("state",function(){a._updateLaserLine()}),this._model.watch("measurementMode",function(){a._updateLaserLine()}),this._model.watch("hoveredHandle",
function(){a._updateView()}),this._model.watch("cursorPoint",function(){a._updateCursorPosition()}),this._model.watch("startPoint",function(){a._updateStartPosition();a._updateView();a._updateLaserLine()}),this._model.watch("endPoint",function(){a._updateEndPosition();a._updateView();a._updateLaserLine()}),this._model.watch("unit",function(){a._updateView()}),this._model.watch("active",function(){a._updateLaserLine();a._updateView()}),this._sceneView.state.watch("camera",function(){a._updateView()})])};
a.prototype._destroyListeners=function(){this._listenerHandles.destroy();this._listenerHandles=null};return a}();(function(a){var k=function(){return function(){}}();a.PickRequest=k;k=function(){return function(a,k,b){void 0===a&&(a=null);void 0===k&&(k=null);void 0===b&&(b=null);this.type=a;this.scenePoint=k;this.mapPoint=b}}();a.PickResult=k})(y||(y={}));var A=Math.cos(v.deg2rad(12));return y})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/LaserLineRenderer":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/vec4 ../../../../../core/libs/gl-matrix-2/vec4f64 ../../../webgl-engine/lib/glUtil3D ../../../webgl-engine/lib/Util ../../../webgl-engine/materials/internal/MaterialUtil ../../../webgl-engine/shaders/LaserLinePrograms ../../../../webgl/renderState".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n){function u(a,b,k,c){var r=f,t=x;l.vec3.transformMat4(r,b,c);l.vec3.copy(t,k);t[3]=0;h.vec4.transformMat4(t,t,c);h.vec4.set(a,t[0],t[1],t[2],-l.vec3.dot(t,r))}var f=g.vec3f64.create(),x=d.vec4f64.create(),B={glowColor:[1,.5,0],glowWidth:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75};return function(){function h(b,k){void 0===k&&(k={});this._projInfo=d.vec4f64.create();this._zScale=a.vec2f64.create();this._segmentActive=this._focusSphereActive=this._focusPlaneActive=
!1;this._focusPosition=g.vec3f64.create();this._focusSpherePosition=g.vec3f64.create();this._segmentStartPosition=g.vec3f64.create();this._segmentEndPosition=g.vec3f64.create();this._needsRender=!1;this._tempNormal=g.vec3f64.create();this._tempDir=g.vec3f64.create();this._tempUp=g.vec3f64.create();this._tempVec3=g.vec3f64.create();this._tempVec4=d.vec4f64.create();this.didRender=!1;this._renderCoordsHelper=b;this._params=c.copyParameters(k,B)}Object.defineProperty(h.prototype,"needsRender",{get:function(){return this._needsRender},
enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"renderSlots",{get:function(){return[15]},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"needsLinearDepth",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"focusPlaneActive",{get:function(){return this._focusPlaneActive},set:function(a){a!==this._focusPlaneActive&&(this._focusPlaneActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"focusSphereActive",{get:function(){return this._focusSphereActive},set:function(a){a!==this._focusSphereActive&&(this._focusSphereActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"segmentActive",{get:function(){return this._segmentActive},set:function(a){a!==this._segmentActive&&(this._segmentActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"focusPosition",{get:function(){return this._focusPosition},
set:function(a){l.vec3.copy(this._focusPosition,a);this._needsRender=!0},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"focusSpherePosition",{get:function(){return this._focusSpherePosition},set:function(a){l.vec3.copy(this._focusSpherePosition,a);this._needsRender=!0},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"segmentStartPosition",{get:function(){return this._segmentStartPosition},set:function(a){l.vec3.copy(this._segmentStartPosition,a);this._needsRender=
!0},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"segmentEndPosition",{get:function(){return this._segmentEndPosition},set:function(a){l.vec3.copy(this._segmentEndPosition,a);this._needsRender=!0},enumerable:!0,configurable:!0});h.prototype.setParameterValues=function(a){c.updateParameters(this._params,a)&&(this._needsRender=!0)};h.prototype.initializeRenderContext=function(a){this._quadVAO=q.createQuadVAO(a.rctx);this._laserLineProgram=a.programRep.getProgram(b.program);this._laserLinePipelineState=
n.makePipelineState({blending:n.simpleBlendingParams(1,771),colorWrite:n.defaultColorWriteParams})};h.prototype.uninitializeRenderContext=function(a){this._quadVAO.dispose();this._projInfo=this._laserLineProgram=this._quadVAO=null};h.prototype.render=function(a){this._needsRender=!1;var k=a.rctx,b=a.camera,c=this._renderCoordsHelper,w=this._laserLineProgram,d=this._projInfo,g=this._zScale;k.bindProgram(w);k.setPipelineState(this._laserLinePipelineState);e.inverseProjectionInfo(b.projectionMatrix,
b.fullWidth,b.fullHeight,d,g);w.setUniform4fv("projInfo",d);w.setUniform2fv("zScale",g);w.setUniform2f("nearFar",b.near,b.far);w.setUniform1f("maxPixelDistance",2*b.computeScreenPixelSizeAt(this._focusPosition));if(this._focusPlaneActive){var d=this._focusPosition,g=this._tempVec3,q=this._tempVec4;c.worldUpAtPosition(d,g);u(q,d,g,b.viewMatrix);w.setUniform4fv("focusPlane",q)}else w.setUniform4fv("focusPlane",[0,0,0,1E10]);this._focusSphereActive?(g=this._tempVec4,d=this._tempVec3,l.vec3.copy(g,this._focusSpherePosition),
l.vec3.transformMat4(g,g,b.viewMatrix),l.vec3.copy(d,this._focusPosition),l.vec3.transformMat4(d,d,b.viewMatrix),g[3]=l.vec3.distance(g,d),w.setUniform4fv("focusSphere",g)):w.setUniform4fv("focusSphere",[0,0,0,1E10]);if(this._segmentActive){var d=this._tempVec4,g=this._tempVec3,q=this._tempUp,h=this._tempDir,n=this._tempNormal;l.vec3.lerp(g,this._segmentStartPosition,this._segmentEndPosition,.5);c.worldUpAtPosition(g,q);l.vec3.subtract(h,this._segmentEndPosition,this._segmentStartPosition);l.vec3.normalize(h,
h);l.vec3.cross(n,q,h);l.vec3.normalize(n,n);u(d,this._segmentStartPosition,n,b.viewMatrix);w.setUniform4fv("segmentPlane",d)}else w.setUniform4fv("segmentPlane",[0,0,0,1E10]);d=f;l.vec3.copy(d,this._segmentStartPosition);c.setAltitude(0,d);l.vec3.transformMat4(d,d,b.viewMatrix);w.setUniform3fv("segmentStart",d);d=f;l.vec3.copy(d,this._segmentEndPosition);c.setAltitude(0,d);l.vec3.transformMat4(d,d,b.viewMatrix);w.setUniform3fv("segmentEnd",d);w.setUniform1i("depthMap",0);k.bindTexture(a.offscreenRenderingHelper.linearDepthTexture,
0);a=a.camera.pixelRatio;w.setUniform3fv("innerColor",this._params.innerColor);w.setUniform1f("innerWidth",this._params.innerWidth*a);w.setUniform3fv("glowColor",this._params.glowColor);w.setUniform1f("glowWidth",this._params.glowWidth*a);w.setUniform1f("globalAlpha",this._params.globalAlpha);k.bindVAO(this._quadVAO);k.drawArrays(5,0,4);return!0};return h}()})},"esri/views/3d/webgl-engine/shaders/LaserLinePrograms":function(){define(["require","exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],
function(y,p,m,a){Object.defineProperty(p,"__esModule",{value:!0});p.program={name:"laserline",shaders:{vertexShader:a.resolveIncludes("util/quad.vert"),fragmentShader:a.resolveIncludes("renderer/laserLine/laserLine.frag")},attributes:m.Default3D}})},"esri/views/3d/interactive/measurementTools/support/Label":function(){define(["require","exports","../../../../overlay/LineOverlayItem","../../../../overlay/TextOverlayItem"],function(y,p,m,a){return function(){function l(g){this._textItem=new a({visible:!1});
this._calloutItem=new m({visible:!1,width:2});this._visible=!1;this._calloutVisible=!0;g&&(this.fontSize=g)}Object.defineProperty(l.prototype,"textItem",{get:function(){return this._textItem},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"calloutItem",{get:function(){return this._calloutItem},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"text",{get:function(){return this._textItem.text},set:function(a){this._textItem.text=a},enumerable:!0,configurable:!0});
Object.defineProperty(l.prototype,"fontSize",{get:function(){return this._textItem.fontSize},set:function(a){this._textItem.fontSize=a},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible=a;this._updateVisibility()},enumerable:!0,configurable:!0});l.prototype.addToView=function(a){a.overlay.items.addMany([this._textItem,this._calloutItem])};l.prototype.removeFromView=function(a){a.overlay&&!a.overlay.destroyed&&
a.overlay.items.removeMany([this._textItem,this._calloutItem])};l.prototype.updatePosition=function(a,h){if(h){var d=h[0]-a[0],q=h[1]-a[1];this._textItem.position=[h[0],h[1]];this._textItem.anchor=Math.abs(d)>Math.abs(q)?0<d?"left":"right":0<q?"top":"bottom";this._calloutItem.startPosition=[a[0],a[1]];this._calloutItem.endPosition=[h[0],h[1]];this._calloutVisible=!0}else this._textItem.position=[a[0],a[1]],this._textItem.anchor="center",this._calloutVisible=!1};l.prototype._updateVisibility=function(){this._textItem.visible=
this._visible;this._calloutItem.visible=this._visible&&this._calloutVisible};return l}()})},"esri/views/overlay/LineOverlayItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./ViewOverlayItem maquette".split(" "),function(y,p,m,a,l,g,h,d){var q={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0};return function(e){function c(a){a=e.call(this,a)||this;a.startX=0;a.startY=0;
a.endX=0;a.endY=0;a.width=1;a.color=[0,0,0,.5];a.visible=!0;return a}m(c,e);Object.defineProperty(c.prototype,"startPosition",{get:function(){return[this.startX,this.startY]},set:function(a){this._set("startX",a[0]);this._set("startY",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"endPosition",{get:function(){return[this.endX,this.endY]},set:function(a){this._set("endX",a[0]);this._set("endY",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"strokeStyle",
{get:function(){var a=this.color;return"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"lineCap",{get:function(){return"round"},enumerable:!0,configurable:!0});c.prototype.render=function(){var a=this.calculateCoordinates(q);return d.h("div",{classes:{"esri-line-overlay-item":!0},styles:{left:a.left+"px",top:a.top+"px",width:a.width+"px",height:a.height+"px",visibility:this.visible?"visible":"hidden"},innerHTML:"\x3csvg width\x3d"+
a.width+" height\x3d"+a.height+"\x3e"+("\x3cline x1\x3d"+a.x1+" y1\x3d"+a.y1+" x2\x3d"+a.x2+" y2\x3d"+a.y2+' style\x3d"stroke: '+this.strokeStyle+"; stroke-width: "+this.width+"; stroke-linecap: "+this.lineCap+';"\x3e\x3c/line\x3e')+"\x3c/svg\x3e"})};c.prototype.renderCanvas=function(a){if(this.visible){a.strokeStyle=this.strokeStyle;a.lineWidth=this.width;a.lineCap=this.lineCap;var b=this.calculateCoordinates(q);a.beginPath();a.moveTo(b.left+b.x1,b.top+b.y1);a.lineTo(b.left+b.x2,b.top+b.y2);a.stroke()}};
c.prototype.calculateCoordinates=function(a){var b=Math.min(this.startX,this.endX),c=Math.max(this.startX,this.endX),f=Math.min(this.startY,this.endY),e=Math.max(this.startY,this.endY),d=this.width;a.left=b-d;a.top=f-d;a.width=c-b+2*d;a.height=Math.max(20,e-f+2*d);a.x1=this.startX-b+d;a.y1=this.startY-f+d;a.x2=this.endX-b+d;a.y2=this.endY-f+d;return a};a([g.property()],c.prototype,"startX",void 0);a([g.property()],c.prototype,"startY",void 0);a([g.property()],c.prototype,"endX",void 0);a([g.property()],
c.prototype,"endY",void 0);a([g.property({dependsOn:["startX","startY"]})],c.prototype,"startPosition",null);a([g.property({dependsOn:["endX","endY"]})],c.prototype,"endPosition",null);a([g.property()],c.prototype,"width",void 0);a([g.property()],c.prototype,"color",void 0);a([g.property()],c.prototype,"visible",void 0);a([g.property({readOnly:!0,dependsOn:["color"]})],c.prototype,"strokeStyle",null);return c=a([g.subclass("esri.views.overlay.LineOverlayItem")],c)}(g.declared(l,h))})},"esri/views/overlay/ViewOverlayItem":function(){define(["require",
"exports","../../core/tsSupport/declareExtendsHelper","../../core/tsSupport/decorateHelper"],function(y,p,m,a){return function(){return function(){}}()})},"esri/views/overlay/TextOverlayItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./ViewOverlayItem maquette".split(" "),function(y,p,m,a,l,g,h,d){var q={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right",
"bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};y=function(b){function h(a){a=b.call(this,a)||this;a.x=0;a.y=0;a.text="-";a.fontSize=14;a.anchor="center";a.visible=!0;a.backgroundColor="rgba(0, 0, 0, 0.6)";a.textColor=
"white";a.textShadowColor=[0,0,0];a.textShadowSize=1;return a}m(h,b);Object.defineProperty(h.prototype,"position",{get:function(){return[this.x,this.y]},set:function(a){this._set("x",a[0]);this._set("y",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"padding",{get:function(){return.5*this.fontSize},enumerable:!0,configurable:!0});h.prototype.render=function(){return d.h("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?
"visible":"hidden",fontSize:this.fontSize+"px",backgroundColor:this.backgroundColor,color:this.textColor,padding:this.padding+"px",borderRadius:this.padding+"px",textShadow:"0 0 "+this.textShadowSize+"px rgb("+this.textShadowColor[0]+", "+this.textShadowColor[1]+", "+this.textShadowColor[2]+")"}},[this.text])};h.prototype.renderCanvas=function(a){if(this.visible){var b=a.font.replace(/^(.*?)px/,"");a.font=this.fontSize+"px "+b;var c=this.padding,d=this.padding,h=a.measureText(this.text).width,q=this.fontSize,
b=e[this.anchor];a.textAlign="center";a.textBaseline="middle";h+=2*c;c=q+2*c;this.roundedRect(a,this.x+b.x*h,this.y+b.y*c,h,c,d);a.fillStyle=this.backgroundColor;a.fill();d=this.x+(b.x+.5)*h;b=this.y+(b.y+.5)*c;this._renderTextShadow(a,this.text,d,b);a.fillStyle=this.textColor;a.fillText(this.text,d,b)}};h.prototype._renderTextShadow=function(a,b,d,e){a.lineJoin="miter";a.fillStyle="rgba("+this.textShadowColor[0]+", "+this.textShadowColor[1]+", "+this.textShadowColor[2]+", "+1/c.length+")";for(var f=
this.textShadowSize,h=0,k=c;h<k.length;h++){var t=k[h];a.fillText(b,d+f*t[0],e+f*t[1])}};h.prototype.roundedRect=function(a,b,c,d,e,h){a.beginPath();a.moveTo(b,c+h);a.arcTo(b,c,b+h,c,h);a.lineTo(b+d-h,c);a.arcTo(b+d,c,b+d,c+h,h);a.lineTo(b+d,c+e-h);a.arcTo(b+d,c+e,b+d-h,c+e,h);a.lineTo(b+h,c+e);a.arcTo(b,c+e,b,c+e-h,h);a.closePath()};h.prototype._cssClasses=function(){var a={"esri-text-overlay-item":!0},b;for(b in q)a[q[b]]=this.anchor===b;return a};a([g.property()],h.prototype,"x",void 0);a([g.property()],
h.prototype,"y",void 0);a([g.property({dependsOn:["x","y"]})],h.prototype,"position",null);a([g.property()],h.prototype,"text",void 0);a([g.property()],h.prototype,"fontSize",void 0);a([g.property()],h.prototype,"anchor",void 0);a([g.property()],h.prototype,"visible",void 0);a([g.property({dependsOn:["fontSize"]})],h.prototype,"padding",null);return h=a([g.subclass("esri.views.overlay.TextOverlayItem")],h)}(g.declared(l,h));var e={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,
y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},c=[];for(p=0;360>p;p+=22.5)c.push([Math.cos(Math.PI*
p/180),Math.sin(Math.PI*p/180)]);return y})},"esri/views/3d/interactive/measurementTools/support/LabelSegment":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec3","../../../../../core/libs/gl-matrix-2/vec3f64","./viewUtils"],function(y,p,m,a,l){return function(){function g(){this.origin=a.vec3f64.create();this.start=a.vec3f64.create();this.end=a.vec3f64.create()}g.prototype.update=function(a,d,q){m.vec3.copy(this.start,a);m.vec3.copy(this.end,d);if(q)switch(q){case "start":m.vec3.copy(this.origin,
this.start);break;case "center":l.midpoint([a,d],this.origin);break;case "end":m.vec3.copy(this.origin,this.end);break;default:m.vec3.copy(this.origin,q)}else l.midpoint([a,d],this.origin)};return g}()})},"esri/views/3d/interactive/measurementTools/support/viewUtils":function(){define("require exports ../../../../../core/lang ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64".split(" "),
function(y,p,m,a,l,g,h,d){function q(k,f,d){var r=d._stage.getCamera();d.renderCoordsHelper.toRenderCoords(k,c);r.projectPoint(c,b);a.renderArrayToScreen(d,b,f)}Object.defineProperty(p,"__esModule",{value:!0});var e=d.vec3f64.create();p.copyParameter=function(a,b){a=m.mixin({},a);b=m.clone(b);m.mixin(a,b);return a};p.resizeArray=function(a,b,c,f){for(;a.length<b;)a.push(c());if(f)for(;a.length>b;)c=a.pop(),f(c);else a.length=b};p.scaleTranslateMatrix=function(a,b,c){l.mat4.identity(c);l.mat4.translate(c,
c,b);h.vec3.set(e,a,a,a);l.mat4.scale(c,c,e)};p.midpoint=function(a,b){h.vec3.set(b,0,0,0);if(0<a.length){for(var c=0;c<a.length;++c)h.vec3.add(b,b,a[c]);h.vec3.scale(b,b,1/a.length)}};p.screenSpaceTangent=function(a,b,c,d){d.projectPoint(a,n);d.projectPoint(b,f);g.vec2.subtract(c,x,u);g.vec2.normalize(c,c)};p.projectPoint=q;p.pointToPointScreenDistance=function(a,b,c){q(a,v,c);q(b,z,c);return g.vec2.distance(v,z)};p.pointToScreenPositionDistance=function(a,b,c){q(a,B,c);return g.vec2.distance(B,
b)};var c=d.vec3f64.create(),b=a.createRenderScreenPointArray3(),n=a.createRenderScreenPointArray3(),u=n,f=a.createRenderScreenPointArray3(),x=f,B=a.createScreenPointArray(),v=a.createScreenPointArray(),z=a.createScreenPointArray()})},"esri/views/3d/interactive/measurementTools/support/labelUtils":function(){define("require exports ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ./viewUtils".split(" "),
function(y,p,m,a,l,g,h){function d(a,b,c){a.projectPoint(b,f);if(0>f[2]||1<f[2])return!1;a.renderToScreen(f,c);return!0}function q(c,d,e,w,q,g){if(!d)return!1;h.screenSpaceTangent(d.start,d.end,b,c);a.vec2.set(u,-b[1],b[0]);var k=!1;switch(w){case "top":k=0>u[1];break;case "bottom":k=0<u[1];break;case "left":k=0<u[0];break;case "right":k=0>u[0]}k&&a.vec2.negate(u,u);if(0===a.vec2.length(u))switch(w){case "top":u[1]=1;break;case "bottom":u[1]=-1;break;case "left":u[0]=-1;break;case "right":u[0]=1}c.projectPoint(d.origin,
f);if(0>f[2]||1<f[2])return!1;c.renderToScreen(f,q);a.vec2.scale(u,u,e*c.pixelRatio);a.vec2.add(u,u,f);c.renderToScreen(u,g);return!0}function e(c,d,e,w,q,g){if(!d||!e)return!1;h.screenSpaceTangent(d.end,d.start,b,c);h.screenSpaceTangent(e.start,e.end,n,c);a.vec2.add(u,b,n);a.vec2.negate(u,u);a.vec2.normalize(u,u);c.projectPoint(d.end,f);if(0>f[2]||1<f[2])return!1;c.renderToScreen(f,q);a.vec2.scale(u,u,w*c.pixelRatio);a.vec2.add(u,u,f);c.renderToScreen(u,g);return!0}function c(b,c,d,e,h,q){b.projectPoint(c,
f);l.vec3.add(B,c,d);b.projectPoint(B,x);if(0>f[2]||1<f[2]||0>x[2]||1<x[2])return!1;a.vec2.subtract(u,x,f);a.vec2.normalize(u,u);b.renderToScreen(f,h);a.vec2.scale(u,u,e*b.pixelRatio);a.vec2.add(u,u,f);b.renderToScreen(u,q);return!0}Object.defineProperty(p,"__esModule",{value:!0});p.mirrorPosition=function(a){switch(a){case "top":return"bottom";case "right":return"left";case "bottom":return"top";case "left":return"right"}};p.computeLabelPositionFromPoint=d;p.positionLabelOnPoint=function(a,b,c){(b=
d(c,b,v))&&a.updatePosition(v,null);return b};p.computeLabelPositionFromSegment=q;p.positionLabelOnSegment=function(a,b,c,d,f){(b=q(f,b,c,d,v,z))&&a.updatePosition(v,z);return b};p.computeLabelPositionFromCorner=e;p.computeLabelPositionFromPlane=c;p.positionLabelOnCorner=function(a,b,c,d,f){(b=e(f,b,c,d,v,z))&&a.updatePosition(v,z);return b};p.positionLabelOnPlane=function(a,b,d,f,e,h){(b=c(h,b,d,f,v,z))&&a.updatePosition(v,z);return b};var b=m.createRenderScreenPointArray(),n=m.createRenderScreenPointArray(),
u=m.createRenderScreenPointArray(),f=m.createRenderScreenPointArray3(),x=m.createRenderScreenPointArray3(),B=g.vec3f64.create(),v=m.createScreenPointArray(),z=m.createScreenPointArray()})},"esri/views/3d/interactive/measurementTools/support/PathSegmentInterpolator":function(){define("require exports ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../support/mathUtils ../../../support/projectionUtils".split(" "),function(y,p,m,a,l,g){var h;(function(d){var h=
function(){function d(c,b){this._startPosition=a.vec3f64.create();this._endPosition=a.vec3f64.create();m.vec3.copy(this._startPosition,c);m.vec3.copy(this._endPosition,b)}d.prototype.eval=function(a,b){m.vec3.lerp(b,this._startPosition,this._endPosition,a)};return d}();d.Linear=h;h=function(){function d(c,b,d,e){this._startPosition=a.vec3f64.create();this._endPosition=a.vec3f64.create();g.vectorToVector(c,d,this._startPosition,g.SphericalECEFSpatialReference);g.vectorToVector(b,d,this._endPosition,
g.SphericalECEFSpatialReference);this._destSR=e}d.prototype.eval=function(a,b){l.slerp(this._startPosition,this._endPosition,a,b);g.vectorToVector(b,g.SphericalECEFSpatialReference,b,this._destSR)};return d}();d.Spherical=h})(h||(h={}));return h})},"esri/views/3d/webgl-engine/materials/MeasurementArrowMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../lib/Util ./internal/MaterialUtil ./renderers/MergedRenderer ../shaders/MeasurementArrowPrograms ../../../webgl/renderState".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n){y=function(a){function b(b,c){c=a.call(this,c)||this;c.params=e.copyParameters(b,f);return c}m(b,a);b.prototype.dispose=function(){};b.prototype.setParameterValues=function(a){e.updateParameters(this.params,a)&&this.notifyDirty("matChanged")};b.prototype.getParameters=function(){return this.params};b.prototype.intersect=function(a,b,c,k,d,f,e,w){};b.prototype.createBufferWriter=function(){return new r};b.prototype.createRenderer=function(a,b){return new c(a,b,this)};
b.prototype.getGLMaterials=function(){return{color:u,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};return b}(d);var u=function(a){function c(b,c,k){b=a.call(this,b,c)||this;b.updateParameters();return b}m(c,a);c.prototype.selectProgram=function(){this.program=this.programRep.getProgram(b.colorPass);this.pipelineState=n.makePipelineState({polygonOffset:this.params.polygonOffset&&{factor:0,units:-4},depthTest:{func:513},depthWrite:n.defaultDepthWriteParams,colorWrite:n.defaultColorWriteParams})};
c.prototype.updateParameters=function(){this.params=e.copyParameters(this.material.getParameters());this.selectProgram()};c.prototype.beginSlot=function(a){return 5===a};c.prototype.getProgram=function(){return this.program};c.prototype.getDrawMode=function(){return 5};c.prototype.bind=function(a,b){b=this.program;a.bindProgram(b);a.setPipelineState(this.pipelineState);b.setUniform1f("width",this.params.width);b.setUniform1f("outlineSize",this.params.outlineSize);b.setUniform4fv("outlineColor",this.params.outlineColor);
b.setUniform1f("stripeLength",this.params.stripeLength);b.setUniform4fv("stripeEvenColor",this.params.stripeEvenColor);b.setUniform4fv("stripeOddColor",this.params.stripeOddColor)};c.prototype.bindView=function(a,b){a=b.origin;var c=this.getProgram();e.bindView(a,b.view,c)};c.prototype.bindInstance=function(a,b){this.getProgram().setUniformMatrix4fv("model",b.transformation)};c.prototype.release=function(a){};return c}(h),f={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,
1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1},x=g.newLayout().vec3f(q.VertexAttrConstants.POSITION).vec3f(q.VertexAttrConstants.NORMAL).vec2f(q.VertexAttrConstants.UV0).f32(q.VertexAttrConstants.AUXPOS1),B=l.vec3f64.create(),v=l.vec3f64.create(),z=l.vec3f64.create(),k=l.vec3f64.create(),t=l.vec3f64.create(),r=function(){function b(){this.vertexBufferLayout=x}b.prototype.allocate=function(a){return this.vertexBufferLayout.createBuffer(a)};b.prototype.elementCount=function(a){return 2*(a.indices[q.VertexAttrConstants.POSITION].length/
2+1)};b.prototype.write=function(b,c,d,f){var e=c.vertexAttr[q.VertexAttrConstants.POSITION].data,h=c.vertexAttr[q.VertexAttrConstants.NORMAL].data,w=e.length/3;(c=c&&c.indices&&c.indices.position)&&c.length!==2*(w-1)&&console.warn("MeasurementArrowMaterial does not support indices");c=b.transformation;for(var r=b.invTranspTransformation,g=d.position,A=d.normal,l=d.uv0,C=b=0;C<w;++C){var m=3*C;a.vec3.set(B,e[m],e[m+1],e[m+2]);C<w-1&&(m=3*(C+1),a.vec3.set(v,e[m],e[m+1],e[m+2]),a.vec3.set(t,h[m],h[m+
1],h[m+2]),a.vec3.normalize(t,t),a.vec3.subtract(z,v,B),a.vec3.normalize(z,z),a.vec3.cross(k,t,z),a.vec3.normalize(k,k));m=a.vec3.distance(B,v);c&&r&&(a.vec3.transformMat4(B,B,c),a.vec3.transformMat4(v,v,c),a.vec3.transformMat4(k,k,r));var x=f+2*C,n=x+1;g.setVec(x,B);g.setVec(n,B);A.setVec(x,k);A.setVec(n,k);l.set(x,0,b);l.set(x,1,-1);l.set(n,0,b);l.set(n,1,1);C<w-1&&(b+=m)}d=d.auxpos1;for(C=0;C<2*w;++C)d.set(f+C,b)};return b}();return y})},"esri/views/3d/webgl-engine/shaders/MeasurementArrowPrograms":function(){define(["require",
"exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],function(y,p,m,a){Object.defineProperty(p,"__esModule",{value:!0});p.colorPass={name:"measurement-arrow-color",shaders:{vertexShader:a.resolveIncludes("materials/measurementArrow/measurementArrow.vert"),fragmentShader:a.resolveIncludes("materials/measurementArrow/measurementArrow.frag")},attributes:m.Default3D}})},"esri/views/interactive/manipulatorUtils":function(){define("require exports ../../core/libs/gl-matrix-2/mat4 ../../core/libs/gl-matrix-2/vec3 ../3d/support/stack ../3d/webgl-engine/lib/Geometry ../3d/webgl-engine/lib/GeometryUtil ../3d/webgl-engine/materials/DefaultMaterial ./Manipulator3D".split(" "),
function(y,p,m,a,l,g,h,d,q){function e(a,c){var b=1!==c;a=new d({diffuse:a,transparent:b,writeDepth:!b,cullFace:"back",opacity:c,castShadows:!1,softwareInstanced:!0},"manipulator");a.renderOccluded=4;return a}function c(b,c,d,f){b=a.vec3.normalize(l.sv3d.get(),b);c=a.vec3.normalize(l.sv3d.get(),c);var e=a.vec3.cross(l.sv3d.get(),b,c);f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=0;f[4]=c[0];f[5]=c[1];f[6]=c[2];f[7]=0;f[8]=e[0];f[9]=e[1];f[10]=e[2];f[11]=0;f[12]=d[0];f[13]=d[1];f[14]=d[2];f[15]=1;return f}Object.defineProperty(p,
"__esModule",{value:!0});p.createManipulatorMaterial=e;p.createSphereManipulator=function(a,c,d){return new q.Manipulator3D({view:a,renderObjects:[{geometry:new g(h.createSphereGeometry(1,32,32),"manipulator"),material:e(c,d)}]})};p.calculateInputRotationTransform=function(b,d,e,f){b=a.vec3.subtract(l.sv3d.get(),b,e);f=a.vec3.cross(l.sv3d.get(),f,b);e=c(b,f,e,l.sm4d.get());m.mat4.invert(e,e);d=a.vec3.transformMat4(l.sv3d.get(),d,e);return Math.atan2(d[1],d[0])};p.calculateTranslateRotateFromBases=
c})},"esri/views/interactive/Manipulator3D":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/Accessor ../../core/Collection ../../core/compilerUtils ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f64 ../../core/libs/gl-matrix-2/mat4 ../../core/libs/gl-matrix-2/mat4f64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec3 ../../core/libs/gl-matrix-2/vec3f64 ../../geometry/support/aaBoundingRect ../../layers/graphics/dehydratedFeatures ../3d/support/geometryUtils ../3d/support/stack ../3d/webgl-engine/lib/Intersector ../3d/webgl-engine/lib/intersectorUtils ../3d/webgl-engine/lib/Layer ../3d/webgl-engine/lib/Object3D ../3d/webgl-engine/parts/Model".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n,u,f,x,B,v,z,k,t,r,w,C,K,G,H,E){function I(a){return 0!==a[12]||0!==a[13]||0!==a[14]}Object.defineProperty(p,"__esModule",{value:!0});y=function(l){function n(a){a=l.call(this)||this;a.hideOnGrab=!1;a.moveOnDrag=!0;a.snapToPointer=!0;a.collisionType={type:"point"};a.collisionPriority=0;a.renderObjects=[];a.autoScaleRenderObjects=!0;a._radius=10;a._worldSized=!1;a._focusMultiplier=2;a._touchMultiplier=2.5;a.interactive=!0;a.selectable=!1;a.dragging=!1;a._areAnyEngineObjectsVisible=
!1;a._position=z.vec3f64.create();a._modelTransform=f.mat4f64.create();a._dragOffset=null;a._dirtyScreenPoint=q.createScreenPoint();a._dirtyScreenPointArray=q.createScreenPointArray();a._dirtyRenderScreenPointArray=q.createRenderScreenPointArray3();a._dirtyOriginScreenPointArray=q.createScreenPointArray();a._dirtyScreenPixelSize=1;a._screenPositionDirty=!0;a._engineResourcesAddedToStage=!1;a._engineResources=null;a._attached=!1;a._engineLayerId=null;a._materialIdReferences=null;a._hitResult={onSurface:!1,
surfaceType:"ground"};a._handlers=new g;return a}a(n,l);n.prototype.initialize=function(){this._intersector=new C(this.view.viewingMode);this._mapPoint=t.makeDehydratedPoint(0,0,0,this.view.spatialReference)};n.prototype.destroy=function(){this._handlers.removeAll();this._handlers=null;this._removeResourcesFromStage();this._engineResources=null;this._set("view",null);this._camera=null};Object.defineProperty(n.prototype,"alignment",{get:function(){return this._get("alignment")},set:function(a){this._set("alignment",
a);this.constructed&&this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"visible",{set:function(a){a!==this._get("visible")&&(this._set("visible",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"radius",{get:function(){return this._radius},set:function(a){a!==this._radius&&(this._radius=a,this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"worldSized",{get:function(){return this._worldSized},
set:function(a){a!==this._worldSized&&(this._worldSized=a,this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"focusMultiplier",{get:function(){return this._focusMultiplier},set:function(a){this._focusMultiplier=a},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"touchMultiplier",{get:function(){return this._touchMultiplier},set:function(a){this._touchMultiplier=a},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"modelTransform",
{get:function(){return this._modelTransform},set:function(a){I(a)&&(this._screenPositionDirty=!0);u.mat4.copy(this._modelTransform,a);this._updateEngineObject()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"position",{get:function(){return this._position},set:function(a){this.view.renderCoordsHelper.fromRenderCoords(a,this._mapPoint,this._mapPoint.spatialReference);this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"mapPoint",{get:function(){return this._mapPoint},
set:function(a){t.clonePoint(a,this._mapPoint);this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"grabbing",{set:function(a){a!==this._get("grabbing")&&(this._set("grabbing",a),this._updateEngineObject());a||(this._dragOffset=null)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"hovering",{set:function(a){a!==this._get("hovering")&&(this._set("hovering",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,
"selected",{set:function(a){a!==this._get("selected")&&(this._set("selected",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"state",{set:function(a){a!==this._get("state")&&(this._set("state",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"areAnyEngineObjectsVisible",{get:function(){return this._areAnyEngineObjectsVisible},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"surfaceType",
{get:function(){return this._hitResult.onSurface?this._hitResult.surfaceType:null},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"focused",{get:function(){return this._focused},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"_focused",{get:function(){return this._get("hovering")||this._get("grabbing")},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"screenPoint",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPoint},
enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"_screenPointArray",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"_renderScreenPointArray",{get:function(){this._updateScreenSpaceProperties();return this._dirtyRenderScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"_originScreenPointArray",{get:function(){this._updateScreenSpaceProperties();
return this._dirtyOriginScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"_screenPixelSize",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPixelSize},enumerable:!0,configurable:!0});n.prototype._updateScreenSpaceProperties=function(){if(this._screenPositionDirty){this._screenPositionDirty=!1;this._dirtyScreenPixelSize=this._camera.computeScreenPixelSizeAt(this._position);var a=I(this._modelTransform),b;a?(b=this._calculateModelTransformOffset(W),
b=v.vec3.add(b,b,this._position)):b=this._position;this._camera.projectPoint(b,this._dirtyRenderScreenPointArray);this._camera.renderToScreen(this._dirtyRenderScreenPointArray,this._dirtyScreenPointArray);q.screenPointArrayToObject(this._dirtyScreenPointArray,this._dirtyScreenPoint);a?(this._camera.projectPoint(this._position,F),this._camera.renderToScreen(F,this._dirtyOriginScreenPointArray)):x.vec2.copy(this._dirtyOriginScreenPointArray,this._dirtyScreenPointArray)}};n.prototype.intersectionDistance=
function(a,c){if(!this._get("visible"))return null;var k=q.screenPointObjectToArray(a,N),d=this._getCollisionRadius(c);c=-1*this._get("collisionPriority");switch(this.collisionType.type){case "point":if(x.vec2.squaredDistance(this._screenPointArray,k)<d*d)return this._renderScreenPointArray[2]+c;break;case "line":var f=this.collisionType.paths;a=this._getWorldToScreenObjectScale();a=this._calculateObjectTransform(a,O);for(var d=d*this._screenPixelSize,k=r.ray.fromScreen(this._camera,k,J),e=0,t=f;e<
t.length;e++)if(f=t[e],0!==f.length)for(var g=v.vec3.transformMat4(T,f[0],a),l=1;l<f.length;l++){var n=v.vec3.transformMat4(S,f[l],a),m=r.lineSegment.closestRayDistance2(r.lineSegment.fromPoints(g,n,A),k);if(null!=m&&m<d*d)return a=v.vec3.add(w.sv3d.get(),g,n),v.vec3.scale(a,a,.5),d=q.castRenderScreenPointArray(w.sv3d.get()),this._camera.projectPoint(a,d),d[2]+c;v.vec3.copy(g,n)}break;case "disc":g=this.collisionType.direction;a=this._getWorldToScreenObjectScale();a=this._calculateObjectTransform(a,
O);d*=this._screenPixelSize;k=r.ray.fromScreen(this._camera,k,J);l=b.mat3.fromMat4(R,a);l=v.vec3.transformMat3(L,g,l);g=this._calculateModelTransformPosition(M);r.plane.fromPositionAndNormal(g,l,P);e=Q;if(r.plane.intersectRay(P,k,e)&&v.vec3.squaredDistance(e,g)<d*d)return this._renderScreenPointArray[2]+c;break;case "ribbon":a=this.collisionType;f=a.paths;g=a.direction;a=this._getWorldToScreenObjectScale();a=this._calculateObjectTransform(a,O);d*=this._camera.computeScreenPixelSizeAt(this._position);
k=r.ray.fromScreen(this._camera,k,J);l=b.mat3.fromMat4(R,a);l=v.vec3.transformMat3(L,g,l);g=this._calculateModelTransformPosition(M);r.plane.fromPositionAndNormal(g,l,P);e=Q;if(!r.plane.intersectRay(P,k,e))break;k=0;for(t=f;k<t.length;k++)if(f=t[k],0!==f.length)for(g=v.vec3.transformMat4(T,f[0],a),l=1;l<f.length;l++){n=v.vec3.transformMat4(S,f[l],a);m=r.lineSegment.distance2(r.lineSegment.fromPoints(g,n,A),e);if(null!=m&&m<d*d)return a=v.vec3.add(w.sv3d.get(),g,n),v.vec3.scale(a,a,.5),d=q.castRenderScreenPointArray(w.sv3d.get()),
this._camera.projectPoint(a,d),d[2]+c;v.vec3.copy(g,n)}break;default:h.neverReached(this.collisionType)}return null};n.prototype.attemptDragTo=function(a){if(!this.moveOnDrag)return this._handlers.forEach(function(b){var c=b.handler;"drag"===b.type&&c(a)}),!1;var b=q.screenPointObjectToArray(a.screenPoint,N);d.isNone(this._dragOffset)&&this.grabbing&&!this.snapToPointer&&(this._dragOffset=x.vec2.subtract(B.vec2f32.create(),b,this._originScreenPointArray));d.isSome(this._dragOffset)&&x.vec2.subtract(b,
b,this._dragOffset);var b=this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(b,this._intersector,"on-the-ground"===this.alignment?D:null).results.min,c=Q;b.getIntersectionPoint(c)?(this.position=c,this._hitResult.onSurface=!0,this._hitResult.surfaceType="TerrainRenderer"===b.intersector?"ground":"feature",this._handlers.forEach(function(b){var c=b.handler;"drag"===b.type&&c(a)})):this._hitResult.onSurface=!1;return this._hitResult.onSurface};n.prototype.grab=function(a){this._handlers.forEach(function(b){var c=
b.handler;"grab"===b.type&&c(a)})};n.prototype.click=function(a){this._handlers.forEach(function(b){var c=b.handler;"click"===b.type&&c(a)})};n.prototype.on=function(a,b){this._handlers.push({type:a,handler:b})};n.prototype.attach=function(a){void 0===a&&(a={manipulator3D:{}});if(this.view._stage){a=a.manipulator3D;this._engineLayerId=a.engineLayerId;if(d.isNone(this._engineLayerId)){var b=new G("manipulator-3d",{isPickable:!1});this.view._stage.add(E.ContentType.LAYER,b);this.view._stage.addToViewContent([b.id]);
this._engineLayerId=b.id;a.engineLayerId=b.id}a.engineLayerReferences=(a.engineLayerReferences||0)+1;this._materialIdReferences=a.materialIdReferences;d.isNone(this._materialIdReferences)&&(this._materialIdReferences=new Map,a.materialIdReferences=this._materialIdReferences);this._camera=this.view.state.camera;this._attached=!0;this._updateEngineObject()}};n.prototype.detach=function(a){void 0===a&&(a={manipulator3D:{}});a=a.manipulator3D;a.engineLayerReferences--;var b=0===a.engineLayerReferences;
b&&(a.engineLayerId=null);this._removeResourcesFromStage(b);this._camera=this._materialIdReferences=this._engineLayerId=this._engineResources=null;this._attached=!1};n.prototype.onCameraChange=function(a){this._camera=a;this._screenPositionDirty=!0;this._updateEngineObject()};n.prototype.onElevationChange=function(a){this.view.renderCoordsHelper.fromRenderCoords(this.position,U,a.spatialReference)&&k.containsPoint(a.extent,U)&&this._refreshMapPoint(!0)};n.prototype._refreshMapPoint=function(a){void 0===
a&&(a=!1);switch(this.alignment){case "none":break;case "on-the-ground":var b=this.view.elevationProvider.getElevation(this.mapPoint,"ground");if(b===this._mapPoint.z&&a)return;this._mapPoint.z=b;break;default:h.neverReached(this.alignment)}this._screenPositionDirty=!0;this._hitResult.onSurface=!1;this.view.renderCoordsHelper.toRenderCoords(this._mapPoint,this._position);this._updateEngineObject()};n.prototype._updateEngineObject=function(){this._areAnyEngineObjectsVisible=!1;if(this._attached)if(!1===
this._get("visible"))this._removeResourcesFromStage();else{var a=this._getWorldToScreenObjectScale(),b=O;!0===this._get("autoScaleRenderObjects")&&(a*=this._getFocusedSize(this._radius,this._focused));this._calculateObjectTransform(a,b);for(var a=this._ensureEngineResources().objectsByState,c=(this._focused?2:1)|(this._get("selected")?8:4),k=this._get("hideOnGrab")&&this._get("grabbing"),d=0;d<a.length;d++){var f=a[d],e=f.stateMask,f=f.objects;if(k)for(var e=0,A=f;e<A.length;e++)f=A[e],f.hideAllComponents();
else if(A=0===(e&15)||(c&e)===(e&15),e=0===(e&65520)||(this._get("state")&e)===(e&65520),A&&e)for(e=0,A=f;e<A.length;e++)f=A[e],f.unhideAllComponents(),f.objectTransformation=b,this._areAnyEngineObjectsVisible=!0;else for(e=0,A=f;e<A.length;e++)f=A[e],f.hideAllComponents()}}};n.prototype._ensureEngineResources=function(){if(d.isNone(this._engineResources)){var a=this.view._stage.get(E.ContentType.LAYER,d.expect(this._engineLayerId)),b=[],c=new Set;this.renderObjects.forEach(function(a){a=a.material;
c.has(a)||(b.push(a),c.add(a))});var k=function(a,b){var c=b.geometry,k=b.material,d=b.transform;Array.isArray(c)?c.forEach(function(b){return a.addGeometry(b,k,d)}):a.addGeometry(c,k,d)},f=new Map;this.renderObjects.forEach(function(a){var b=new H({idHint:"manipulator"});k(b,a);a=a.stateMask||0;var c=f.get(a)||[];c.push(b);f.set(a,c)});var e=[];f.forEach(function(a,b){e.push({stateMask:b,objects:a})});this._engineResources={objectsByState:e,layer:a,materials:b}}this._addResourcesToStage();return this._engineResources};
n.prototype._addResourcesToStage=function(){var a=this;if(!this._engineResourcesAddedToStage&&!d.isNone(this._engineResources)){var b=this._engineResources,c=b.objectsByState,k=b.layer;b.materials.forEach(function(b){var c=d.expect(a._materialIdReferences),k=c.get(b.id)||0;0===k&&a.view._stage.add(E.ContentType.MATERIAL,b);c.set(b.id,k+1)});c.forEach(function(b){b.objects.forEach(function(b){k.addObject(b);a.view._stage.add(E.ContentType.OBJECT,b)})});this._engineResourcesAddedToStage=!0}};n.prototype._removeResourcesFromStage=
function(a){var b=this;void 0===a&&(a=!1);if(this._engineResourcesAddedToStage&&!d.isNone(this._engineResources)){var c=this._engineResources,k=c.layer,f=c.materials;c.objectsByState.forEach(function(a){a.objects.forEach(function(a){k.removeObject(a);b.view._stage.remove(E.ContentType.OBJECT,a.id)})});f.forEach(function(a){var c=d.expect(b._materialIdReferences),k=c.get(a.id);1===k?(b.view._stage.remove(E.ContentType.MATERIAL,a.id),c.delete(a.id)):c.set(a.id,k-1)});a&&this.view._stage.remove(E.ContentType.LAYER,
k.id);this._engineResourcesAddedToStage=!1}};n.prototype._getCollisionRadius=function(a){return this._getFocusedSize(this._radius,!0)*("touch"===a?this._touchMultiplier:1)};n.prototype._getFocusedSize=function(a,b){return a*(b?this._focusMultiplier:1)};n.prototype._getWorldToScreenObjectScale=function(){return this._worldSized?1:this._screenPixelSize};n.prototype._calculateModelTransformPosition=function(a){var b=this._getWorldToScreenObjectScale(),b=this._calculateObjectTransform(b,V);return v.vec3.set(a,
b[12],b[13],b[14])};n.prototype._calculateModelTransformOffset=function(a){var b=this._calculateModelTransformPosition(a);return v.vec3.subtract(a,b,this._position)};n.prototype._calculateObjectTransform=function(a,b){u.mat4.set(b,a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,1);u.mat4.multiply(b,b,this._modelTransform);b[12]+=this._position[0];b[13]+=this._position[1];b[14]+=this._position[2];b[15]=1;return b};m([e.property({constructOnly:!0,nonNullable:!0})],n.prototype,"view",void 0);m([e.property({value:"none",
nonNullable:!0})],n.prototype,"alignment",null);m([e.property()],n.prototype,"hideOnGrab",void 0);m([e.property()],n.prototype,"moveOnDrag",void 0);m([e.property()],n.prototype,"snapToPointer",void 0);m([e.property()],n.prototype,"collisionType",void 0);m([e.property({type:c.Integer})],n.prototype,"collisionPriority",void 0);m([e.property({constructOnly:!0})],n.prototype,"renderObjects",void 0);m([e.property()],n.prototype,"autoScaleRenderObjects",void 0);m([e.property({value:!0})],n.prototype,"visible",
null);m([e.property()],n.prototype,"radius",null);m([e.property()],n.prototype,"worldSized",null);m([e.property()],n.prototype,"focusMultiplier",null);m([e.property()],n.prototype,"touchMultiplier",null);m([e.property()],n.prototype,"interactive",void 0);m([e.property()],n.prototype,"selectable",void 0);m([e.property({value:!1})],n.prototype,"grabbing",null);m([e.property()],n.prototype,"dragging",void 0);m([e.property({value:!1})],n.prototype,"hovering",null);m([e.property({value:!1})],n.prototype,
"selected",null);m([e.property({value:0})],n.prototype,"state",null);m([e.property({dependsOn:["hovering","grabbing"]})],n.prototype,"focused",null);return n=m([e.subclass("esri.views.interactive.Manipulator3D")],n)}(e.declared(l));p.Manipulator3D=y;var D={include:new Set};D.include.add(K.TERRAIN_ID);var N=q.createScreenPointArray(),F=q.createRenderScreenPointArray3(),A=r.lineSegment.create(),J=r.ray.create(),R=n.mat3f64.create(),V=f.mat4f64.create(),O=f.mat4f64.create(),P=r.plane.create(),T=z.vec3f64.create(),
S=z.vec3f64.create(),Q=z.vec3f64.create(),L=z.vec3f64.create(),M=z.vec3f64.create(),W=z.vec3f64.create(),U=z.vec3f64.create()})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DModel":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/Handles ../../../../../core/Quantity ../../../../../core/quantityUtils ../../../../../core/unitUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../geometry/Point ../../../../../geometry/support/geodesicUtils ../support/UnitNormalizer ../../../support/earthUtils ../../../support/mathUtils ../../../support/mathUtils ../../../support/projectionUtils ../../../support/PropertiesPool".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n,u,f,x,B,v,z,k,t){var r=B.earthRadius*Math.PI/180;y=function(l){function p(){var a=null!==l&&l.apply(this,arguments)||this;a._tempStartPosition=n.vec3f64.create();a._tempEndPosition=n.vec3f64.create();a._tempCornerPosition=n.vec3f64.create();a._unitNormalizer=new x;a._handles=new g;a._propertiesPool=new t.default({startPoint:u,endPoint:u},a);a.cursorPoint=null;a.state="initial";a.mode="auto";a.unit="metric";a.active=!1;a.directDistance=null;a.horizontalDistance=null;
a.verticalDistance=null;a.geodesicDistance=null;a.geodesicAngle=null;a.triangleCollapseRatioThreshold=.03;a.geodesicMeasurementDistanceThreshold=1E5;return a}m(p,l);p.prototype.initialize=function(){var a=this;this._handles.add(e.init(this.sceneView,"spatialReference",function(b){a._unitNormalizer.spatialReference=b}),"scene-view");this.reset()};p.prototype.destroy=function(){this._handles.destroy();this._handles=null;this._propertiesPool.destroy();this._propertiesPool=null};Object.defineProperty(p.prototype,
"startPoint",{set:function(a){if(a){var b=this._propertiesPool.get("startPoint");b.copy(a);this._set("startPoint",b);this._updateMeasurement()}else this._set("startPoint",null)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"startPointSurfaceLocation",{set:function(a){this._set("startPointSurfaceLocation",a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"endPoint",{set:function(a){if(a){var b=this._propertiesPool.get("endPoint");b.copy(a);
this._set("endPoint",b);this._updateMeasurement()}else this._set("endPoint",null)},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"endPointSurfaceLocation",{set:function(a){this._set("endPointSurfaceLocation",a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"measurementSurfaceLocation",{get:function(){var a=this.startPointSurfaceLocation,b=this.endPointSurfaceLocation;return null==a||null==b||"above-the-surface"===a&&"below-the-surface"===
b||"below-the-surface"===a&&"above-the-surface"===b||"on-the-surface"===a&&"on-the-surface"===b?"camera-dependent":"above-the-surface"===a||"above-the-surface"===b?"above-the-surface":"below-the-surface"},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"validMeasurement",{get:function(){return!!this.startPoint&&!!this.endPoint},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"isMeasuring",{get:function(){return!!this.startPoint},enumerable:!0,configurable:!0});
Object.defineProperty(p.prototype,"geodesicDistanceExceeded",{get:function(){return this.horizontalDistance&&this.horizontalDistance.value>this.geodesicMeasurementDistanceThreshold},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"measurementMode",{get:function(){var a=this.mode;if("auto"===a){a="euclidean";if("degrees"===this.unit||"degrees-minutes-seconds"===this.unit)a="geodesic";this.geodesicDistanceExceeded&&(a="geodesic")}return a},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,
"triangleView",{get:function(){var a=this._collapseTriangle(),b=null,c=null,k=null,f=this.directDistance,c="geodesic"===this.measurementMode?this.geodesicDistance:this.horizontalDistance,e=this.verticalDistance,A=null;switch(this.unit){case "metric":b=f&&d.formatMetricLength(f);c=c&&d.formatMetricLength(c);k=e&&d.formatMetricVerticalLength(e);A=f&&f.toUnit("meters");break;case "imperial":b=f&&d.formatImperialLength(f);c=c&&d.formatImperialLength(c);k=e&&d.formatImperialVerticalLength(e);A=f&&f.toUnit(q.preferredImperialLengthUnit(f.value,
f.unit));break;case "degrees":c=this.geodesicAngle&&d.formatDecimal(this.geodesicAngle,"degrees");A=this.geodesicAngle&&this.geodesicAngle.toUnit("degrees");break;case "degrees-minutes-seconds":c=this.geodesicAngle&&d.formatDMS(this.geodesicAngle);A=this.geodesicAngle&&this.geodesicAngle.toUnit("degrees");break;default:b=f&&d.formatDecimal(f,this.unit),c=c&&d.formatDecimal(c,this.unit),k=e&&d.formatDecimal(e,this.unit),A=f&&f.toUnit(this.unit)}f=1;A&&(f=z.nextHighestPowerOfTen(A.value/30),f*="degrees"===
A.unit?r:q.convertUnit(1,A.unit,"meters"),f/=this._unitNormalizer.normalizeDistance(1));return{visible:this.validMeasurement&&!this.startPoint.equals(this.endPoint),mode:this.measurementMode,collapsed:a,directLabel:b,horizontalLabel:c,verticalLabel:k,stripeLength:f}},enumerable:!0,configurable:!0});p.prototype.reset=function(){this.clearMeasurement()};p.prototype.clearMeasurement=function(){this.state="initial";this.cursorPoint=this.endPoint=this.startPoint=null;this._clearOverride("measurementSurfaceLocation");
this._updateMeasurement()};p.prototype.finishedMeasurement=function(a){if(!this._isOverridden("measurementSurfaceLocation")){var b=this.measurementSurfaceLocation;this._override("measurementSurfaceLocation","camera-dependent"===b?a.cameraAboveGround?"above-the-surface":"below-the-surface":b)}this.state="measured"};p.prototype._collapseTriangle=function(){return!this.validMeasurement||this.startPoint.equals(this.endPoint)||"geodesic"===this.measurementMode?!0:Math.min(this.verticalDistance.value/this.horizontalDistance.value,
this.horizontalDistance.value/this.verticalDistance.value)<this.triangleCollapseRatioThreshold};p.prototype._exactGeodesicDistanceAndAngle=function(a,b){k.pointToWGS84ComparableLonLat(a,w);k.pointToWGS84ComparableLonLat(b,C);a=z.deg2rad(w[0]);b=z.deg2rad(w[1]);var c=z.deg2rad(C[0]),d=z.deg2rad(C[1]);a=v.acos(Math.sin(b)*Math.sin(d)+Math.cos(b)*Math.cos(d)*Math.cos(Math.abs(c-a)));a=z.rad2deg(a);b={distance:0};f.inverseGeodeticSolver(b,[w[0],w[1]],[C[0],C[1]]);return{distance:new h(b.distance,"meters"),
angle:new h(a,"degrees")}};p.prototype._approximateGeodesicDistanceAndAngle=function(a){return{distance:new h(a,"meters"),angle:new h(a/r,"degrees")}};p.prototype._euclideanDistances=function(a,c){a.z>c.z&&(a=[a,a=c][0]);var d=a.clone();d.z=c.z;var f=this._tempStartPosition,e=this._tempEndPosition,w=this._tempCornerPosition,A=this.sceneView.spatialReference,A=k.canProject(A,k.WGS84ECEFSpatialReference)?k.WGS84ECEFSpatialReference:A;k.pointToVector(a,f,A);k.pointToVector(c,e,A);k.pointToVector(d,w,
A);d=b.vec3.distance(f,e);e=b.vec3.distance(w,e);a=Math.abs(c.z-a.z);d=this._unitNormalizer.normalizeDistance(d);e=this._unitNormalizer.normalizeDistance(e);a=this._unitNormalizer.normalizeElevation(a);return{direct:new h(d,"meters"),horizontal:new h(e,"meters"),vertical:new h(a,"meters")}};p.prototype._updateMeasurement=function(){if(this.startPoint&&this.endPoint){var a=this._euclideanDistances(this.startPoint,this.endPoint),b=k.canProjectToWGS84ComparableLonLat(this.sceneView.spatialReference)?
this._exactGeodesicDistanceAndAngle(this.startPoint,this.endPoint):this._approximateGeodesicDistanceAndAngle(a.horizontal.value);this._set("directDistance",a.direct);this._set("horizontalDistance",a.horizontal);this._set("verticalDistance",a.vertical);this._set("geodesicDistance",b.distance);this._set("geodesicAngle",b.angle)}else this._set("directDistance",null),this._set("horizontalDistance",null),this._set("verticalDistance",null),this._set("geodesicDistance",null),this._set("geodesicAngle",null)};
a([c.property({constructOnly:!0})],p.prototype,"sceneView",void 0);a([c.property({value:null})],p.prototype,"startPoint",null);a([c.property({value:null})],p.prototype,"startPointSurfaceLocation",null);a([c.property({value:null})],p.prototype,"endPoint",null);a([c.property({value:null})],p.prototype,"endPointSurfaceLocation",null);a([c.property({dependsOn:["startPointSurfaceLocation","endPointSurfaceLocation"]})],p.prototype,"measurementSurfaceLocation",null);a([c.property()],p.prototype,"cursorPoint",
void 0);a([c.property()],p.prototype,"state",void 0);a([c.property()],p.prototype,"mode",void 0);a([c.property()],p.prototype,"unit",void 0);a([c.property()],p.prototype,"active",void 0);a([c.property({readOnly:!0,dependsOn:["startPoint","endPoint"]})],p.prototype,"validMeasurement",null);a([c.property({readOnly:!0,dependsOn:["startPoint"]})],p.prototype,"isMeasuring",null);a([c.property({readOnly:!0})],p.prototype,"directDistance",void 0);a([c.property({readOnly:!0})],p.prototype,"horizontalDistance",
void 0);a([c.property({readOnly:!0})],p.prototype,"verticalDistance",void 0);a([c.property({readOnly:!0})],p.prototype,"geodesicDistance",void 0);a([c.property({readOnly:!0})],p.prototype,"geodesicAngle",void 0);a([c.property({readOnly:!0,dependsOn:["horizontalDistance","geodesicMeasurementDistanceThreshold"]})],p.prototype,"geodesicDistanceExceeded",null);a([c.property({readOnly:!0,dependsOn:["horizontalDistance","unit","geodesicDistanceExceeded"]})],p.prototype,"measurementMode",null);a([c.property({readOnly:!0,
dependsOn:["unit","measurementMode","startPoint","endPoint","triangleCollapseRatioThreshold"]})],p.prototype,"triangleView",null);a([c.property()],p.prototype,"triangleCollapseRatioThreshold",void 0);a([c.property()],p.prototype,"geodesicMeasurementDistanceThreshold",void 0);return p=a([c.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DModel")],p)}(c.declared(l));var w=n.vec3f64.create(),C=n.vec3f64.create();return y})},"esri/core/Quantity":function(){define(["require",
"exports","./unitFormatUtils","./unitUtils"],function(y,p,m,a){return function(){function l(g,h){this.measure=a.measureForUnit(h);this.value=g;this.unit=h}Object.defineProperty(l.prototype,"isBaseUnit",{get:function(){return a.isBaseUnit(this.unit)},enumerable:!0,configurable:!0});l.prototype.toUnit=function(g){return new l(a.convertUnit(this.value,this.unit,g),g)};l.prototype.toBaseUnit=function(){return this.toUnit(a.baseUnitForUnit(this.unit))};l.prototype.toDecimalString=function(a,h){void 0===
a&&(a=2);return m.formatDecimal(this.value,this.unit,a,h)};return l}()})},"esri/core/unitFormatUtils":function(){define(["require","exports","dojo/i18n!./nls/Units","./unitUtils","../intl/number"],function(y,p,m,a,l){function g(a,h){return m.units[a][h]}function h(a,h,e,c){void 0===e&&(e=2);void 0===c&&(c="abbr");return l.formatNumber(a,{minimumFractionDigits:e,maximumFractionDigits:e})+" "+g(h,c)}Object.defineProperty(p,"__esModule",{value:!0});p.unitName=g;p.formatDecimal=h;p.formatMetricLength=
function(d,g,e,c){void 0===e&&(e=2);void 0===c&&(c="abbr");var b=a.preferredMetricLengthUnit(d,g);return h(a.convertUnit(d,g,b),b,e,c)};p.formatMetricVerticalLength=function(d,g,e,c){void 0===e&&(e=2);void 0===c&&(c="abbr");var b=a.preferredMetricVerticalLengthUnit(d,g);return h(a.convertUnit(d,g,b),b,e,c)};p.formatImperialLength=function(d,g,e,c){void 0===e&&(e=2);void 0===c&&(c="abbr");var b=a.preferredImperialLengthUnit(d,g);return h(a.convertUnit(d,g,b),b,e,c)};p.formatImperialVerticalLength=
function(d,g,e,c){void 0===e&&(e=2);void 0===c&&(c="abbr");var b=a.preferredImperialVerticalLengthUnit(d,g);return h(a.convertUnit(d,g,b),b,e,c)};p.formatMetricArea=function(d,g,e,c){void 0===e&&(e=2);void 0===c&&(c="abbr");var b=a.preferredMetricAreaUnit(d,g);return h(a.convertUnit(d,g,b),b,e,c)};p.formatImperialArea=function(d,g,e,c){void 0===e&&(e=2);void 0===c&&(c="abbr");var b=a.preferredImperialAreaUnit(d,g);return h(a.convertUnit(d,g,b),b,e,c)};p.formatDMS=function(d,h,e){void 0===e&&(e=2);
d=a.convertUnit(d,h,"degrees");h=d-Math.floor(d);d-=h;h*=60;var c=h-Math.floor(h);h-=c;c*=60;return d.toFixed()+"\u00b0 "+h.toFixed()+"' "+c.toFixed(e)+'"'}})},"esri/core/quantityUtils":function(){define(["require","exports","./unitFormatUtils"],function(y,p,m){Object.defineProperty(p,"__esModule",{value:!0});p.formatDecimal=function(a,l,g,h){void 0===g&&(g=2);void 0===h&&(h="abbr");return m.formatDecimal(a.toUnit(l).value,l,g,h)};p.formatMetricLength=function(a,l,g){void 0===l&&(l=2);void 0===g&&
(g="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return m.formatMetricLength(a.value,a.unit,l,g)};p.formatMetricVerticalLength=function(a,l,g){void 0===l&&(l=2);void 0===g&&(g="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return m.formatMetricVerticalLength(a.value,a.unit,l,g)};p.formatMetricArea=function(a,l,g){void 0===l&&(l=2);void 0===g&&(g="abbr");if("area"!==a.measure)throw Error("quantity is not an area");return m.formatMetricArea(a.value,
a.unit,l,g)};p.formatImperialLength=function(a,l,g){void 0===l&&(l=2);void 0===g&&(g="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return m.formatImperialLength(a.value,a.unit,l,g)};p.formatImperialVerticalLength=function(a,l,g){void 0===l&&(l=2);void 0===g&&(g="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return m.formatImperialVerticalLength(a.value,a.unit,l,g)};p.formatImperialArea=function(a,l,g){void 0===l&&(l=2);void 0===g&&(g="abbr");if("area"!==
a.measure)throw Error("quantity is not an area");return m.formatImperialArea(a.value,a.unit,l,g)};p.formatDMS=function(a){if("angle"!==a.measure)throw Error("quantity is not an angle");return m.formatDMS(a.value,a.unit)}})},"esri/geometry/support/geodesicUtils":function(){define("require exports @dojo/framework/shim/object ../. ../../core/Error ../../core/Logger ../../core/unitUtils".split(" "),function(y,p,m,a,l,g,h){function d(a){if(!a||!a.isGeographic)return null;if(a.wkid){var b=z[a.wkid];if(b)return b}if(a.wkt){a=
v.exec(a.wkt);if(!a||2!==a.length)return null;b=a[1].split(",");if(!b||3!==b.length)return null;a=parseFloat(b[1]);b=parseFloat(b[2]);return isNaN(a)||isNaN(b)?null:{a:a,f:0===b?0:1/b}}return null}function q(a){a=d(a||B);if("b"in a&&"eSq"in a&&"radius"in a)return a;var b=a.a*(1-a.f);return m.assign(a,{b:b,eSq:1-Math.pow(b/a.a,2),radius:(2*a.a+b)/3})}function e(a,b,c){var k=q(c);c=k.a;var k=k.eSq,d=Math.sqrt(k),f=Math.sin(b[1]*x);b=c*b[0]*x;c=0<k?c*(1-k)*(f/(1-k*f*f)-1/(2*d)*Math.log((1-d*f)/(1+d*
f)))*.5:c*f;a[0]=b;a[1]=c;return a}function c(a){return null!==d(a)}function b(b,d){if("polyline"!==b.type&&"polygon"!==b.type)throw f.error("invalid geometry: the input geometry is neither polyline nor polygon"),new l("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");var k=b.spatialReference;if(!c(k))throw f.error("invalid spatialreference: the input geometry spatialreference is not supported"),new l("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");
var e=q(k).radius/1E4;d<e&&(d=e);for(var e=[],h=[0,0],g={distance:null},t=0,m="polyline"===b.type?b.paths:b.rings;t<m.length;t++){var p=m[t],x=[];e.push(x);x.push([p[0][0],p[0][1]]);for(var z=p[0][0],v=p[0][1],F=void 0,A=void 0,J=0;J<p.length-1;J++)if(F=p[J+1][0],A=p[J+1][1],z!==F||v!==A){var B=[z,v];u(g,[z,v],[F,A],k);z=g.azimuth;v=g.distance;F=v/d;if(1<F){for(A=1;A<=F-1;A++)n(h,B,z,A*d,k),x.push(h.slice(0));n(h,B,z,(v+Math.floor(F-1)*d)/2,k);x.push(h.slice(0))}n(h,B,z,v,k);x.push(h.slice(0));z=
h[0];v=h[1]}}return"polyline"===b.type?new a.Polyline({paths:e,spatialReference:k}):new a.Polygon({rings:e,spatialReference:k})}function n(a,b,c,d,f){var k=b[0]*x,e=b[1]*x;b=c*x;f=q(f);var h=f.a,g=f.b;f=f.f;c=Math.sin(b);b=Math.cos(b);for(var w=(1-f)*Math.tan(e),e=1/Math.sqrt(1+w*w),l=w*e,r=Math.atan2(w,b),w=e*c,t=w*w,A=1-t,h=A*(h*h-g*g)/(g*g),n=1+h/16384*(4096+h*(-768+h*(320-175*h))),m=h/1024*(256+h*(-128+h*(74-47*h))),h=d/(g*n),p=2*Math.PI,C,z,v,u;1E-12<Math.abs(h-p);)v=Math.cos(2*r+h),C=Math.sin(h),
z=Math.cos(h),u=m*C*(v+m/4*(z*(-1+2*v*v)-m/6*v*(-3+4*C*C)*(-3+4*v*v))),p=h,h=d/(g*n)+u;d=l*C-e*z*b;g=f/16*A*(4+f*(4-3*A));d=Math.atan2(l*z+e*C*b,(1-f)*Math.sqrt(t+d*d))/x;k=(k+(Math.atan2(C*c,e*z-l*C*b)-(1-g)*f*w*(h+g*C*(v+g*z*(-1+2*v*v)))))/x;a.splice(0,a.length);a.push(k,d);return a}function u(a,b,c,d){var k=b[0]*x;b=b[1]*x;var f=c[0]*x;c=c[1]*x;var e=q(d),h=e.a;d=e.b;var g=e.f,w=e.radius,l=f-k,r=Math.atan((1-g)*Math.tan(b)),n=Math.atan((1-g)*Math.tan(c)),e=Math.sin(r),r=Math.cos(r),A=Math.sin(n),
n=Math.cos(n),t=1E3,m=l,p,z,v,u,B,y,L,M;do{u=Math.sin(m);B=Math.cos(m);v=Math.sqrt(n*u*n*u+(r*A-e*n*B)*(r*A-e*n*B));if(0===v)return{distance:0};B=e*A+r*n*B;y=Math.atan2(v,B);L=r*n*u/v;z=1-L*L;u=B-2*e*A/z;isNaN(u)&&(u=0);M=g/16*z*(4+g*(4-3*z));p=m;m=l+(1-M)*g*L*(y+M*v*(u+M*B*(-1+2*u*u)))}while(1E-12<Math.abs(m-p)&&0<--t);if(0===t)return a=f-k,{azimuth:Math.atan2(Math.sin(a)*Math.cos(c),Math.cos(b)*Math.sin(c)-Math.sin(b)*Math.cos(c)*Math.cos(a))/x,distance:Math.acos(Math.sin(b)*Math.sin(c)+Math.cos(b)*
Math.cos(c)*Math.cos(f-k))*w};k=z*(h*h-d*d)/(d*d);b=k/1024*(256+k*(-128+k*(74-47*k)));f=Math.atan2(r*Math.sin(m),r*A*Math.cos(m)-e*n);a.azimuth=Math.atan2(n*Math.sin(m),r*A-e*n*Math.cos(m))/x;a.distance=d*(1+k/16384*(4096+k*(-768+k*(320-175*k))))*(y-b*v*(u+b/4*(B*(-1+2*u*u)-b/6*u*(-3+4*v*v)*(-3+4*u*u))));a.reverseAzimuth=f/x;return a}Object.defineProperty(p,"__esModule",{value:!0});var f=g.getLogger("esri.geometry.support.geodesicUtils"),x=Math.PI/180,B=a.SpatialReference.WGS84,v=/SPHEROID\[([^\]]+)]/i,
z={4326:{a:6378137,f:1/298.257223563},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:1737400,f:0},104904:{a:3393400,f:.005207166853303471},104905:{a:3396190,f:.005886007555525457},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},
104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,
f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,
f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:3396190,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};p.isSupported=c;p.geodesicAreas=function(a,d){void 0===d&&(d="square-meters");if(a.some(function(a){return!c(a.spatialReference)}))throw f.error("invalid spatialreference: the input geometries spatialreference is not supported"),new l("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");
for(var k=[],g=0;g<a.length;g++){var n=a[g],m=n.spatialReference,m=.0015696101447650193*q(m).radius;k.push(b(n,m))}a=[];for(var g=[0,0],n=[0,0],t=0;t<k.length;t++){for(var m=k[t],p=m.rings,m=m.spatialReference,z=0,v=0;v<p.length;v++){var x=p[v];e(g,x[0],m);e(n,x[x.length-1],m);for(var u=n[0]*g[1]-g[0]*n[1],B=0;B<x.length-1;B++)e(g,x[B+1],m),e(n,x[B],m),u+=n[0]*g[1]-g[0]*n[1];z+=u}z=h.convertUnit(z,"square-meters",d);a.push(z/-2)}return a};p.geodesicLengths=function(a,b){void 0===b&&(b="meters");if(!a&&
!a)throw f.error("invalid geometry type: the input geometries type is not supported"),new l("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(a.some(function(a){return!c(a.spatialReference)}))throw f.error("invalid spatialreference: the input geometries spatialreference is not supported"),new l("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var k=[],d=0;d<a.length;d++){for(var e=a[d],g=e.spatialReference,
e="polyline"===e.type?e.paths:e.rings,n=0,m=0;m<e.length;m++){for(var q=e[m],t=0,p=1;p<q.length;p++){var z=q[p-1][0],v=q[p][0],A=q[p-1][1],x=q[p][1];if(A!==x||z!==v){var B={distance:null};u(B,[z,A],[v,x],g);t+=B.distance}}n+=t}n=h.convertUnit(n,"meters",b);k.push(n)}return k};p.geodesicDensify=b;p.directGeodeticSolver=n;p.inverseGeodeticSolver=u;p.geodesicDistance=function(a,b,d){void 0===d&&(d="meters");if(!a||!b)throw a="one or both input parameters are missing",f.error("missing-parameters: "+a),
new l("geodesic-distance:missing-parameters",a);if(!a.spatialReference||!b.spatialReference)throw a="one or both input points do not have a spatial reference",f.error("invalid-parameters: "+a),new l("geodesic-distance:invalid-parameters",a);if(!a.spatialReference.equals(b.spatialReference))throw a="spatial references of input parameters do not match",f.error("invalid-parameters: "+a),new l("geodesic-distance:invalid-parameters",a);var k=a.spatialReference;if(!c(k))throw a="spatial references is not supported",
f.error("not-supported: "+a),new l("geodesic-distance:not-supported",a);if(a.equals(b))return{distance:0,azimuth:0,reverseAzimuth:0};var e={distance:null};u(e,[a.x,a.y],[b.x,b.y],k);e.distance=h.convertUnit(e.distance,"meters",d);return e};p.pointFromDistance=function(b,d,e){if(!b||null==d||null==e)throw b="one or more input parameters are missing or undefined",f.error("missing-parameters: "+b),new l("point-from-distance:missing-parameters",b);if(0>e||360<e)throw b="azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees",
f.error("out-of-bounds: "+b),new l("point-from-distance:-of-bounds",b);if(!b.spatialReference)throw b="the input point must have a spatial reference",f.error("missing-spatial-reference: "+b),new l("point-from-distance:missing-spatial-reference",b);var k=b.spatialReference;if(!c(k))throw b="spatial references is not supported",f.error("not-supported: "+b),new l("geodesic-distance:not-supported",b);var h=[0,0];n(h,[b.x,b.y],e,d,k);return new a.Point({x:h[0],y:h[1],spatialReference:k})}})},"esri/views/3d/interactive/measurementTools/support/UnitNormalizer":function(){define(["require",
"exports","../../../../../core/unitUtils"],function(y,p,m){return function(){function a(a){void 0===a&&(a=null);this.spatialReference=a;this._updateNormalizationFactors}Object.defineProperty(a.prototype,"spatialReference",{get:function(){return this._spatialReference},set:function(a){a!==this._spatialReference&&(this._spatialReference=a,this._updateNormalizationFactors())},enumerable:!0,configurable:!0});a.prototype.normalizeDistance=function(a){return a*this._metersPerDistanceUnit};a.prototype.normalizeElevation=
function(a){return a*this._metersPerElevationUnit};a.prototype.normalizeArea=function(a){return a*this._squareMetersPerAreaUnit};a.prototype._updateNormalizationFactors=function(){this._metersPerDistanceUnit=m.getMetersPerUnitForSR(this._spatialReference,1);this._metersPerElevationUnit=m.getMetersPerUnitForSR(this._spatialReference,1);this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit};return a}()})},"esri/views/interactive/InteractiveToolBase":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/accessorSupport/decorators ./interactiveToolUtils ./ManipulatorCollection".split(" "),
function(y,p,m,a,l,g,h,d,q){Object.defineProperty(p,"__esModule",{value:!0});y=function(e){function c(a){a=e.call(this)||this;a.manipulators=new q.ManipulatorCollection;a._attached=!1;a._editableFlags=[];a._manipulatorHandles=new g;return a}m(c,e);Object.defineProperty(c.prototype,"active",{get:function(){return this.view.activeTool===this},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isSupported",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"visible",{set:function(a){this._set("visible",a);this._attached&&(a?this._show():this._hide())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"editable",{get:function(){return this.hasEditableFlag(0)},set:function(a){this.setEditableFlag(0,a)},enumerable:!0,configurable:!0});c.prototype.attach=function(){if(!this._attached&&this.isSupported){this.manipulators.attach();this.onAttach();if(this.visible)this.onShow();this._attached=!0}};c.prototype.detach=function(){this._attached&&
(this.onHide(),this.onDetach(),this.manipulators.detach(),this._manipulatorHandles.removeAll(),this._attached=!1)};c.prototype.handleInputEvent=function(a){if(this._attached)this.onInputEvent(a)};c.prototype.destroy=function(){this.manipulators.destroy();this._manipulatorHandles.removeAll();this._manipulatorHandles=null;this._set("view",null)};c.prototype.setEditableFlag=function(a,c){this._editableFlags[a]=c;this.manipulators.isToolEditable=this._editableFlags.every(function(a){return null==a||a});
this._updateManipulatorAttachment();0===a&&this.notifyChange("editable");this.onEditableChange()};c.prototype.hasEditableFlag=function(a){a=this._editableFlags[a];return null==a?!0:a};c.prototype.onAttach=function(){};c.prototype.onDetach=function(){};c.prototype.onShow=function(){};c.prototype.onHide=function(){};c.prototype.onEditableChange=function(){};c.prototype.onInputEvent=function(a){};Object.defineProperty(c.prototype,"internallyEditable",{get:function(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)},
enumerable:!0,configurable:!0});c.prototype._show=function(){this._updateManipulatorAttachment();this.onShow()};c.prototype._hide=function(){d.setActive(this,!1);this._updateManipulatorAttachment();this.onHide()};c.prototype._updateManipulatorAttachment=function(){this.visible?this.manipulators.attach():this.manipulators.detach()};a([h.property({constructOnly:!0})],c.prototype,"view",void 0);a([h.property({dependsOn:["view.activeTool"],readOnly:!0})],c.prototype,"active",null);a([h.property({value:!0})],
c.prototype,"visible",null);a([h.property({value:!0})],c.prototype,"editable",null);a([h.property({readOnly:!0})],c.prototype,"manipulators",void 0);return c=a([h.subclass("esri.views.interactive.InteractiveToolBase")],c)}(h.declared(l));p.InteractiveToolBase=y})},"esri/views/interactive/ManipulatorCollection":function(){define(["require","exports","../../core/tsSupport/decorateHelper","../../core/Collection","../../core/maybe"],function(y,p,m,a,l){Object.defineProperty(p,"__esModule",{value:!0});
y=function(){function g(){this._isToolEditable=!0;this._manipulators=new a;this._nextManipulatorId=0;this._resourceContexts={manipulator3D:{}};this._attached=!1}Object.defineProperty(g.prototype,"isToolEditable",{set:function(a){this._isToolEditable=a},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"length",{get:function(){return this._manipulators.length},enumerable:!0,configurable:!0});g.prototype.add=function(a,d){void 0===d&&(d=0);return this.addMany([a],d)[0]};g.prototype.addMany=
function(a,d){var h=this;void 0===d&&(d=0);return a.map(function(a){var c=h._nextManipulatorId++;a={id:c,manipulator:a,visibilityPredicate:d,attached:!1};h._manipulators.add(a);h._attached&&h._updateManipulatorAttachment(a);return c})};g.prototype.remove=function(a){if("number"===typeof a){for(var d=0;d<this._manipulators.length;d++)if(this._manipulators.getItemAt(d).id===a)return a=this._manipulators.splice(d,1)[0],this._detachManipulator(a),a.id;return null}for(d=0;d<this._manipulators.length;d++)if(this._manipulators.getItemAt(d).manipulator===
a)return a=this._manipulators.splice(d,1)[0],this._detachManipulator(a),a.id;return null};g.prototype.removeAll=function(){var a=this;this._manipulators.forEach(function(d){a._detachManipulator(d)});this._manipulators.removeAll()};g.prototype.attach=function(){var a=this;this._manipulators.forEach(function(d){a._updateManipulatorAttachment(d)});this._attached=!0};g.prototype.detach=function(){var a=this;this._manipulators.forEach(function(d){a._detachManipulator(d)});this._attached=!1};g.prototype.destroy=
function(){this._manipulators.forEach(function(a){a=a.manipulator;a.destroy&&a.destroy()});this._manipulators.destroy();this._resourceContexts=null};g.prototype.on=function(a,d){return this._manipulators.on("change",function(a){d(a)})};g.prototype.forEach=function(a){for(var d=0,g=this._manipulators.items;d<g.length;d++)a(g[d])};g.prototype.intersect=function(a,d){var g=null,e=Number.MAX_VALUE;this._manipulators.forEach(function(c){var b=c.id,h=c.manipulator;c.attached&&h.interactive&&(c=h.intersectionDistance(a,
d),l.isSome(c)&&c<e&&(e=c,g=b))});return g};g.prototype.findById=function(a){if(l.isNone(a))return null;for(var d=0,g=this._manipulators.items;d<g.length;d++){var e=g[d];if(a===e.id)return e.manipulator}return null};g.prototype._updateManipulatorAttachment=function(a){this._isManipulatorItemVisible(a)?this._attachManipulator(a):this._detachManipulator(a)};g.prototype._attachManipulator=function(a){a.attached||(a.manipulator.attach(this._resourceContexts),a.attached=!0)};g.prototype._detachManipulator=
function(a){if(a.attached){var d=a.manipulator;d.grabbing=!1;d.dragging=!1;d.hovering=!1;d.selected=!1;d.detach(this._resourceContexts);a.attached=!1}};g.prototype._isManipulatorItemVisible=function(a){return 2===a.visibilityPredicate?!0:this._isToolEditable?0===a.visibilityPredicate:1===a.visibilityPredicate};return g}();p.ManipulatorCollection=y})},"esri/widgets/support/InteractiveToolViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/interactive/interactiveToolUtils".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b){return function(d){function n(a){var b=d.call(this)||this;b.tool=null;b._baseHandles=new q;b._loggedUnsupportedErrorOnce=!1;b._createPromise=null;a&&null!=a.visible&&(b.visible=a.visible);return b}m(n,d);n.prototype.initialize=function(){var a=this;this._baseHandles.add(e.init(this,["view.ready","isSupported"],function(){a.view&&a.view.ready&&!a.isSupported?a._loggedUnsupportedErrorOnce||(a.logUnsupportedError(),a._loggedUnsupportedErrorOnce=!0):a._loggedUnsupportedErrorOnce=
!1}))};n.prototype.destroy=function(){this.tool&&(b.setActive(this.tool,!1),this.view&&this.view.tools.remove(this.tool),this.tool.destroy(),this._set("tool",null));this.view=null;this._baseHandles.destroy();this._createPromise=this._baseHandles=null};Object.defineProperty(n.prototype,"isSupported",{get:function(){return!this.view||this.view.type===this.supportedViewType},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"view",{get:function(){return this._get("view")},set:function(a){this._createToolOnView(a);
this._set("view",a)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"visible",{set:function(a){this._set("visible",a);this.tool&&(this.tool.visible=a)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"active",{get:function(){return!!this.tool&&this.tool.active},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"isDisabled",{get:function(){return!this.tool||!this.view||!this.view.ready||!this.isSupported},enumerable:!0,configurable:!0});n.prototype._createToolOnView=
function(a){return g(this,void 0,void 0,function(){var b,c,d=this;return l(this,function(e){switch(e.label){case 0:return this._createPromise?[4,this._createPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return a!==this.view&&this.view&&this.tool&&(this.view.removeTool(this.tool),this.tool.destroyed||this.tool.destroy(),this._set("tool",null)),a&&(b=this.createToolParams(),c=h({visible:this.visible},b.constructorArguments),this._createPromise=a.createTool(b.toolConstructor,c,this.tool).then(function(a){d._set("tool",
a)})),[2]}})})};a([c.property({constructOnly:!0})],n.prototype,"tool",void 0);a([c.property({dependsOn:["view.type"]})],n.prototype,"isSupported",null);a([c.property({value:null})],n.prototype,"view",null);a([c.property({type:Boolean,value:!0})],n.prototype,"visible",null);a([c.property({dependsOn:["tool.active"]})],n.prototype,"active",null);a([c.property({dependsOn:["tool","view","view.ready","isSupported"]})],n.prototype,"isDisabled",null);return n=a([c.subclass("esri.widgets.support.InteractiveToolViewModel")],
n)}(c.declared(d))})},"esri/widgets/AreaMeasurement3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./AreaMeasurement3D/nls/AreaMeasurement3D ../core/accessorSupport/decorators ./Widget ./AreaMeasurement3D/AreaMeasurement3DViewModel ./support/widget".split(" "),function(y,p,m,a,l,g,h,d,q){return function(e){function c(a){a=e.call(this)||this;a.view=null;a.visible=null;a.viewModel=new d;a.unitOptions=null;a.unit=null;return a}
m(c,e);c.prototype.render=function(){var a=this,c=this.viewModel.isSupported,d=this.viewModel.active,e="disabled"===this.viewModel.state,g="ready"===this.viewModel.state,h="measuring"===this.viewModel.state||"measured"===this.viewModel.state,m=this.viewModel.measurement,g=d&&g?q.tsx("section",{key:"esri-area-measurement-3d__hint",class:"esri-area-measurement-3d__hint"},q.tsx("p",{class:"esri-area-measurement-3d__hint-text"},l.hint)):null,p=c?null:q.tsx("section",{key:"esri-area-measurement-3d__unsupported",
class:"esri-area-measurement-3d__panel--error"},q.tsx("p",null,l.unsupported)),k=function(b,c,d){switch(c.state){case "available":return q.tsx("div",{key:d+"-enabled",class:"esri-area-measurement-3d__measurement-item"},q.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b),q.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},c.text));case "unavailable":return q.tsx("div",{key:d+"-disabled",class:a.classes("esri-area-measurement-3d__measurement-item","esri-area-measurement-3d__measurement-item--disabled")},
q.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b));case "invalid":return q.tsx("div",{key:d+"-enabled",class:"esri-area-measurement-3d__measurement-item"},q.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b),q.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},l.notApplicable))}},m=h?q.tsx("section",{key:"esri-area-measurement-3d__measurement",class:"esri-area-measurement-3d__measurement"},k(l.area,m.area,"area"),k(l.perimeterLength,
m.perimeterLength,"perimeter-length")):null,t=this.id+"__units",k=q.tsx("label",{class:"esri-area-measurement-3d__units-label",for:t},l.unit),t=q.tsx("div",{class:"esri-area-measurement-3d__units-select-wrapper"},q.tsx("select",{class:"esri-area-measurement-3d__units-select esri-select",id:t,onchange:this._changeUnit,bind:this},this.viewModel.unitOptions.map(function(b){return b===a.viewModel.unit?q.tsx("option",{key:b,value:b,selected:!0},l.units[b]):q.tsx("option",{key:b,value:b},l.units[b])}))),
k=h?q.tsx("section",{key:"esri-area-measurement-3d__units",class:"esri-area-measurement-3d__units"},k,t):null,k=h?q.tsx("div",{key:"settings",class:"esri-area-measurement-3d__settings"},k):null,c=!c||d&&!h?null:q.tsx("div",{class:"esri-area-measurement-3d__actions"},q.tsx("button",{disabled:e,class:this.classes("esri-button esri-button--secondary","esri-area-measurement-3d__clear-button",e&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement},l.newMeasurement)),c=this.visible?q.tsx("div",
{class:"esri-area-measurement-3d__container"},p,g,k,m,c):null;return q.tsx("div",{key:"",class:"esri-area-measurement-3d esri-widget esri-widget--panel",role:"presentation"},c)};c.prototype._newMeasurement=function(){this.viewModel.newMeasurement()};c.prototype._changeUnit=function(a){a=a.target;if(a=a.options[a.selectedIndex])this.unit=a.value};a([g.aliasOf("viewModel.view")],c.prototype,"view",void 0);a([g.aliasOf("viewModel.visible"),q.renderable()],c.prototype,"visible",void 0);a([g.aliasOf("viewModel.active"),
q.renderable()],c.prototype,"active",void 0);a([g.property({type:d}),q.renderable(["viewModel.state","viewModel.unitOptions","viewModel.unit","viewModel.measurement"])],c.prototype,"viewModel",void 0);a([g.aliasOf("viewModel.unitOptions")],c.prototype,"unitOptions",void 0);a([g.aliasOf("viewModel.unit")],c.prototype,"unit",void 0);a([q.accessibleHandler()],c.prototype,"_newMeasurement",null);a([q.accessibleHandler()],c.prototype,"_changeUnit",null);return c=a([g.subclass("esri.widgets.AreaMeasurement3D")],
c)}(g.declared(h))})},"esri/widgets/AreaMeasurement3D/AreaMeasurement3DViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/Logger ../../core/unitUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool ../support/InteractiveToolViewModel".split(" "),function(y,p,m,a,l,g,h,d,q,e,c){var b="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" "),
n=g.getLogger("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel");return function(c){function f(a){a=c.call(this,a)||this;a.supportedViewType="3d";a._handles=new l;a._userUnitOptions=null;a._userUnit=null;a.tool=null;return a}m(f,c);f.prototype.initialize=function(){var a=this;this._handles.add([d.init(this,"unit",function(b){a.tool&&(a.tool.unit=b)})])};Object.defineProperty(f.prototype,"state",{get:function(){return this.isDisabled?"disabled":this.tool.state},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"measurement",{get:function(){if(this.isDisabled)return null;var a=this.tool.model,b=a.measurementMode,c=a.measurementData,d=a.validMeasurement,e=(c=0===("euclidean"===b?c.intersectingSegments:c.geodesicIntersectingSegments).size)?d?"available":"unavailable":"invalid";return{mode:b,area:{text:c&&d?a.areaLabel:null,state:e},perimeterLength:{text:c&&d?a.perimeterLengthLabel:null,state:e}}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"defaultUnit",
{get:function(){return this.defaultUnitFromPortal||this.defaultUnitFromSpatialReference||"metric"},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"defaultUnitFromSpatialReference",{get:function(){return h.getDefaultUnitSystem(this.view&&this.view.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"defaultUnitFromPortal",{get:function(){var a=this.get("view.map.portalItem.portal");if(!a)return null;switch(a.user&&a.user.units||a.units){case "metric":return"metric";
case "english":return"imperial";default:return null}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"unitOptions",{get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(a){this._userUnitOptions=a;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"unit",{get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):
this._findSelectableUnit(this.defaultUnit)},set:function(a){this._userUnit=a?this._findSelectableUnit(a,this._userUnit):null;this.notifyChange("unit")},enumerable:!0,configurable:!0});f.prototype.newMeasurement=function(){this.tool&&this.tool.newMeasurement()};f.prototype.clearMeasurement=function(){this.tool&&this.tool.clearMeasurement()};f.prototype.createToolParams=function(){return{toolConstructor:e,constructorArguments:{unit:this.unit}}};f.prototype.logUnsupportedError=function(){n.error("AreaMeasurement3D widget is not implemented for MapView")};
f.prototype.logError=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];n.error.apply(n,a)};f.prototype._findSelectableUnit=function(a,b){var c=this.unitOptions;return-1!==c.indexOf(a)?a:b?this._findSelectableUnit(b):c[0]};f.prototype._filteredOrAllUnits=function(a){if(!a)return b.slice();a=a.filter(function(a){return-1!==b.indexOf(a)});return 0===a.length?b.slice():a};a([q.property({dependsOn:["view.ready","isDisabled","tool.state"],readOnly:!0})],f.prototype,"state",null);a([q.property({dependsOn:"view.ready tool.area tool.geodesicArea tool.areaLabel tool.perimeterLength tool.geodesicPerimeterLength tool.model.perimeterLengthLabel tool.model.measurementMode tool.model.measurementData".split(" "),
readOnly:!0})],f.prototype,"measurement",null);a([q.property({constructOnly:!0})],f.prototype,"tool",void 0);a([q.property({readOnly:!0,dependsOn:["defaultUnitFromPortal","defaultUnitFromSpatialReference"]})],f.prototype,"defaultUnit",null);a([q.property({readOnly:!0,dependsOn:["view.spatialReference"]})],f.prototype,"defaultUnitFromSpatialReference",null);a([q.property({readOnly:!0,dependsOn:["view.map.portalItem.portal.units","view.map.portalItem.portal.user.units"]})],f.prototype,"defaultUnitFromPortal",
null);a([q.property({dependsOn:["view.spatialReference"]})],f.prototype,"unitOptions",null);a([q.property({dependsOn:["unitOptions","defaultUnit"]})],f.prototype,"unit",null);a([q.property()],f.prototype,"clearMeasurement",null);return f=a([q.subclass("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],f)}(q.declared(c))})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/restHelper ../../../../../core/Handles ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./AreaMeasurement3DController ./AreaMeasurement3DModel ./AreaMeasurement3DView ../../../../interactive/InteractiveToolBase ../../../../interactive/interactiveToolUtils".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n){return function(b){function f(a){var c=b.call(this,a)||this;c._handles=new g;c.model=new e({sceneView:a.view});return c}m(f,b);f.prototype.normalizeCtorArgs=function(a){return l(a,["view"])};f.prototype.initialize=function(){var a=this;this._view=new c(this.model,this.manipulators);this._controller=new q(this.model,this._view,this.manipulators);this._handles.add([h.init(this,"state",function(){"measured"===a.state&&n.setActive(a,!1)},!0)])};f.prototype.destroy=
function(){this.detach();this._view.destroy();this._view=null;this._controller.destroy();this._controller=null;this._handles.destroy();this._handles=null};Object.defineProperty(f.prototype,"state",{get:function(){return this.model.isMeasuring?"measured"===this.model.state?"measured":"measuring":"ready"},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isSupported",{get:function(){return"3d"===this.get("view.type")},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"cursor",{get:function(){return!this.model.active||"initial"!==this.model.state&&"drawing"!==this.model.state?null:"crosshair"},enumerable:!0,configurable:!0});f.prototype.newMeasurement=function(){this.model.reset();n.setActive(this,!0)};f.prototype.clearMeasurement=function(){this.model.reset();n.setActive(this,!1)};f.prototype.activate=function(){this.model.active=!0};f.prototype.deactivate=function(){this.model.active=!1;"measured"!==this.model.state&&this.model.reset()};f.prototype.onShow=function(){this._view.show()};
f.prototype.onHide=function(){this._view.hide()};f.prototype.onDetach=function(){this.model.reset()};f.prototype.onInputEvent=function(a){this._controller.handleInputEvent(a,this.manipulators)};a([d.property({dependsOn:["model.isMeasuring","model.state"],readOnly:!0})],f.prototype,"state",null);a([d.property({dependsOn:["view.type"],readOnly:!0})],f.prototype,"isSupported",null);a([d.property({dependsOn:["model.active","state"],readOnly:!0})],f.prototype,"cursor",null);a([d.property({constructOnly:!0})],
f.prototype,"model",void 0);a([d.aliasOf("model.sceneView")],f.prototype,"view",void 0);a([d.aliasOf("model.mode")],f.prototype,"mode",void 0);a([d.aliasOf("model.unit")],f.prototype,"unit",void 0);a([d.aliasOf("model.areaLabel")],f.prototype,"areaLabel",void 0);a([d.aliasOf("model.area")],f.prototype,"area",void 0);a([d.aliasOf("model.geodesicArea")],f.prototype,"geodesicArea",void 0);a([d.aliasOf("model.pathLengthLabel")],f.prototype,"pathLengthLabel",void 0);a([d.aliasOf("model.pathLength")],f.prototype,
"pathLength",void 0);a([d.aliasOf("model.geodesicPathLength")],f.prototype,"geodesicPathLength",void 0);a([d.aliasOf("model.perimeterLengthLabel")],f.prototype,"perimeterLengthLabel",void 0);a([d.aliasOf("model.perimeterLength")],f.prototype,"perimeterLength",void 0);a([d.aliasOf("model.geodesicPerimeterLength")],f.prototype,"geodesicPerimeterLength",void 0);a([d.aliasOf("model.validMeasurement")],f.prototype,"validMeasurement",void 0);a([d.aliasOf("model.viewData")],f.prototype,"viewData",void 0);
return f=a([d.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],f)}(d.declared(b.InteractiveToolBase))})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../geometry/Point ../../../../../layers/graphics/dehydratedFeatures ./AreaMeasurement3DView".split(" "),
function(y,p,m,a,l,g,h,d,q,e){return function(){function a(a,c,d){this._manipulators=d;this._handles=new l;this._tempPickRequest=new e.PickRequest;this.model=a;this.view=c;this.model.reset();this._setupManipulators()}a.prototype.destroy=function(){this._handles.destroy();this._handles=null};a.prototype.handleInputEvent=function(a,c){switch(a.type){case "immediate-click":this._handleImmediateClick(a);break;case "pointer-move":this._handlePointerMove(a);break;case "double-click":this._handleDoubleClick(a);
break;case "drag":this._handleDrag(a);break;case "key-down":this._handleKeyDown(a)}};a.prototype._setupManipulators=function(){var a=this,c=0,e=function(b,e){a._handles.add(e.watch("dragging",function(d){d?(c++,a.model.lastDraggedVertex=g.expect(a.view.manipulatorIdToVertexId(b)),"measured"===a.model.state&&(a.model.state="editing")):(c--,0===c&&"editing"===a.model.state&&(a.model.state="measured"))},!0),"manipulator-"+b);e.on("drag",function(){var c=g.expect(a.view.manipulatorIdToVertexId(b));a.model.path.update(c,
q.clonePoint(e.mapPoint,new d))})};this._manipulators.forEach(function(a){e(a.id,a.manipulator)});this._handles.add(this._manipulators.on("change",function(b){b.added.forEach(function(a){e(a.id,a.manipulator)});b.removed.forEach(function(b){a._handles.remove("manipulator-"+b.id)})}))};a.prototype._handleDrag=function(a){"editing"===this.model.state&&a.stopPropagation()};a.prototype._handleImmediateClick=function(a){if("mouse"!==a.pointerType||0===a.button){var b=h.createScreenPointFromEvent(a),c=
!1;if(this.model.active)switch(this.model.state){case "initial":this._addVertexAt(b,a.pointerType)&&(this.model.state="drawing",c=!0);break;case "drawing":var d=this.view.vertexHandleAt(b,a.pointerType);if(g.isNone(d)){if(this._addVertexAt(b,a.pointerType)){a.stopPropagation();return}}else 0===d&&(this.model.finishMeasurement(),c=!0);break;case "measured":g.isNone(this.view.vertexHandleAt(b,a.pointerType))&&(this.model.clearMeasurement(),this._addVertexAt(b,a.pointerType)&&(this.model.state="drawing",
c=!0))}c&&a.stopPropagation();"mouse"===a.pointerType&&this._hoverAt(b)}};a.prototype._handlePointerMove=function(a){var b=h.createScreenPointFromEvent(a);"mouse"===a.pointerType&&this._hoverAt(b)};a.prototype._handleDoubleClick=function(a){if("mouse"!==a.pointerType||0===a.button){var b=h.createScreenPointFromEvent(a);"drawing"===this.model.state&&g.isSome(this.view.vertexHandleAt(b,a.pointerType))&&(this.model.finishMeasurement(),a.stopPropagation())}};a.prototype._handleKeyDown=function(a){"Escape"===
a.key&&"drawing"===this.model.state&&(this.model.clearMeasurement(),a.stopPropagation());"Enter"===a.key&&"drawing"===this.model.state&&(this.model.finishMeasurement(),a.stopPropagation())};a.prototype._hoverAt=function(a){this.view.requiresCursorPoint?(a=this._pick(a),a.mapPoint&&(this.model.cursorPoint=a.mapPoint)):this.model.cursorPoint=null};a.prototype._addVertexAt=function(a,c){a=this._pick(a);return a.mapPoint?(this.model.path.add(a.mapPoint),!0):!1};a.prototype._pick=function(a){var b=this._tempPickRequest;
b.screenPoint=a;return this.view.pick(b)};return a}()})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DView":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../directLineMeasurement3D/LaserLineRenderer ../support/Label ../support/LabelSegment ../support/labelUtils ../support/PathSegmentInterpolator ../support/viewUtils ../../../support/projectionUtils ../../../support/stack ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryData ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/Layer ../../../webgl-engine/lib/Object3D ../../../webgl-engine/materials/CheckerBoardMaterial ../../../webgl-engine/materials/RibbonLineMaterial ../../../webgl-engine/parts/Model ../../../../interactive/ManipulatorCollection ../../../../interactive/manipulatorUtils".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n,u,f,x,B,v,z,k,t,r,w,C,K,G,H,E,I,D){var N={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,
projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25};y=function(){function a(a,b,d){void 0===b&&(b=new I.ManipulatorCollection);void 0===d&&(d={});this._model=a;this._manipulators=b;this.vertexManipulators=[];this._visible=!1;this._cursorManipulator=this._laserLineRenderer=null;this._pathSegmentObjects=[];this._perimeterSegmentObjects=[];this._projectionLineObjects=[];this._areaLabel=new n(16);this._pathLengthLabel=new n(12);
this._cursorSegmentLengthLabel=new n(12);this._perimeterLengthLabel=new n(12);this._pathLabelSegments=[];this._perimeterLabelSegments=[];this._cursorSegmentLengthLabelSegment=new u;this._listenerHandles=null;this._origin=c.vec3f64.create();this._originTransform=q.mat4f64.create();this._tempStartPosition=c.vec3f64.create();this._tempEndPosition=c.vec3f64.create();this._tempHandlePosition=c.vec3f64.create();this._sceneView=this._model.sceneView;this._params=B.copyParameter(N,d);this._layer=new C("path-measurement-tool",
{isPickable:!1});this._createMaterials();this._createObjects();this._intersector=new w(this._sceneView.viewingMode);a=D.createSphereManipulator(this._sceneView,this._params.handleColor,this._params.handleOpacity);a.visible=!1;a.radius=this._params.handleRadius;a.interactive=!1;this._manipulators.add(a);this._cursorManipulator=a}a.prototype.destroy=function(){this.hide()};Object.defineProperty(a.prototype,"requiresCursorPoint",{get:function(){return("initial"===this._model.state||"drawing"===this._model.state)&&
this._model.active},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){a?this.show():this.hide()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"testData",{get:function(){return{labels:{area:this._areaLabel,pathLength:this._pathLengthLabel,cursorSegmentLength:this._cursorSegmentLengthLabel,perimeterLength:this._perimeterLengthLabel},laserLineRenderer:this._laserLineRenderer}},enumerable:!0,configurable:!0});
a.prototype.show=function(){if(!this._visible){this._visible=!0;var a=this._sceneView._stage;this._laserLineRenderer=new b(this._sceneView.renderCoordsHelper,{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,globalAlpha:this._params.laserLineGlobalAlpha});a.addRenderPlugin(this._laserLineRenderer.renderSlots,this._laserLineRenderer);this._addToStage(a);this._areaLabel.addToView(this._sceneView);
this._pathLengthLabel.addToView(this._sceneView);this._cursorSegmentLengthLabel.addToView(this._sceneView);this._perimeterLengthLabel.addToView(this._sceneView);this._initializeListeners();this._updateAll(this._model.viewData)}};a.prototype.hide=function(){if(this._visible){this._visible=!1;var a=this._sceneView._stage;a.removeRenderPlugin(this._laserLineRenderer);this._laserLineRenderer=null;this._destroyListeners();this._updatePathLength(0);this._removeFromStage(a);this._areaLabel.removeFromView(this._sceneView);
this._pathLengthLabel.removeFromView(this._sceneView);this._cursorSegmentLengthLabel.removeFromView(this._sceneView);this._perimeterLengthLabel.removeFromView(this._sceneView);this._sceneView.cursor=null}};a.prototype.vertexHandleAt=function(a,b){a=this._manipulators.intersect(a,b);return g.isSome(a)?this.manipulatorIdToVertexId(a):null};a.prototype.manipulatorIdToVertexId=function(a){for(var b=0;b<this.vertexManipulators.length;b++)if(a===this.vertexManipulators[b].id)return b;return null};a.prototype.pick=
function(b){var d=this._sceneView.spatialReference;b=h.screenPointObjectToArray(b.screenPoint);b=this._sceneView.sceneIntersectionHelper.intersectToolIntersectorScreen(b,this._intersector).results.min;var e=c.vec3f64.create();if(!b.getIntersectionPoint(e))return new a.PickResult;d=this._sceneView.renderCoordsHelper.fromRenderCoords(e,d);return new a.PickResult("TerrainRenderer"===b.intersector?"surface":"feature",e,d)};a.prototype.overlappingHandles=function(a,b){return B.pointToPointScreenDistance(a,
b,this._sceneView)<=this._params.handleRadius};a.prototype._createMaterials=function(){this._pathLineMaterial=new H({width:this._params.pathLineWidth,color:this._params.pathLineColor,polygonOffset:!0},"path-line");this._pathLineMaterial.renderOccluded=4;this._intersectingPathLineMaterial=new H({width:this._params.pathLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0},"intersecting-path-line");this._intersectingPathLineMaterial.renderOccluded=4;this._perimeterLineMaterial=new H({width:this._params.perimeterLineWidth,
color:this._params.perimeterLineColor,polygonOffset:!0},"perimeter-line");this._perimeterLineMaterial.renderOccluded=4;this._intersectingPerimeterLineMaterial=new H({width:this._params.perimeterLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0},"intersecting-perimeter-line");this._intersectingPerimeterLineMaterial.renderOccluded=4;this._projectionLineMaterial=new H({width:this._params.projectionLineWidth,color:this._params.projectionLineColor,polygonOffset:!0,stippleLength:0},"projection-line");
this._projectionLineMaterial.renderOccluded=4;this._checkerBoardMaterial=new G({color1:this._params.areaColor1,color2:this._params.areaColor2,transparent:!0,writeDepth:!1,polygonOffset:!0},"checker-board");this._checkerBoardMaterial.renderOccluded=4};a.prototype._createObjects=function(){this._cursorSegmentObject=new K;this._areaObject=new K};a.prototype._addToStage=function(a){a.add(E.ContentType.LAYER,this._layer);a.add(E.ContentType.MATERIAL,this._pathLineMaterial);a.add(E.ContentType.MATERIAL,
this._intersectingPathLineMaterial);a.add(E.ContentType.MATERIAL,this._perimeterLineMaterial);a.add(E.ContentType.MATERIAL,this._intersectingPerimeterLineMaterial);a.add(E.ContentType.MATERIAL,this._projectionLineMaterial);a.add(E.ContentType.MATERIAL,this._checkerBoardMaterial);a.addToViewContent([this._layer.id])};a.prototype._removeFromStage=function(a){a.removeFromViewContent([this._layer.id]);a.remove(E.ContentType.LAYER,this._layer.id);a.remove(E.ContentType.MATERIAL,this._pathLineMaterial.id);
a.remove(E.ContentType.MATERIAL,this._intersectingPathLineMaterial.id);a.remove(E.ContentType.MATERIAL,this._perimeterLineMaterial.id);a.remove(E.ContentType.MATERIAL,this._intersectingPerimeterLineMaterial.id);a.remove(E.ContentType.MATERIAL,this._projectionLineMaterial.id);a.remove(E.ContentType.MATERIAL,this._checkerBoardMaterial.id)};a.prototype._syncViewData=function(a){var b=this;if(!this._visible)return"none";var c=a.pathChanges;"full"===c.change?this._updateAll(a):"incremental"===c.change&&
(c.updatedVertices.forEach(function(c){var d=(c-1+b._model.path.length)%b._model.path.length;b._updatePathSegment(a,c);b._updatePathSegment(a,d);b._updateVertexHandle(a,c);b._updateArea(a);b._updatePerimeterSegments(a);b._updateProjectionLines(a);b._updateLaserLine();b._updateLabels(a)}),c.updatedVertices.has(this._model.path.length-1)&&this._updateCursorSegment(a));var d=c.change;c.clear();return d};a.prototype._updateAfterSyncViewData=function(a){var b=this._model.viewData;"full"!==this._syncViewData(b)&&
a&&a(b)};a.prototype._updateOrigin=function(a){B.midpoint(a.positionsRenderCoords,this._origin);d.mat4.identity(this._originTransform);d.mat4.translate(this._originTransform,this._originTransform,this._origin)};a.prototype._updateAll=function(a){this._updateOrigin(a);this._updatePathLength(a.path.length);this._updatePathSegments(a);this._updatePerimeterSegments(a);this._updateHandles(a);this._updateArea(a);this._updateProjectionLines(a);this._updateLabels(a);this._updateLaserLine()};a.prototype._updateCameraDependent=
function(a){this._updateHandles(a);this._updateProjectionLines(a);this._updateLabels(a)};a.prototype._updatePathLength=function(a){this._resizeObject3DArray(this._pathSegmentObjects,a);this._resizeObject3DArray(this._perimeterSegmentObjects,a);this._resizeManipulatorArray(this.vertexManipulators,a);B.resizeArray(this._pathLabelSegments,a,function(){return new u});B.resizeArray(this._perimeterLabelSegments,a,function(){return new u})};a.prototype._updatePathSegments=function(a){for(var b=0;b<this._pathSegmentObjects.length;++b)this._updatePathSegment(a,
b);this._updateCursorSegment(a)};a.prototype._updatePathSegment=function(a,b){var c=a.path,d=this._pathSegmentObjects[b];a.validMeasurement||b<c.length-1?(this._createInterpolatedLineGeometry(d,a.intersectingSegments.has(b)?this._intersectingPathLineMaterial:this._pathLineMaterial,"path-segment",a.positionsRenderCoords[b],a.positionsRenderCoords[(b+1)%c.length],this._origin,this._originTransform,this._model.measurementMode,this._pathLabelSegments[b],a.validMeasurement?"center":"end"),this._addObject3D(d)):
(d.removeAllGeometries(),this._removeObject3D(d))};a.prototype._updateCursorSegment=function(a){a=this._sceneView.renderCoordsHelper;var b=this._model.path,c=this._cursorSegmentObject;0<b.length&&"drawing"===this._model.state&&this._model.cursorPoint?(a.toRenderCoords(b.back,this._tempStartPosition),a.toRenderCoords(this._model.cursorPoint,this._tempEndPosition),this._createInterpolatedLineGeometry(c,this._pathLineMaterial,"path-segment",this._tempStartPosition,this._tempEndPosition,this._origin,
this._originTransform,this._model.measurementMode,this._cursorSegmentLengthLabelSegment,"end"),this._addObject3D(c)):(c.removeAllGeometries(),this._removeObject3D(c))};a.prototype._updatePerimeterSegments=function(a){for(var b=0;b<this._perimeterSegmentObjects.length;++b)this._updatePerimeterSegment(a,b)};a.prototype._updatePerimeterSegment=function(a,b){var c=a.path,d=this._perimeterSegmentObjects[b];a.validMeasurement&&"geodesic"!==this._model.measurementMode?(this._updatePerimeterSegmentObject(d,
a.positionsFittedRenderCoords[b],a.positionsFittedRenderCoords[(b+1)%c.length],this._origin,this._originTransform,a.intersectingSegments.has(b),this._perimeterLabelSegments[b]),this._addObject3D(d)):(d.removeAllGeometries(),this._removeObject3D(d))};a.prototype._updatePerimeterSegmentObject=function(a,b,c,d,e,k,f){this._createInterpolatedLineGeometry(a,k?this._intersectingPerimeterLineMaterial:this._perimeterLineMaterial,"perimeter-segment",b,c,d,e,this._model.measurementMode,f)};a.prototype._updateHandles=
function(a){for(var b=0;b<this.vertexManipulators.length;++b)this._updateVertexHandle(a,b);this._updateCursorHandle()};a.prototype._updateVertexHandle=function(a,b){this.vertexManipulators[b].manipulator.position=a.positionsRenderCoords[b]};a.prototype._updateCursorHandle=function(){var a=this._cursorManipulator;"drawing"===this._model.state&&this._model.cursorPoint?(a.visible=!0,a.mapPoint=this._model.cursorPoint):a.visible=!1};a.prototype._updateArea=function(a){switch(this._model.measurementMode){case "euclidean":this._updateAreaEuclidean(a);
break;case "geodesic":this._updateAreaGeodesic()}};a.prototype._updateAreaEuclidean=function(a){var b=this,d=this._areaObject;if(a.validMeasurement&&0===a.intersectingSegments.size&&a.triangleIndices){var f=[],g=c.vec3f64.create();a.positionsFittedRenderCoords.forEach(function(a){e.vec3.subtract(g,a,b._origin);f.push(g[0],g[1],g[2])});var h=[];a.positionsProjected.forEach(function(a){h.push(a[0],a[1])});var l=new t({position:{size:3,data:f},uv0:{size:2,data:h}},{position:a.triangleIndices,uv0:a.triangleIndices}),
l=new k(l,"area");d.removeAllGeometries();d.addGeometry(l,this._checkerBoardMaterial,this._originTransform);this._addObject3D(d);this._checkerBoardMaterial.setParameterValues({size:[a.checkerSize,a.checkerSize]})}else d.removeAllGeometries(),this._removeObject3D(d)};a.prototype._updateAreaGeodesic=function(){var a=this._areaObject;a.removeAllGeometries();this._removeObject3D(a)};a.prototype._updateProjectionLines=function(a){var b=a.path;this._resizeObject3DArray(this._projectionLineObjects,b.length);
for(var c=0;c<b.length;++c)this._updateProjectionLine(a,c);for(var d=Infinity,c=0;c<b.length;++c)d=Math.max(this._sceneView._stage.getCamera().computeScreenPixelSizeAt(a.positionsRenderCoords[c])),d=Math.max(this._sceneView._stage.getCamera().computeScreenPixelSizeAt(a.positionsFittedRenderCoords[c]));this._projectionLineMaterial.setParameterValues({stippleLength:this._params.projectionLineStippleSize*d})};a.prototype._updateProjectionLine=function(a,b){var d=this._projectionLineObjects[b];d.removeAllGeometries();
if(a.validMeasurement&&"euclidean"===this._model.measurementMode){a=c.vec3f64.create();e.vec3.subtract(a,this._model.viewData.positionsRenderCoords[b],this._origin);var f=c.vec3f64.create();e.vec3.subtract(f,this._model.viewData.positionsFittedRenderCoords[b],this._origin);b=new k(r.createPolylineGeometry([a,f]),"projected-line");d.addGeometry(b,this._projectionLineMaterial,this._originTransform);this._addObject3D(d)}else this._removeObject3D(d)};a.prototype._updateLabels=function(a){var b=this,c=
this._sceneView._stage.getCamera(),d=this._params.labelDistance,e=this._model,k="geodesic"===e.measurementMode,g="drawing"===e.state,h=function(a,c){return a.visible&&c.visible&&b._sceneView.overlay.overlaps(a.textItem,c.textItem)},l=this._areaLabel,m=f.positionLabelOnPoint(l,a.areaCentroid,c);l.text=e.areaLabel;l.visible=m&&a.validMeasurement&&0===a.intersectingSegments.size&&null!=e.areaLabel;l=this._pathLengthLabel;m=f.positionLabelOnCorner(l,this._pathLabelSegments[a.pathLengthLabelSegmentIndex],
this._cursorSegmentLengthLabelSegment,d,c);l.text=e.pathLengthLabel;l.visible=m&&g&&0<e.path.length;l=this._cursorSegmentLengthLabel;m=this._cursorSegmentLengthLabelSegment;m=f.positionLabelOnSegment(l,m,d,"bottom",c);l.text=e.cursorSegmentLengthLabel;l.visible=m&&g&&e.cursorSegmentLength&&0!==e.cursorSegmentLength.value;h(this._cursorSegmentLengthLabel,this._pathLengthLabel)&&(this._cursorSegmentLengthLabel.visible=!1);h(this._pathLengthLabel,this._areaLabel)&&(this._pathLengthLabel.visible=!1);
l=this._perimeterLengthLabel;if(e.validMeasurement&&0===a.intersectingSegments.size)for(g=0;g<a.path.length;++g)if(m=(a.perimeterLengthLabelSegmentIndex+g)%a.path.length,m=k?this._pathLabelSegments[m]:this._perimeterLabelSegments[m],m=f.positionLabelOnSegment(l,m,d,"top",c),l.text=e.perimeterLengthLabel,l.visible=m,h(l,this._areaLabel))l.visible=!1;else break;else l.visible=!1};a.prototype._getFocusPoint=function(){var a=this._model,b=this._model.lastDraggedVertex;switch(a.state){case "drawing":return a.cursorPoint?
a.cursorPoint:a.path.vertex(g.isSome(b)?b:a.path.length-1);case "editing":return g.isSome(b)?a.path.vertex(b):null;default:return a.cursorPoint}};a.prototype._updateLaserLine=function(){var a=this._model,b=this._params.laserLineEnabled&&"measured"!==a.state&&a.active;this._laserLineRenderer.focusSphereActive=!1;this._laserLineRenderer.segmentActive=!1;a=this._getFocusPoint();b&&a?(b=this._tempHandlePosition,this._sceneView.renderCoordsHelper.toRenderCoords(a,b),this._laserLineRenderer.focusPosition=
b,this._laserLineRenderer.focusPlaneActive=!0):this._laserLineRenderer.focusPlaneActive=!1};a.prototype._addObject3D=function(a){a.parentLayer||(this._layer.addObject(a),this._sceneView._stage.add(E.ContentType.OBJECT,a))};a.prototype._removeObject3D=function(a){a.parentLayer&&(this._layer.removeObject(a),this._sceneView._stage.remove(E.ContentType.OBJECT,a.id))};a.prototype._resizeObject3DArray=function(a,b){var c=this;B.resizeArray(a,b,function(){return new K},function(a){c._removeObject3D(a)})};
a.prototype._resizeManipulatorArray=function(a,b){var c=this;B.resizeArray(a,b,function(){var a=D.createSphereManipulator(c._sceneView,c._params.handleColor,c._params.handleOpacity);a.hideOnGrab=!0;a.radius=c._params.handleRadius;return{id:c._manipulators.add(a),manipulator:a}},function(a){c._manipulators.remove(a.manipulator)})};a.prototype._createInterpolatedLineGeometry=function(a,b,c,d,f,g,h,l,m,w){var n=this._sceneView.renderCoordsHelper,q=[],p=[],t=function(a,b){var c=z.sv3d.get();e.vec3.subtract(c,
a,g);q.push(c);p.push(b)};if("euclidean"===l){var v=z.sv3d.get();B.midpoint([d,f],v);l=z.sv3d.get();n.worldUpAtPosition(v,l);t(d,l);t(f,l);m&&m.update(d,f,w)}else{d=this._getSegmentInterpolator(d,f);f=this._params.lineSubdivisions+1&-2;var C=v=null,A=f/2-1,u=f/2;"start"===w?(A=0,u=1):"end"===w&&(A=f-2,u=f-1);for(var x=0;x<f;++x){var y=x/(f-1),D=z.sv3d.get();l=z.sv3d.get();d.eval(y,D);n.worldUpAtPosition(D,l);x===A&&(v=D);x===u&&(C=D);t(D,l)}m&&m.update(v,C,w)}c=new k(r.createPolylineGeometry(q,p),
c);a.removeAllGeometries();a.addGeometry(c,b,h)};a.prototype._getSegmentInterpolator=function(a,b){if(v.canProject(this._sceneView.spatialReference,v.SphericalECEFSpatialReference)){var c=this._sceneView.renderCoordsHelper.spatialReference;return new x.Spherical(a,b,c,c)}return new x.Linear(a,b)};a.prototype._initializeListeners=function(){var a=this;this._listenerHandles=new l;this._listenerHandles.add([this._model.watch(["state","lastDraggedVertex"],function(){return a._updateLaserLine()}),this._model.watch("cursorPoint",
function(){return a._updateAfterSyncViewData(function(b){a._updateCursorSegment(b);a._updateCursorHandle();"drawing"===a._model.state&&a._updateLabels(b);a._updateLaserLine()})}),this._sceneView.state.watch("camera",function(){return a._updateAfterSyncViewData(function(b){return a._updateCameraDependent(a._model.viewData)})}),this._model.watch(["unit","measurementMode"],function(){return a._updateAll(a._model.viewData)}),this._model.watch(["active"],function(){a._updateLaserLine();a._syncViewData(a._model.viewData)}),
this._model.watch("viewData",function(b){return a._syncViewData(b)})])};a.prototype._destroyListeners=function(){this._listenerHandles.destroy();this._listenerHandles=null};a._handleGeometry=new k(r.createSphereGeometry(1,32,32),"handle");return a}();(function(a){var b=function(){return function(){}}();a.PickRequest=b;b=function(){return function(a,b,c){void 0===a&&(a=null);void 0===b&&(b=null);void 0===c&&(c=null);this.type=a;this.scenePoint=b;this.mapPoint=c}}();a.PickResult=b})(y||(y={}));return y})},
"esri/views/3d/webgl-engine/materials/CheckerBoardMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../lib/Util ./internal/bufferWriters ./internal/MaterialUtil ./internal/MaterialUtil ./renderers/InstancedRenderer ../shaders/CheckerBoardPrograms ../../../webgl/renderState".split(" "),function(y,p,m,a,l,g,h,d,q,e,c,b,n){y=function(a){function b(b,c){c=a.call(this,c)||this;c.params=q.copyParameters(b,
f);return c}m(b,a);b.prototype.dispose=function(){};b.prototype.getParameterValues=function(){var a=this.params;return{size:a.size,color1:a.color1,color2:a.color2,transparent:a.transparent,writeDepth:a.writeDepth,polygonOffset:a.polygonOffset}};b.prototype.setParameterValues=function(a){q.updateParameters(this.params,a)&&this.notifyDirty("matChanged")};b.prototype.getParams=function(){return this.params};b.prototype.intersect=function(a,b,c,d,f,g,h,l){return e.intersectTriangleGeometry(a,b,c,d,f,
g,h)};b.prototype.getGLMaterials=function(){return{color:u,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};b.prototype.createBufferWriter=function(){return new B};b.prototype.createRenderer=function(a,b){return new c(a,b,this)};return b}(g);var u=function(a){function c(b,c,d){b=a.call(this,b,c)||this;b.programRep=c;b.updateParameters();return b}m(c,a);c.prototype.selectProgram=function(){this.program=this.programRep.getProgram(b.colorPass);this.pipelineState=n.makePipelineState({blending:this.params.transparent&&
n.separateBlendingParams(770,1,771,771),polygonOffset:this.params.polygonOffset&&{factor:0,units:-25},depthTest:{func:513},depthWrite:this.params.writeDepth&&n.defaultDepthWriteParams,colorWrite:n.defaultColorWriteParams})};c.prototype.updateParameters=function(){this.params=this.material.getParameterValues();this.selectProgram()};c.prototype.beginSlot=function(a){var b=5;this.params.transparent&&(b=this.params.writeDepth?7:10);return a===b};c.prototype.getProgram=function(){return this.program};
c.prototype.getDrawMode=function(){return 4};c.prototype.bind=function(a,b){b=this.program;a.bindProgram(b);a.setPipelineState(this.pipelineState);b.setUniform2fv("size",this.params.size);b.setUniform4fv("color1",this.params.color1);b.setUniform4fv("color2",this.params.color2)};c.prototype.bindView=function(a,b){a=b.origin;var c=this.getProgram();q.bindView(a,b.view,c)};c.prototype.bindInstance=function(a,b){this.getProgram().setUniformMatrix4fv("model",b.transformation)};c.prototype.release=function(a){};
return c}(l),f={size:[1,1],color1:[.75,.75,.75,1],color2:[.5,.5,.5,1],transparent:!1,writeDepth:!0,polygonOffset:!1},x=a.newLayout().vec3f(h.VertexAttrConstants.POSITION).vec2f(h.VertexAttrConstants.UV0),B=function(){function a(){this.vertexBufferLayout=x}a.prototype.allocate=function(a){return x.createBuffer(a)};a.prototype.elementCount=function(a){return a.indices[h.VertexAttrConstants.POSITION].length};a.prototype.write=function(a,b,c,e){d.writePosition(b.indices[h.VertexAttrConstants.POSITION],
b.vertexAttr[h.VertexAttrConstants.POSITION].data,a.transformation,c.position,e);d.writeBufferVec2(b.indices[h.VertexAttrConstants.UV0],b.vertexAttr[h.VertexAttrConstants.UV0].data,c.uv0,e)};return a}();return y})},"esri/views/3d/webgl-engine/shaders/CheckerBoardPrograms":function(){define(["require","exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],function(y,p,m,a){Object.defineProperty(p,"__esModule",{value:!0});p.colorPass={name:"checker-board-color",shaders:{vertexShader:a.resolveIncludes("materials/checkerBoard/checkerBoard.vert"),
fragmentShader:a.resolveIncludes("materials/checkerBoard/checkerBoard.frag")},attributes:m.Default3D}})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DModel":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/compilerUtils ../../../../../core/Handles ../../../../../core/Quantity ../../../../../core/quantityUtils ../../../../../core/unitUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./MeasurementData ./PathChanges ../support/measurementUtils ../support/Path ../support/setUtils ../support/UnitNormalizer ../../../support/mathUtils ../../../support/projectionUtils".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n,u,f,x,B,v,z,k){return function(l){function r(){var a=null!==l&&l.apply(this,arguments)||this;a._unitNormalizer=new v;a._measurementData=new n;a._measurementDataChanges=new u;a._viewDataChanges=new u;a._handles=new h;a.path=new x;a.pathVersion=0;a.cursorPoint=null;a.state="initial";a.lastDraggedVertex=null;a.mode="auto";a.unit="metric";a.active=!1;a.maxRelativeErrorCoplanar=.005;a.maxRelativeErrorAlmostCoplanar=.01;a.verticalAngleThreshold=80;a.geodesicMeasurementDistanceThreshold=
1E5;return a}m(r,l);r.prototype.initialize=function(){var a=this;this._handles.add(c.whenTrue(this.sceneView,"ready",function(){var b=a.sceneView.spatialReference;a._worldSpatialReference=!b||k.canProject(b,k.WGS84ECEFSpatialReference)?k.WGS84ECEFSpatialReference:b;a._unitNormalizer.spatialReference=b}),"scene-view");this.reset();var b=function(){a._set("pathVersion",a.pathVersion+1)};this._handles.add(this.path.on("cleared",function(){a._measurementDataChanges.fullChange();a._set("pathVersion",0)}));
this._handles.add(this.path.on("vertex-added",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-inserted",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-removed",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-updated",function(c){a._measurementDataChanges.incrementalChange(c.index);b()}))};r.prototype.destroy=function(){this._handles.destroy();this._handles=
null};Object.defineProperty(r.prototype,"validMeasurement",{get:function(){return 3<=this.path.length&&"measured"===this.state||"editing"===this.state},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"isMeasuring",{get:function(){return 1<=this.path.length},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"measurementData",{get:function(){this._viewDataChanges.merge(this._measurementDataChanges);var a=B.clone(this._measurementData.intersectingSegments),b=B.clone(this._measurementData.geodesicIntersectingSegments);
this._measurementData.update(this.path,this._measurementDataChanges,this.sceneView,this._unitNormalizer,this.validMeasurement,this.sceneView.renderSpatialReference,this._worldSpatialReference,{maxRelativeErrorCoplanar:this.maxRelativeErrorCoplanar,maxRelativeErrorAlmostCoplanar:this.maxRelativeErrorAlmostCoplanar,verticalAngleThreshold:this.verticalAngleThreshold});f.compareSets(this._measurementData.intersectingSegments,a)||this._viewDataChanges.fullChange();f.compareSets(this._measurementData.geodesicIntersectingSegments,
b)||this._viewDataChanges.fullChange();return this._measurementData},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"area",{get:function(){return this.measurementData.area},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"geodesicArea",{get:function(){return this.measurementData.geodesicArea},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"areaLabel",{get:function(){return this._formatAreaLabel("geodesic"===this.measurementMode?this.measurementData.geodesicArea:
this.measurementData.area,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"pathLength",{get:function(){return this.measurementData.pathLength},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"geodesicPathLength",{get:function(){return this.measurementData.geodesicPathLength},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"pathLengthLabel",{get:function(){return this._formatLengthLabel("geodesic"===this.measurementMode?this.measurementData.geodesicPathLength:
this.measurementData.pathLength,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"perimeterLength",{get:function(){return this.measurementData.perimeterLength},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"geodesicPerimeterLength",{get:function(){return this.measurementData.geodesicPathLength},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"perimeterLengthLabel",{get:function(){return this.measurementData.perimeterLength&&this._formatLengthLabel("geodesic"===
this.measurementMode?this.measurementData.geodesicPathLength:this.measurementData.perimeterLength,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"cursorSegmentLength",{get:function(){return this.path.back&&this.cursorPoint&&new d(this._unitNormalizer.normalizeDistance(f.segmentLengthEuclidean(this.path.back,this.cursorPoint,this._worldSpatialReference)),"meters")},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"geodesicCursorSegmentLength",{get:function(){return this.path.back&&
this.cursorPoint&&new d(f.segmentLengthGeodesic(this.path.back,this.cursorPoint),"meters")},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"cursorSegmentLengthLabel",{get:function(){return this._formatLengthLabel("geodesic"===this.measurementMode?this.geodesicCursorSegmentLength:this.cursorSegmentLength,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"viewData",{get:function(){var a=this.measurementData,b="geodesic"===this.measurementMode,c=b?this.geodesicArea:
this.area,d=1;c&&(c=this._toPreferredAreaUnit(c,this.unit),d=z.nextHighestPowerOfTen(Math.sqrt(c.value)/Math.sqrt(300)),d*=Math.sqrt(e.convertUnit(1,c.unit,"square-meters")),d/=this._unitNormalizer.normalizeDistance(1));return{validMeasurement:this.validMeasurement,path:this.path,pathChanges:this._viewDataChanges,positionsGeographic:a.positionsGeographic,positionsRenderCoords:a.positionsRenderCoords,positionsProjected:a.positionsProjectedWorldCoords,positionsFittedRenderCoords:a.positionsFittedRenderCoords,
intersectingSegments:b?a.geodesicIntersectingSegments:a.intersectingSegments,triangleIndices:b?a.geodesicTriangleIndices:a.triangleIndices,fittingMode:a.fittingMode,areaCentroid:b?a.geodesicAreaCentroidRenderCoords:a.areaCentroidRenderCoords,pathLengthLabelSegmentIndex:this.validMeasurement?0:this.path.length-2,perimeterLengthLabelSegmentIndex:0,checkerSize:d}},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"measurementMode",{get:function(){var a=this.mode;"auto"===a&&(a="euclidean",
(this.geodesicPathLength?this.geodesicPathLength.value:0)+(!this.validMeasurement&&this.geodesicCursorSegmentLength?this.geodesicCursorSegmentLength.value:0)>this.geodesicMeasurementDistanceThreshold&&(a="geodesic"));null==this.geodesicPathLength&&(a="euclidean");return a},enumerable:!0,configurable:!0});r.prototype.reset=function(){this.clearMeasurement()};r.prototype.clearMeasurement=function(){this.path.clear();this.state="initial";this.cursorPoint=null};r.prototype.finishMeasurement=function(){3>
this.path.length?this.clearMeasurement():(this._measurementDataChanges.fullChange(),this.state="measured")};r.prototype._preferredAreaUnit=function(a,b){switch(b){case "metric":return e.preferredMetricAreaUnit(a.value,a.unit);case "imperial":return e.preferredImperialAreaUnit(a.value,a.unit);default:return b}};r.prototype._preferredLengthUnit=function(a,b){b=this._deriveLengthUnitFromAreaUnit(b);switch(b){case "metric":return e.preferredMetricLengthUnit(a.value,a.unit);case "imperial":return e.preferredImperialLengthUnit(a.value,
a.unit);default:return b}};r.prototype._toPreferredAreaUnit=function(a,b){return a.toUnit(this._preferredAreaUnit(a,b))};r.prototype._toPreferredLengthUnit=function(a,b){return a.toUnit(this._preferredLengthUnit(a,b))};r.prototype._formatAreaLabel=function(a,b){return a&&q.formatDecimal(a,this._preferredAreaUnit(a,b))};r.prototype._formatLengthLabel=function(a,b){return a&&q.formatDecimal(a,this._preferredLengthUnit(a,b))};r.prototype._deriveLengthUnitFromAreaUnit=function(a){switch(a){case "metric":return"metric";
case "imperial":return"imperial";case "square-inches":return"inches";case "square-feet":return"feet";case "square-yards":return"yards";case "square-miles":return"miles";case "square-us-feet":return"us-feet";case "square-millimeters":return"millimeters";case "square-centimeters":return"centimeters";case "square-decimeters":return"decimeters";case "square-meters":return"meters";case "square-kilometers":return"kilometers";case "acres":return"imperial";case "ares":case "hectares":return"metric";default:g.neverReached(a)}throw Error("unhandled area unit");
};a([b.property({constructOnly:!0})],r.prototype,"sceneView",void 0);a([b.property({readOnly:!0})],r.prototype,"path",void 0);a([b.property({readOnly:!0})],r.prototype,"pathVersion",void 0);a([b.property()],r.prototype,"cursorPoint",void 0);a([b.property()],r.prototype,"state",void 0);a([b.property()],r.prototype,"lastDraggedVertex",void 0);a([b.property()],r.prototype,"mode",void 0);a([b.property()],r.prototype,"unit",void 0);a([b.property()],r.prototype,"active",void 0);a([b.property({readOnly:!0,
dependsOn:["path.length","state"]})],r.prototype,"validMeasurement",null);a([b.property({readOnly:!0,dependsOn:["path.length"]})],r.prototype,"isMeasuring",null);a([b.property({readOnly:!0,dependsOn:["pathVersion","validMeasurement","maxRelativeErrorCoplanar","maxRelativeErrorAlmostCoplanar","verticalAngleThreshold"]})],r.prototype,"measurementData",null);a([b.property({readOnly:!0,dependsOn:["measurementData"]})],r.prototype,"area",null);a([b.property({readOnly:!0,dependsOn:["measurementData"]})],
r.prototype,"geodesicArea",null);a([b.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],r.prototype,"areaLabel",null);a([b.property({readOnly:!0,dependsOn:["measurementData"]})],r.prototype,"pathLength",null);a([b.property({readOnly:!0,dependsOn:["measurementData"]})],r.prototype,"geodesicPathLength",null);a([b.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],r.prototype,"pathLengthLabel",null);a([b.property({readOnly:!0,dependsOn:["measurementData"]})],
r.prototype,"perimeterLength",null);a([b.property({readOnly:!0,dependsOn:["measurementData"]})],r.prototype,"geodesicPerimeterLength",null);a([b.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],r.prototype,"perimeterLengthLabel",null);a([b.property({readOnly:!0,dependsOn:["path.back","cursorPoint"]})],r.prototype,"cursorSegmentLength",null);a([b.property({readOnly:!0,dependsOn:["path.back","cursorPoint"]})],r.prototype,"geodesicCursorSegmentLength",null);a([b.property({readOnly:!0,
dependsOn:["measurementData","unit","measurementMode"]})],r.prototype,"cursorSegmentLengthLabel",null);a([b.property({readOnly:!0,dependsOn:["unit","measurementMode","measurementData"]})],r.prototype,"viewData",null);a([b.property()],r.prototype,"maxRelativeErrorCoplanar",void 0);a([b.property()],r.prototype,"maxRelativeErrorAlmostCoplanar",void 0);a([b.property()],r.prototype,"verticalAngleThreshold",void 0);a([b.property()],r.prototype,"geodesicMeasurementDistanceThreshold",void 0);a([b.property({readOnly:!0,
dependsOn:["mode","validMeasurement","geodesicPathLength","geodesicCursorSegmentLength","geodesicMeasurementDistanceThreshold"]})],r.prototype,"measurementMode",null);return r=a([b.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DModel")],r)}(b.declared(l))})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/MeasurementData":function(){define("require exports ../../../../../core/Quantity ../../../../../core/libs/earcut/earcut ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/vec4f64 ../../../../../geometry/SpatialReference ../../../../../geometry/support/intersects ../support/measurementUtils ../support/viewUtils ../../../support/earthUtils ../../../support/mathUtils ../../../support/mathUtils ../../../support/projectionUtils".split(" "),
function(y,p,m,a,l,g,h,d,q,e,c,b,n,u,f,x,B){function v(a,b,c){b=new Float64Array(a.length*c);for(var d=0;d<a.length;++d)for(var e=a[d],f=0;f<c;++f)b[d*c+f]=e[f];return b}return function(){function p(){this.positionsWorldCoords=[];this.positionsRenderCoords=[];this.positionsProjectedWorldCoords=[];this.positionsFittedRenderCoords=[];this.positionsGeographic=[];this.positionsSpherical=[];this.positionsStereographic=[];this.pathSegmentLengths=[];this.geodesicPathSegmentLengths=[];this.perimeterSegmentLengths=
[];this.intersectingSegments=new Set;this.geodesicIntersectingSegments=new Set;this.areaCentroidWorldCoords=d.vec3f64.create();this.areaCentroidRenderCoords=d.vec3f64.create();this.geodesicAreaCentroidRenderCoords=d.vec3f64.create();this._length=0;this._centroidRenderCoords=d.vec3f64.create();this._planeWorldCoords=q.vec4f64.create();this._worldUp=d.vec3f64.create();this._worldTangent=d.vec3f64.create();this._frame=[d.vec3f64.create(),d.vec3f64.create(),d.vec3f64.create()];this._tempU=d.vec3f64.create();
this._tempV=d.vec3f64.create();this._tempVec3=d.vec3f64.create();this._tempSphere={center:d.vec3f64.create(),radius:0}}p.prototype.update=function(a,b,c,d,e,f,g,l){b.clear();this._resize(a.length);b=B.canProject(c.spatialReference,B.SphericalECEFSpatialReference)&&B.canProjectToWGS84ComparableLonLat(c.spatialReference);for(var k=this.positionsGeographic,n=this.positionsWorldCoords,p=this.positionsRenderCoords,q=this.positionsSpherical,r=0;r<a.length;++r){var t=a.vertex(r);B.pointToVector(t,n[r],g);
B.pointToVector(t,p[r],f);b&&(B.pointToWGS84ComparableLonLat(t,k[r]),B.pointToVector(t,q[r],B.SphericalECEFSpatialReference),h.vec3.normalize(q[r],q[r]))}a=this._updatePathLengths(e);this.pathLength=0<this._length?new m(d.normalizeDistance(a),"meters"):null;b?(a=this._updateGeodesicPathLengths(e),this.geodesicPathLength=0<this._length?new m(a,"meters"):null):this.geodesicPathLength=null;e?(this._updateArea(c,d,f,g,l),b&&this._updateGeodesicArea(c,f)):(this.geodesicTriangleIndices=this.triangleIndices=
this.perimeterLength=this.geodesicArea=this.area=null,this.intersectingSegments.clear(),this.geodesicIntersectingSegments.clear())};p.prototype._resize=function(a){a<this._length&&(this.positionsWorldCoords.length=a,this.positionsRenderCoords.length=a,this.positionsProjectedWorldCoords.length=a,this.positionsFittedRenderCoords.length=a,this.positionsGeographic.length=a,this.positionsSpherical.length=a,this.positionsStereographic.length=a,this.pathSegmentLengths.length=a,this.geodesicPathSegmentLengths.length=
a,this._length=this.perimeterSegmentLengths.length=a);for(;this._length<a;)this.positionsWorldCoords.push(d.vec3f64.create()),this.positionsRenderCoords.push(d.vec3f64.create()),this.positionsProjectedWorldCoords.push(g.vec2f64.create()),this.positionsFittedRenderCoords.push(d.vec3f64.create()),this.positionsGeographic.push(d.vec3f64.create()),this.positionsSpherical.push(d.vec3f64.create()),this.positionsStereographic.push(g.vec2f64.create()),this.pathSegmentLengths.push(0),this.geodesicPathSegmentLengths.push(0),
this.perimeterSegmentLengths.push(0),++this._length};p.prototype._updatePathLengths=function(a){for(var b=this.positionsWorldCoords,c=this.pathSegmentLengths,d=0,e=0;e<this._length;++e){var f=c[e]=h.vec3.distance(b[e],b[(e+1)%this._length]);if(e<this._length-1||a)d+=f}return d};p.prototype._updateGeodesicPathLengths=function(a){for(var c=this.positionsGeographic,d=this.geodesicPathSegmentLengths,e=0,f=0;f<this._length;++f){var g=d[f]=b.segmentLengthGeodesicVector(c[f],c[(f+1)%this._length]);if(f<
this._length-1||a)e+=g}return e};p.prototype._updateArea=function(a,c,d,e,f){var g=a.renderCoordsHelper;a=this.positionsWorldCoords;var k=this.positionsRenderCoords,p=this.positionsProjectedWorldCoords,q=this.positionsFittedRenderCoords,r=this._planeWorldCoords,t=this._centroidRenderCoords;n.midpoint(k,t);g.worldUpAtPosition(t,this._worldUp);g.worldBasisAtPosition(t,0,this._worldTangent);B.transformDirection(t,this._worldUp,d,this._worldUp,e);B.transformDirection(t,this._worldTangent,d,this._worldTangent,
e);b.bestFitPlane(a,r);this.fittingMode=this._selectFittingMode(r,a,this._worldUp,f);var v=0;if("horizontal"===this.fittingMode){var w=-Infinity;k.forEach(function(a,b){a=g.getAltitude(k[b]);a>w&&(w=a,v=b)})}f=a[v];var t=r,z=this._worldTangent;"horizontal"===this.fittingMode?t=this._worldUp:"vertical"===this.fittingMode&&(t=this._tempVec3,z=this._worldUp,x.makeOrthonormal(r,this._worldUp,t));h.vec3.copy(this._frame[2],t);x.makeOrthonormal(z,t,this._frame[0]);h.vec3.cross(this._frame[1],this._frame[0],
this._frame[2]);h.vec3.negate(this._frame[1],this._frame[1]);for(var r=this._tempVec3,t=this._tempU,z=this._tempV,u=0;u<this._length;++u){var y=p[u],C=q[u];h.vec3.subtract(r,a[u],f);l.vec2.set(y,h.vec3.dot(this._frame[0],r),h.vec3.dot(this._frame[1],r));h.vec3.scale(t,this._frame[0],y[0]);h.vec3.scale(z,this._frame[1],y[1]);h.vec3.add(r,t,z);h.vec3.add(r,r,f);B.vectorToVector(r,e,C,d)}this.perimeterLength=0<this._length?new m(c.normalizeDistance(this._updatePerimeterLengths()),"meters"):null;n.midpoint(q,
this.areaCentroidRenderCoords);B.vectorToVector(this.areaCentroidRenderCoords,d,this.areaCentroidWorldCoords,e);this._updateIntersectingSegments();this.area=0===this.intersectingSegments.size?new m(c.normalizeArea(this._computeArea()),"square-meters"):null};p.prototype._updateGeodesicArea=function(a,c){a=a.renderCoordsHelper;c=this.positionsSpherical;var d=this.positionsStereographic,e=this._tempVec3,f=b.fitHemisphere(c,e);if(f){var g=this._tempU,k=this._tempV;x.tangentFrame(e,g,k);for(var n=0;n<
this._length;++n){var p=h.vec3.dot(c[n],g),q=h.vec3.dot(c[n],k),t=h.vec3.dot(c[n],e);l.vec2.set(d[n],p/t,q/t)}h.vec3.scale(e,e,u.earthRadius);a.toRenderCoords(e,B.SphericalECEFSpatialReference,this.geodesicAreaCentroidRenderCoords);this._updateGeodesicIntersectingSegments();this.geodesicArea=f&&0===this.geodesicIntersectingSegments.size?new m(this._computeGeodesicArea(),"square-meters"):null}else this.geodesicArea=null};p.prototype._updatePerimeterLengths=function(){for(var a=this.positionsProjectedWorldCoords,
b=this.perimeterSegmentLengths,c=0,d=0;d<this._length;++d)var e=b[d]=l.vec2.distance(a[d],a[(d+1)%this._length]),c=c+e;return c};p.prototype._updateIntersectingSegments=function(){var a=this.positionsProjectedWorldCoords,b=this.intersectingSegments;b.clear();for(var d=0;d<this._length;++d)for(var e=d+2;e<this._length;++e)(e+1)%this._length!==d&&c.segmentIntersects(a[d],a[(d+1)%this._length],a[e],a[(e+1)%this._length])&&(b.add(d),b.add(e))};p.prototype._computeArea=function(){for(var c=this.positionsProjectedWorldCoords,
d=v(c,2,2),d=this.triangleIndices=new Uint32Array(a(d,[],2)),e=0,f=0;f<d.length;f+=3)e+=b.triangleAreaEuclidean(c[d[f]],c[d[f+1]],c[d[f+2]]);return e};p.prototype._updateGeodesicIntersectingSegments=function(){var a=this.positionsStereographic,b=this.geodesicIntersectingSegments;b.clear();for(var d=0;d<this._length;++d)for(var e=d+2;e<this._length;++e)(e+1)%this._length!==d&&c.segmentIntersects(a[d],a[(d+1)%this._length],a[e],a[(e+1)%this._length])&&(b.add(d),b.add(e))};p.prototype._computeGeodesicArea=
function(){for(var c=this.positionsGeographic,d=v(this.positionsStereographic,2,2),d=this.geodesicTriangleIndices=new Uint32Array(a(d,[],2)),f=0,g=0;g<d.length;g+=3)f+=b.triangleAreaGeodesic(c[d[g]],c[d[g+1]],c[d[g+2]],e.WGS84);return f};p.prototype._selectFittingMode=function(a,c,d,e){var g=c.map(function(c){return Math.abs(b.planePointDistance(a,c))}).reduce(function(a,b){return Math.max(a,b)},0);b.boundingSphere(c,this._tempSphere);c=g/(2*this._tempSphere.radius);var g=c<e.maxRelativeErrorAlmostCoplanar,
k="horizontal";c<e.maxRelativeErrorCoplanar?k="oblique":g&&(k=Math.abs(h.vec3.dot(d,a))>Math.cos(f.deg2rad(e.verticalAngleThreshold))?"horizontal":"vertical");return k};return p}()})},"esri/views/3d/interactive/measurementTools/support/measurementUtils":function(){define("require exports ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../geometry/geometryEngine ../../../../../geometry/Polygon ../../../../../geometry/SpatialReference ../../../../../geometry/support/geodesicUtils ../../../support/mathUtils ../../../support/projectionUtils".split(" "),
function(y,p,m,a,l,g,h,d,q,e){var c;(function(a){a.boundingSphere=function(a,b){var c=b.center;m.vec3.set(c,0,0,0);for(var d=0;d<a.length;++d)m.vec3.add(c,c,a[d]);m.vec3.scale(c,c,1/a.length);for(var e=0,d=0;d<a.length;++d)e=Math.max(e,m.vec3.squaredDistance(c,a[d]));b.radius=Math.sqrt(e)};a.bestFitPlane=function(a,b){if(3>a.length)throw Error("need at least 3 points to fit a plane");q.planeFromPoints(a[0],a[1],a[2],b)};a.planePointDistance=function(a,b){return m.vec3.dot(a,b)+a[3]};a.segmentLengthEuclidean=
function(a,c,d){return e.pointToVector(a,b,d)&&e.pointToVector(c,n,d)?m.vec3.distance(b,n):0};a.segmentLengthGeodesic=function(a,c){if(!e.pointToWGS84ComparableLonLat(a,b)||!e.pointToWGS84ComparableLonLat(c,n))return 0;a={distance:null};d.inverseGeodeticSolver(a,[b[0],b[1]],[n[0],n[1]]);return a.distance};a.segmentLengthGeodesicVector=function(a,b){var c={distance:null};d.inverseGeodeticSolver(c,[a[0],a[1]],[b[0],b[1]]);return c.distance};a.triangleAreaEuclidean=function(a,b,c){return.5*Math.abs((b[0]-
a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0]))};a.triangleAreaGeodesic=function(a,c,d,g){var h=f;if(!e.vectorToWGS84ComparableLonLat(a,g,b)||!e.vectorToWGS84ComparableLonLat(c,g,n)||!e.vectorToWGS84ComparableLonLat(d,g,u))return 0;h.setPoint(0,0,b);h.setPoint(0,1,n);h.setPoint(0,2,u);return Math.abs(l.geodesicArea(h,"square-meters"))};a.tangentFrame=function(a,b,c){Math.abs(a[0])>Math.abs(a[1])?m.vec3.set(b,0,1,0):m.vec3.set(b,1,0,0);m.vec3.cross(c,a,b);m.vec3.normalize(b,b);m.vec3.cross(b,c,a);m.vec3.normalize(c,
c)};a.fitHemisphere=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=!0);var d=function(a,b){if(0===b[0]&&0===b[1]&&0===b[2])return!1;for(var c=0;c<a.length;++c)if(-1E-6>m.vec3.dot(b,a[c]))return!1;return!0};if(0===a.length)return!1;if(1===a.length)return b&&m.vec3.copy(b,a[0]),!0;m.vec3.set(x,0,0,0);for(var e=0;e<a.length;++e)m.vec3.add(x,x,a[e]);m.vec3.normalize(x,x);if(d(a,x))return b&&m.vec3.copy(b,x),!0;if(!c)return!1;for(e=0;e<a.length;++e)for(c=0;c<a.length;++c)if(e!==c&&(m.vec3.cross(x,
a[e],a[c]),m.vec3.normalize(x,x),d(a,x)))return b&&m.vec3.copy(b,x),!0;return!1};a.compareSets=function(a,b){if(a===b)return!0;if(a.size!==b.size)return!1;for(var c=0;c<a.size;++c)if(!b.has(a[c]))return!1;return!0}})(c||(c={}));var b=a.vec3f64.create(),n=a.vec3f64.create(),u=a.vec3f64.create(),f=new g({rings:[[b,n,u]],spatialReference:h.WGS84}),x=a.vec3f64.create();return c})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/PathChanges":function(){define(["require","exports","../support/setUtils"],
function(y,p,m){return function(){function a(){this.change="none";this.updatedVertices=new Set}a.prototype.fullChange=function(){this.change="full"};a.prototype.incrementalChange=function(a){"none"===this.change&&(this.change="incremental");this.updatedVertices.add(a)};a.prototype.clear=function(){this.change="none";this.updatedVertices.clear()};a.prototype.assign=function(a){this.change=a.change;this.updatedVertices=m.clone(a.updatedVertices)};a.prototype.merge=function(a){var g=this;switch(this.change){case "none":this.assign(a);
break;case "incremental":"incremental"===a.change?a.updatedVertices.forEach(function(a){g.updatedVertices.add(a)}):"full"===a.change&&(this.change="full")}};return a}()})},"esri/views/3d/interactive/measurementTools/support/setUtils":function(){define(["require","exports"],function(y,p){Object.defineProperty(p,"__esModule",{value:!0});p.clone=function(m){var a=new Set;m.forEach(function(l){a.add(l)});return a}})},"esri/views/3d/interactive/measurementTools/support/Path":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/Collection ../../../../../core/Evented ../../../../../core/accessorSupport/decorators".split(" "),
function(y,p,m,a,l,g,h,d){return function(h){function e(){var a=null!==h&&h.apply(this,arguments)||this;a.vertices=new g;return a}m(e,h);Object.defineProperty(e.prototype,"front",{get:function(){return this.vertices.items[0]||null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"back",{get:function(){return this.vertices.items[this.vertices.length-1]||null},enumerable:!0,configurable:!0});e.prototype.clear=function(){this.vertices.removeAll();this.emit("cleared",{});this._notifyFrontBack()};
e.prototype.vertex=function(a){return this.vertices.items[a]};e.prototype.add=function(a){this.vertices.add(a);a=this.vertices.length-1;this._notifyFrontBack();this.emit("vertex-added",{index:a});return a};e.prototype.insert=function(a,b){this.vertices.splice(a,0,b);this._notifyFrontBack();this.emit("vertex-inserted",{index:a});return a};e.prototype.remove=function(a){this.vertices.removeAt(a);this._notifyFrontBack();this.emit("vertex-removed",{index:a})};e.prototype.update=function(a,b){null!=b&&
(this.vertices.splice(a,1,b),this._notifyFrontBack());this.emit("vertex-updated",{index:a})};e.prototype._notifyFrontBack=function(){this.notifyChange("front");this.notifyChange("back")};a([d.property({readOnly:!0})],e.prototype,"vertices",void 0);a([d.property({aliasOf:"vertices.length"})],e.prototype,"length",void 0);a([d.property({readOnly:!0})],e.prototype,"front",null);a([d.property({readOnly:!0})],e.prototype,"back",null);return e=a([d.subclass("esri.views.3d.interactive.measurementTools.support.Path")],
e)}(d.declared(l,h))})},"widgets/Measurement3D/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Measurement3D/Widget.html":'\x3cdiv\x3e\r\n\t\x3cheader class\x3d"${baseClass}__header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/header\x3e\r\n\t\x3cdiv class\x3d"hidden" data-dojo-attach-point\x3d"measurementNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"${baseClass}__hint" data-dojo-attach-point\x3d"hintNode"\x3e${nls.hint}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Measurement3D/css/style.css":".esri-area-measurement-3d__container,.esri-direct-line-measurement-3d__container {padding: 0;}.esri-direct-line-measurement-3d {pointer-events: auto;}.jimu-widget-measurement .hidden {display: none !important;}.jimu-widget-measurement .esri-button {height: 32px; cursor: pointer; font-family: inherit; font-size: 14px;}.jimu-widget-measurement .measurement-button-wrapper {padding: 12px 15px;}.jimu-button-group {display: flex; flex-direction: row;}.jimu-button-group \x3e button {font-family: inherit; background: #fff; border: 1px solid #ccc; padding: 5px 10px; line-height: 20px; font-size: 1em; flex-basis: 0; flex-grow: 1; transition: background-color 125ms ease-in-out; position: relative; z-index: 1;}.jimu-button-group \x3e button:hover {background: #f0f0f0;}.jimu-button-group \x3e button.jimu-state-active {background: #24b5cc; border-color: #24b5cc; color: #fff; z-index: 2;}.jimu-button-group \x3e button.jimu-state-active:before {content: none;}.jimu-button-group \x3e button:not(:disabled) {cursor: pointer;}.jimu-button-group \x3e button + button {margin-left: -1px; border-left-width: 0;}.jimu-button-group \x3e button + button::before {content: ''; display: block; position: absolute; left: -1px; top: 4px; bottom: 4px; border-left: 1px solid #ccc;}.jimu-rtl .jimu-button-group \x3e button + button {margin-left: auto; margin-right: -1px; border-left-width: 1px; border-right-width: 0;}.jimu-rtl .jimu-button-group \x3e button + button::before {right: -1px; left: auto;}.jimu-button-group \x3e button img {vertical-align: middle; margin-right: 8px; pointer-events: none;}.jimu-rtl .jimu-button-group \x3e button img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__header {font-size: 14px; text-align: center; border-bottom: 1px solid #e7e7e7; margin-bottom: 12px;}.jimu-widget-measurement__header img {vertical-align: middle; margin-right: 8px;}.jimu-rtl .jimu-widget-measurement__header img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__hint {color: #323232; font-size: 14px;}.jimu-widget-frame.jimu-container .jimu-widget-measurement__header {margin: -14px -14px 14px; padding: 14px 14px 14px;}",
"*now":function(y){y(['dojo/i18n!*preload*widgets/Measurement3D/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/on jimu/BaseWidget ./ButtonGroup jimu/dijit/ViewStack esri/widgets/DirectLineMeasurement3D esri/widgets/AreaMeasurement3D esri/core/watchUtils".split(" "),function(y,p,m,a,l,g,h,d,q){return y([a],{baseClass:"jimu-widget-measurement",name:"Measurement",MEASURE_TYPES:{DISTANCE:"distance",AREA:"area",LOCATION:"location"},measureWidgets:{},selectedMeasureType:null,buttonGroup:null,CSS:{clearButton:"esri-direct-line-measurement-3d__clear-button"},postCreate:function(){this.inherited(arguments);
this.measureWidgets={};this.selectedMeasureType=null},startup:function(){this.inherited(arguments);this.initUI()},destroy:function(){if(this.measureWidgets)for(var a in this.measureWidgets)if(this.measureWidgets.hasOwnProperty(a)){var c=this.measureWidgets[a];c.destroy&&c.destroy()}this.buttonGroup&&this.buttonGroup.destroy&&(this.buttonGroup.destroy(),this.buttonGroup=null);this.selectedMeasureType=null;this.inherited(arguments)},onOpen:function(){this.activateWidget(this.selectedMeasureType)},onClose:function(){this.deactivateWidget(this.selectedMeasureType)},
onActive:function(){this.onOpen()},onDeActive:function(){this.onClose()},_applyConfig:function(a){if(this.config&&a){var c=this.config,b,d;switch(a.measureType){case this.MEASURE_TYPES.DISTANCE:b="lengthUnit";d="defaultLengthUnit";break;case this.MEASURE_TYPES.AREA:b="areaUnit",d="defaultAreaUnit"}c.measurement&&c.measurement[b]?a.unit=c.measurement[b]:c[d]&&(a.unit=c[d])}},_createWidget:function(a){a=this._ensureWidget(a);this._applyConfig(a);return a},_ensureWidget:function(a){var c=this.getWidget(a);
c||(c=document.createElement("div"),a===this.MEASURE_TYPES.DISTANCE?this.measureWidgets[a]=new h({container:c,view:this.sceneView,measureType:a,visible:!1}):a===this.MEASURE_TYPES.AREA&&(this.measureWidgets[a]=new d({container:c,view:this.sceneView,measureType:a})),c=this.measureWidgets[a]);return c},_initWidget:function(a){var c=this.getWidget(a);c||(c=this._createWidget(a),this._addtoViewStack(c));c.visible=!0;this.viewStack.switchView(a)},_addtoViewStack:function(a){if(a){var c=document.createElement("div");
c.label=a.measureType;c.appendChild(a.domNode);this.viewStack.addView(c)}},_initMeasurements:function(a){if(a){var c=[];a instanceof Array&&a.forEach(p.hitch(this,function(a){var b=document.createElement("img");b.title=a.value;b.src=this._getMeasurementIconSource(a.value);c.push({value:a.value,label:a.label,icon:b,content:a.label})}));a=this.buttonGroup=new l({buttons:c,selected:null});a.placeAt(this.headerNode);this.own(m(a,"Change",p.hitch(this,function(a){this._toggleWidgetSection(!!a);this._handleMeasureChanged()})))}},
_handleMeasureChanged:function(){var a=this.buttonGroup.getActiveButtonValue(),c=this.getWidget(this.selectedMeasureType);c&&(c.visible=!1);null!==a&&this._initWidget(a);this.selectedMeasureType=a},_toggleWidgetSection:function(a){a?(this.measurementNode.classList.remove("hidden"),this.hintNode.classList.add("hidden")):(this.measurementNode.classList.add("hidden"),this.hintNode.classList.remove("hidden"))},_getMeasurementIconSource:function(a){var c;switch(a){case this.MEASURE_TYPES.DISTANCE:c=this.folderUrl+
"images/Measure_Distance16.png";break;case this.MEASURE_TYPES.AREA:c=this.folderUrl+"images/Measure_Area16.png"}return c},initUI:function(){var a=this.config,c=[];this.viewStack=new g(null,this.measurementNode);a&&(a.showArea&&c.push({label:this.nls.area,value:this.MEASURE_TYPES.AREA}),a.showDistance&&c.push({label:this.nls.distance,value:this.MEASURE_TYPES.DISTANCE}));0!==c.length&&this._initMeasurements(c)},activateWidget:function(a){},deactivateWidget:function(a){var c=this.getWidget(a);a=this.buttonGroup&&
this.buttonGroup.getActiveButton();c&&("measured"!==c.viewModel.tool.model.state?a&&a.click():(c.viewModel.tool._controller.deactivate(),c.viewModel.tool._view._sceneView.cursor=null,q.once(c.viewModel.tool.model,"state",function(a){"initial"===a&&c.viewModel.tool.activate()})))},getWidget:function(a){return a&&this.measureWidgets[a]}})});