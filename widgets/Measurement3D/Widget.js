// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Measurement3D/ButtonGroup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/query dojo/dom-class dojo/on dijit/_WidgetBase".split(" "),function(u,p,n,a,l,c,q){return u([q],{baseClass:"jimu-button-group",CSS:{ACTIVE:"jimu-state-active"},buttons:[],activeButton:null,postCreate:function(){this.inherited(arguments);this._initUI()},buttonClicked:function(c){this.activeButton===c?(l.remove(c,this.CSS.ACTIVE),this.activeButton=null):(a("button",this.domNode).removeClass(this.CSS.ACTIVE),
l.add(c,this.CSS.ACTIVE),this.activeButton=c);this.onChange(this.activeButton)},getActiveButton:function(){return this.activeButton},getActiveButtonValue:function(){var a=this.getActiveButton();return a&&a.getAttribute("data-value")},_initUI:function(){n.forEach(this.buttons,function(a){this._createButton(a)},this)},_createButton:function(a){var e=document.createElement("button");e.type="button";e.title=a.label;e.setAttribute("data-value",a.value);a.icon&&e.appendChild(a.icon);e.appendChild(document.createTextNode(a.content||
a.value));this.domNode.appendChild(e);this.own(c(e,"click",p.hitch(this,function(a){this.buttonClicked(a.target)})))},onChange:function(){}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(u,p,n,a,l){return u(l,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);a.forEach(this.views,p.hitch(this,
function(a){1===a.nodeType?(n.place(a,this.domNode),n.addClass(a,"view"),n.setStyle(a,"display","none")):a.domNode&&(n.place(a.domNode,this.domNode),n.addClass(a.domNode,"view"),n.setStyle(a.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var a="",q=this.getSelectedView();q&&(a=q.label);return a},getViewByLabel:function(a){for(var c=0;c<this.views.length;c++)if(a===
this.views[c].label)return this.views[c];return null},addView:function(a){this.views.push(a);1===a.nodeType?(n.place(a,this.domNode),n.addClass(a,"view")):a.domNode&&(n.place(a.domNode,this.domNode),n.addClass(a.domNode,"view"))},removeView:function(c){var q=this.views.length;this.views=a.filter(this.views,function(a){return c!==a});q!==this.views.length&&(1===c.nodeType?n.destroy(c):c.domNode&&c.destroyRecursive())},switchView:function(a){var c,h;c="number"===typeof a?this.views[a]:"string"===typeof a?
this.getViewByLabel(a):a;this.views.forEach(p.hitch(this,function(a){a&&(1===a.nodeType?h=a:a.domNode&&(h=a.domNode),a===c?(n.setStyle(h,"display","block"),a.domNode&&!a._started&&(a.startup(),a._started=!0)):n.setStyle(h,"display","none"))}));this._currentView=c;this.onViewSwitch(c)},onViewSwitch:function(){}})})},"esri/widgets/DirectLineMeasurement3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./DirectLineMeasurement3D/nls/DirectLineMeasurement3D ../core/accessorSupport/decorators ./Widget ./DirectLineMeasurement3D/DirectLineMeasurement3DViewModel ./support/widget".split(" "),
function(u,p,n,a,l,c,q,h,e){return function(g){function b(a){a=g.call(this)||this;a.view=null;a.visible=null;a.iconClass="esri-icon-measure-line";a.viewModel=new h;a.unitOptions=null;a.unit=null;return a}n(b,g);b.prototype.render=function(){var a=this,b=this.viewModel.isSupported,c=this.viewModel.active,f="disabled"===this.viewModel.state,g="ready"===this.viewModel.state,h="measuring"===this.viewModel.state||"measured"===this.viewModel.state,q=this.viewModel.measurement,g=c&&g?e.tsx("section",{key:"esri-direct-line-measurement-3d__hint",
class:"esri-direct-line-measurement-3d__hint"},e.tsx("p",{class:"esri-direct-line-measurement-3d__hint-text"},l.hint)):null,n=b?null:e.tsx("section",{key:"esri-direct-line-measurement-3d__unsupported",class:"esri-direct-line-measurement-3d__panel--error"},e.tsx("p",null,l.unsupported)),m=function(m,b,d){switch(b.state){case "available":return e.tsx("div",{key:d+"-enabled",class:"esri-direct-line-measurement-3d__measurement-item"},e.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},
m),e.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-value"},b.text));case "unavailable":return e.tsx("div",{key:d+"-disabled",class:a.classes("esri-direct-line-measurement-3d__measurement-item","esri-direct-line-measurement-3d__measurement-item--disabled")},e.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},m))}},q=h?e.tsx("section",{key:"esri-direct-line-measurement-3d__measurement",class:"esri-direct-line-measurement-3d__measurement"},m(l.direct,
q.directDistance,"direct"),m(l.horizontal,q.horizontalDistance,"horizontal"),m(l.vertical,q.verticalDistance,"vertical")):null,C=this.id+"__units",m=e.tsx("label",{class:"esri-direct-line-measurement-3d__units-label",for:C},l.unit),C=e.tsx("div",{class:"esri-direct-line-measurement-3d__units-select-wrapper"},e.tsx("select",{class:"esri-direct-line-measurement-3d__units-select esri-select",id:C,onchange:this._changeUnit,bind:this},this.viewModel.unitOptions.map(function(m){return m===a.viewModel.unit?
e.tsx("option",{key:m,value:m,selected:!0},l.units[m]):e.tsx("option",{key:m,value:m},l.units[m])}))),m=e.tsx("section",{key:"esri-direct-line-measurement-3d__units",class:"esri-direct-line-measurement-3d__units"},m,C),m=h?e.tsx("div",{key:"settings",class:"esri-direct-line-measurement-3d__settings"},m):null,b=!b||c&&!h?null:e.tsx("div",{class:"esri-direct-line-measurement-3d__actions"},e.tsx("button",{disabled:f,class:this.classes("esri-button esri-button--secondary","esri-direct-line-measurement-3d__clear-button",
f&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement},l.newMeasurement)),b=this.visible?e.tsx("div",{class:"esri-direct-line-measurement-3d__container"},n,g,m,q,b):null;return e.tsx("div",{key:"",class:"esri-direct-line-measurement-3d esri-widget esri-widget--panel",role:"presentation"},b)};b.prototype._newMeasurement=function(){this.viewModel.newMeasurement()};b.prototype._changeUnit=function(a){a=a.target;if(a=a.options[a.selectedIndex])this.unit=a.value};a([c.aliasOf("viewModel.view")],
b.prototype,"view",void 0);a([c.aliasOf("viewModel.visible"),e.renderable()],b.prototype,"visible",void 0);a([c.aliasOf("viewModel.active"),e.renderable()],b.prototype,"active",void 0);a([c.property()],b.prototype,"iconClass",void 0);a([c.property({type:h}),e.renderable(["viewModel.state","viewModel.unitOptions","viewModel.unit","viewModel.measurement"])],b.prototype,"viewModel",void 0);a([c.aliasOf("viewModel.unitOptions")],b.prototype,"unitOptions",void 0);a([c.aliasOf("viewModel.unit")],b.prototype,
"unit",void 0);a([e.accessibleHandler()],b.prototype,"_newMeasurement",null);a([e.accessibleHandler()],b.prototype,"_changeUnit",null);return b=a([c.subclass("esri.widgets.DirectLineMeasurement3D")],b)}(c.declared(q))})},"esri/widgets/DirectLineMeasurement3D/DirectLineMeasurement3DViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/Logger ../../core/unitUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool ../support/commonProperties ../support/InteractiveToolViewModel".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d){var k=c.getLogger("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel");return function(d){function f(a){a=d.call(this,a)||this;a.supportedViewType="3d";a._handles=new l;a._userUnitOptions=null;a._userUnit=null;return a}n(f,d);f.prototype.initialize=function(){var a=this;this._handles.add([h.init(this,"unit",function(b){a.tool&&(a.tool.unit=b)})])};f.prototype.destroy=function(){this._handles.destroy();this._handles=null};Object.defineProperty(f.prototype,
"state",{get:function(){return this.isDisabled?"disabled":this.tool.state},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"measurement",{get:function(){if(!this.tool)return null;var a=this.tool.model,b=a.measurementMode,d="geodesic"===b,a=a.validMeasurement;return{mode:b,directDistance:{text:d?null:this.tool.triangleView.directLabel,state:a&&!d?"available":"unavailable"},horizontalDistance:{text:this.tool.triangleView.horizontalLabel,state:a?"available":"unavailable"},verticalDistance:{text:this.tool.triangleView.verticalLabel,
state:a?"available":"unavailable"}}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"unitOptions",{get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(a){this._userUnitOptions=a;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"unit",{get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},
set:function(a){this._userUnit=a?this._findSelectableUnit(a,this._userUnit):null;this.notifyChange("unit")},enumerable:!0,configurable:!0});f.prototype.newMeasurement=function(){this.tool&&this.tool.newMeasurement()};f.prototype.clearMeasurement=function(){this.tool&&this.tool.clearMeasurement()};f.prototype.createToolParams=function(){return{toolConstructor:g,constructorArguments:{unit:this.unit}}};f.prototype.logUnsupportedError=function(){k.error("DirectLineMeasurement3D widget is not implemented for MapView")};
f.prototype.logError=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];k.error.apply(k,a)};f.prototype._findSelectableUnit=function(a,b){var d=this.unitOptions;return-1!==d.indexOf(a)?a:b?this._findSelectableUnit(b):d[0]};f.prototype._filteredOrAllUnits=function(a){if(!a)return q.measurementLengthUnits.slice();a=a.filter(function(a){return-1!==q.measurementLengthUnits.indexOf(a)});return 0===a.length?q.measurementLengthUnits.slice():a};a([e.property({dependsOn:["view.ready","isDisabled",
"tool.state"],readOnly:!0})],f.prototype,"state",null);a([e.property({dependsOn:"view.ready tool.triangleView tool.model.directDistance tool.model.horizontalDistance tool.model.verticalDistance tool.model.geodesicDistance tool.model.measurementMode".split(" "),readOnly:!0})],f.prototype,"measurement",null);a([e.property()],f.prototype,"tool",void 0);a([e.property(b.defaultUnitPropertyMetadata)],f.prototype,"defaultUnit",void 0);a([e.property({dependsOn:["view.spatialReference"]})],f.prototype,"unitOptions",
null);a([e.property({dependsOn:["unitOptions","defaultUnit"]})],f.prototype,"unit",null);return f=a([e.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],f)}(e.declared(d))})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/restHelper ../../../../../core/Handles ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./DirectLineMeasurement3DController ./DirectLineMeasurement3DModel ./DirectLineMeasurement3DView ../../../../interactive/InteractiveToolBase ../../../../interactive/interactiveToolUtils".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k){return function(d){function f(a){var b=d.call(this,a)||this;b.startManipulator=null;b.endManipulator=null;b.model=new g({sceneView:a.view});return b}n(f,d);f.prototype.normalizeCtorArgs=function(a){return l(a,["view"])};f.prototype.initialize=function(){var a=this;this._view=new b(this.model);this._controller=new e(this.model,this._view);this._handles=new c;this._handles.add([q.init(this,"state",function(){"measured"===a.state&&k.setActive(a,!1)},!0)]);var d=this._view.createManipulators();
this._controller.setup(d);this.manipulators.add(d.start);this.manipulators.add(d.end);this.startManipulator=d.start;this.endManipulator=d.end};f.prototype.destroy=function(){this._view.destroy();this._view=null;this._controller.destroy();this._controller=null;this._handles.destroy();this._handles=null};Object.defineProperty(f.prototype,"state",{get:function(){return this.model.isMeasuring?"measured"===this.model.state?"measured":"measuring":"ready"},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"isSupported",{get:function(){return"3d"===this.get("view.type")},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"cursor",{get:function(){return!this.model.active||"drawing"!==this.model.state&&"initial"!==this.model.state?null:"crosshair"},enumerable:!0,configurable:!0});f.prototype.newMeasurement=function(){this.model.reset();k.setActive(this,!0)};f.prototype.clearMeasurement=function(){this.model.reset();k.setActive(this,!1)};f.prototype.activate=function(){this.model.active=
!0};f.prototype.deactivate=function(){this.model.active=!1;"measured"!==this.model.state&&this.model.reset()};f.prototype.onDetach=function(){this.model.reset()};f.prototype.onShow=function(){this._view.show();this._updateManipulatorVisibility()};f.prototype.onHide=function(){this._view.hide()};f.prototype.onInputEvent=function(a){this._controller.handleInputEvent(a,{start:this.startManipulator,end:this.endManipulator});this._updateManipulatorVisibility()};f.prototype._updateManipulatorVisibility=
function(){this.startManipulator.visible=null!=this.model.startPoint;this.endManipulator.visible=null!=this.model.endPoint};a([h.property({dependsOn:["model.isMeasuring","model.state"],readOnly:!0})],f.prototype,"state",null);a([h.property({dependsOn:["view.type"],readOnly:!0})],f.prototype,"isSupported",null);a([h.property({dependsOn:["model.active","model.state"],readOnly:!0})],f.prototype,"cursor",null);a([h.property({constructOnly:!0})],f.prototype,"model",void 0);a([h.aliasOf("model.sceneView")],
f.prototype,"view",void 0);a([h.aliasOf("model.mode")],f.prototype,"mode",void 0);a([h.aliasOf("model.unit")],f.prototype,"unit",void 0);a([h.aliasOf("model.directDistance")],f.prototype,"directDistance",void 0);a([h.aliasOf("model.validMeasurement")],f.prototype,"validMeasurement",void 0);a([h.aliasOf("model.horizontalDistance")],f.prototype,"horizontalDistance",void 0);a([h.aliasOf("model.verticalDistance")],f.prototype,"verticalDistance",void 0);a([h.aliasOf("model.geodesicDistance")],f.prototype,
"geodesicDistance",void 0);a([h.aliasOf("model.geodesicAngle")],f.prototype,"geodesicAngle",void 0);a([h.aliasOf("model.triangleView")],f.prototype,"triangleView",void 0);return f=a([h.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],f)}(h.declared(d.InteractiveToolBase))})},"esri/core/tsSupport/restHelper":function(){define([],function(){return function(u,p){var n={},a;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&0>p.indexOf(a)&&
(n[a]=u[a]);if(null!=u&&"function"===typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(u);l<a.length;l++)0>p.indexOf(a[l])&&(n[a[l]]=u[a[l]])}return n}})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../geometry ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../layers/graphics/dehydratedFeatures ./DirectLineMeasurement3DView".split(" "),
function(u,p,n,a,l,c,q,h,e,g){u=function(){function a(a,b){this._handles=new c;this._cachedPickRequest=new g.PickRequest;this._cachedPickResult=new g.PickResult;this._isAnyPointerDown=!1;this.model=a;this.view=b;this.model.reset()}a.prototype.destroy=function(){this._handles.destroy();this._handles=null};a.prototype.setup=function(a){var d=this,f=a.start,c=a.end;f.on("drag",function(){var a=f.mapPoint,c=f.surfaceType;q.isSome(a)&&q.isSome(c)&&(a=e.clonePoint(a,b),d.model.startPoint=a,d.model.startPointSurfaceLocation=
d._surfaceLocation(a,c))});c.on("drag",function(){var a=c.mapPoint,f=c.surfaceType;q.isSome(a)&&q.isSome(f)&&(a=e.clonePoint(a,b),d.model.endPoint=a,d.model.endPointSurfaceLocation=d._surfaceLocation(a,f))});[f,c].forEach(function(b){d._handles.add([b.watch("grabbing",function(){var b=a.start.grabbing||a.end.grabbing;b&&"measured"===d.model.state&&(d.model.state="editing");b||(d.model.finishedMeasurement({cameraAboveGround:d.view.cameraAboveGround}),"editing"===d.model.state&&(d.model.state="measured"))},
!0)])})};a.prototype.handleInputEvent=function(a,b){switch(a.type){case "immediate-click":this._handleImmediateClick(a,b);break;case "pointer-move":this._handlePointerMove(a,b);break;case "pointer-down":this._handlePointerDown(a);break;case "pointer-up":this._handlePointerUp(a);break;case "key-down":this._handleKeyDown(a)}};a.prototype._handlePointerMove=function(a,b){this._clearCachedPickRequest();var d=h.createScreenPointFromEvent(a);"mouse"===a.pointerType&&(this._hoverAt(d),"drawing"===this.model.state&&
(b.end.attemptDragTo({screenPoint:d}),a.stopPropagation()))};a.prototype._handlePointerDown=function(a){this._isAnyPointerDown=!0};a.prototype._handlePointerUp=function(a){this._isAnyPointerDown=!1};a.prototype._handleImmediateClick=function(a,b){this._clearCachedPickRequest();if("mouse"!==a.pointerType||0===a.button){var d=h.createScreenPointFromEvent(a),c=!1;if(this.model.active)switch(this.model.state){case "initial":b.start.attemptDragTo({screenPoint:d})&&(b.start.interactive=!1,b.end.interactive=
!1,this.model.state="drawing",c=!0);break;case "drawing":b.end.attemptDragTo({screenPoint:d})&&(b.start.interactive=!0,b.end.interactive=!0,this.model.finishedMeasurement({cameraAboveGround:this.view.cameraAboveGround}),c=!0)}c&&a.stopPropagation();"mouse"===a.pointerType&&this._hoverAt(d)}};a.prototype._handleKeyDown=function(a){"Escape"===a.key&&"drawing"===this.model.state&&(this.model.clearMeasurement(),a.stopPropagation())};a.prototype._hoverAt=function(a){var b=this._isAnyPointerDown&&"drawing"!==
this.model.state&&"editing"!==this.model.state;this.view.requiresCursorPoint&&!b?(a=this._pick(a),a.mapPoint&&(this.model.cursorPoint=a.mapPoint)):this.model.cursorPoint=null};a.prototype._pick=function(a){var b=this._cachedPickRequest.screenPoint;if(b&&b.x===a.x&&b.y===a.y)return this._cachedPickResult;this._cachedPickRequest.screenPoint=a;return this._cachedPickResult=this.view.pick(this._cachedPickRequest)};a.prototype._clearCachedPickRequest=function(){this._cachedPickRequest.screenPoint=null};
a.prototype._surfaceLocation=function(a,b){return"ground"===b?"on-the-surface":a.z>=this.view.getElevation(a)?"above-the-surface":"below-the-surface"};return a}();var b=new l.Point;return u})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DView":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/mathUtils ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ./LaserLineRenderer ../support/Label ../support/LabelSegment ../support/labelUtils ../support/PathSegmentInterpolator ../support/viewUtils ../../../support/projectionUtils ../../../support/stack ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryData ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/Layer ../../../webgl-engine/lib/Object3D ../../../webgl-engine/materials/ColorMaterial ../../../webgl-engine/materials/MeasurementArrowMaterial ../../../webgl-engine/materials/RibbonLineMaterial ../../../../interactive/manipulatorUtils".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k,w,f,x,z,y,B,m,C,r,t,A,D,E,G,L,H,K){u=[1,.5,0,.75];var M={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,triangleColor:u,triangleLineWidth:3,triangleCornerSize:32,triangleSubdivisions:128,arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,
arrowSubdivisions:128,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:u,guideLineWidth:2,guideLineColor:u,guideStippleLengthPixels:6,labelDistance:25};u=function(){function a(a,b){void 0===b&&(b={});this._visible=!1;this._laserLineRenderer=null;this._directDistanceLabel=new w;this._horizontalDistanceLabel=new w;this._verticalDistanceLabel=new w;this._handles=new l;this._listenerHandles=null;this._cursorPosition=d.vec3f64.create();this._startPosition=d.vec3f64.create();this._endPosition=
d.vec3f64.create();this._centerPosition=d.vec3f64.create();this._cornerPosition=d.vec3f64.create();this._arrowLabelSegment=new f;this._horizontalLabelSegment=new f;this._verticalLabelSegment=new f;this._geodesicProjectionLabelSegment=new f;this._origin=d.vec3f64.create();this._originTransform=e.mat4f64.create();this._lastDraggedHandle=null;this._model=a;this._sceneView=a.sceneView;this._params=y.copyParameter(M,b);this._layer=new D("point-to-point-measurement",{isPickable:!1});this._createMaterials();
this._createObjects();this._intersector=new A(this._sceneView.viewingMode)}a.prototype.destroy=function(){this.hide();this._handles.destroy();this._handles=null};Object.defineProperty(a.prototype,"requiresCursorPoint",{get:function(){return"initial"===this._model.state&&this._model.active},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"cameraAboveGround",{get:function(){return this._sceneView.state.camera.aboveGround},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"visible",{get:function(){return this._visible},set:function(a){a?this.show():this.hide()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"testData",{get:function(){return{labels:{direct:this._directDistanceLabel,horizontal:this._horizontalDistanceLabel,vertical:this._verticalDistanceLabel},laserLineRenderer:this._laserLineRenderer}},enumerable:!0,configurable:!0});a.prototype.createManipulators=function(){var a=this,b=function(){var b=K.createSphereManipulator(a._sceneView,a._params.handleColor,
a._params.handleOpacity);b.visible=!1;b.hideOnGrab=!0;b.radius=a._params.handleRadius;return b},m=b(),d=b();this._model.startPoint&&(m.mapPoint=this._model.startPoint,m.visible=!0);this._model.endPoint&&(d.mapPoint=this._model.endPoint,d.visible=!0);var f=function(){var b=a._lastDraggedHandle;m.grabbing&&!d.grabbing&&(b="start");d.grabbing&&!m.grabbing&&(b="end");m.grabbing||d.grabbing||(b=null);var f=b!==a._lastDraggedHandle;a._lastDraggedHandle=b;f&&a.visible&&a._updateLaserLine()};this._handles.add([m.watch("grabbing",
function(){f()}),d.watch("grabbing",function(){f()})]);return{start:m,end:d}};a.prototype.show=function(){if(!this._visible){this._visible=!0;var a=this._sceneView._stage;this._laserLineRenderer=new k(this._sceneView.renderCoordsHelper,{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,globalAlpha:this._params.laserLineGlobalAlpha});a.addRenderPlugin(this._laserLineRenderer.renderSlots,
this._laserLineRenderer);this._addToStage(a);this._directDistanceLabel.addToView(this._sceneView);this._horizontalDistanceLabel.addToView(this._sceneView);this._verticalDistanceLabel.addToView(this._sceneView);this._initializeListeners();this._updateCursorPosition();this._updateStartPosition();this._updateEndPosition();this._updateLaserLine();this._updateView()}};a.prototype.hide=function(){if(this._visible){this._visible=!1;var a=this._sceneView._stage;a.removeRenderPlugin(this._laserLineRenderer);
this._laserLineRenderer=null;this._removeFromStage(a);this._directDistanceLabel.removeFromView(this._sceneView);this._horizontalDistanceLabel.removeFromView(this._sceneView);this._verticalDistanceLabel.removeFromView(this._sceneView);this._destroyListeners();this._sceneView.cursor=null}};a.prototype.pick=function(b){var m=this._sceneView.spatialReference;b=q.screenPointObjectToArray(b.screenPoint);b=this._sceneView.sceneIntersectionHelper.intersectToolIntersectorScreen(b,this._intersector).results.min;
var f=d.vec3f64.create();if(!b.getIntersectionPoint(f))return new a.PickResult;m=this._sceneView.renderCoordsHelper.fromRenderCoords(f,m);return new a.PickResult("TerrainRenderer"===b.intersector?"ground":"feature",f,m)};a.prototype.getElevation=function(a){return this._sceneView.basemapTerrain.ready?this._sceneView.basemapTerrain.getElevation(a)||0:0};a.prototype.overlappingHandles=function(a,b){return y.pointToPointScreenDistance(a,b,this._sceneView)<=this._params.handleRadius};a.prototype._createMaterials=
function(){this._triangleLineMaterial=new H({width:this._params.triangleLineWidth,color:this._params.triangleColor,polygonOffset:!0},"triangle-line");this._triangleLineMaterial.renderOccluded=4;this._triangleCornerMaterial=new G({color:this._params.triangleColor,transparent:!0,writeDepth:!1,polygonOffset:!0},"triangle-corner");this._triangleCornerMaterial.renderOccluded=4;this._arrowMaterial=new L({outlineColor:this._params.arrowOutlineColor,stripeEvenColor:this._params.arrowStripeEvenColor,stripeOddColor:this._params.arrowStripeOddColor,
polygonOffset:!0},"arrow");this._arrowMaterial.renderOccluded=4;this._geodesicProjectionLineMaterial=new H({width:this._params.geodesicProjectionLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0},"geodesic-line");this._geodesicProjectionLineMaterial.renderOccluded=4;this._geodesicGuideLineMaterial=new H({width:this._params.guideLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0,stippleLength:0},"geodesic-guide");this._geodesicGuideLineMaterial.renderOccluded=
4};a.prototype._createObjects=function(){this._triangleLineObject=new E;this._layer.addObject(this._triangleLineObject);this._triangleCornerObject=new E;this._layer.addObject(this._triangleCornerObject);this._arrowObject=new E;this._layer.addObject(this._arrowObject);this._geodesicProjectionLineObject=new E;this._layer.addObject(this._geodesicProjectionLineObject);this._geodesicProjectionStartGuideObject=new E;this._layer.addObject(this._geodesicProjectionStartGuideObject);this._geodesicProjectionEndGuideObject=
new E;this._layer.addObject(this._geodesicProjectionEndGuideObject)};a.prototype._addToStage=function(a){a.add(0,this._layer);a.add(3,this._triangleLineMaterial);a.add(3,this._triangleCornerMaterial);a.add(3,this._arrowMaterial);a.add(3,this._geodesicProjectionLineMaterial);a.add(3,this._geodesicGuideLineMaterial);a.add(1,this._triangleLineObject);a.add(1,this._triangleCornerObject);a.add(1,this._arrowObject);a.add(1,this._geodesicProjectionLineObject);a.add(1,this._geodesicProjectionStartGuideObject);
a.add(1,this._geodesicProjectionEndGuideObject);a.addToViewContent([this._layer.id])};a.prototype._removeFromStage=function(a){a.removeFromViewContent([this._layer.id]);a.remove(0,this._layer.id);a.remove(3,this._triangleLineMaterial.id);a.remove(3,this._triangleCornerMaterial.id);a.remove(3,this._arrowMaterial.id);a.remove(3,this._geodesicProjectionLineMaterial.id);a.remove(3,this._geodesicGuideLineMaterial.id);a.remove(1,this._triangleLineObject.id);a.remove(1,this._triangleCornerObject.id);a.remove(1,
this._arrowObject.id);a.remove(1,this._geodesicProjectionLineObject.id);a.remove(1,this._geodesicProjectionStartGuideObject.id);a.remove(1,this._geodesicProjectionEndGuideObject.id)};a.prototype._getLabelPositions=function(a,b,d,f,r){var t=this._model.triangleView.collapsed,e=q.castRenderScreenPointArray3(m.sv3d.get()),C=q.castRenderScreenPointArray3(m.sv3d.get());r.projectPoint(d,e);r.projectPoint(b,C);e={direct:t?"top":"bottom",horizontal:"top",vertical:e[0]<C[0]?"left":"right"};t||(C=m.sv2d.get(),
t=m.sv2d.get(),y.screenSpaceTangent(a,d,C,r),y.screenSpaceTangent(a,b,t,r),g.vec2.dot(C,t)>=v?e.direct=c.sign(C[1])===c.sign(t[1])?x.mirrorPosition(e.vertical):e.vertical:(a=q.castRenderScreenPointArray(m.sv2d.get()),y.screenSpaceTangent(d,b,a,r),g.vec2.dot(a,t)>=v&&(e.direct=c.sign(a[0])===c.sign(t[0])?x.mirrorPosition(e.horizontal):e.horizontal)));"below-the-surface"===f&&(b=function(a){return"top"===a?"bottom":"top"},e.direct=b(e.direct),e.horizontal=b(e.horizontal),e.vertical=b(e.vertical));return e};
a.prototype._updateView=function(){var a;if(this._sceneView.ready){var m=this._sceneView._stage.getCamera(),d=this._sceneView.renderCoordsHelper,f=this._model.triangleView;if(f.visible){var r="camera-dependent"===this._model.measurementSurfaceLocation?this._sceneView.state.camera.aboveGround?"above-the-surface":"below-the-surface":this._model.measurementSurfaceLocation,t=this._startPosition;a=this._endPosition;var v="above-the-surface"===r?1:-1,c=v*(d.getAltitude(a)-d.getAltitude(t));0>c&&(a=[a,t],
t=a[0],a=a[1]);var e=this._cornerPosition;d.worldUpAtPosition(t,e);b.vec3.scale(e,e,v*Math.abs(c));b.vec3.add(e,e,t);d=this._centerPosition;y.midpoint([t,a,e],d);b.vec3.copy(this._origin,d);h.mat4.identity(this._originTransform);h.mat4.translate(this._originTransform,this._originTransform,this._origin);f.collapsed?(this._triangleLineObject.removeAllGeometries(),this._triangleCornerObject.removeAllGeometries()):this._updateTriangleObjects(this._triangleLineObject,this._triangleCornerObject,t,a,e,this._origin,
this._originTransform,m,f.mode,this._horizontalLabelSegment,this._verticalLabelSegment);this._updateArrowObject(this._arrowObject,this._startPosition,this._endPosition,this._origin,this._originTransform,f.stripeLength,m,f.mode,this._arrowLabelSegment);d=this._requiresGeodesicGuides(this._startPosition,this._endPosition,m,f.mode);this._updateGeodesicProjectionLineObject(this._geodesicProjectionLineObject,this._startPosition,this._endPosition,this._origin,this._originTransform,d,this._geodesicProjectionLabelSegment);
this._updateGeodesicProjectionGuideObjects(m,d);v=this._params.labelDistance;r=this._getLabelPositions(t,a,e,r,m);this._updateAuxiliaryMeasureLabels(f,m,r);"geodesic"!==f.mode?this._updateLabel(this._directDistanceLabel,this._arrowLabelSegment,v,r.direct,f.directLabel,f.visible,16,m):(this._updateLabel(this._horizontalDistanceLabel,d?this._geodesicProjectionLabelSegment:this._arrowLabelSegment,v,r.horizontal,f.horizontalLabel,f.visible,16,m),this._directDistanceLabel.visible=!1)}else this._triangleLineObject.removeAllGeometries(),
this._triangleCornerObject.removeAllGeometries(),this._arrowObject.removeAllGeometries(),this._geodesicProjectionLineObject.removeAllGeometries(),this._geodesicProjectionStartGuideObject.removeAllGeometries(),this._geodesicProjectionEndGuideObject.removeAllGeometries(),this._directDistanceLabel.visible=!1,this._horizontalDistanceLabel.visible=!1,this._verticalDistanceLabel.visible=!1}};a.prototype._updateAuxiliaryMeasureLabels=function(a,b,m){if(a.collapsed)this._horizontalDistanceLabel.visible=!1,
this._verticalDistanceLabel.visible=!1;else{var d=this._params.labelDistance;this._updateLabel(this._horizontalDistanceLabel,this._horizontalLabelSegment,d,m.horizontal,a.horizontalLabel,!0,12,b);this._updateLabel(this._verticalDistanceLabel,this._verticalLabelSegment,d,m.vertical,a.verticalLabel,!0,12,b)}};a.prototype._updateTriangleObjects=function(a,d,f,r,v,c,e,g,h,A,q){h=[b.vec3.subtract(m.sv3d.get(),f,c),b.vec3.subtract(m.sv3d.get(),v,c),b.vec3.subtract(m.sv3d.get(),r,c)];A.update(v,r);q.update(f,
v);A=new C(t.createPolylineGeometry(h),"triangle-line");a.removeAllGeometries();a.addGeometry(A,this._triangleLineMaterial,e);a=m.sv3d.get();A=m.sv3d.get();b.vec3.subtract(a,v,f);b.vec3.normalize(a,a);b.vec3.subtract(A,r,v);b.vec3.normalize(A,A);f=.33*Math.min(b.vec3.distance(v,f),b.vec3.distance(v,r));g=this._params.triangleCornerSize*g.computeScreenPixelSizeAt(v);v=new C(this._quadGeometryData(v,a,A,Math.min(f,g),c),"triangle-corner");d.removeAllGeometries();d.addGeometry(v,this._triangleCornerMaterial,
e)};a.prototype._updateArrowObject=function(a,b,m,d,f,v,r,t,c){this._createInterpolatedLineGeometry(a,this._arrowMaterial,"arrow",b,m,d,f,t,this._arrowLabelSegment);a=r.computeScreenPixelSizeAt(c.origin);this._arrowMaterial.setParameterValues({width:this._params.arrowWidth*a,stripeLength:v})};a.prototype._getSegmentInterpolator=function(a,b){var m=this._sceneView.renderCoordsHelper.spatialReference;return B.canProject(this._sceneView.spatialReference,B.SphericalECEFSpatialReference)?new z.Spherical(a,
b,m,m):new z.Linear(a,b)};a.prototype._updateGeodesicProjectionLineObject=function(a,d,f,v,r,t,c){t?(t=this._sceneView.renderCoordsHelper,d=b.vec3.copy(m.sv3d.get(),d),f=b.vec3.copy(m.sv3d.get(),f),t.setAltitude(0,d),t.setAltitude(0,f),this._createInterpolatedLineGeometry(a,this._geodesicProjectionLineMaterial,"geodesicProjectionLine",d,f,v,r,"geodesic",c)):a.removeAllGeometries()};a.prototype._requiresGeodesicGuides=function(a,b,m,d){return"geodesic"===d&&this._model.geodesicDistanceExceeded?this._requiresGeodesicGuideAt(a,
m)||this._requiresGeodesicGuideAt(b,m):!1};a.prototype._requiresGeodesicGuideAt=function(a,b){var m=this._sceneView.renderCoordsHelper;b=b.computeScreenPixelSizeAt(a);return 10<=m.getAltitude(a)/b};a.prototype._updateGeodesicProjectionGuideObjects=function(a,d){if(d){d=this._sceneView.renderCoordsHelper;var f=b.vec3.copy(m.sv3d.get(),this._startPosition),v=b.vec3.copy(m.sv3d.get(),this._endPosition);d.setAltitude(0,f);d.setAltitude(0,v);this._createInterpolatedLineGeometry(this._geodesicProjectionStartGuideObject,
this._geodesicGuideLineMaterial,"geodesicGuideLine",f,this._startPosition,this._origin,this._originTransform,"euclidean");this._createInterpolatedLineGeometry(this._geodesicProjectionEndGuideObject,this._geodesicGuideLineMaterial,"geodesicGuideLine",v,this._endPosition,this._origin,this._originTransform,"euclidean");a=Math.min(a.computeScreenPixelSizeAt(this._startPosition),a.computeScreenPixelSizeAt(f),a.computeScreenPixelSizeAt(this._endPosition),a.computeScreenPixelSizeAt(v));this._geodesicGuideLineMaterial.setParameterValues({stippleLength:this._params.guideStippleLengthPixels*
a})}else this._geodesicProjectionStartGuideObject.removeAllGeometries(),this._geodesicProjectionEndGuideObject.removeAllGeometries()};a.prototype._createInterpolatedLineGeometry=function(a,d,f,v,r,c,e,g,h){var A=this._sceneView.renderCoordsHelper,q=[],l=[],k=function(a,d){var f=m.sv3d.get();b.vec3.subtract(f,a,c);q.push(f);l.push(d)};if("euclidean"===g){var x=m.sv3d.get();y.midpoint([v,r],x);g=m.sv3d.get();A.worldUpAtPosition(x,g);k(v,g);k(r,g);h&&h.update(v,r)}else{v=this._getSegmentInterpolator(v,
r);r=this._params.arrowSubdivisions+1&-2;for(var D=x=null,E=0;E<r;++E){var w=E/(r-1),n=m.sv3d.get();g=m.sv3d.get();v.eval(w,n);A.worldUpAtPosition(n,g);E===r/2-1?x=n:E===r/2&&(D=n);k(n,g)}h&&h.update(x,D)}f=new C(t.createPolylineGeometry(q,l),f);a.removeAllGeometries();a.addGeometry(f,d,e)};a.prototype._quadGeometryData=function(a,d,f,v,t){var c=m.sv3d.get(),e=[],g=m.sv3d.get();b.vec3.scale(g,f,v);f=m.sv3d.get();b.vec3.scale(f,d,-v);for(d=0;4>d;++d)b.vec3.copy(c,a),b.vec3.subtract(c,c,t),d&1&&b.vec3.add(c,
c,g),d&2&&b.vec3.add(c,c,f),e.push(c[0],c[1],c[2]);return new r.GeometryData({position:{size:3,data:e}},{position:new Uint32Array([0,1,2,1,2,3])})};a.prototype._updateLabel=function(a,b,d,f,v,r,c,t){var e=q.castScreenPointArray(m.sv2d.get()),g=q.castScreenPointArray(m.sv2d.get());b=x.computeLabelPositionFromSegment(t,b,d,f,e,g);a.updatePosition(e,g);a.text=v;a.visible=b&&r;a.fontSize=c};a.prototype._updateCursorPosition=function(){this._model.cursorPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.cursorPoint,
this._cursorPosition);this._updateLaserLine()};a.prototype._updateStartPosition=function(){this._model.startPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.startPoint,this._startPosition)};a.prototype._updateEndPosition=function(){this._model.endPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.endPoint,this._endPosition)};a.prototype._getFocusPosition=function(){var a=this._model,b=a.triangleView.visible&&a.triangleView.collapsed&&"euclidean"===a.measurementMode;
switch(a.state){case "drawing":return b?this._startPosition:a.endPoint?this._endPosition:this._startPosition;case "editing":return b?"start"===this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return a.cursorPoint?this._cursorPosition:null}};a.prototype._getFocusSpherePosition=function(){return"drawing"===this._model.state||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition};a.prototype._updateLaserLine=
function(){var a=this._model,b=this._getFocusPosition(),m=this._params.laserLineEnabled&&!!b&&"measured"!==a.state&&a.active;m?(this._laserLineRenderer.focusPlaneActive=m&&"euclidean"===a.measurementMode,this._laserLineRenderer.focusSphereActive=m&&!!a.startPoint&&"geodesic"===a.measurementMode,this._laserLineRenderer.focusPosition=b,this._laserLineRenderer.focusSpherePosition=this._getFocusSpherePosition(),this._laserLineRenderer.segmentActive=m&&a.triangleView.visible&&!a.triangleView.collapsed,
this._laserLineRenderer.segmentStartPosition=this._startPosition,this._laserLineRenderer.segmentEndPosition=this._endPosition):(this._laserLineRenderer.focusPlaneActive=!1,this._laserLineRenderer.focusSphereActive=!1,this._laserLineRenderer.segmentActive=!1)};a.prototype._initializeListeners=function(){var a=this;this._listenerHandles=new l;this._listenerHandles.add([this._model.watch("state",function(){a._updateLaserLine()}),this._model.watch("measurementMode",function(){a._updateLaserLine()}),this._model.watch("hoveredHandle",
function(){a._updateView()}),this._model.watch("cursorPoint",function(){a._updateCursorPosition()}),this._model.watch("startPoint",function(){a._updateStartPosition();a._updateView();a._updateLaserLine()}),this._model.watch("endPoint",function(){a._updateEndPosition();a._updateView();a._updateLaserLine()}),this._model.watch("unit",function(){a._updateView()}),this._model.watch("active",function(){a._updateLaserLine();a._updateView()}),this._sceneView.state.watch("camera",function(){a._updateView()})])};
a.prototype._destroyListeners=function(){this._listenerHandles.destroy();this._listenerHandles=null};return a}();(function(a){var b=function(){return function(){}}();a.PickRequest=b;b=function(){return function(a,b,m){void 0===a&&(a=null);void 0===b&&(b=null);void 0===m&&(m=null);this.type=a;this.scenePoint=b;this.mapPoint=m}}();a.PickResult=b})(u||(u={}));var v=Math.cos(c.deg2rad(12));return u})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/LaserLineRenderer":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/vec4 ../../../../../core/libs/gl-matrix-2/vec4f64 ../../../webgl-engine/lib/glUtil3D ../../../webgl-engine/lib/Util ../../../webgl-engine/materials/internal/MaterialUtil ../../../webgl-engine/shaders/LaserLinePrograms ../../../../webgl/renderState".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k){function w(a,b,m,d){var r=f,c=x;l.vec3.transformMat4(r,b,d);l.vec3.copy(c,m);c[3]=0;q.vec4.transformMat4(c,c,d);q.vec4.set(a,c[0],c[1],c[2],-l.vec3.dot(c,r))}var f=c.vec3f64.create(),x=h.vec4f64.create(),z={glowColor:[1,.5,0],glowWidth:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75};return function(){function q(d,m){void 0===m&&(m={});this._projInfo=h.vec4f64.create();this._zScale=a.vec2f64.create();this._segmentActive=this._focusSphereActive=this._focusPlaneActive=
!1;this._focusPosition=c.vec3f64.create();this._focusSpherePosition=c.vec3f64.create();this._segmentStartPosition=c.vec3f64.create();this._segmentEndPosition=c.vec3f64.create();this.canRender=!0;this._tempNormal=c.vec3f64.create();this._tempDir=c.vec3f64.create();this._tempUp=c.vec3f64.create();this._tempVec3=c.vec3f64.create();this._tempVec4=h.vec4f64.create();this._renderCoordsHelper=d;this._params=b.copyParameters(m,z)}Object.defineProperty(q.prototype,"renderSlots",{get:function(){return[15]},
enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"needsLinearDepth",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"focusPlaneActive",{get:function(){return this._focusPlaneActive},set:function(a){a!==this._focusPlaneActive&&(this._focusPlaneActive=a,this._requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"focusSphereActive",{get:function(){return this._focusSphereActive},set:function(a){a!==this._focusSphereActive&&
(this._focusSphereActive=a,this._requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"segmentActive",{get:function(){return this._segmentActive},set:function(a){a!==this._segmentActive&&(this._segmentActive=a,this._requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"focusPosition",{get:function(){return this._focusPosition},set:function(a){l.vec3.copy(this._focusPosition,a);this._requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,
"focusSpherePosition",{get:function(){return this._focusSpherePosition},set:function(a){l.vec3.copy(this._focusSpherePosition,a);this._requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"segmentStartPosition",{get:function(){return this._segmentStartPosition},set:function(a){l.vec3.copy(this._segmentStartPosition,a);this._requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(q.prototype,"segmentEndPosition",{get:function(){return this._segmentEndPosition},
set:function(a){l.vec3.copy(this._segmentEndPosition,a);this._requestRender()},enumerable:!0,configurable:!0});q.prototype.setParameterValues=function(a){b.updateParameters(this._params,a)&&this._requestRender()};q.prototype.initializeRenderContext=function(a){this._initContext=a;this._quadVAO=e.createQuadVAO(a.rctx);this._laserLineProgram=a.programRep.getProgram(d.program);this._laserLinePipelineState=k.makePipelineState({blending:k.simpleBlendingParams(1,771),colorWrite:k.defaultColorWriteParams})};
q.prototype.uninitializeRenderContext=function(a){this._quadVAO.dispose();this._projInfo=this._laserLineProgram=this._quadVAO=null};q.prototype.render=function(a){var b=a.rctx,d=a.camera,c=this._renderCoordsHelper,t=this._laserLineProgram,e=this._projInfo,h=this._zScale;b.bindProgram(t);b.setPipelineState(this._laserLinePipelineState);g.inverseProjectionInfo(d.projectionMatrix,d.fullWidth,d.fullHeight,e,h);t.setUniform4fv("projInfo",e);t.setUniform2fv("zScale",h);t.setUniform2f("nearFar",d.near,d.far);
t.setUniform1f("maxPixelDistance",2*d.computeScreenPixelSizeAt(this._focusPosition));if(this._focusPlaneActive){var e=this._focusPosition,h=this._tempVec3,q=this._tempVec4;c.worldUpAtPosition(e,h);w(q,e,h,d.viewMatrix);t.setUniform4fv("focusPlane",q)}else t.setUniform4fv("focusPlane",[0,0,0,1E10]);this._focusSphereActive?(h=this._tempVec4,e=this._tempVec3,l.vec3.copy(h,this._focusSpherePosition),l.vec3.transformMat4(h,h,d.viewMatrix),l.vec3.copy(e,this._focusPosition),l.vec3.transformMat4(e,e,d.viewMatrix),
h[3]=l.vec3.distance(h,e),t.setUniform4fv("focusSphere",h)):t.setUniform4fv("focusSphere",[0,0,0,1E10]);if(this._segmentActive){var e=this._tempVec4,h=this._tempVec3,q=this._tempUp,k=this._tempDir,x=this._tempNormal;l.vec3.lerp(h,this._segmentStartPosition,this._segmentEndPosition,.5);c.worldUpAtPosition(h,q);l.vec3.subtract(k,this._segmentEndPosition,this._segmentStartPosition);l.vec3.normalize(k,k);l.vec3.cross(x,q,k);l.vec3.normalize(x,x);w(e,this._segmentStartPosition,x,d.viewMatrix);t.setUniform4fv("segmentPlane",
e)}else t.setUniform4fv("segmentPlane",[0,0,0,1E10]);e=f;l.vec3.copy(e,this._segmentStartPosition);c.setAltitude(0,e);l.vec3.transformMat4(e,e,d.viewMatrix);t.setUniform3fv("segmentStart",e);e=f;l.vec3.copy(e,this._segmentEndPosition);c.setAltitude(0,e);l.vec3.transformMat4(e,e,d.viewMatrix);t.setUniform3fv("segmentEnd",e);t.setUniform1i("depthMap",0);b.bindTexture(a.offscreenRenderingHelper.linearDepthTexture,0);a=a.camera.pixelRatio;t.setUniform3fv("innerColor",this._params.innerColor);t.setUniform1f("innerWidth",
this._params.innerWidth*a);t.setUniform3fv("glowColor",this._params.glowColor);t.setUniform1f("glowWidth",this._params.glowWidth*a);t.setUniform1f("globalAlpha",this._params.globalAlpha);b.bindVAO(this._quadVAO);b.drawArrays(5,0,4);return!0};q.prototype._requestRender=function(){this._initContext&&this._initContext.requestRender()};return q}()})},"esri/views/3d/webgl-engine/shaders/LaserLinePrograms":function(){define(["require","exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],
function(u,p,n,a){Object.defineProperty(p,"__esModule",{value:!0});p.program={name:"laserline",shaders:{vertexShader:a.resolveIncludes("util/quad.vert"),fragmentShader:a.resolveIncludes("renderer/laserLine/laserLine.frag")},attributes:n.Default3D}})},"esri/views/3d/interactive/measurementTools/support/Label":function(){define(["require","exports","../../../../overlay/LineOverlayItem","../../../../overlay/TextOverlayItem"],function(u,p,n,a){return function(){function l(c){this._textItem=new a({visible:!1});
this._calloutItem=new n({visible:!1,width:2});this._visible=!1;this._calloutVisible=!0;c&&(this.fontSize=c)}Object.defineProperty(l.prototype,"textItem",{get:function(){return this._textItem},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"calloutItem",{get:function(){return this._calloutItem},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"text",{get:function(){return this._textItem.text},set:function(a){this._textItem.text=a},enumerable:!0,configurable:!0});
Object.defineProperty(l.prototype,"fontSize",{get:function(){return this._textItem.fontSize},set:function(a){this._textItem.fontSize=a},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible=a;this._updateVisibility()},enumerable:!0,configurable:!0});l.prototype.addToView=function(a){a.overlay.items.addMany([this._textItem,this._calloutItem])};l.prototype.removeFromView=function(a){a.overlay&&!a.overlay.destroyed&&
a.overlay.items.removeMany([this._textItem,this._calloutItem])};l.prototype.updatePosition=function(a,q){if(q){var c=q[0]-a[0],e=q[1]-a[1];this._textItem.position=[q[0],q[1]];this._textItem.anchor=Math.abs(c)>Math.abs(e)?0<c?"left":"right":0<e?"top":"bottom";this._calloutItem.startPosition=[a[0],a[1]];this._calloutItem.endPosition=[q[0],q[1]];this._calloutVisible=!0}else this._textItem.position=[a[0],a[1]],this._textItem.anchor="center",this._calloutVisible=!1};l.prototype._updateVisibility=function(){this._textItem.visible=
this._visible;this._calloutItem.visible=this._visible&&this._calloutVisible};return l}()})},"esri/views/overlay/LineOverlayItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators maquette".split(" "),function(u,p,n,a,l,c,q){var h={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0};return function(e){function g(a){a=e.call(this,a)||this;a.startX=0;a.startY=0;a.endX=0;a.endY=0;a.width=
1;a.color=[0,0,0,.5];a.visible=!0;return a}n(g,e);Object.defineProperty(g.prototype,"startPosition",{get:function(){return[this.startX,this.startY]},set:function(a){this._set("startX",a[0]);this._set("startY",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"endPosition",{get:function(){return[this.endX,this.endY]},set:function(a){this._set("endX",a[0]);this._set("endY",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"strokeStyle",{get:function(){var a=
this.color;return"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"lineCap",{get:function(){return"round"},enumerable:!0,configurable:!0});g.prototype.render=function(){var a=this.calculateCoordinates(h);return q.h("div",{classes:{"esri-line-overlay-item":!0},styles:{left:a.left+"px",top:a.top+"px",width:a.width+"px",height:a.height+"px",visibility:this.visible?"visible":"hidden"},innerHTML:"\x3csvg width\x3d"+a.width+" height\x3d"+
a.height+"\x3e"+("\x3cline x1\x3d"+a.x1+" y1\x3d"+a.y1+" x2\x3d"+a.x2+" y2\x3d"+a.y2+' style\x3d"stroke: '+this.strokeStyle+"; stroke-width: "+this.width+"; stroke-linecap: "+this.lineCap+';"\x3e\x3c/line\x3e')+"\x3c/svg\x3e"})};g.prototype.renderCanvas=function(a){if(this.visible){a.strokeStyle=this.strokeStyle;a.lineWidth=this.width;a.lineCap=this.lineCap;var b=this.calculateCoordinates(h);a.beginPath();a.moveTo(b.left+b.x1,b.top+b.y1);a.lineTo(b.left+b.x2,b.top+b.y2);a.stroke()}};g.prototype.calculateCoordinates=
function(a){var b=Math.min(this.startX,this.endX),e=Math.max(this.startX,this.endX),c=Math.min(this.startY,this.endY),f=Math.max(this.startY,this.endY),g=this.width;a.left=b-g;a.top=c-g;a.width=e-b+2*g;a.height=Math.max(20,f-c+2*g);a.x1=this.startX-b+g;a.y1=this.startY-c+g;a.x2=this.endX-b+g;a.y2=this.endY-c+g;return a};a([c.property()],g.prototype,"startX",void 0);a([c.property()],g.prototype,"startY",void 0);a([c.property()],g.prototype,"endX",void 0);a([c.property()],g.prototype,"endY",void 0);
a([c.property({dependsOn:["startX","startY"]})],g.prototype,"startPosition",null);a([c.property({dependsOn:["endX","endY"]})],g.prototype,"endPosition",null);a([c.property()],g.prototype,"width",void 0);a([c.property()],g.prototype,"color",void 0);a([c.property()],g.prototype,"visible",void 0);a([c.property({readOnly:!0,dependsOn:["color"]})],g.prototype,"strokeStyle",null);return g=a([c.subclass("esri.views.overlay.LineOverlayItem")],g)}(c.declared(l))})},"esri/views/overlay/TextOverlayItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators maquette".split(" "),
function(u,p,n,a,l,c,q){var h={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};u=function(b){function d(a){a=
b.call(this,a)||this;a.x=0;a.y=0;a.text="-";a.fontSize=14;a.anchor="center";a.visible=!0;a.backgroundColor="rgba(0, 0, 0, 0.6)";a.textColor="white";a.textShadowColor=[0,0,0];a.textShadowSize=1;return a}n(d,b);Object.defineProperty(d.prototype,"position",{get:function(){return[this.x,this.y]},set:function(a){this._set("x",a[0]);this._set("y",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"padding",{get:function(){return.5*this.fontSize},enumerable:!0,configurable:!0});d.prototype.render=
function(){return q.h("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",backgroundColor:this.backgroundColor,color:this.textColor,padding:this.padding+"px",borderRadius:this.padding+"px",textShadow:"0 0 "+this.textShadowSize+"px rgb("+this.textShadowColor[0]+", "+this.textShadowColor[1]+", "+this.textShadowColor[2]+")"}},[this.text])};d.prototype.renderCanvas=function(a){if(this.visible){var b=
a.font.replace(/^(.*?)px/,"");a.font=this.fontSize+"px "+b;var d=this.padding,c=this.padding,g=a.measureText(this.text).width,h=this.fontSize,b=e[this.anchor];a.textAlign="center";a.textBaseline="middle";g+=2*d;d=h+2*d;this.roundedRect(a,this.x+b.x*g,this.y+b.y*d,g,d,c);a.fillStyle=this.backgroundColor;a.fill();c=this.x+(b.x+.5)*g;b=this.y+(b.y+.5)*d;this._renderTextShadow(a,this.text,c,b);a.fillStyle=this.textColor;a.fillText(this.text,c,b)}};d.prototype._renderTextShadow=function(a,b,d,e){a.lineJoin=
"miter";a.fillStyle="rgba("+this.textShadowColor[0]+", "+this.textShadowColor[1]+", "+this.textShadowColor[2]+", "+1/g.length+")";for(var f=this.textShadowSize,c=0,h=g;c<h.length;c++){var m=h[c];a.fillText(b,d+f*m[0],e+f*m[1])}};d.prototype.roundedRect=function(a,b,d,e,c,g){a.beginPath();a.moveTo(b,d+g);a.arcTo(b,d,b+g,d,g);a.lineTo(b+e-g,d);a.arcTo(b+e,d,b+e,d+g,g);a.lineTo(b+e,d+c-g);a.arcTo(b+e,d+c,b+e-g,d+c,g);a.lineTo(b+g,d+c);a.arcTo(b,d+c,b,d+c-g,g);a.closePath()};d.prototype._cssClasses=function(){var a=
{"esri-text-overlay-item":!0},b;for(b in h)a[h[b]]=this.anchor===b;return a};a([c.property()],d.prototype,"x",void 0);a([c.property()],d.prototype,"y",void 0);a([c.property({dependsOn:["x","y"]})],d.prototype,"position",null);a([c.property()],d.prototype,"text",void 0);a([c.property()],d.prototype,"fontSize",void 0);a([c.property()],d.prototype,"anchor",void 0);a([c.property()],d.prototype,"visible",void 0);a([c.property({dependsOn:["fontSize"]})],d.prototype,"padding",null);return d=a([c.subclass("esri.views.overlay.TextOverlayItem")],
d)}(c.declared(l));var e={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},
"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},g=[];for(p=0;360>p;p+=22.5)g.push([Math.cos(Math.PI*p/180),Math.sin(Math.PI*p/180)]);return u})},"esri/views/3d/interactive/measurementTools/support/LabelSegment":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec3","../../../../../core/libs/gl-matrix-2/vec3f64","./viewUtils"],function(u,p,n,a,l){return function(){function c(){this.origin=a.vec3f64.create();this.start=a.vec3f64.create();this.end=a.vec3f64.create()}
c.prototype.update=function(a,c,e){n.vec3.copy(this.start,a);n.vec3.copy(this.end,c);if(e)switch(e){case "start":n.vec3.copy(this.origin,this.start);break;case "center":l.midpoint([a,c],this.origin);break;case "end":n.vec3.copy(this.origin,this.end);break;default:n.vec3.copy(this.origin,e)}else l.midpoint([a,c],this.origin)};return c}()})},"esri/views/3d/interactive/measurementTools/support/viewUtils":function(){define("require exports ../../../../../core/lang ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64".split(" "),
function(u,p,n,a,l,c,q,h){function e(m,f,c){var e=c._stage.getCamera();c.renderCoordsHelper.toRenderCoords(m,b);e.projectPoint(b,d);a.renderArrayToScreen(c,d,f)}Object.defineProperty(p,"__esModule",{value:!0});var g=h.vec3f64.create();p.copyParameter=function(a,b){a=n.mixin({},a);b=n.clone(b);n.mixin(a,b);return a};p.resizeArray=function(a,b,d,f){for(;a.length<b;)a.push(d());if(f)for(;a.length>b;)d=a.pop(),f(d);else a.length=b};p.scaleTranslateMatrix=function(a,b,d){l.mat4.identity(d);l.mat4.translate(d,
d,b);q.vec3.set(g,a,a,a);l.mat4.scale(d,d,g)};p.midpoint=function(a,b){q.vec3.set(b,0,0,0);if(0<a.length){for(var d=0;d<a.length;++d)q.vec3.add(b,b,a[d]);q.vec3.scale(b,b,1/a.length)}};p.screenSpaceTangent=function(a,b,d,e){e.projectPoint(a,k);e.projectPoint(b,f);c.vec2.subtract(d,x,w);c.vec2.normalize(d,d)};p.projectPoint=e;p.pointToPointScreenDistance=function(a,b,d){e(a,y,d);e(b,B,d);return c.vec2.distance(y,B)};p.pointToScreenPositionDistance=function(a,b,d){e(a,z,d);return c.vec2.distance(z,
b)};var b=h.vec3f64.create(),d=a.createRenderScreenPointArray3(),k=a.createRenderScreenPointArray3(),w=k,f=a.createRenderScreenPointArray3(),x=f,z=a.createScreenPointArray(),y=a.createScreenPointArray(),B=a.createScreenPointArray()})},"esri/views/3d/interactive/measurementTools/support/labelUtils":function(){define("require exports ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ./viewUtils".split(" "),
function(u,p,n,a,l,c,q){function h(a,b,d){a.projectPoint(b,f);if(0>f[2]||1<f[2])return!1;a.renderToScreen(f,d);return!0}function e(b,e,c,g,h,l){if(!e)return!1;q.screenSpaceTangent(e.start,e.end,d,b);a.vec2.set(w,-d[1],d[0]);var m=!1;switch(g){case "top":m=0>w[1];break;case "bottom":m=0<w[1];break;case "left":m=0<w[0];break;case "right":m=0>w[0]}m&&a.vec2.negate(w,w);if(0===a.vec2.length(w))switch(g){case "top":w[1]=1;break;case "bottom":w[1]=-1;break;case "left":w[0]=-1;break;case "right":w[0]=1}b.projectPoint(e.origin,
f);if(0>f[2]||1<f[2])return!1;b.renderToScreen(f,h);a.vec2.scale(w,w,c*b.pixelRatio);a.vec2.add(w,w,f);b.renderToScreen(w,l);return!0}function g(b,e,c,g,h,l){if(!e||!c)return!1;q.screenSpaceTangent(e.end,e.start,d,b);q.screenSpaceTangent(c.start,c.end,k,b);a.vec2.add(w,d,k);a.vec2.negate(w,w);a.vec2.normalize(w,w);b.projectPoint(e.end,f);if(0>f[2]||1<f[2])return!1;b.renderToScreen(f,h);a.vec2.scale(w,w,g*b.pixelRatio);a.vec2.add(w,w,f);b.renderToScreen(w,l);return!0}function b(b,d,e,c,g,h){b.projectPoint(d,
f);l.vec3.add(z,d,e);b.projectPoint(z,x);if(0>f[2]||1<f[2]||0>x[2]||1<x[2])return!1;a.vec2.subtract(w,x,f);a.vec2.normalize(w,w);b.renderToScreen(f,g);a.vec2.scale(w,w,c*b.pixelRatio);a.vec2.add(w,w,f);b.renderToScreen(w,h);return!0}Object.defineProperty(p,"__esModule",{value:!0});p.mirrorPosition=function(a){switch(a){case "top":return"bottom";case "right":return"left";case "bottom":return"top";case "left":return"right"}};p.computeLabelPositionFromPoint=h;p.positionLabelOnPoint=function(a,b,d){(b=
h(d,b,y))&&a.updatePosition(y,null);return b};p.computeLabelPositionFromSegment=e;p.positionLabelOnSegment=function(a,b,d,f,c){(b=e(c,b,d,f,y,B))&&a.updatePosition(y,B);return b};p.computeLabelPositionFromCorner=g;p.computeLabelPositionFromPlane=b;p.positionLabelOnCorner=function(a,b,d,f,e){(b=g(e,b,d,f,y,B))&&a.updatePosition(y,B);return b};p.positionLabelOnPlane=function(a,d,f,e,c,g){(d=b(g,d,f,e,y,B))&&a.updatePosition(y,B);return d};var d=n.createRenderScreenPointArray(),k=n.createRenderScreenPointArray(),
w=n.createRenderScreenPointArray(),f=n.createRenderScreenPointArray3(),x=n.createRenderScreenPointArray3(),z=c.vec3f64.create(),y=n.createScreenPointArray(),B=n.createScreenPointArray()})},"esri/views/3d/interactive/measurementTools/support/PathSegmentInterpolator":function(){define("require exports ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../support/mathUtils ../../../support/projectionUtils".split(" "),function(u,p,n,a,l,c){var q;(function(h){var e=
function(){function e(b,d){this._startPosition=a.vec3f64.create();this._endPosition=a.vec3f64.create();n.vec3.copy(this._startPosition,b);n.vec3.copy(this._endPosition,d)}e.prototype.eval=function(a,d){n.vec3.lerp(d,this._startPosition,this._endPosition,a)};return e}();h.Linear=e;e=function(){function e(b,d,e,g){this._startPosition=a.vec3f64.create();this._endPosition=a.vec3f64.create();c.vectorToVector(b,e,this._startPosition,c.SphericalECEFSpatialReference);c.vectorToVector(d,e,this._endPosition,
c.SphericalECEFSpatialReference);this._destSR=g}e.prototype.eval=function(a,d){l.slerp(this._startPosition,this._endPosition,a,d);c.vectorToVector(d,c.SphericalECEFSpatialReference,d,this._destSR)};return e}();h.Spherical=e})(q||(q={}));return q})},"esri/views/3d/webgl-engine/materials/MeasurementArrowMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../lib/Util ./internal/MaterialUtil ./renderers/MergedRenderer ../shaders/MeasurementArrowPrograms ../../../webgl/renderState".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k){u=function(a){function d(b,d){d=a.call(this,d)||this;d.params=g.copyParameters(b,f);return d}n(d,a);d.prototype.dispose=function(){};d.prototype.setParameterValues=function(a){g.updateParameters(this.params,a)&&this.notifyDirty("matChanged")};d.prototype.getParameters=function(){return this.params};d.prototype.intersect=function(a,b,d,e,m,f,c,v){};d.prototype.createBufferWriter=function(){return new r};d.prototype.createRenderer=function(a,d){return new b(a,d,this)};
d.prototype.getGLMaterials=function(){return{color:w,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};return d}(h.Material);var w=function(a){function b(b){b=a.call(this,b)||this;b.updateParameters();return b}n(b,a);b.prototype.selectProgram=function(){this.program=this.programRep.getProgram(d.colorPass);this.pipelineState=k.makePipelineState({polygonOffset:this.params.polygonOffset&&{factor:0,units:-4},depthTest:{func:513},depthWrite:k.defaultDepthWriteParams,colorWrite:k.defaultColorWriteParams})};
b.prototype.updateParameters=function(){this.params=g.copyParameters(this.material.getParameters());this.selectProgram()};b.prototype.beginSlot=function(a){return 5===a};b.prototype.getProgram=function(){return this.program};b.prototype.getDrawMode=function(){return 5};b.prototype.bind=function(a,b){b=this.program;a.bindProgram(b);a.setPipelineState(this.pipelineState);b.setUniform1f("width",this.params.width);b.setUniform1f("outlineSize",this.params.outlineSize);b.setUniform4fv("outlineColor",this.params.outlineColor);
b.setUniform1f("stripeLength",this.params.stripeLength);b.setUniform4fv("stripeEvenColor",this.params.stripeEvenColor);b.setUniform4fv("stripeOddColor",this.params.stripeOddColor)};b.prototype.bindView=function(a,b){a=b.origin;var d=this.getProgram();g.bindView(a,b.view,d)};b.prototype.bindInstance=function(a,b){this.getProgram().setUniformMatrix4fv("model",b.transformation)};b.prototype.release=function(a){};return b}(q),f={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,
1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1},x=c.newLayout().vec3f(e.VertexAttrConstants.POSITION).vec3f(e.VertexAttrConstants.NORMAL).vec2f(e.VertexAttrConstants.UV0).f32(e.VertexAttrConstants.AUXPOS1),z=l.vec3f64.create(),y=l.vec3f64.create(),B=l.vec3f64.create(),m=l.vec3f64.create(),C=l.vec3f64.create(),r=function(){function b(){this.vertexBufferLayout=x}b.prototype.allocate=function(a){return this.vertexBufferLayout.createBuffer(a)};b.prototype.elementCount=function(a){return 2*(a.indices[e.VertexAttrConstants.POSITION].length/
2+1)};b.prototype.write=function(b,d,f,c){var g=d.vertexAttr[e.VertexAttrConstants.POSITION].data,h=d.vertexAttr[e.VertexAttrConstants.NORMAL].data,t=g.length/3;(d=d&&d.indices&&d.indices.position)&&d.length!==2*(t-1)&&console.warn("MeasurementArrowMaterial does not support indices");d=b.transformation;for(var r=b.invTranspTransformation,v=f.position,q=f.normal,l=f.uv0,x=b=0;x<t;++x){var n=3*x;a.vec3.set(z,g[n],g[n+1],g[n+2]);x<t-1&&(n=3*(x+1),a.vec3.set(y,g[n],g[n+1],g[n+2]),a.vec3.set(C,h[n],h[n+
1],h[n+2]),a.vec3.normalize(C,C),a.vec3.subtract(B,y,z),a.vec3.normalize(B,B),a.vec3.cross(m,C,B),a.vec3.normalize(m,m));n=a.vec3.distance(z,y);d&&r&&(a.vec3.transformMat4(z,z,d),a.vec3.transformMat4(y,y,d),a.vec3.transformMat4(m,m,r));var k=c+2*x,A=k+1;v.setVec(k,z);v.setVec(A,z);q.setVec(k,m);q.setVec(A,m);l.set(k,0,b);l.set(k,1,-1);l.set(A,0,b);l.set(A,1,1);x<t-1&&(b+=n)}f=f.auxpos1;for(x=0;x<2*t;++x)f.set(c+x,b)};return b}();return u})},"esri/views/3d/webgl-engine/shaders/MeasurementArrowPrograms":function(){define(["require",
"exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],function(u,p,n,a){Object.defineProperty(p,"__esModule",{value:!0});p.colorPass={name:"measurement-arrow-color",shaders:{vertexShader:a.resolveIncludes("materials/measurementArrow/measurementArrow.vert"),fragmentShader:a.resolveIncludes("materials/measurementArrow/measurementArrow.frag")},attributes:n.Default3D}})},"esri/views/interactive/manipulatorUtils":function(){define("require exports ../../core/libs/gl-matrix-2/mat4 ../../core/libs/gl-matrix-2/vec3 ../3d/support/stack ../3d/webgl-engine/lib/Geometry ../3d/webgl-engine/lib/GeometryUtil ../3d/webgl-engine/materials/DefaultMaterial ./Manipulator3D".split(" "),
function(u,p,n,a,l,c,q,h,e){function g(a,b){var d=1!==b;a=new h({diffuse:a,transparent:d,writeDepth:!d,cullFace:"back",opacity:b,castShadows:!1,softwareInstanced:!0},"manipulator");a.renderOccluded=4;return a}function b(b,e,c,f){b=a.vec3.normalize(l.sv3d.get(),b);e=a.vec3.normalize(l.sv3d.get(),e);var d=a.vec3.cross(l.sv3d.get(),b,e);f[0]=b[0];f[1]=b[1];f[2]=b[2];f[3]=0;f[4]=e[0];f[5]=e[1];f[6]=e[2];f[7]=0;f[8]=d[0];f[9]=d[1];f[10]=d[2];f[11]=0;f[12]=c[0];f[13]=c[1];f[14]=c[2];f[15]=1;return f}Object.defineProperty(p,
"__esModule",{value:!0});p.createManipulatorMaterial=g;p.createSphereManipulator=function(a,b,h){return new e.Manipulator3D({view:a,renderObjects:[{geometry:new c(q.createSphereGeometry(1,32,32),"manipulator"),material:g(b,h)}]})};p.calculateInputRotationTransform=function(d,e,c,f){d=a.vec3.subtract(l.sv3d.get(),d,c);f=a.vec3.cross(l.sv3d.get(),f,d);c=b(d,f,c,l.sm4d.get());n.mat4.invert(c,c);e=a.vec3.transformMat4(l.sv3d.get(),e,c);return Math.atan2(e[1],e[0])};p.calculateTranslateRotateFromBases=
b})},"esri/views/interactive/Manipulator3D":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/Accessor ../../core/Collection ../../core/compilerUtils ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f64 ../../core/libs/gl-matrix-2/mat4 ../../core/libs/gl-matrix-2/mat4f64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec3 ../../core/libs/gl-matrix-2/vec3f64 ../../geometry/support/aaBoundingRect ../../layers/graphics/dehydratedFeatures ../3d/support/geometryUtils ../3d/support/projectionUtils ../3d/support/stack ../3d/webgl-engine/lib/Intersector ../3d/webgl-engine/lib/intersectorUtils ../3d/webgl-engine/lib/Layer ../3d/webgl-engine/lib/Object3D".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k,w,f,x,z,y,B,m,C,r,t,A,D,E,G,L){function H(a){return 0!==a[12]||0!==a[13]||0!==a[14]}Object.defineProperty(p,"__esModule",{value:!0});u=function(l){function k(a){a=l.call(this)||this;a.hideOnGrab=!1;a.moveOnDrag=!0;a.snapToPointer=!0;a.collisionType={type:"point"};a.collisionPriority=0;a.renderObjects=[];a.autoScaleRenderObjects=!0;a._radius=10;a._worldSized=!1;a._focusMultiplier=2;a._touchMultiplier=2.5;a.interactive=!0;a.selectable=!1;a.dragging=!1;a._areAnyEngineObjectsVisible=
!1;a._position=B.vec3f64.create();a._modelTransform=f.mat4f64.create();a._dragOffset=null;a._dirtyScreenPoint=e.createScreenPoint();a._dirtyScreenPointArray=e.createScreenPointArray();a._dirtyRenderScreenPointArray=e.createRenderScreenPointArray3();a._dirtyOriginScreenPointArray=e.createScreenPointArray();a._dirtyScreenPixelSize=1;a._screenPositionDirty=!0;a._engineResourcesAddedToStage=!1;a._engineResources=null;a._attached=!1;a._engineLayerId=null;a._materialIdReferences=null;a._hitResult={onSurface:!1,
surfaceType:"ground"};a._handlers=new c;return a}a(k,l);k.prototype.initialize=function(){this._intersector=new D(this.view.viewingMode);this._mapPoint=C.makeDehydratedPoint(0,0,0,this.view.spatialReference)};k.prototype.destroy=function(){this._handlers.removeAll();this._handlers=null;this._removeResourcesFromStage();this._engineResources=null;this._set("view",null);this._camera=null};Object.defineProperty(k.prototype,"alignment",{get:function(){return this._get("alignment")},set:function(a){this._set("alignment",
a);this.constructed&&this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"visible",{set:function(a){a!==this._get("visible")&&(this._set("visible",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"radius",{get:function(){return this._radius},set:function(a){a!==this._radius&&(this._radius=a,this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"worldSized",{get:function(){return this._worldSized},
set:function(a){a!==this._worldSized&&(this._worldSized=a,this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"focusMultiplier",{get:function(){return this._focusMultiplier},set:function(a){this._focusMultiplier=a},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"touchMultiplier",{get:function(){return this._touchMultiplier},set:function(a){this._touchMultiplier=a},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"modelTransform",
{get:function(){return this._modelTransform},set:function(a){H(a)&&(this._screenPositionDirty=!0);w.mat4.copy(this._modelTransform,a);this._updateEngineObject()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"position",{get:function(){return this._position},set:function(a){this.view.renderCoordsHelper.fromRenderCoords(a,this._mapPoint,this._mapPoint.spatialReference);this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"mapPoint",{get:function(){return this._mapPoint},
set:function(a){C.clonePoint(a,this._mapPoint);this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"grabbing",{set:function(a){a!==this._get("grabbing")&&(this._set("grabbing",a),this._updateEngineObject());a||(this._dragOffset=null)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"hovering",{set:function(a){a!==this._get("hovering")&&(this._set("hovering",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"selected",{set:function(a){a!==this._get("selected")&&(this._set("selected",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"state",{set:function(a){a!==this._get("state")&&(this._set("state",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"areAnyEngineObjectsVisible",{get:function(){return this._areAnyEngineObjectsVisible},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"surfaceType",
{get:function(){return this._hitResult.onSurface?this._hitResult.surfaceType:null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"focused",{get:function(){return this._focused},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_focused",{get:function(){return this._get("hovering")||this._get("grabbing")},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"screenPoint",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPoint},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_screenPointArray",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_renderScreenPointArray",{get:function(){this._updateScreenSpaceProperties();return this._dirtyRenderScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_originScreenPointArray",{get:function(){this._updateScreenSpaceProperties();
return this._dirtyOriginScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_screenPixelSize",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPixelSize},enumerable:!0,configurable:!0});k.prototype._updateScreenSpaceProperties=function(){if(this._screenPositionDirty){this._screenPositionDirty=!1;this._dirtyScreenPixelSize=this._camera.computeScreenPixelSizeAt(this._position);var a=H(this._modelTransform),b;a?(b=this._calculateModelTransformOffset(W),
b=y.vec3.add(b,b,this._position)):b=this._position;this._camera.projectPoint(b,this._dirtyRenderScreenPointArray);this._camera.renderToScreen(this._dirtyRenderScreenPointArray,this._dirtyScreenPointArray);e.screenPointArrayToObject(this._dirtyScreenPointArray,this._dirtyScreenPoint);a?(this._camera.projectPoint(this._position,v),this._camera.renderToScreen(v,this._dirtyOriginScreenPointArray)):x.vec2.copy(this._dirtyOriginScreenPointArray,this._dirtyScreenPointArray)}};k.prototype.intersectionDistance=
function(a,b){if(!this._get("visible"))return null;var f=e.screenPointObjectToArray(a,M),c=this._getCollisionRadius(b);b=-1*this._get("collisionPriority");switch(this.collisionType.type){case "point":if(x.vec2.squaredDistance(this._screenPointArray,f)<c*c)return this._renderScreenPointArray[2]+b;break;case "line":var m=this.collisionType.paths;a=this._getWorldToScreenObjectScale();a=this._calculateObjectTransform(a,N);for(var c=c*this._screenPixelSize,f=r.ray.fromScreen(this._camera,f,P),v=0,g=m;v<
g.length;v++)if(m=g[v],0!==m.length)for(var h=y.vec3.transformMat4(S,m[0],a),t=1;t<m.length;t++){var k=y.vec3.transformMat4(T,m[t],a),l=r.lineSegment.closestRayDistance2(r.lineSegment.fromPoints(h,k,F),f);if(null!=l&&l<c*c)return a=y.vec3.add(A.sv3d.get(),h,k),y.vec3.scale(a,a,.5),c=e.castRenderScreenPointArray(A.sv3d.get()),this._camera.projectPoint(a,c),c[2]+b;y.vec3.copy(h,k)}break;case "disc":h=this.collisionType.direction;a=this._getWorldToScreenObjectScale();a=this._calculateObjectTransform(a,
N);c*=this._screenPixelSize;f=r.ray.fromScreen(this._camera,f,P);t=d.mat3.fromMat4(R,a);t=y.vec3.transformMat3(I,h,t);h=this._calculateModelTransformPosition(J);r.plane.fromPositionAndNormal(h,t,O);v=Q;if(r.plane.intersectRay(O,f,v)&&y.vec3.squaredDistance(v,h)<c*c)return this._renderScreenPointArray[2]+b;break;case "ribbon":a=this.collisionType;m=a.paths;h=a.direction;a=this._getWorldToScreenObjectScale();a=this._calculateObjectTransform(a,N);c*=this._camera.computeScreenPixelSizeAt(this._position);
f=r.ray.fromScreen(this._camera,f,P);t=d.mat3.fromMat4(R,a);t=y.vec3.transformMat3(I,h,t);h=this._calculateModelTransformPosition(J);r.plane.fromPositionAndNormal(h,t,O);v=Q;if(!r.plane.intersectRay(O,f,v))break;f=0;for(g=m;f<g.length;f++)if(m=g[f],0!==m.length)for(h=y.vec3.transformMat4(S,m[0],a),t=1;t<m.length;t++){k=y.vec3.transformMat4(T,m[t],a);l=r.lineSegment.distance2(r.lineSegment.fromPoints(h,k,F),v);if(null!=l&&l<c*c)return a=y.vec3.add(A.sv3d.get(),h,k),y.vec3.scale(a,a,.5),c=e.castRenderScreenPointArray(A.sv3d.get()),
this._camera.projectPoint(a,c),c[2]+b;y.vec3.copy(h,k)}break;default:q.neverReached(this.collisionType)}return null};k.prototype.attemptDragTo=function(a){if(!this.moveOnDrag)return this._handlers.forEach(function(b){var d=b.handler;"drag"===b.type&&d(a)}),!1;var b=e.screenPointObjectToArray(a.screenPoint,M);h.isNone(this._dragOffset)&&this.grabbing&&!this.snapToPointer&&(this._dragOffset=x.vec2.subtract(z.vec2f32.create(),b,this._originScreenPointArray));h.isSome(this._dragOffset)&&x.vec2.subtract(b,
b,this._dragOffset);var b=this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(b,this._intersector,"on-the-ground"===this.alignment?K:null).results.min,d=Q;b.getIntersectionPoint(d)?(this.position=d,this._hitResult.onSurface=!0,this._hitResult.surfaceType="TerrainRenderer"===b.intersector?"ground":"feature",this._handlers.forEach(function(b){var d=b.handler;"drag"===b.type&&d(a)})):this._hitResult.onSurface=!1;return this._hitResult.onSurface};k.prototype.grab=function(a){this._handlers.forEach(function(b){var d=
b.handler;"grab"===b.type&&d(a)})};k.prototype.click=function(a){this._handlers.forEach(function(b){var d=b.handler;"click"===b.type&&d(a)})};k.prototype.on=function(a,b){this._handlers.push({type:a,handler:b})};k.prototype.attach=function(a){void 0===a&&(a={manipulator3D:{}});if(this.view._stage){a=a.manipulator3D;this._engineLayerId=a.engineLayerId;if(h.isNone(this._engineLayerId)){var b=new G("manipulator-3d",{isPickable:!1});this.view._stage.add(0,b);this.view._stage.addToViewContent([b.id]);
this._engineLayerId=b.id;a.engineLayerId=b.id}a.engineLayerReferences=(a.engineLayerReferences||0)+1;this._materialIdReferences=a.materialIdReferences;h.isNone(this._materialIdReferences)&&(this._materialIdReferences=new Map,a.materialIdReferences=this._materialIdReferences);this._camera=this.view.state.camera;this._attached=!0;this._updateEngineObject();t.canProject(this._mapPoint.spatialReference,this.view.spatialReference)||(this.mapPoint=C.makeDehydratedPoint(0,0,0,this.view.spatialReference))}};
k.prototype.detach=function(a){void 0===a&&(a={manipulator3D:{}});a=a.manipulator3D;a.engineLayerReferences--;var b=0===a.engineLayerReferences;b&&(a.engineLayerId=null);this._removeResourcesFromStage(b);this._camera=this._materialIdReferences=this._engineLayerId=this._engineResources=null;this._attached=!1};k.prototype.onCameraChange=function(a){this._camera=a;this._screenPositionDirty=!0;this._updateEngineObject()};k.prototype.onElevationChange=function(a){this.view.renderCoordsHelper.fromRenderCoords(this.position,
U,a.spatialReference)&&m.containsPoint(a.extent,U)&&this._refreshMapPoint(!0)};k.prototype._refreshMapPoint=function(a){void 0===a&&(a=!1);switch(this.alignment){case "none":break;case "on-the-ground":var b=this.view.elevationProvider.getElevation(this.mapPoint,"ground");if(b===this._mapPoint.z&&a)return;this._mapPoint.z=b;break;default:q.neverReached(this.alignment)}this._screenPositionDirty=!0;this._hitResult.onSurface=!1;this.view.renderCoordsHelper.toRenderCoords(this._mapPoint,this._position);
this._updateEngineObject()};k.prototype._updateEngineObject=function(){this._areAnyEngineObjectsVisible=!1;if(this._attached)if(!1===this._get("visible"))this._removeResourcesFromStage();else{var a=this._getWorldToScreenObjectScale(),b=N;!0===this._get("autoScaleRenderObjects")&&(a*=this._getFocusedSize(this._radius,this._focused));this._calculateObjectTransform(a,b);for(var a=this._ensureEngineResources().objectsByState,d=(this._focused?2:1)|(this._get("selected")?8:4),c=this._get("hideOnGrab")&&
this._get("grabbing"),f=0;f<a.length;f++){var m=a[f],e=m.stateMask,m=m.objects;if(c)for(var e=0,v=m;e<v.length;e++)m=v[e],m.hideAllComponents();else if(v=0===(e&15)||(d&e)===(e&15),e=0===(e&65520)||(this._get("state")&e)===(e&65520),v&&e)for(e=0,v=m;e<v.length;e++)m=v[e],m.unhideAllComponents(),m.objectTransformation=b,this._areAnyEngineObjectsVisible=!0;else for(e=0,v=m;e<v.length;e++)m=v[e],m.hideAllComponents()}}};k.prototype._ensureEngineResources=function(){if(h.isNone(this._engineResources)){var a=
this.view._stage.getContent(0,h.expect(this._engineLayerId)),b=[],d=new Set;this.renderObjects.forEach(function(a){a=a.material;d.has(a)||(b.push(a),d.add(a))});var e=function(a,b){var d=b.geometry,e=b.material,m=b.transform;Array.isArray(d)?d.forEach(function(b){return a.addGeometry(b,e,m)}):a.addGeometry(d,e,m)},m=new Map;this.renderObjects.forEach(function(a){var b=new L({idHint:"manipulator"});e(b,a);a=a.stateMask||0;var d=m.get(a)||[];d.push(b);m.set(a,d)});var f=[];m.forEach(function(a,b){f.push({stateMask:b,
objects:a})});this._engineResources={objectsByState:f,layer:a,materials:b}}this._addResourcesToStage();return this._engineResources};k.prototype._addResourcesToStage=function(){var a=this;if(!this._engineResourcesAddedToStage&&!h.isNone(this._engineResources)){var b=this._engineResources,d=b.objectsByState,e=b.layer;b.materials.forEach(function(b){var d=h.expect(a._materialIdReferences),e=d.get(b.id)||0;0===e&&a.view._stage.add(3,b);d.set(b.id,e+1)});d.forEach(function(b){b.objects.forEach(function(b){e.addObject(b);
a.view._stage.add(1,b)})});this._engineResourcesAddedToStage=!0}};k.prototype._removeResourcesFromStage=function(a){var b=this;void 0===a&&(a=!1);if(this._engineResourcesAddedToStage&&!h.isNone(this._engineResources)){var d=this._engineResources,e=d.layer,m=d.materials;d.objectsByState.forEach(function(a){a.objects.forEach(function(a){e.removeObject(a);b.view._stage.remove(1,a.id)})});m.forEach(function(a){var d=h.expect(b._materialIdReferences),e=d.get(a.id);1===e?(b.view._stage.remove(3,a.id),d.delete(a.id)):
d.set(a.id,e-1)});a&&this.view._stage.remove(0,e.id);this._engineResourcesAddedToStage=!1}};k.prototype._getCollisionRadius=function(a){return this._getFocusedSize(this._radius,!0)*("touch"===a?this._touchMultiplier:1)};k.prototype._getFocusedSize=function(a,b){return a*(b?this._focusMultiplier:1)};k.prototype._getWorldToScreenObjectScale=function(){return this._worldSized?1:this._screenPixelSize};k.prototype._calculateModelTransformPosition=function(a){var b=this._getWorldToScreenObjectScale(),b=
this._calculateObjectTransform(b,V);return y.vec3.set(a,b[12],b[13],b[14])};k.prototype._calculateModelTransformOffset=function(a){var b=this._calculateModelTransformPosition(a);return y.vec3.subtract(a,b,this._position)};k.prototype._calculateObjectTransform=function(a,b){w.mat4.set(b,a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,1);w.mat4.multiply(b,b,this._modelTransform);b[12]+=this._position[0];b[13]+=this._position[1];b[14]+=this._position[2];b[15]=1;return b};n([g.property({constructOnly:!0,nonNullable:!0})],
k.prototype,"view",void 0);n([g.property({value:"none",nonNullable:!0})],k.prototype,"alignment",null);n([g.property()],k.prototype,"hideOnGrab",void 0);n([g.property()],k.prototype,"moveOnDrag",void 0);n([g.property()],k.prototype,"snapToPointer",void 0);n([g.property()],k.prototype,"collisionType",void 0);n([g.property({type:b.Integer})],k.prototype,"collisionPriority",void 0);n([g.property({constructOnly:!0})],k.prototype,"renderObjects",void 0);n([g.property()],k.prototype,"autoScaleRenderObjects",
void 0);n([g.property({value:!0})],k.prototype,"visible",null);n([g.property()],k.prototype,"radius",null);n([g.property()],k.prototype,"worldSized",null);n([g.property()],k.prototype,"focusMultiplier",null);n([g.property()],k.prototype,"touchMultiplier",null);n([g.property()],k.prototype,"interactive",void 0);n([g.property()],k.prototype,"selectable",void 0);n([g.property({value:!1})],k.prototype,"grabbing",null);n([g.property()],k.prototype,"dragging",void 0);n([g.property({value:!1})],k.prototype,
"hovering",null);n([g.property({value:!1})],k.prototype,"selected",null);n([g.property({value:0})],k.prototype,"state",null);n([g.property({dependsOn:["hovering","grabbing"]})],k.prototype,"focused",null);return k=n([g.subclass("esri.views.interactive.Manipulator3D")],k)}(g.declared(l));p.Manipulator3D=u;var K={include:new Set};K.include.add(E.TERRAIN_ID);var M=e.createScreenPointArray(),v=e.createRenderScreenPointArray3(),F=r.lineSegment.create(),P=r.ray.create(),R=k.mat3f64.create(),V=f.mat4f64.create(),
N=f.mat4f64.create(),O=r.plane.create(),S=B.vec3f64.create(),T=B.vec3f64.create(),Q=B.vec3f64.create(),I=B.vec3f64.create(),J=B.vec3f64.create(),W=B.vec3f64.create(),U=B.vec3f64.create()})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DModel":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/Handles ../../../../../core/mathUtils ../../../../../core/Quantity ../../../../../core/quantityUtils ../../../../../core/unitUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../geometry/Point ../../../../../geometry/support/geodesicUtils ../support/UnitNormalizer ../../../support/earthUtils ../../../support/projectionUtils ../../../support/PropertiesPool".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k,w,f,x,z,y,B,m){var C=y.earthRadius*Math.PI/180;u=function(l){function A(){var a=null!==l&&l.apply(this,arguments)||this;a._tempStartPosition=w.vec3f64.create();a._tempEndPosition=w.vec3f64.create();a._tempCornerPosition=w.vec3f64.create();a._unitNormalizer=new z;a._handles=new c;a._propertiesPool=new m.default({startPoint:f,endPoint:f},a);a.cursorPoint=null;a.state="initial";a.mode="auto";a.unit="metric";a.active=!1;a.directDistance=null;a.horizontalDistance=null;
a.verticalDistance=null;a.geodesicDistance=null;a.geodesicAngle=null;a.triangleCollapseRatioThreshold=.03;a.geodesicMeasurementDistanceThreshold=1E5;return a}n(A,l);A.prototype.initialize=function(){var a=this;this._handles.add(b.init(this.sceneView,"spatialReference",function(b){a._unitNormalizer.spatialReference=b}),"scene-view");this.reset()};A.prototype.destroy=function(){this._handles.destroy();this._handles=null;this._propertiesPool.destroy();this._propertiesPool=null};Object.defineProperty(A.prototype,
"startPoint",{set:function(a){if(a){var b=this._propertiesPool.get("startPoint");b.copy(a);this._set("startPoint",b);this._updateMeasurement()}else this._set("startPoint",null)},enumerable:!0,configurable:!0});Object.defineProperty(A.prototype,"startPointSurfaceLocation",{set:function(a){this._set("startPointSurfaceLocation",a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(A.prototype,"endPoint",{set:function(a){if(a){var b=this._propertiesPool.get("endPoint");b.copy(a);
this._set("endPoint",b);this._updateMeasurement()}else this._set("endPoint",null)},enumerable:!0,configurable:!0});Object.defineProperty(A.prototype,"endPointSurfaceLocation",{set:function(a){this._set("endPointSurfaceLocation",a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(A.prototype,"measurementSurfaceLocation",{get:function(){var a=this.startPointSurfaceLocation,b=this.endPointSurfaceLocation;return null==a||null==b||"above-the-surface"===a&&"below-the-surface"===
b||"below-the-surface"===a&&"above-the-surface"===b||"on-the-surface"===a&&"on-the-surface"===b?"camera-dependent":"above-the-surface"===a||"above-the-surface"===b?"above-the-surface":"below-the-surface"},enumerable:!0,configurable:!0});Object.defineProperty(A.prototype,"validMeasurement",{get:function(){return!!this.startPoint&&!!this.endPoint},enumerable:!0,configurable:!0});Object.defineProperty(A.prototype,"isMeasuring",{get:function(){return!!this.startPoint},enumerable:!0,configurable:!0});
Object.defineProperty(A.prototype,"geodesicDistanceExceeded",{get:function(){return this.horizontalDistance&&this.horizontalDistance.value>this.geodesicMeasurementDistanceThreshold},enumerable:!0,configurable:!0});Object.defineProperty(A.prototype,"measurementMode",{get:function(){var a=this.mode;if("auto"===a){a="euclidean";if("degrees"===this.unit||"degrees-minutes-seconds"===this.unit)a="geodesic";this.geodesicDistanceExceeded&&(a="geodesic")}return a},enumerable:!0,configurable:!0});Object.defineProperty(A.prototype,
"triangleView",{get:function(){var a=this._collapseTriangle(),b=null,d=null,m=null,f=this.directDistance,d="geodesic"===this.measurementMode?this.geodesicDistance:this.horizontalDistance,c=this.verticalDistance,v=null;switch(this.unit){case "metric":b=f&&e.formatMetricLength(f);d=d&&e.formatMetricLength(d);m=c&&e.formatMetricVerticalLength(c);v=f&&f.toUnit("meters");break;case "imperial":b=f&&e.formatImperialLength(f);d=d&&e.formatImperialLength(d);m=c&&e.formatImperialVerticalLength(c);v=f&&f.toUnit(g.preferredImperialLengthUnit(f.value,
f.unit));break;case "degrees":d=this.geodesicAngle&&e.formatDecimal(this.geodesicAngle,"degrees");v=this.geodesicAngle&&this.geodesicAngle.toUnit("degrees");break;case "degrees-minutes-seconds":d=this.geodesicAngle&&e.formatDMS(this.geodesicAngle);v=this.geodesicAngle&&this.geodesicAngle.toUnit("degrees");break;default:b=f&&e.formatDecimal(f,this.unit),d=d&&e.formatDecimal(d,this.unit),m=c&&e.formatDecimal(c,this.unit),v=f&&f.toUnit(this.unit)}f=1;v&&(f=q.nextHighestPowerOfTen(v.value/30),f*="degrees"===
v.unit?C:g.convertUnit(1,v.unit,"meters"),f/=this._unitNormalizer.normalizeDistance(1));return{visible:this.validMeasurement&&!this.startPoint.equals(this.endPoint),mode:this.measurementMode,collapsed:a,directLabel:b,horizontalLabel:d,verticalLabel:m,stripeLength:f}},enumerable:!0,configurable:!0});A.prototype.reset=function(){this.clearMeasurement()};A.prototype.clearMeasurement=function(){this.state="initial";this.cursorPoint=this.endPoint=this.startPoint=null;this._clearOverride("measurementSurfaceLocation");
this._updateMeasurement()};A.prototype.finishedMeasurement=function(a){if(!this._isOverridden("measurementSurfaceLocation")){var b=this.measurementSurfaceLocation;this._override("measurementSurfaceLocation","camera-dependent"===b?a.cameraAboveGround?"above-the-surface":"below-the-surface":b)}this.state="measured"};A.prototype._collapseTriangle=function(){return!this.validMeasurement||this.startPoint.equals(this.endPoint)||"geodesic"===this.measurementMode?!0:Math.min(this.verticalDistance.value/this.horizontalDistance.value,
this.horizontalDistance.value/this.verticalDistance.value)<this.triangleCollapseRatioThreshold};A.prototype._exactGeodesicDistanceAndAngle=function(a,b){B.pointToWGS84ComparableLonLat(a,r);B.pointToWGS84ComparableLonLat(b,t);a=q.deg2rad(r[0]);b=q.deg2rad(r[1]);var d=q.deg2rad(t[0]),e=q.deg2rad(t[1]);a=q.acosClamped(Math.sin(b)*Math.sin(e)+Math.cos(b)*Math.cos(e)*Math.cos(Math.abs(d-a)));a=q.rad2deg(a);b={distance:0};x.inverseGeodeticSolver(b,[r[0],r[1]],[t[0],t[1]]);return{distance:new h(b.distance,
"meters"),angle:new h(a,"degrees")}};A.prototype._approximateGeodesicDistanceAndAngle=function(a){return{distance:new h(a,"meters"),angle:new h(a/C,"degrees")}};A.prototype._euclideanDistances=function(a,b){a.z>b.z&&(a=[a,a=b][0]);var d=a.clone();d.z=b.z;var e=this._tempStartPosition,f=this._tempEndPosition,m=this._tempCornerPosition,c=this.sceneView.spatialReference,c=B.canProject(c,B.WGS84ECEFSpatialReference)?B.WGS84ECEFSpatialReference:c;B.pointToVector(a,e,c);B.pointToVector(b,f,c);B.pointToVector(d,
m,c);d=k.vec3.distance(e,f);f=k.vec3.distance(m,f);a=Math.abs(b.z-a.z);d=this._unitNormalizer.normalizeDistance(d);f=this._unitNormalizer.normalizeDistance(f);a=this._unitNormalizer.normalizeElevation(a);return{direct:new h(d,"meters"),horizontal:new h(f,"meters"),vertical:new h(a,"meters")}};A.prototype._updateMeasurement=function(){if(this.startPoint&&this.endPoint){var a=this._euclideanDistances(this.startPoint,this.endPoint),b=B.canProjectToWGS84ComparableLonLat(this.sceneView.spatialReference)?
this._exactGeodesicDistanceAndAngle(this.startPoint,this.endPoint):this._approximateGeodesicDistanceAndAngle(a.horizontal.value);this._set("directDistance",a.direct);this._set("horizontalDistance",a.horizontal);this._set("verticalDistance",a.vertical);this._set("geodesicDistance",b.distance);this._set("geodesicAngle",b.angle)}else this._set("directDistance",null),this._set("horizontalDistance",null),this._set("verticalDistance",null),this._set("geodesicDistance",null),this._set("geodesicAngle",null)};
a([d.property({constructOnly:!0})],A.prototype,"sceneView",void 0);a([d.property({value:null})],A.prototype,"startPoint",null);a([d.property({value:null})],A.prototype,"startPointSurfaceLocation",null);a([d.property({value:null})],A.prototype,"endPoint",null);a([d.property({value:null})],A.prototype,"endPointSurfaceLocation",null);a([d.property({dependsOn:["startPointSurfaceLocation","endPointSurfaceLocation"]})],A.prototype,"measurementSurfaceLocation",null);a([d.property()],A.prototype,"cursorPoint",
void 0);a([d.property()],A.prototype,"state",void 0);a([d.property()],A.prototype,"mode",void 0);a([d.property()],A.prototype,"unit",void 0);a([d.property()],A.prototype,"active",void 0);a([d.property({readOnly:!0,dependsOn:["startPoint","endPoint"]})],A.prototype,"validMeasurement",null);a([d.property({readOnly:!0,dependsOn:["startPoint"]})],A.prototype,"isMeasuring",null);a([d.property({readOnly:!0})],A.prototype,"directDistance",void 0);a([d.property({readOnly:!0})],A.prototype,"horizontalDistance",
void 0);a([d.property({readOnly:!0})],A.prototype,"verticalDistance",void 0);a([d.property({readOnly:!0})],A.prototype,"geodesicDistance",void 0);a([d.property({readOnly:!0})],A.prototype,"geodesicAngle",void 0);a([d.property({readOnly:!0,dependsOn:["horizontalDistance","geodesicMeasurementDistanceThreshold"]})],A.prototype,"geodesicDistanceExceeded",null);a([d.property({readOnly:!0,dependsOn:["horizontalDistance","unit","geodesicDistanceExceeded"]})],A.prototype,"measurementMode",null);a([d.property({readOnly:!0,
dependsOn:["unit","measurementMode","startPoint","endPoint","triangleCollapseRatioThreshold"]})],A.prototype,"triangleView",null);a([d.property()],A.prototype,"triangleCollapseRatioThreshold",void 0);a([d.property()],A.prototype,"geodesicMeasurementDistanceThreshold",void 0);return A=a([d.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DModel")],A)}(d.declared(l));var r=w.vec3f64.create(),t=w.vec3f64.create();return u})},"esri/core/Quantity":function(){define(["require",
"exports","./unitFormatUtils","./unitUtils"],function(u,p,n,a){return function(){function l(c,q){this.measure=a.measureForUnit(q);this.value=c;this.unit=q}Object.defineProperty(l.prototype,"isBaseUnit",{get:function(){return a.isBaseUnit(this.unit)},enumerable:!0,configurable:!0});l.prototype.toUnit=function(c){return new l(a.convertUnit(this.value,this.unit,c),c)};l.prototype.toBaseUnit=function(){return this.toUnit(a.baseUnitForUnit(this.unit))};l.prototype.toDecimalString=function(a,q){void 0===
a&&(a=2);return n.formatDecimal(this.value,this.unit,a,q)};return l}()})},"esri/core/unitFormatUtils":function(){define(["require","exports","dojo/i18n!./nls/Units","./unitUtils","../intl/number"],function(u,p,n,a,l){function c(a,e){return n.units[a][e]}function q(a,e,g,b){void 0===g&&(g=2);void 0===b&&(b="abbr");return l.formatNumber(a,{minimumFractionDigits:g,maximumFractionDigits:g})+" "+c(e,b)}Object.defineProperty(p,"__esModule",{value:!0});p.unitName=c;p.formatDecimal=q;p.formatMetricLength=
function(c,e,g,b){void 0===g&&(g=2);void 0===b&&(b="abbr");var d=a.preferredMetricLengthUnit(c,e);return q(a.convertUnit(c,e,d),d,g,b)};p.formatMetricVerticalLength=function(c,e,g,b){void 0===g&&(g=2);void 0===b&&(b="abbr");var d=a.preferredMetricVerticalLengthUnit(c,e);return q(a.convertUnit(c,e,d),d,g,b)};p.formatImperialLength=function(c,e,g,b){void 0===g&&(g=2);void 0===b&&(b="abbr");var d=a.preferredImperialLengthUnit(c,e);return q(a.convertUnit(c,e,d),d,g,b)};p.formatImperialVerticalLength=
function(c,e,g,b){void 0===g&&(g=2);void 0===b&&(b="abbr");var d=a.preferredImperialVerticalLengthUnit(c,e);return q(a.convertUnit(c,e,d),d,g,b)};p.formatMetricArea=function(c,e,g,b){void 0===g&&(g=2);void 0===b&&(b="abbr");var d=a.preferredMetricAreaUnit(c,e);return q(a.convertUnit(c,e,d),d,g,b)};p.formatImperialArea=function(c,e,g,b){void 0===g&&(g=2);void 0===b&&(b="abbr");var d=a.preferredImperialAreaUnit(c,e);return q(a.convertUnit(c,e,d),d,g,b)};p.formatDMS=function(c,e,g){void 0===g&&(g=2);
c=a.convertUnit(c,e,"degrees");e=c-Math.floor(c);c-=e;e*=60;var b=e-Math.floor(e);e-=b;b*=60;return c.toFixed()+"\u00b0 "+e.toFixed()+"' "+b.toFixed(g)+'"'}})},"esri/core/quantityUtils":function(){define(["require","exports","./unitFormatUtils"],function(u,p,n){Object.defineProperty(p,"__esModule",{value:!0});p.formatDecimal=function(a,l,c,q){void 0===c&&(c=2);void 0===q&&(q="abbr");return n.formatDecimal(a.toUnit(l).value,l,c,q)};p.formatMetricLength=function(a,l,c){void 0===l&&(l=2);void 0===c&&
(c="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return n.formatMetricLength(a.value,a.unit,l,c)};p.formatMetricVerticalLength=function(a,l,c){void 0===l&&(l=2);void 0===c&&(c="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return n.formatMetricVerticalLength(a.value,a.unit,l,c)};p.formatMetricArea=function(a,l,c){void 0===l&&(l=2);void 0===c&&(c="abbr");if("area"!==a.measure)throw Error("quantity is not an area");return n.formatMetricArea(a.value,
a.unit,l,c)};p.formatImperialLength=function(a,l,c){void 0===l&&(l=2);void 0===c&&(c="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return n.formatImperialLength(a.value,a.unit,l,c)};p.formatImperialVerticalLength=function(a,l,c){void 0===l&&(l=2);void 0===c&&(c="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return n.formatImperialVerticalLength(a.value,a.unit,l,c)};p.formatImperialArea=function(a,l,c){void 0===l&&(l=2);void 0===c&&(c="abbr");if("area"!==
a.measure)throw Error("quantity is not an area");return n.formatImperialArea(a.value,a.unit,l,c)};p.formatDMS=function(a){if("angle"!==a.measure)throw Error("quantity is not an angle");return n.formatDMS(a.value,a.unit)}})},"esri/geometry/support/geodesicUtils":function(){define("require exports @dojo/framework/shim/object ../. ../../core/Error ../../core/Logger ../../core/unitUtils".split(" "),function(u,p,n,a,l,c,q){function h(a){if(!a||!a.isGeographic)return null;if(a.wkid){var b=B[a.wkid];if(b)return b}if(a.wkt){a=
y.exec(a.wkt);if(!a||2!==a.length)return null;b=a[1].split(",");if(!b||3!==b.length)return null;a=parseFloat(b[1]);b=parseFloat(b[2]);return isNaN(a)||isNaN(b)?null:{a:a,f:0===b?0:1/b}}return null}function e(a){a=h(a||z);if("b"in a&&"eSq"in a&&"radius"in a)return a;var b=a.a*(1-a.f);return n.assign(a,{b:b,eSq:1-Math.pow(b/a.a,2),radius:(2*a.a+b)/3})}function g(a,b,d){var c=e(d);d=c.a;var c=c.eSq,f=Math.sqrt(c),m=Math.sin(b[1]*x);b=d*b[0]*x;d=0<c?d*(1-c)*(m/(1-c*m*m)-1/(2*f)*Math.log((1-f*m)/(1+f*
m)))*.5:d*m;a[0]=b;a[1]=d;return a}function b(a){return null!==h(a)}function d(d,c){if("polyline"!==d.type&&"polygon"!==d.type)throw f.error("invalid geometry: the input geometry is neither polyline nor polygon"),new l("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");var m=d.spatialReference;if(!b(m))throw f.error("invalid spatialreference: the input geometry spatialreference is not supported"),new l("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");
var g=e(m).radius/1E4;c<g&&(c=g);for(var g=[],h=[0,0],q={distance:null},n=0,x="polyline"===d.type?d.paths:d.rings;n<x.length;n++){var C=x[n],p=[];g.push(p);p.push([C[0][0],C[0][1]]);for(var y=C[0][0],z=C[0][1],v=void 0,F=void 0,B=0;B<C.length-1;B++)if(v=C[B+1][0],F=C[B+1][1],y!==v||z!==F){var u=[y,z];w(q,[y,z],[v,F],m);y=q.azimuth;z=q.distance;v=z/c;if(1<v){for(F=1;F<=v-1;F++)k(h,u,y,F*c,m),p.push(h.slice(0));k(h,u,y,(z+Math.floor(v-1)*c)/2,m);p.push(h.slice(0))}k(h,u,y,z,m);p.push(h.slice(0));y=
h[0];z=h[1]}}return"polyline"===d.type?new a.Polyline({paths:g,spatialReference:m}):new a.Polygon({rings:g,spatialReference:m})}function k(a,b,d,c,f){var m=b[0]*x,g=b[1]*x;b=d*x;f=e(f);var h=f.a,t=f.b;f=f.f;d=Math.sin(b);b=Math.cos(b);for(var q=(1-f)*Math.tan(g),g=1/Math.sqrt(1+q*q),l=q*g,k=Math.atan2(q,b),q=g*d,v=q*q,r=1-v,h=r*(h*h-t*t)/(t*t),n=1+h/16384*(4096+h*(-768+h*(320-175*h))),A=h/1024*(256+h*(-128+h*(74-47*h))),h=c/(t*n),p=2*Math.PI,C,y,z,w;1E-12<Math.abs(h-p);)z=Math.cos(2*k+h),C=Math.sin(h),
y=Math.cos(h),w=A*C*(z+A/4*(y*(-1+2*z*z)-A/6*z*(-3+4*C*C)*(-3+4*z*z))),p=h,h=c/(t*n)+w;c=l*C-g*y*b;t=f/16*r*(4+f*(4-3*r));c=Math.atan2(l*y+g*C*b,(1-f)*Math.sqrt(v+c*c))/x;m=(m+(Math.atan2(C*d,g*y-l*C*b)-(1-t)*f*q*(h+t*C*(z+t*y*(-1+2*z*z)))))/x;a.splice(0,a.length);a.push(m,c);return a}function w(a,b,d,c){var f=b[0]*x;b=b[1]*x;var m=d[0]*x;d=d[1]*x;var g=e(c),h=g.a;c=g.b;var t=g.f,q=g.radius,l=m-f,k=Math.atan((1-t)*Math.tan(b)),v=Math.atan((1-t)*Math.tan(d)),g=Math.sin(k),k=Math.cos(k),r=Math.sin(v),
v=Math.cos(v),n=1E3,p=l,C,y,z,w,B,u,I,J;do{w=Math.sin(p);B=Math.cos(p);z=Math.sqrt(v*w*v*w+(k*r-g*v*B)*(k*r-g*v*B));if(0===z)return{distance:0};B=g*r+k*v*B;u=Math.atan2(z,B);I=k*v*w/z;y=1-I*I;w=B-2*g*r/y;isNaN(w)&&(w=0);J=t/16*y*(4+t*(4-3*y));C=p;p=l+(1-J)*t*I*(u+J*z*(w+J*B*(-1+2*w*w)))}while(1E-12<Math.abs(p-C)&&0<--n);if(0===n)return a=m-f,{azimuth:Math.atan2(Math.sin(a)*Math.cos(d),Math.cos(b)*Math.sin(d)-Math.sin(b)*Math.cos(d)*Math.cos(a))/x,distance:Math.acos(Math.sin(b)*Math.sin(d)+Math.cos(b)*
Math.cos(d)*Math.cos(m-f))*q};f=y*(h*h-c*c)/(c*c);b=f/1024*(256+f*(-128+f*(74-47*f)));m=Math.atan2(k*Math.sin(p),k*r*Math.cos(p)-g*v);a.azimuth=Math.atan2(v*Math.sin(p),k*r-g*v*Math.cos(p))/x;a.distance=c*(1+f/16384*(4096+f*(-768+f*(320-175*f))))*(u-b*z*(w+b/4*(B*(-1+2*w*w)-b/6*w*(-3+4*z*z)*(-3+4*w*w))));a.reverseAzimuth=m/x;return a}Object.defineProperty(p,"__esModule",{value:!0});var f=c.getLogger("esri.geometry.support.geodesicUtils"),x=Math.PI/180,z=a.SpatialReference.WGS84,y=/SPHEROID\[([^\]]+)]/i,
B={4326:{a:6378137,f:1/298.257223563},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:1737400,f:0},104904:{a:3393400,f:.005207166853303471},104905:{a:3396190,f:.005886007555525457},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},
104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,
f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,
f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:3396190,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};p.isSupported=b;p.geodesicAreas=function(a,c){void 0===c&&(c="square-meters");if(a.some(function(a){return!b(a.spatialReference)}))throw f.error("invalid spatialreference: the input geometries spatialreference is not supported"),new l("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");
for(var m=[],h=0;h<a.length;h++){var k=a[h],n=k.spatialReference,n=.0015696101447650193*e(n).radius;m.push(d(k,n))}a=[];for(var h=[0,0],k=[0,0],x=0;x<m.length;x++){for(var n=m[x],p=n.rings,n=n.spatialReference,y=0,C=0;C<p.length;C++){var z=p[C];g(h,z[0],n);g(k,z[z.length-1],n);for(var w=k[0]*h[1]-h[0]*k[1],v=0;v<z.length-1;v++)g(h,z[v+1],n),g(k,z[v],n),w+=k[0]*h[1]-h[0]*k[1];y+=w}y=q.convertUnit(y,"square-meters",c);a.push(y/-2)}return a};p.geodesicLengths=function(a,d){void 0===d&&(d="meters");if(!a&&
!a)throw f.error("invalid geometry type: the input geometries type is not supported"),new l("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(a.some(function(a){return!b(a.spatialReference)}))throw f.error("invalid spatialreference: the input geometries spatialreference is not supported"),new l("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var c=[],e=0;e<a.length;e++){for(var m=a[e],g=m.spatialReference,
m="polyline"===m.type?m.paths:m.rings,h=0,k=0;k<m.length;k++){for(var n=m[k],x=0,p=1;p<n.length;p++){var y=n[p-1][0],v=n[p][0],z=n[p-1][1],C=n[p][1];if(z!==C||y!==v){var B={distance:null};w(B,[y,z],[v,C],g);x+=B.distance}}h+=x}h=q.convertUnit(h,"meters",d);c.push(h)}return c};p.geodesicDensify=d;p.directGeodeticSolver=k;p.inverseGeodeticSolver=w;p.geodesicDistance=function(a,d,c){void 0===c&&(c="meters");if(!a||!d)throw a="one or both input parameters are missing",f.error("missing-parameters: "+a),
new l("geodesic-distance:missing-parameters",a);if(!a.spatialReference||!d.spatialReference)throw a="one or both input points do not have a spatial reference",f.error("invalid-parameters: "+a),new l("geodesic-distance:invalid-parameters",a);if(!a.spatialReference.equals(d.spatialReference))throw a="spatial references of input parameters do not match",f.error("invalid-parameters: "+a),new l("geodesic-distance:invalid-parameters",a);var e=a.spatialReference;if(!b(e))throw a="spatial references is not supported",
f.error("not-supported: "+a),new l("geodesic-distance:not-supported",a);if(a.equals(d))return{distance:0,azimuth:0,reverseAzimuth:0};var g={distance:null};w(g,[a.x,a.y],[d.x,d.y],e);g.distance=q.convertUnit(g.distance,"meters",c);return g};p.pointFromDistance=function(d,c,e){if(!d||null==c||null==e)throw d="one or more input parameters are missing or undefined",f.error("missing-parameters: "+d),new l("point-from-distance:missing-parameters",d);if(0>e||360<e)throw d="azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees",
f.error("out-of-bounds: "+d),new l("point-from-distance:-of-bounds",d);if(!d.spatialReference)throw d="the input point must have a spatial reference",f.error("missing-spatial-reference: "+d),new l("point-from-distance:missing-spatial-reference",d);var g=d.spatialReference;if(!b(g))throw d="spatial references is not supported",f.error("not-supported: "+d),new l("geodesic-distance:not-supported",d);var m=[0,0];k(m,[d.x,d.y],e,c,g);return new a.Point({x:m[0],y:m[1],spatialReference:g})}})},"@dojo/framework/shim/object":function(){(function(u){"object"===
typeof module&&"object"===typeof module.exports?(u=u(require,exports),void 0!==u&&(module.exports=u)):"function"===typeof define&&define.amd&&define(["require","exports","./global","../has/has","./Symbol"],u)})(function(u,p){Object.defineProperty(p,"__esModule",{value:!0});var n=u("./global"),a=u("../has/has"),l=u("./Symbol");a.default("es6-object")?(u=n.default.Object,p.assign=u.assign,p.getOwnPropertyDescriptor=u.getOwnPropertyDescriptor,p.getOwnPropertyNames=u.getOwnPropertyNames,p.getOwnPropertySymbols=
u.getOwnPropertySymbols,p.is=u.is,p.keys=u.keys):(p.keys=function(a){return Object.keys(a).filter(function(a){return!a.match(/^@@.+/)})},p.assign=function(a){for(var c=[],h=1;h<arguments.length;h++)c[h-1]=arguments[h];if(null==a)throw new TypeError("Cannot convert undefined or null to object");var e=Object(a);c.forEach(function(a){a&&p.keys(a).forEach(function(b){e[b]=a[b]})});return e},p.getOwnPropertyDescriptor=function(a,q){l.isSymbol(q);return Object.getOwnPropertyDescriptor(a,q)},p.getOwnPropertyNames=
function(a){return Object.getOwnPropertyNames(a).filter(function(a){return!a.match(/^@@.+/)})},p.getOwnPropertySymbols=function(a){return Object.getOwnPropertyNames(a).filter(function(a){return!!a.match(/^@@.+/)}).map(function(a){return Symbol.for(a.substring(2))})},p.is=function(a,q){return a===q?0!==a||1/a===1/q:a!==a&&q!==q});a.default("es2017-object")?(u=n.default.Object,p.getOwnPropertyDescriptors=u.getOwnPropertyDescriptors,p.entries=u.entries,p.values=u.values):(p.getOwnPropertyDescriptors=
function(a){return p.getOwnPropertyNames(a).reduce(function(c,h){c[h]=p.getOwnPropertyDescriptor(a,h);return c},{})},p.entries=function(a){return p.keys(a).map(function(c){return[c,a[c]]})},p.values=function(a){return p.keys(a).map(function(c){return a[c]})})})},"esri/views/3d/interactive/measurementTools/support/UnitNormalizer":function(){define(["require","exports","../../../../../core/unitUtils"],function(u,p,n){return function(){function a(a){void 0===a&&(a=null);this.spatialReference=a;this._updateNormalizationFactors}
Object.defineProperty(a.prototype,"spatialReference",{get:function(){return this._spatialReference},set:function(a){a!==this._spatialReference&&(this._spatialReference=a,this._updateNormalizationFactors())},enumerable:!0,configurable:!0});a.prototype.normalizeDistance=function(a){return a*this._metersPerDistanceUnit};a.prototype.normalizeElevation=function(a){return a*this._metersPerElevationUnit};a.prototype.normalizeArea=function(a){return a*this._squareMetersPerAreaUnit};a.prototype._updateNormalizationFactors=
function(){this._metersPerDistanceUnit=n.getMetersPerUnitForSR(this._spatialReference,1);this._metersPerElevationUnit=n.getMetersPerUnitForSR(this._spatialReference,1);this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit};return a}()})},"esri/views/interactive/InteractiveToolBase":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/accessorSupport/decorators ./interactiveToolUtils ./ManipulatorCollection".split(" "),
function(u,p,n,a,l,c,q,h,e){Object.defineProperty(p,"__esModule",{value:!0});u=function(g){function b(a){a=g.call(this,a)||this;a.manipulators=new e.ManipulatorCollection;a._attached=!1;a._editableFlags=[];a._manipulatorHandles=new c;return a}n(b,g);Object.defineProperty(b.prototype,"active",{get:function(){return null!=this.view&&this.view.activeTool===this},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isSupported",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"visible",{set:function(a){this._set("visible",a);this._attached&&(a?this._show():this._hide())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"editable",{get:function(){return this.hasEditableFlag(0)},set:function(a){this.setEditableFlag(0,a)},enumerable:!0,configurable:!0});b.prototype.attach=function(){if(!this._attached&&this.isSupported){this.manipulators.attach();this.onAttach();if(this.visible)this.onShow();this._attached=!0}};b.prototype.detach=function(){this._attached&&
(this.onHide(),this.onDetach(),this.manipulators.detach(),this._manipulatorHandles.removeAll(),this._attached=!1)};b.prototype.handleInputEvent=function(a){if(this._attached)this.onInputEvent(a)};b.prototype.destroy=function(){this.manipulators.destroy();this._manipulatorHandles.removeAll();this._manipulatorHandles=null;this._set("view",null)};b.prototype.setEditableFlag=function(a,b){this._editableFlags[a]=b;this.manipulators.isToolEditable=this._editableFlags.every(function(a){return null==a||a});
this._updateManipulatorAttachment();0===a&&this.notifyChange("editable");this.onEditableChange()};b.prototype.hasEditableFlag=function(a){a=this._editableFlags[a];return null==a?!0:a};b.prototype.onAttach=function(){};b.prototype.onDetach=function(){};b.prototype.onShow=function(){};b.prototype.onHide=function(){};b.prototype.onEditableChange=function(){};b.prototype.onInputEvent=function(a){};Object.defineProperty(b.prototype,"internallyEditable",{get:function(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)},
enumerable:!0,configurable:!0});b.prototype._show=function(){this._updateManipulatorAttachment();this.onShow()};b.prototype._hide=function(){h.setActive(this,!1);this._updateManipulatorAttachment();this.onHide()};b.prototype._updateManipulatorAttachment=function(){this.visible?this.manipulators.attach():this.manipulators.detach()};a([q.property({constructOnly:!0})],b.prototype,"view",void 0);a([q.property({dependsOn:["view.activeTool"],readOnly:!0})],b.prototype,"active",null);a([q.property({value:!0})],
b.prototype,"visible",null);a([q.property({value:!0})],b.prototype,"editable",null);a([q.property({readOnly:!0})],b.prototype,"manipulators",void 0);return b=a([q.subclass("esri.views.interactive.InteractiveToolBase")],b)}(q.declared(l));p.InteractiveToolBase=u})},"esri/views/interactive/ManipulatorCollection":function(){define(["require","exports","../../core/tsSupport/decorateHelper","../../core/Collection","../../core/maybe"],function(u,p,n,a,l){Object.defineProperty(p,"__esModule",{value:!0});
u=function(){function c(){this._isToolEditable=!0;this._manipulators=new a;this._nextManipulatorId=0;this._resourceContexts={manipulator3D:{}};this._attached=!1}Object.defineProperty(c.prototype,"isToolEditable",{set:function(a){this._isToolEditable=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"length",{get:function(){return this._manipulators.length},enumerable:!0,configurable:!0});c.prototype.add=function(a,c){void 0===c&&(c=0);return this.addMany([a],c)[0]};c.prototype.addMany=
function(a,c){var e=this;void 0===c&&(c=0);return a.map(function(a){var b=e._nextManipulatorId++;a={id:b,manipulator:a,visibilityPredicate:c,attached:!1};e._manipulators.add(a);e._attached&&e._updateManipulatorAttachment(a);return b})};c.prototype.remove=function(a){if("number"===typeof a){for(var c=0;c<this._manipulators.length;c++)if(this._manipulators.getItemAt(c).id===a)return a=this._manipulators.splice(c,1)[0],this._detachManipulator(a),a.id;return null}for(c=0;c<this._manipulators.length;c++)if(this._manipulators.getItemAt(c).manipulator===
a)return a=this._manipulators.splice(c,1)[0],this._detachManipulator(a),a.id;return null};c.prototype.removeAll=function(){var a=this;this._manipulators.forEach(function(c){a._detachManipulator(c)});this._manipulators.removeAll()};c.prototype.attach=function(){var a=this;this._manipulators.forEach(function(c){a._updateManipulatorAttachment(c)});this._attached=!0};c.prototype.detach=function(){var a=this;this._manipulators.forEach(function(c){a._detachManipulator(c)});this._attached=!1};c.prototype.destroy=
function(){this._manipulators.forEach(function(a){a=a.manipulator;a.destroy&&a.destroy()});this._manipulators.destroy();this._resourceContexts=null};c.prototype.on=function(a,c){return this._manipulators.on("change",function(a){c(a)})};c.prototype.forEach=function(a){for(var c=0,e=this._manipulators.items;c<e.length;c++)a(e[c])};c.prototype.intersect=function(a,c){var e=null,g=Number.MAX_VALUE;this._manipulators.forEach(function(b){var d=b.id,h=b.manipulator;b.attached&&h.interactive&&(b=h.intersectionDistance(a,
c),l.isSome(b)&&b<g&&(g=b,e=d))});return e};c.prototype.findById=function(a){if(l.isNone(a))return null;for(var c=0,e=this._manipulators.items;c<e.length;c++){var g=e[c];if(a===g.id)return g.manipulator}return null};c.prototype._updateManipulatorAttachment=function(a){this._isManipulatorItemVisible(a)?this._attachManipulator(a):this._detachManipulator(a)};c.prototype._attachManipulator=function(a){a.attached||(a.manipulator.attach(this._resourceContexts),a.attached=!0)};c.prototype._detachManipulator=
function(a){if(a.attached){var c=a.manipulator;c.grabbing=!1;c.dragging=!1;c.hovering=!1;c.selected=!1;c.detach(this._resourceContexts);a.attached=!1}};c.prototype._isManipulatorItemVisible=function(a){return 2===a.visibilityPredicate?!0:this._isToolEditable?0===a.visibilityPredicate:1===a.visibilityPredicate};return c}();p.ManipulatorCollection=u})},"esri/widgets/support/commonProperties":function(){define(["require","exports","../../core/unitUtils"],function(u,p,n){Object.defineProperty(p,"__esModule",
{value:!0});p.defaultUnitPropertyMetadata={dependsOn:["view.map.portalItem.portal.units","view.map.portalItem.portal.user.units","view.spatialReference"],readOnly:!0,get:function(){var a=this.view;if(!a)return"metric";var l=a.get("map.portalItem.portal");if(l)switch(l.get("user.units")||l.units){case "metric":return"metric";case "english":return"imperial"}return n.getDefaultUnitSystem(a.spatialReference)||"metric"}}})},"esri/widgets/support/InteractiveToolViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/interactive/interactiveToolUtils".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d){return function(h){function k(a){var b=h.call(this)||this;b.tool=null;b._baseHandles=new e;b._loggedUnsupportedErrorOnce=!1;b._createPromise=null;a&&null!=a.visible&&(b.visible=a.visible);return b}n(k,h);k.prototype.initialize=function(){var a=this;this._baseHandles.add(g.init(this,["view.ready","isSupported"],function(){a.view&&a.view.ready&&!a.isSupported?a._loggedUnsupportedErrorOnce||(a.logUnsupportedError(),a._loggedUnsupportedErrorOnce=!0):a._loggedUnsupportedErrorOnce=
!1}))};k.prototype.destroy=function(){this.tool&&(d.setActive(this.tool,!1),this.view&&this.view.tools.remove(this.tool),this.tool.destroy(),this._set("tool",null));this.view=null;this._baseHandles.destroy();this._createPromise=this._baseHandles=null};Object.defineProperty(k.prototype,"isSupported",{get:function(){return!this.view||this.view.type===this.supportedViewType},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"view",{get:function(){return this._get("view")},set:function(a){this._createToolOnView(a);
this._set("view",a)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"visible",{set:function(a){this._set("visible",a);this.tool&&(this.tool.visible=a)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"active",{get:function(){return null!=this.tool&&this.tool.active},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"isDisabled",{get:function(){return!this.tool||!this.view||!this.view.ready||!this.isSupported},enumerable:!0,configurable:!0});k.prototype._createToolOnView=
function(a){return c(this,void 0,void 0,function(){var b,d,c,e=this;return l(this,function(f){switch(f.label){case 0:return a!==this.view&&this.view&&(this.tool&&(this.view.removeTool(this.tool),this.tool.destroyed||this.tool.destroy(),this._set("tool",null)),this._createPromise&&(this._createPromise=null)),this._createPromise?[4,this._createPromise]:[3,2];case 1:f.sent(),f.label=2;case 2:return a&&(b=this.createToolParams(),d=q({visible:this.visible},b.constructorArguments),c=this._createPromise=
a.createTool(b.toolConstructor,d,this.tool),c.then(function(a){e._createPromise===c&&e._set("tool",a)})),[2]}})})};a([b.property({constructOnly:!0})],k.prototype,"tool",void 0);a([b.property({dependsOn:["view.type"]})],k.prototype,"isSupported",null);a([b.property({value:null})],k.prototype,"view",null);a([b.property({type:Boolean,value:!0})],k.prototype,"visible",null);a([b.property({dependsOn:["tool.active"]})],k.prototype,"active",null);a([b.property({dependsOn:["tool","view","view.ready","isSupported"]})],
k.prototype,"isDisabled",null);return k=a([b.subclass("esri.widgets.support.InteractiveToolViewModel")],k)}(b.declared(h))})},"esri/widgets/AreaMeasurement3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./AreaMeasurement3D/nls/AreaMeasurement3D ../core/accessorSupport/decorators ./Widget ./AreaMeasurement3D/AreaMeasurement3DViewModel ./support/widget".split(" "),function(u,p,n,a,l,c,q,h,e){return function(g){function b(a){a=
g.call(this)||this;a.view=null;a.visible=null;a.iconClass="esri-icon-measure-area";a.viewModel=new h;a.unitOptions=null;a.unit=null;return a}n(b,g);b.prototype.render=function(){var a=this,b=this.viewModel.isSupported,c=this.viewModel.active,f="disabled"===this.viewModel.state,g="ready"===this.viewModel.state,h="measuring"===this.viewModel.state||"measured"===this.viewModel.state,n=this.viewModel.measurement,g=c&&g?e.tsx("section",{key:"esri-area-measurement-3d__hint",class:"esri-area-measurement-3d__hint"},
e.tsx("p",{class:"esri-area-measurement-3d__hint-text"},l.hint)):null,q=b?null:e.tsx("section",{key:"esri-area-measurement-3d__unsupported",class:"esri-area-measurement-3d__panel--error"},e.tsx("p",null,l.unsupported)),m=function(b,d,c){switch(d.state){case "available":return e.tsx("div",{key:c+"-enabled",class:"esri-area-measurement-3d__measurement-item"},e.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b),e.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},
d.text));case "unavailable":return e.tsx("div",{key:c+"-disabled",class:a.classes("esri-area-measurement-3d__measurement-item","esri-area-measurement-3d__measurement-item--disabled")},e.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b));case "invalid":return e.tsx("div",{key:c+"-enabled",class:"esri-area-measurement-3d__measurement-item"},e.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b),e.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},
l.notApplicable))}},n=h?e.tsx("section",{key:"esri-area-measurement-3d__measurement",class:"esri-area-measurement-3d__measurement"},m(l.area,n.area,"area"),m(l.perimeterLength,n.perimeterLength,"perimeter-length")):null,p=this.id+"__units",m=e.tsx("label",{class:"esri-area-measurement-3d__units-label",for:p},l.unit),p=e.tsx("div",{class:"esri-area-measurement-3d__units-select-wrapper"},e.tsx("select",{class:"esri-area-measurement-3d__units-select esri-select",id:p,onchange:this._changeUnit,bind:this},
this.viewModel.unitOptions.map(function(b){return b===a.viewModel.unit?e.tsx("option",{key:b,value:b,selected:!0},l.units[b]):e.tsx("option",{key:b,value:b},l.units[b])}))),m=h?e.tsx("section",{key:"esri-area-measurement-3d__units",class:"esri-area-measurement-3d__units"},m,p):null,m=h?e.tsx("div",{key:"settings",class:"esri-area-measurement-3d__settings"},m):null,b=!b||c&&!h?null:e.tsx("div",{class:"esri-area-measurement-3d__actions"},e.tsx("button",{disabled:f,class:this.classes("esri-button esri-button--secondary",
"esri-area-measurement-3d__clear-button",f&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement},l.newMeasurement)),b=this.visible?e.tsx("div",{class:"esri-area-measurement-3d__container"},q,g,m,n,b):null;return e.tsx("div",{key:"",class:"esri-area-measurement-3d esri-widget esri-widget--panel",role:"presentation"},b)};b.prototype._newMeasurement=function(){this.viewModel.newMeasurement()};b.prototype._changeUnit=function(a){a=a.target;if(a=a.options[a.selectedIndex])this.unit=a.value};
a([c.aliasOf("viewModel.view")],b.prototype,"view",void 0);a([c.aliasOf("viewModel.visible"),e.renderable()],b.prototype,"visible",void 0);a([c.aliasOf("viewModel.active"),e.renderable()],b.prototype,"active",void 0);a([c.property()],b.prototype,"iconClass",void 0);a([c.property({type:h}),e.renderable(["viewModel.state","viewModel.unitOptions","viewModel.unit","viewModel.measurement"])],b.prototype,"viewModel",void 0);a([c.aliasOf("viewModel.unitOptions")],b.prototype,"unitOptions",void 0);a([c.aliasOf("viewModel.unit")],
b.prototype,"unit",void 0);a([e.accessibleHandler()],b.prototype,"_newMeasurement",null);a([e.accessibleHandler()],b.prototype,"_changeUnit",null);return b=a([c.subclass("esri.widgets.AreaMeasurement3D")],b)}(c.declared(q))})},"esri/widgets/AreaMeasurement3D/AreaMeasurement3DViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/Logger ../../core/unitUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool ../support/commonProperties ../support/InteractiveToolViewModel".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d){var k=c.getLogger("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel");return function(d){function c(a){a=d.call(this,a)||this;a.supportedViewType="3d";a._handles=new l;a._userUnitOptions=null;a._userUnit=null;a.tool=null;return a}n(c,d);c.prototype.initialize=function(){var a=this;this._handles.add([h.init(this,"unit",function(b){a.tool&&(a.tool.unit=b)})])};Object.defineProperty(c.prototype,"state",{get:function(){return this.isDisabled?"disabled":this.tool.state},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"measurement",{get:function(){if(this.isDisabled)return null;var a=this.tool.model,b=a.measurementMode,d=a.measurementData,c=a.validMeasurement,e=(d=0===("euclidean"===b?d.intersectingSegments:d.geodesicIntersectingSegments).size)?c?"available":"unavailable":"invalid";return{mode:b,area:{text:d&&c?a.areaLabel:null,state:e},perimeterLength:{text:d&&c?a.perimeterLengthLabel:null,state:e}}},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"unitOptions",{get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(a){this._userUnitOptions=a;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"unit",{get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},set:function(a){this._userUnit=a?this._findSelectableUnit(a,this._userUnit):
null;this.notifyChange("unit")},enumerable:!0,configurable:!0});c.prototype.newMeasurement=function(){this.tool&&this.tool.newMeasurement()};c.prototype.clearMeasurement=function(){this.tool&&this.tool.clearMeasurement()};c.prototype.createToolParams=function(){return{toolConstructor:g,constructorArguments:{unit:this.unit}}};c.prototype.logUnsupportedError=function(){k.error("AreaMeasurement3D widget is not implemented for MapView")};c.prototype.logError=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=
arguments[b];k.error.apply(k,a)};c.prototype._findSelectableUnit=function(a,b){var d=this.unitOptions;return-1!==d.indexOf(a)?a:b?this._findSelectableUnit(b):d[0]};c.prototype._filteredOrAllUnits=function(a){if(!a)return q.measurementAreaUnits.slice();a=a.filter(function(a){return-1!==q.measurementAreaUnits.indexOf(a)});return 0===a.length?q.measurementAreaUnits.slice():a};a([e.property({dependsOn:["view.ready","isDisabled","tool.state"],readOnly:!0})],c.prototype,"state",null);a([e.property({dependsOn:"view.ready tool.area tool.geodesicArea tool.areaLabel tool.perimeterLength tool.geodesicPerimeterLength tool.model.perimeterLengthLabel tool.model.measurementMode tool.model.measurementData".split(" "),
readOnly:!0})],c.prototype,"measurement",null);a([e.property({constructOnly:!0})],c.prototype,"tool",void 0);a([e.property(b.defaultUnitPropertyMetadata)],c.prototype,"defaultUnit",void 0);a([e.property({dependsOn:["view.spatialReference"]})],c.prototype,"unitOptions",null);a([e.property({dependsOn:["unitOptions","defaultUnit"]})],c.prototype,"unit",null);a([e.property()],c.prototype,"clearMeasurement",null);return c=a([e.subclass("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],c)}(e.declared(d))})},
"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/restHelper ../../../../../core/Handles ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./AreaMeasurement3DController ./AreaMeasurement3DModel ./AreaMeasurement3DView ../../../../interactive/InteractiveToolBase ../../../../interactive/interactiveToolUtils".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k){return function(d){function f(a){var b=d.call(this,a)||this;b._handles=new c;b.model=new g({sceneView:a.view});return b}n(f,d);f.prototype.normalizeCtorArgs=function(a){return l(a,["view"])};f.prototype.initialize=function(){var a=this;this._view=new b(this.model,this.manipulators);this._controller=new e(this.model,this._view,this.manipulators);this._handles.add([q.init(this,"state",function(){"measured"===a.state&&k.setActive(a,!1)},!0)])};f.prototype.destroy=
function(){this.detach();this._view.destroy();this._view=null;this._controller.destroy();this._controller=null;this._handles.destroy();this._handles=null};Object.defineProperty(f.prototype,"state",{get:function(){return this.model.isMeasuring?"measured"===this.model.state?"measured":"measuring":"ready"},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isSupported",{get:function(){return"3d"===this.get("view.type")},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"cursor",{get:function(){return!this.model.active||"initial"!==this.model.state&&"drawing"!==this.model.state?null:"crosshair"},enumerable:!0,configurable:!0});f.prototype.newMeasurement=function(){this.model.reset();k.setActive(this,!0)};f.prototype.clearMeasurement=function(){this.model.reset();k.setActive(this,!1)};f.prototype.activate=function(){this.model.active=!0};f.prototype.deactivate=function(){this.model.active=!1;"measured"!==this.model.state&&this.model.reset()};f.prototype.onShow=function(){this._view.show()};
f.prototype.onHide=function(){this._view.hide()};f.prototype.onDetach=function(){this.model.reset()};f.prototype.onInputEvent=function(a){this._controller.handleInputEvent(a,this.manipulators)};a([h.property({dependsOn:["model.isMeasuring","model.state"],readOnly:!0})],f.prototype,"state",null);a([h.property({dependsOn:["view.type"],readOnly:!0})],f.prototype,"isSupported",null);a([h.property({dependsOn:["model.active","state"],readOnly:!0})],f.prototype,"cursor",null);a([h.property({constructOnly:!0})],
f.prototype,"model",void 0);a([h.aliasOf("model.sceneView")],f.prototype,"view",void 0);a([h.aliasOf("model.mode")],f.prototype,"mode",void 0);a([h.aliasOf("model.unit")],f.prototype,"unit",void 0);a([h.aliasOf("model.areaLabel")],f.prototype,"areaLabel",void 0);a([h.aliasOf("model.area")],f.prototype,"area",void 0);a([h.aliasOf("model.geodesicArea")],f.prototype,"geodesicArea",void 0);a([h.aliasOf("model.pathLengthLabel")],f.prototype,"pathLengthLabel",void 0);a([h.aliasOf("model.pathLength")],f.prototype,
"pathLength",void 0);a([h.aliasOf("model.geodesicPathLength")],f.prototype,"geodesicPathLength",void 0);a([h.aliasOf("model.perimeterLengthLabel")],f.prototype,"perimeterLengthLabel",void 0);a([h.aliasOf("model.perimeterLength")],f.prototype,"perimeterLength",void 0);a([h.aliasOf("model.geodesicPerimeterLength")],f.prototype,"geodesicPerimeterLength",void 0);a([h.aliasOf("model.validMeasurement")],f.prototype,"validMeasurement",void 0);a([h.aliasOf("model.viewData")],f.prototype,"viewData",void 0);
return f=a([h.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],f)}(h.declared(d.InteractiveToolBase))})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../geometry/Point ../../../../../layers/graphics/dehydratedFeatures ./AreaMeasurement3DView".split(" "),
function(u,p,n,a,l,c,q,h,e,g){return function(){function a(a,b,c){this._manipulators=c;this._handles=new l;this._tempPickRequest=new g.PickRequest;this.model=a;this.view=b;this.model.reset();this._setupManipulators()}a.prototype.destroy=function(){this._handles.destroy();this._handles=null};a.prototype.handleInputEvent=function(a,b){switch(a.type){case "immediate-click":this._handleImmediateClick(a);break;case "pointer-move":this._handlePointerMove(a);break;case "double-click":this._handleDoubleClick(a);
break;case "drag":this._handleDrag(a);break;case "key-down":this._handleKeyDown(a)}};a.prototype._setupManipulators=function(){var a=this,b=0,g=function(d,g){a._handles.add(g.watch("dragging",function(e){e?(b++,a.model.lastDraggedVertex=c.expect(a.view.manipulatorIdToVertexId(d)),"measured"===a.model.state&&(a.model.state="editing")):(b--,0===b&&"editing"===a.model.state&&(a.model.state="measured"))},!0),"manipulator-"+d);g.on("drag",function(){var b=c.expect(a.view.manipulatorIdToVertexId(d));a.model.path.update(b,
e.clonePoint(g.mapPoint,new h))})};this._manipulators.forEach(function(a){g(a.id,a.manipulator)});this._handles.add(this._manipulators.on("change",function(b){b.added.forEach(function(a){g(a.id,a.manipulator)});b.removed.forEach(function(b){a._handles.remove("manipulator-"+b.id)})}))};a.prototype._handleDrag=function(a){"editing"===this.model.state&&a.stopPropagation()};a.prototype._handleImmediateClick=function(a){if("mouse"!==a.pointerType||0===a.button){var b=q.createScreenPointFromEvent(a),d=
!1;if(this.model.active)switch(this.model.state){case "initial":this._addVertexAt(b,a.pointerType)&&(this.model.state="drawing",d=!0);break;case "drawing":var e=this.view.vertexHandleAt(b,a.pointerType);if(c.isNone(e)){if(this._addVertexAt(b,a.pointerType)){a.stopPropagation();return}}else 0===e&&(this.model.finishMeasurement(),d=!0);break;case "measured":c.isNone(this.view.vertexHandleAt(b,a.pointerType))&&(this.model.clearMeasurement(),this._addVertexAt(b,a.pointerType)&&(this.model.state="drawing",
d=!0))}d&&a.stopPropagation();"mouse"===a.pointerType&&this._hoverAt(b)}};a.prototype._handlePointerMove=function(a){var b=q.createScreenPointFromEvent(a);"mouse"===a.pointerType&&this._hoverAt(b)};a.prototype._handleDoubleClick=function(a){if("mouse"!==a.pointerType||0===a.button){var b=q.createScreenPointFromEvent(a);"drawing"===this.model.state&&c.isSome(this.view.vertexHandleAt(b,a.pointerType))&&(this.model.finishMeasurement(),a.stopPropagation())}};a.prototype._handleKeyDown=function(a){"Escape"===
a.key&&"drawing"===this.model.state&&(this.model.clearMeasurement(),a.stopPropagation());"Enter"===a.key&&"drawing"===this.model.state&&(this.model.finishMeasurement(),a.stopPropagation())};a.prototype._hoverAt=function(a){this.view.requiresCursorPoint?(a=this._pick(a),a.mapPoint&&(this.model.cursorPoint=a.mapPoint)):this.model.cursorPoint=null};a.prototype._addVertexAt=function(a,b){a=this._pick(a);return a.mapPoint?(this.model.path.add(a.mapPoint),!0):!1};a.prototype._pick=function(a){var b=this._tempPickRequest;
b.screenPoint=a;return this.view.pick(b)};return a}()})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DView":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../directLineMeasurement3D/LaserLineRenderer ../support/Label ../support/LabelSegment ../support/labelUtils ../support/PathSegmentInterpolator ../support/viewUtils ../../../support/projectionUtils ../../../support/stack ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryData ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/Layer ../../../webgl-engine/lib/Object3D ../../../webgl-engine/materials/CheckerBoardMaterial ../../../webgl-engine/materials/RibbonLineMaterial ../../../../interactive/ManipulatorCollection ../../../../interactive/manipulatorUtils".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k,w,f,x,z,y,B,m,C,r,t,A,D,E,G,L,H){var K={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,
projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25};u=function(){function a(a,c,d){void 0===c&&(c=new L.ManipulatorCollection);void 0===d&&(d={});this._model=a;this._manipulators=c;this.vertexManipulators=[];this._visible=!1;this._cursorManipulator=this._laserLineRenderer=null;this._pathSegmentObjects=[];this._perimeterSegmentObjects=[];this._projectionLineObjects=[];this._areaLabel=new k(16);this._pathLengthLabel=new k(12);
this._cursorSegmentLengthLabel=new k(12);this._perimeterLengthLabel=new k(12);this._pathLabelSegments=[];this._perimeterLabelSegments=[];this._cursorSegmentLengthLabelSegment=new w;this._listenerHandles=null;this._origin=b.vec3f64.create();this._originTransform=e.mat4f64.create();this._tempStartPosition=b.vec3f64.create();this._tempEndPosition=b.vec3f64.create();this._tempHandlePosition=b.vec3f64.create();this._sceneView=this._model.sceneView;this._params=z.copyParameter(K,d);this._layer=new A("path-measurement-tool",
{isPickable:!1});this._createMaterials();this._createObjects();this._intersector=new t(this._sceneView.viewingMode);a=H.createSphereManipulator(this._sceneView,this._params.handleColor,this._params.handleOpacity);a.visible=!1;a.radius=this._params.handleRadius;a.interactive=!1;this._manipulators.add(a);this._cursorManipulator=a}a.prototype.destroy=function(){this.hide()};Object.defineProperty(a.prototype,"requiresCursorPoint",{get:function(){return("initial"===this._model.state||"drawing"===this._model.state)&&
this._model.active},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){a?this.show():this.hide()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"testData",{get:function(){return{labels:{area:this._areaLabel,pathLength:this._pathLengthLabel,cursorSegmentLength:this._cursorSegmentLengthLabel,perimeterLength:this._perimeterLengthLabel},laserLineRenderer:this._laserLineRenderer}},enumerable:!0,configurable:!0});
a.prototype.show=function(){if(!this._visible){this._visible=!0;var a=this._sceneView._stage;this._laserLineRenderer=new d(this._sceneView.renderCoordsHelper,{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,globalAlpha:this._params.laserLineGlobalAlpha});a.addRenderPlugin(this._laserLineRenderer.renderSlots,this._laserLineRenderer);this._addToStage(a);this._areaLabel.addToView(this._sceneView);
this._pathLengthLabel.addToView(this._sceneView);this._cursorSegmentLengthLabel.addToView(this._sceneView);this._perimeterLengthLabel.addToView(this._sceneView);this._initializeListeners();this._updateAll(this._model.viewData)}};a.prototype.hide=function(){if(this._visible){this._visible=!1;var a=this._sceneView._stage;a.removeRenderPlugin(this._laserLineRenderer);this._laserLineRenderer=null;this._destroyListeners();this._updatePathLength(0);this._removeFromStage(a);this._areaLabel.removeFromView(this._sceneView);
this._pathLengthLabel.removeFromView(this._sceneView);this._cursorSegmentLengthLabel.removeFromView(this._sceneView);this._perimeterLengthLabel.removeFromView(this._sceneView);this._sceneView.cursor=null}};a.prototype.vertexHandleAt=function(a,b){a=this._manipulators.intersect(a,b);return c.isSome(a)?this.manipulatorIdToVertexId(a):null};a.prototype.manipulatorIdToVertexId=function(a){for(var b=0;b<this.vertexManipulators.length;b++)if(a===this.vertexManipulators[b].id)return b;return null};a.prototype.pick=
function(c){var d=this._sceneView.spatialReference;c=q.screenPointObjectToArray(c.screenPoint);c=this._sceneView.sceneIntersectionHelper.intersectToolIntersectorScreen(c,this._intersector).results.min;var e=b.vec3f64.create();if(!c.getIntersectionPoint(e))return new a.PickResult;d=this._sceneView.renderCoordsHelper.fromRenderCoords(e,d);return new a.PickResult("TerrainRenderer"===c.intersector?"surface":"feature",e,d)};a.prototype.overlappingHandles=function(a,b){return z.pointToPointScreenDistance(a,
b,this._sceneView)<=this._params.handleRadius};a.prototype._createMaterials=function(){this._pathLineMaterial=new G({width:this._params.pathLineWidth,color:this._params.pathLineColor,polygonOffset:!0},"path-line");this._pathLineMaterial.renderOccluded=4;this._intersectingPathLineMaterial=new G({width:this._params.pathLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0},"intersecting-path-line");this._intersectingPathLineMaterial.renderOccluded=4;this._perimeterLineMaterial=new G({width:this._params.perimeterLineWidth,
color:this._params.perimeterLineColor,polygonOffset:!0},"perimeter-line");this._perimeterLineMaterial.renderOccluded=4;this._intersectingPerimeterLineMaterial=new G({width:this._params.perimeterLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0},"intersecting-perimeter-line");this._intersectingPerimeterLineMaterial.renderOccluded=4;this._projectionLineMaterial=new G({width:this._params.projectionLineWidth,color:this._params.projectionLineColor,polygonOffset:!0,stippleLength:0},"projection-line");
this._projectionLineMaterial.renderOccluded=4;this._checkerBoardMaterial=new E({color1:this._params.areaColor1,color2:this._params.areaColor2,transparent:!0,writeDepth:!1,polygonOffset:!0},"checker-board");this._checkerBoardMaterial.renderOccluded=4};a.prototype._createObjects=function(){this._cursorSegmentObject=new D;this._areaObject=new D};a.prototype._addToStage=function(a){a.add(0,this._layer);a.add(3,this._pathLineMaterial);a.add(3,this._intersectingPathLineMaterial);a.add(3,this._perimeterLineMaterial);
a.add(3,this._intersectingPerimeterLineMaterial);a.add(3,this._projectionLineMaterial);a.add(3,this._checkerBoardMaterial);a.addToViewContent([this._layer.id])};a.prototype._removeFromStage=function(a){a.removeFromViewContent([this._layer.id]);a.remove(0,this._layer.id);a.remove(3,this._pathLineMaterial.id);a.remove(3,this._intersectingPathLineMaterial.id);a.remove(3,this._perimeterLineMaterial.id);a.remove(3,this._intersectingPerimeterLineMaterial.id);a.remove(3,this._projectionLineMaterial.id);
a.remove(3,this._checkerBoardMaterial.id)};a.prototype._syncViewData=function(a){var b=this;if(!this._visible)return"none";var c=a.pathChanges;"full"===c.change?this._updateAll(a):"incremental"===c.change&&(c.updatedVertices.forEach(function(c){var d=(c-1+b._model.path.length)%b._model.path.length;b._updatePathSegment(a,c);b._updatePathSegment(a,d);b._updateVertexHandle(a,c);b._updateArea(a);b._updatePerimeterSegments(a);b._updateProjectionLines(a);b._updateLaserLine();b._updateLabels(a)}),c.updatedVertices.has(this._model.path.length-
1)&&this._updateCursorSegment(a));var d=c.change;c.clear();return d};a.prototype._updateAfterSyncViewData=function(a){var b=this._model.viewData;"full"!==this._syncViewData(b)&&a&&a(b)};a.prototype._updateOrigin=function(a){z.midpoint(a.positionsRenderCoords,this._origin);h.mat4.identity(this._originTransform);h.mat4.translate(this._originTransform,this._originTransform,this._origin)};a.prototype._updateAll=function(a){this._updateOrigin(a);this._updatePathLength(a.path.length);this._updatePathSegments(a);
this._updatePerimeterSegments(a);this._updateHandles(a);this._updateArea(a);this._updateProjectionLines(a);this._updateLabels(a);this._updateLaserLine()};a.prototype._updateCameraDependent=function(a){this._updateHandles(a);this._updateProjectionLines(a);this._updateLabels(a)};a.prototype._updatePathLength=function(a){this._resizeObject3DArray(this._pathSegmentObjects,a);this._resizeObject3DArray(this._perimeterSegmentObjects,a);this._resizeManipulatorArray(this.vertexManipulators,a);z.resizeArray(this._pathLabelSegments,
a,function(){return new w});z.resizeArray(this._perimeterLabelSegments,a,function(){return new w})};a.prototype._updatePathSegments=function(a){for(var b=0;b<this._pathSegmentObjects.length;++b)this._updatePathSegment(a,b);this._updateCursorSegment(a)};a.prototype._updatePathSegment=function(a,b){var c=a.path,d=this._pathSegmentObjects[b];a.validMeasurement||b<c.length-1?(this._createInterpolatedLineGeometry(d,a.intersectingSegments.has(b)?this._intersectingPathLineMaterial:this._pathLineMaterial,
"path-segment",a.positionsRenderCoords[b],a.positionsRenderCoords[(b+1)%c.length],this._origin,this._originTransform,this._model.measurementMode,this._pathLabelSegments[b],a.validMeasurement?"center":"end"),this._addObject3D(d)):(d.removeAllGeometries(),this._removeObject3D(d))};a.prototype._updateCursorSegment=function(a){a=this._sceneView.renderCoordsHelper;var b=this._model.path,c=this._cursorSegmentObject;0<b.length&&"drawing"===this._model.state&&this._model.cursorPoint?(a.toRenderCoords(b.back,
this._tempStartPosition),a.toRenderCoords(this._model.cursorPoint,this._tempEndPosition),this._createInterpolatedLineGeometry(c,this._pathLineMaterial,"path-segment",this._tempStartPosition,this._tempEndPosition,this._origin,this._originTransform,this._model.measurementMode,this._cursorSegmentLengthLabelSegment,"end"),this._addObject3D(c)):(c.removeAllGeometries(),this._removeObject3D(c))};a.prototype._updatePerimeterSegments=function(a){for(var b=0;b<this._perimeterSegmentObjects.length;++b)this._updatePerimeterSegment(a,
b)};a.prototype._updatePerimeterSegment=function(a,b){var c=a.path,d=this._perimeterSegmentObjects[b];a.validMeasurement&&"geodesic"!==this._model.measurementMode?(this._updatePerimeterSegmentObject(d,a.positionsFittedRenderCoords[b],a.positionsFittedRenderCoords[(b+1)%c.length],this._origin,this._originTransform,a.intersectingSegments.has(b),this._perimeterLabelSegments[b]),this._addObject3D(d)):(d.removeAllGeometries(),this._removeObject3D(d))};a.prototype._updatePerimeterSegmentObject=function(a,
b,c,d,e,f,g){this._createInterpolatedLineGeometry(a,f?this._intersectingPerimeterLineMaterial:this._perimeterLineMaterial,"perimeter-segment",b,c,d,e,this._model.measurementMode,g)};a.prototype._updateHandles=function(a){for(var b=0;b<this.vertexManipulators.length;++b)this._updateVertexHandle(a,b);this._updateCursorHandle()};a.prototype._updateVertexHandle=function(a,b){this.vertexManipulators[b].manipulator.position=a.positionsRenderCoords[b]};a.prototype._updateCursorHandle=function(){var a=this._cursorManipulator;
"drawing"===this._model.state&&this._model.cursorPoint?(a.visible=!0,a.mapPoint=this._model.cursorPoint):a.visible=!1};a.prototype._updateArea=function(a){switch(this._model.measurementMode){case "euclidean":this._updateAreaEuclidean(a);break;case "geodesic":this._updateAreaGeodesic()}};a.prototype._updateAreaEuclidean=function(a){var c=this,d=this._areaObject;if(a.validMeasurement&&0===a.intersectingSegments.size&&a.triangleIndices){var e=[],f=b.vec3f64.create();a.positionsFittedRenderCoords.forEach(function(a){g.vec3.subtract(f,
a,c._origin);e.push(f[0],f[1],f[2])});var h=[];a.positionsProjected.forEach(function(a){h.push(a[0],a[1])});var k=new C.GeometryData({position:{size:3,data:e},uv0:{size:2,data:h}},{position:a.triangleIndices,uv0:a.triangleIndices}),k=new m(k,"area");d.removeAllGeometries();d.addGeometry(k,this._checkerBoardMaterial,this._originTransform);this._addObject3D(d);this._checkerBoardMaterial.setParameterValues({size:[a.checkerSize,a.checkerSize]})}else d.removeAllGeometries(),this._removeObject3D(d)};a.prototype._updateAreaGeodesic=
function(){var a=this._areaObject;a.removeAllGeometries();this._removeObject3D(a)};a.prototype._updateProjectionLines=function(a){var b=a.path;this._resizeObject3DArray(this._projectionLineObjects,b.length);for(var c=0;c<b.length;++c)this._updateProjectionLine(a,c);for(var d=Infinity,c=0;c<b.length;++c)d=Math.max(this._sceneView._stage.getCamera().computeScreenPixelSizeAt(a.positionsRenderCoords[c])),d=Math.max(this._sceneView._stage.getCamera().computeScreenPixelSizeAt(a.positionsFittedRenderCoords[c]));
this._projectionLineMaterial.setParameterValues({stippleLength:this._params.projectionLineStippleSize*d})};a.prototype._updateProjectionLine=function(a,c){var d=this._projectionLineObjects[c];d.removeAllGeometries();if(a.validMeasurement&&"euclidean"===this._model.measurementMode){a=b.vec3f64.create();g.vec3.subtract(a,this._model.viewData.positionsRenderCoords[c],this._origin);var e=b.vec3f64.create();g.vec3.subtract(e,this._model.viewData.positionsFittedRenderCoords[c],this._origin);c=new m(r.createPolylineGeometry([a,
e]),"projected-line");d.addGeometry(c,this._projectionLineMaterial,this._originTransform);this._addObject3D(d)}else this._removeObject3D(d)};a.prototype._updateLabels=function(a){var b=this,c=this._sceneView._stage.getCamera(),d=this._params.labelDistance,e=this._model,g="geodesic"===e.measurementMode,m="drawing"===e.state,h=function(a,c){return a.visible&&c.visible&&b._sceneView.overlay.overlaps(a.textItem,c.textItem)},k=this._areaLabel,t=f.positionLabelOnPoint(k,a.areaCentroid,c);k.text=e.areaLabel;
k.visible=t&&a.validMeasurement&&0===a.intersectingSegments.size&&null!=e.areaLabel;k=this._pathLengthLabel;t=f.positionLabelOnCorner(k,this._pathLabelSegments[a.pathLengthLabelSegmentIndex],this._cursorSegmentLengthLabelSegment,d,c);k.text=e.pathLengthLabel;k.visible=t&&m&&0<e.path.length;k=this._cursorSegmentLengthLabel;t=this._cursorSegmentLengthLabelSegment;t=f.positionLabelOnSegment(k,t,d,"bottom",c);k.text=e.cursorSegmentLengthLabel;k.visible=t&&m&&e.cursorSegmentLength&&0!==e.cursorSegmentLength.value;
h(this._cursorSegmentLengthLabel,this._pathLengthLabel)&&(this._cursorSegmentLengthLabel.visible=!1);h(this._pathLengthLabel,this._areaLabel)&&(this._pathLengthLabel.visible=!1);k=this._perimeterLengthLabel;if(e.validMeasurement&&0===a.intersectingSegments.size)for(m=0;m<a.path.length;++m)if(t=(a.perimeterLengthLabelSegmentIndex+m)%a.path.length,t=g?this._pathLabelSegments[t]:this._perimeterLabelSegments[t],t=f.positionLabelOnSegment(k,t,d,"top",c),k.text=e.perimeterLengthLabel,k.visible=t,h(k,this._areaLabel))k.visible=
!1;else break;else k.visible=!1};a.prototype._getFocusPoint=function(){var a=this._model,b=this._model.lastDraggedVertex;switch(a.state){case "drawing":return a.cursorPoint?a.cursorPoint:a.path.vertex(c.isSome(b)?b:a.path.length-1);case "editing":return c.isSome(b)?a.path.vertex(b):null;default:return a.cursorPoint}};a.prototype._updateLaserLine=function(){var a=this._model,b=this._params.laserLineEnabled&&"measured"!==a.state&&a.active;this._laserLineRenderer.focusSphereActive=!1;this._laserLineRenderer.segmentActive=
!1;a=this._getFocusPoint();b&&a?(b=this._tempHandlePosition,this._sceneView.renderCoordsHelper.toRenderCoords(a,b),this._laserLineRenderer.focusPosition=b,this._laserLineRenderer.focusPlaneActive=!0):this._laserLineRenderer.focusPlaneActive=!1};a.prototype._addObject3D=function(a){a.parentLayer||(this._layer.addObject(a),this._sceneView._stage.add(1,a))};a.prototype._removeObject3D=function(a){a.parentLayer&&(this._layer.removeObject(a),this._sceneView._stage.remove(1,a.id))};a.prototype._resizeObject3DArray=
function(a,b){var c=this;z.resizeArray(a,b,function(){return new D},function(a){c._removeObject3D(a)})};a.prototype._resizeManipulatorArray=function(a,b){var c=this;z.resizeArray(a,b,function(){var a=H.createSphereManipulator(c._sceneView,c._params.handleColor,c._params.handleOpacity);a.hideOnGrab=!0;a.radius=c._params.handleRadius;return{id:c._manipulators.add(a),manipulator:a}},function(a){c._manipulators.remove(a.manipulator)})};a.prototype._createInterpolatedLineGeometry=function(a,b,c,d,e,f,
h,k,t,l){var n=this._sceneView.renderCoordsHelper,q=[],p=[],v=function(a,b){var c=B.sv3d.get();g.vec3.subtract(c,a,f);q.push(c);p.push(b)};if("euclidean"===k){var A=B.sv3d.get();z.midpoint([d,e],A);k=B.sv3d.get();n.worldUpAtPosition(A,k);v(d,k);v(e,k);t&&t.update(d,e,l)}else{d=this._getSegmentInterpolator(d,e);e=this._params.lineSubdivisions+1&-2;var y=A=null,C=e/2-1,x=e/2;"start"===l?(C=0,x=1):"end"===l&&(C=e-2,x=e-1);for(var u=0;u<e;++u){var w=u/(e-1),D=B.sv3d.get();k=B.sv3d.get();d.eval(w,D);n.worldUpAtPosition(D,
k);u===C&&(A=D);u===x&&(y=D);v(D,k)}t&&t.update(A,y,l)}c=new m(r.createPolylineGeometry(q,p),c);a.removeAllGeometries();a.addGeometry(c,b,h)};a.prototype._getSegmentInterpolator=function(a,b){if(y.canProject(this._sceneView.spatialReference,y.SphericalECEFSpatialReference)){var c=this._sceneView.renderCoordsHelper.spatialReference;return new x.Spherical(a,b,c,c)}return new x.Linear(a,b)};a.prototype._initializeListeners=function(){var a=this;this._listenerHandles=new l;this._listenerHandles.add([this._model.watch(["state",
"lastDraggedVertex"],function(){return a._updateLaserLine()}),this._model.watch("cursorPoint",function(){return a._updateAfterSyncViewData(function(b){a._updateCursorSegment(b);a._updateCursorHandle();"drawing"===a._model.state&&a._updateLabels(b);a._updateLaserLine()})}),this._sceneView.state.watch("camera",function(){return a._updateAfterSyncViewData(function(b){return a._updateCameraDependent(a._model.viewData)})}),this._model.watch(["unit","measurementMode"],function(){return a._updateAll(a._model.viewData)}),
this._model.watch(["active"],function(){a._updateLaserLine();a._syncViewData(a._model.viewData)}),this._model.watch("viewData",function(b){return a._syncViewData(b)})])};a.prototype._destroyListeners=function(){this._listenerHandles.destroy();this._listenerHandles=null};a._handleGeometry=new m(r.createSphereGeometry(1,32,32),"handle");return a}();(function(a){var b=function(){return function(){}}();a.PickRequest=b;b=function(){return function(a,b,c){void 0===a&&(a=null);void 0===b&&(b=null);void 0===
c&&(c=null);this.type=a;this.scenePoint=b;this.mapPoint=c}}();a.PickResult=b})(u||(u={}));return u})},"esri/views/3d/webgl-engine/materials/CheckerBoardMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../lib/GLMaterial ../lib/Material ./internal/DefaultBufferWriter ./internal/MaterialUtil ./internal/MaterialUtil ./renderers/InstancedRenderer ../shaders/CheckerBoardPrograms ../../../webgl/renderState".split(" "),function(u,p,n,a,l,c,q,h,e,g,b){u=function(a){function b(b,
c){c=a.call(this,c)||this;c.params=q.copyParameters(b,k);return c}n(b,a);b.prototype.dispose=function(){};b.prototype.getParameterValues=function(){var a=this.params;return{size:a.size,color1:a.color1,color2:a.color2,transparent:a.transparent,writeDepth:a.writeDepth,polygonOffset:a.polygonOffset}};b.prototype.setParameterValues=function(a){q.updateParameters(this.params,a)&&this.notifyDirty("matChanged")};b.prototype.getParams=function(){return this.params};b.prototype.intersect=function(a,b,c,d,
e,f,g,k){return h.intersectTriangleGeometry(a,b,d,e,f,g)};b.prototype.getGLMaterials=function(){return{color:d,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};b.prototype.createBufferWriter=function(){return new c.DefaultBufferWriter(c.PositionUVLayout)};b.prototype.createRenderer=function(a,b){return new e(a,b,this)};return b}(l.Material);var d=function(a){function c(b){b=a.call(this,b)||this;b.updateParameters();return b}n(c,a);c.prototype.selectProgram=function(){this.program=
this.programRep.getProgram(g.colorPass);this.pipelineState=b.makePipelineState({blending:this.params.transparent&&b.separateBlendingParams(770,1,771,771),polygonOffset:this.params.polygonOffset&&{factor:0,units:-25},depthTest:{func:513},depthWrite:this.params.writeDepth&&b.defaultDepthWriteParams,colorWrite:b.defaultColorWriteParams})};c.prototype.updateParameters=function(){this.params=this.material.getParameterValues();this.selectProgram()};c.prototype.beginSlot=function(a){var b=5;this.params.transparent&&
(b=this.params.writeDepth?7:10);return a===b};c.prototype.getProgram=function(){return this.program};c.prototype.getDrawMode=function(){return 4};c.prototype.bind=function(a,b){b=this.program;a.bindProgram(b);a.setPipelineState(this.pipelineState);b.setUniform2fv("size",this.params.size);b.setUniform4fv("color1",this.params.color1);b.setUniform4fv("color2",this.params.color2)};c.prototype.bindView=function(a,b){a=b.origin;var c=this.getProgram();q.bindView(a,b.view,c)};c.prototype.bindInstance=function(a,
b){this.getProgram().setUniformMatrix4fv("model",b.transformation)};c.prototype.release=function(a){};return c}(a),k={size:[1,1],color1:[.75,.75,.75,1],color2:[.5,.5,.5,1],transparent:!1,writeDepth:!0,polygonOffset:!1};return u})},"esri/views/3d/webgl-engine/shaders/CheckerBoardPrograms":function(){define(["require","exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],function(u,p,n,a){Object.defineProperty(p,"__esModule",{value:!0});p.colorPass={name:"checker-board-color",shaders:{vertexShader:a.resolveIncludes("materials/checkerBoard/checkerBoard.vert"),
fragmentShader:a.resolveIncludes("materials/checkerBoard/checkerBoard.frag")},attributes:n.Default3D}})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DModel":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/compilerUtils ../../../../../core/Handles ../../../../../core/mathUtils ../../../../../core/Quantity ../../../../../core/quantityUtils ../../../../../core/unitUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./MeasurementData ./PathChanges ../support/measurementUtils ../support/Path ../support/setUtils ../support/UnitNormalizer ../../../support/projectionUtils".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k,w,f,x,z,y,B,m){return function(l){function r(){var a=null!==l&&l.apply(this,arguments)||this;a._unitNormalizer=new B;a._measurementData=new w;a._measurementDataChanges=new f;a._viewDataChanges=new f;a._handles=new q;a.path=new z;a.pathVersion=0;a.cursorPoint=null;a.state="initial";a.lastDraggedVertex=null;a.mode="auto";a.unit="metric";a.active=!1;a.maxRelativeErrorCoplanar=.005;a.maxRelativeErrorAlmostCoplanar=.01;a.verticalAngleThreshold=80;a.geodesicMeasurementDistanceThreshold=
1E5;return a}n(r,l);r.prototype.initialize=function(){var a=this;this._handles.add(d.whenTrue(this.sceneView,"ready",function(){var b=a.sceneView.spatialReference;a._worldSpatialReference=!b||m.canProject(b,m.WGS84ECEFSpatialReference)?m.WGS84ECEFSpatialReference:b;a._unitNormalizer.spatialReference=b}),"scene-view");this.reset();var b=function(){a._set("pathVersion",a.pathVersion+1)};this._handles.add(this.path.on("cleared",function(){a._measurementDataChanges.fullChange();a._set("pathVersion",0)}));
this._handles.add(this.path.on("vertex-added",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-inserted",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-removed",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-updated",function(c){a._measurementDataChanges.incrementalChange(c.index);b()}))};r.prototype.destroy=function(){this._handles.destroy();this._handles=
null};Object.defineProperty(r.prototype,"validMeasurement",{get:function(){return 3<=this.path.length&&"measured"===this.state||"editing"===this.state},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"isMeasuring",{get:function(){return 1<=this.path.length},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"measurementData",{get:function(){this._viewDataChanges.merge(this._measurementDataChanges);var a=y.clone(this._measurementData.intersectingSegments),b=y.clone(this._measurementData.geodesicIntersectingSegments);
this._measurementData.update(this.path,this._measurementDataChanges,this.sceneView,this._unitNormalizer,this.validMeasurement,this.sceneView.renderSpatialReference,this._worldSpatialReference,{maxRelativeErrorCoplanar:this.maxRelativeErrorCoplanar,maxRelativeErrorAlmostCoplanar:this.maxRelativeErrorAlmostCoplanar,verticalAngleThreshold:this.verticalAngleThreshold});x.compareSets(this._measurementData.intersectingSegments,a)||this._viewDataChanges.fullChange();x.compareSets(this._measurementData.geodesicIntersectingSegments,
b)||this._viewDataChanges.fullChange();return this._measurementData},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"area",{get:function(){return this.measurementData.area},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"geodesicArea",{get:function(){return this.measurementData.geodesicArea},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"areaLabel",{get:function(){return this._formatAreaLabel("geodesic"===this.measurementMode?this.measurementData.geodesicArea:
this.measurementData.area,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"pathLength",{get:function(){return this.measurementData.pathLength},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"geodesicPathLength",{get:function(){return this.measurementData.geodesicPathLength},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"pathLengthLabel",{get:function(){return this._formatLengthLabel("geodesic"===this.measurementMode?this.measurementData.geodesicPathLength:
this.measurementData.pathLength,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"perimeterLength",{get:function(){return this.measurementData.perimeterLength},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"geodesicPerimeterLength",{get:function(){return this.measurementData.geodesicPathLength},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"perimeterLengthLabel",{get:function(){return this.measurementData.perimeterLength&&this._formatLengthLabel("geodesic"===
this.measurementMode?this.measurementData.geodesicPathLength:this.measurementData.perimeterLength,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"cursorSegmentLength",{get:function(){return this.path.back&&this.cursorPoint&&new e(this._unitNormalizer.normalizeDistance(x.segmentLengthEuclidean(this.path.back,this.cursorPoint,this._worldSpatialReference)),"meters")},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"geodesicCursorSegmentLength",{get:function(){return this.path.back&&
this.cursorPoint&&new e(x.segmentLengthGeodesic(this.path.back,this.cursorPoint),"meters")},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"cursorSegmentLengthLabel",{get:function(){return this._formatLengthLabel("geodesic"===this.measurementMode?this.geodesicCursorSegmentLength:this.cursorSegmentLength,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"viewData",{get:function(){var a=this.measurementData,c="geodesic"===this.measurementMode,d=c?this.geodesicArea:
this.area,e=1;d&&(d=this._toPreferredAreaUnit(d,this.unit),e=h.nextHighestPowerOfTen(Math.sqrt(d.value)/Math.sqrt(300)),e*=Math.sqrt(b.convertUnit(1,d.unit,"square-meters")),e/=this._unitNormalizer.normalizeDistance(1));return{validMeasurement:this.validMeasurement,path:this.path,pathChanges:this._viewDataChanges,positionsGeographic:a.positionsGeographic,positionsRenderCoords:a.positionsRenderCoords,positionsProjected:a.positionsProjectedWorldCoords,positionsFittedRenderCoords:a.positionsFittedRenderCoords,
intersectingSegments:c?a.geodesicIntersectingSegments:a.intersectingSegments,triangleIndices:c?a.geodesicTriangleIndices:a.triangleIndices,fittingMode:a.fittingMode,areaCentroid:c?a.geodesicAreaCentroidRenderCoords:a.areaCentroidRenderCoords,pathLengthLabelSegmentIndex:this.validMeasurement?0:this.path.length-2,perimeterLengthLabelSegmentIndex:0,checkerSize:e}},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"measurementMode",{get:function(){var a=this.mode;"auto"===a&&(a="euclidean",
(this.geodesicPathLength?this.geodesicPathLength.value:0)+(!this.validMeasurement&&this.geodesicCursorSegmentLength?this.geodesicCursorSegmentLength.value:0)>this.geodesicMeasurementDistanceThreshold&&(a="geodesic"));null==this.geodesicPathLength&&(a="euclidean");return a},enumerable:!0,configurable:!0});r.prototype.reset=function(){this.clearMeasurement()};r.prototype.clearMeasurement=function(){this.path.clear();this.state="initial";this.cursorPoint=null};r.prototype.finishMeasurement=function(){3>
this.path.length?this.clearMeasurement():(this._measurementDataChanges.fullChange(),this.state="measured")};r.prototype._preferredAreaUnit=function(a,c){switch(c){case "metric":return b.preferredMetricAreaUnit(a.value,a.unit);case "imperial":return b.preferredImperialAreaUnit(a.value,a.unit);default:return c}};r.prototype._preferredLengthUnit=function(a,c){c=this._deriveLengthUnitFromAreaUnit(c);switch(c){case "metric":return b.preferredMetricLengthUnit(a.value,a.unit);case "imperial":return b.preferredImperialLengthUnit(a.value,
a.unit);default:return c}};r.prototype._toPreferredAreaUnit=function(a,b){return a.toUnit(this._preferredAreaUnit(a,b))};r.prototype._toPreferredLengthUnit=function(a,b){return a.toUnit(this._preferredLengthUnit(a,b))};r.prototype._formatAreaLabel=function(a,b){return a&&g.formatDecimal(a,this._preferredAreaUnit(a,b))};r.prototype._formatLengthLabel=function(a,b){return a&&g.formatDecimal(a,this._preferredLengthUnit(a,b))};r.prototype._deriveLengthUnitFromAreaUnit=function(a){switch(a){case "metric":return"metric";
case "imperial":return"imperial";case "square-inches":return"inches";case "square-feet":return"feet";case "square-yards":return"yards";case "square-miles":return"miles";case "square-us-feet":return"us-feet";case "square-millimeters":return"millimeters";case "square-centimeters":return"centimeters";case "square-decimeters":return"decimeters";case "square-meters":return"meters";case "square-kilometers":return"kilometers";case "acres":return"imperial";case "ares":case "hectares":return"metric";default:c.neverReached(a)}throw Error("unhandled area unit");
};a([k.property({constructOnly:!0})],r.prototype,"sceneView",void 0);a([k.property({readOnly:!0})],r.prototype,"path",void 0);a([k.property({readOnly:!0})],r.prototype,"pathVersion",void 0);a([k.property()],r.prototype,"cursorPoint",void 0);a([k.property()],r.prototype,"state",void 0);a([k.property()],r.prototype,"lastDraggedVertex",void 0);a([k.property()],r.prototype,"mode",void 0);a([k.property()],r.prototype,"unit",void 0);a([k.property()],r.prototype,"active",void 0);a([k.property({readOnly:!0,
dependsOn:["path.length","state"]})],r.prototype,"validMeasurement",null);a([k.property({readOnly:!0,dependsOn:["path.length"]})],r.prototype,"isMeasuring",null);a([k.property({readOnly:!0,dependsOn:["pathVersion","validMeasurement","maxRelativeErrorCoplanar","maxRelativeErrorAlmostCoplanar","verticalAngleThreshold"]})],r.prototype,"measurementData",null);a([k.property({readOnly:!0,dependsOn:["measurementData"]})],r.prototype,"area",null);a([k.property({readOnly:!0,dependsOn:["measurementData"]})],
r.prototype,"geodesicArea",null);a([k.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],r.prototype,"areaLabel",null);a([k.property({readOnly:!0,dependsOn:["measurementData"]})],r.prototype,"pathLength",null);a([k.property({readOnly:!0,dependsOn:["measurementData"]})],r.prototype,"geodesicPathLength",null);a([k.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],r.prototype,"pathLengthLabel",null);a([k.property({readOnly:!0,dependsOn:["measurementData"]})],
r.prototype,"perimeterLength",null);a([k.property({readOnly:!0,dependsOn:["measurementData"]})],r.prototype,"geodesicPerimeterLength",null);a([k.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],r.prototype,"perimeterLengthLabel",null);a([k.property({readOnly:!0,dependsOn:["path.back","cursorPoint"]})],r.prototype,"cursorSegmentLength",null);a([k.property({readOnly:!0,dependsOn:["path.back","cursorPoint"]})],r.prototype,"geodesicCursorSegmentLength",null);a([k.property({readOnly:!0,
dependsOn:["unit","measurementMode","cursorSegmentLength","geodesicCursorSegmentLength"]})],r.prototype,"cursorSegmentLengthLabel",null);a([k.property({readOnly:!0,dependsOn:["unit","measurementMode","measurementData"]})],r.prototype,"viewData",null);a([k.property()],r.prototype,"maxRelativeErrorCoplanar",void 0);a([k.property()],r.prototype,"maxRelativeErrorAlmostCoplanar",void 0);a([k.property()],r.prototype,"verticalAngleThreshold",void 0);a([k.property()],r.prototype,"geodesicMeasurementDistanceThreshold",
void 0);a([k.property({readOnly:!0,dependsOn:["mode","validMeasurement","geodesicPathLength","geodesicCursorSegmentLength","geodesicMeasurementDistanceThreshold"]})],r.prototype,"measurementMode",null);return r=a([k.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DModel")],r)}(k.declared(l))})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/MeasurementData":function(){define("require exports ../../../../../core/mathUtils ../../../../../core/Quantity ../../../../../core/libs/earcut/earcut ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/vec4f64 ../../../../../geometry/SpatialReference ../../../../../geometry/support/intersects ../support/measurementUtils ../support/viewUtils ../../../support/earthUtils ../../../support/mathUtils ../../../support/projectionUtils".split(" "),
function(u,p,n,a,l,c,q,h,e,g,b,d,k,w,f,x,z){function y(a,b,c){b=new Float64Array(a.length*c);for(var d=0;d<a.length;++d)for(var e=a[d],f=0;f<c;++f)b[d*c+f]=e[f];return b}return function(){function p(){this.positionsWorldCoords=[];this.positionsRenderCoords=[];this.positionsProjectedWorldCoords=[];this.positionsFittedRenderCoords=[];this.positionsGeographic=[];this.positionsSpherical=[];this.positionsStereographic=[];this.pathSegmentLengths=[];this.geodesicPathSegmentLengths=[];this.perimeterSegmentLengths=
[];this.intersectingSegments=new Set;this.geodesicIntersectingSegments=new Set;this.areaCentroidWorldCoords=e.vec3f64.create();this.areaCentroidRenderCoords=e.vec3f64.create();this.geodesicAreaCentroidRenderCoords=e.vec3f64.create();this._length=0;this._centroidRenderCoords=e.vec3f64.create();this._planeWorldCoords=g.vec4f64.create();this._worldUp=e.vec3f64.create();this._worldTangent=e.vec3f64.create();this._frame=[e.vec3f64.create(),e.vec3f64.create(),e.vec3f64.create()];this._tempU=e.vec3f64.create();
this._tempV=e.vec3f64.create();this._tempVec3=e.vec3f64.create();this._tempSphere={center:e.vec3f64.create(),radius:0}}p.prototype.update=function(b,c,d,e,f,g,k,l){c.clear();this._resize(b.length);c=z.canProject(d.spatialReference,z.SphericalECEFSpatialReference)&&z.canProjectToWGS84ComparableLonLat(d.spatialReference);for(var m=this.positionsGeographic,n=this.positionsWorldCoords,p=this.positionsRenderCoords,r=this.positionsSpherical,q=0;q<b.length;++q){var t=b.vertex(q);z.pointToVector(t,n[q],k);
z.pointToVector(t,p[q],g);c&&(z.pointToWGS84ComparableLonLat(t,m[q]),z.pointToVector(t,r[q],z.SphericalECEFSpatialReference),h.vec3.normalize(r[q],r[q]))}b=this._updatePathLengths(f);this.pathLength=0<this._length?new a(e.normalizeDistance(b),"meters"):null;c?(b=this._updateGeodesicPathLengths(f),this.geodesicPathLength=0<this._length?new a(b,"meters"):null):this.geodesicPathLength=null;f?(this._updateArea(d,e,g,k,l),c&&this._updateGeodesicArea(d,g)):(this.geodesicTriangleIndices=this.triangleIndices=
this.perimeterLength=this.geodesicArea=this.area=null,this.intersectingSegments.clear(),this.geodesicIntersectingSegments.clear())};p.prototype._resize=function(a){a<this._length&&(this.positionsWorldCoords.length=a,this.positionsRenderCoords.length=a,this.positionsProjectedWorldCoords.length=a,this.positionsFittedRenderCoords.length=a,this.positionsGeographic.length=a,this.positionsSpherical.length=a,this.positionsStereographic.length=a,this.pathSegmentLengths.length=a,this.geodesicPathSegmentLengths.length=
a,this._length=this.perimeterSegmentLengths.length=a);for(;this._length<a;)this.positionsWorldCoords.push(e.vec3f64.create()),this.positionsRenderCoords.push(e.vec3f64.create()),this.positionsProjectedWorldCoords.push(q.vec2f64.create()),this.positionsFittedRenderCoords.push(e.vec3f64.create()),this.positionsGeographic.push(e.vec3f64.create()),this.positionsSpherical.push(e.vec3f64.create()),this.positionsStereographic.push(q.vec2f64.create()),this.pathSegmentLengths.push(0),this.geodesicPathSegmentLengths.push(0),
this.perimeterSegmentLengths.push(0),++this._length};p.prototype._updatePathLengths=function(a){for(var b=this.positionsWorldCoords,c=this.pathSegmentLengths,d=0,e=0;e<this._length;++e){var f=c[e]=h.vec3.distance(b[e],b[(e+1)%this._length]);if(e<this._length-1||a)d+=f}return d};p.prototype._updateGeodesicPathLengths=function(a){for(var b=this.positionsGeographic,c=this.geodesicPathSegmentLengths,d=0,e=0;e<this._length;++e){var f=c[e]=k.segmentLengthGeodesicVector(b[e],b[(e+1)%this._length]);if(e<
this._length-1||a)d+=f}return d};p.prototype._updateArea=function(b,d,e,f,g){var m=b.renderCoordsHelper;b=this.positionsWorldCoords;var l=this.positionsRenderCoords,n=this.positionsProjectedWorldCoords,q=this.positionsFittedRenderCoords,p=this._planeWorldCoords,r=this._centroidRenderCoords;w.midpoint(l,r);m.worldUpAtPosition(r,this._worldUp);m.worldBasisAtPosition(r,0,this._worldTangent);z.transformDirection(r,this._worldUp,e,this._worldUp,f);z.transformDirection(r,this._worldTangent,e,this._worldTangent,
f);k.bestFitPlane(b,p);this.fittingMode=this._selectFittingMode(p,b,this._worldUp,g);var t=0;if("horizontal"===this.fittingMode){var y=-Infinity;l.forEach(function(a,b){a=m.getAltitude(l[b]);a>y&&(y=a,t=b)})}g=b[t];var r=p,u=this._worldTangent;"horizontal"===this.fittingMode?r=this._worldUp:"vertical"===this.fittingMode&&(r=this._tempVec3,u=this._worldUp,x.makeOrthonormal(p,this._worldUp,r));h.vec3.copy(this._frame[2],r);x.makeOrthonormal(u,r,this._frame[0]);h.vec3.cross(this._frame[1],this._frame[0],
this._frame[2]);h.vec3.negate(this._frame[1],this._frame[1]);for(var p=this._tempVec3,r=this._tempU,u=this._tempV,C=0;C<this._length;++C){var B=n[C],A=q[C];h.vec3.subtract(p,b[C],g);c.vec2.set(B,h.vec3.dot(this._frame[0],p),h.vec3.dot(this._frame[1],p));h.vec3.scale(r,this._frame[0],B[0]);h.vec3.scale(u,this._frame[1],B[1]);h.vec3.add(p,r,u);h.vec3.add(p,p,g);z.vectorToVector(p,f,A,e)}this.perimeterLength=0<this._length?new a(d.normalizeDistance(this._updatePerimeterLengths()),"meters"):null;w.midpoint(q,
this.areaCentroidRenderCoords);z.vectorToVector(this.areaCentroidRenderCoords,e,this.areaCentroidWorldCoords,f);this._updateIntersectingSegments();this.area=0===this.intersectingSegments.size?new a(d.normalizeArea(this._computeArea()),"square-meters"):null};p.prototype._updateGeodesicArea=function(b,d){b=b.renderCoordsHelper;d=this.positionsSpherical;var e=this.positionsStereographic,g=this._tempVec3,m=k.fitHemisphere(d,g);if(m){var l=this._tempU,n=this._tempV;x.tangentFrame(g,l,n);for(var p=0;p<
this._length;++p){var q=h.vec3.dot(d[p],l),y=h.vec3.dot(d[p],n),u=h.vec3.dot(d[p],g);c.vec2.set(e[p],q/u,y/u)}h.vec3.scale(g,g,f.earthRadius);b.toRenderCoords(g,z.SphericalECEFSpatialReference,this.geodesicAreaCentroidRenderCoords);this._updateGeodesicIntersectingSegments();this.geodesicArea=m&&0===this.geodesicIntersectingSegments.size?new a(this._computeGeodesicArea(),"square-meters"):null}else this.geodesicArea=null};p.prototype._updatePerimeterLengths=function(){for(var a=this.positionsProjectedWorldCoords,
b=this.perimeterSegmentLengths,d=0,e=0;e<this._length;++e)var f=b[e]=c.vec2.distance(a[e],a[(e+1)%this._length]),d=d+f;return d};p.prototype._updateIntersectingSegments=function(){var a=this.positionsProjectedWorldCoords,b=this.intersectingSegments;b.clear();for(var c=0;c<this._length;++c)for(var e=c+2;e<this._length;++e)(e+1)%this._length!==c&&d.segmentIntersects(a[c],a[(c+1)%this._length],a[e],a[(e+1)%this._length])&&(b.add(c),b.add(e))};p.prototype._computeArea=function(){for(var a=this.positionsProjectedWorldCoords,
b=y(a,2,2),b=this.triangleIndices=new Uint32Array(l(b,[],2)),c=0,d=0;d<b.length;d+=3)c+=k.triangleAreaEuclidean(a[b[d]],a[b[d+1]],a[b[d+2]]);return c};p.prototype._updateGeodesicIntersectingSegments=function(){var a=this.positionsStereographic,b=this.geodesicIntersectingSegments;b.clear();for(var c=0;c<this._length;++c)for(var e=c+2;e<this._length;++e)(e+1)%this._length!==c&&d.segmentIntersects(a[c],a[(c+1)%this._length],a[e],a[(e+1)%this._length])&&(b.add(c),b.add(e))};p.prototype._computeGeodesicArea=
function(){for(var a=this.positionsGeographic,c=y(this.positionsStereographic,2,2),c=this.geodesicTriangleIndices=new Uint32Array(l(c,[],2)),d=0,e=0;e<c.length;e+=3)d+=k.triangleAreaGeodesic(a[c[e]],a[c[e+1]],a[c[e+2]],b.WGS84);return d};p.prototype._selectFittingMode=function(a,b,c,d){var e=b.map(function(b){return Math.abs(k.planePointDistance(a,b))}).reduce(function(a,b){return Math.max(a,b)},0);k.boundingSphere(b,this._tempSphere);b=e/(2*this._tempSphere.radius);var e=b<d.maxRelativeErrorAlmostCoplanar,
f="horizontal";b<d.maxRelativeErrorCoplanar?f="oblique":e&&(f=Math.abs(h.vec3.dot(c,a))>Math.cos(n.deg2rad(d.verticalAngleThreshold))?"horizontal":"vertical");return f};return p}()})},"esri/views/3d/interactive/measurementTools/support/measurementUtils":function(){define("require exports ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../geometry/geometryEngine ../../../../../geometry/Polygon ../../../../../geometry/SpatialReference ../../../../../geometry/support/geodesicUtils ../../../support/mathUtils ../../../support/projectionUtils".split(" "),
function(u,p,n,a,l,c,q,h,e,g){var b;(function(a){a.boundingSphere=function(a,b){var c=b.center;n.vec3.set(c,0,0,0);for(var d=0;d<a.length;++d)n.vec3.add(c,c,a[d]);n.vec3.scale(c,c,1/a.length);for(var e=0,d=0;d<a.length;++d)e=Math.max(e,n.vec3.squaredDistance(c,a[d]));b.radius=Math.sqrt(e)};a.bestFitPlane=function(a,b){if(3>a.length)throw Error("need at least 3 points to fit a plane");e.planeFromPoints(a[0],a[1],a[2],b)};a.planePointDistance=function(a,b){return n.vec3.dot(a,b)+a[3]};a.segmentLengthEuclidean=
function(a,b,c){return g.pointToVector(a,d,c)&&g.pointToVector(b,k,c)?n.vec3.distance(d,k):0};a.segmentLengthGeodesic=function(a,b){if(!g.pointToWGS84ComparableLonLat(a,d)||!g.pointToWGS84ComparableLonLat(b,k))return 0;a={distance:null};h.inverseGeodeticSolver(a,[d[0],d[1]],[k[0],k[1]]);return a.distance};a.segmentLengthGeodesicVector=function(a,b){var c={distance:null};h.inverseGeodeticSolver(c,[a[0],a[1]],[b[0],b[1]]);return c.distance};a.triangleAreaEuclidean=function(a,b,c){return.5*Math.abs((b[0]-
a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0]))};a.triangleAreaGeodesic=function(a,b,c,e){var h=f;if(!g.vectorToWGS84ComparableLonLat(a,e,d)||!g.vectorToWGS84ComparableLonLat(b,e,k)||!g.vectorToWGS84ComparableLonLat(c,e,w))return 0;h.setPoint(0,0,d);h.setPoint(0,1,k);h.setPoint(0,2,w);return Math.abs(l.geodesicArea(h,"square-meters"))};a.tangentFrame=function(a,b,c){Math.abs(a[0])>Math.abs(a[1])?n.vec3.set(b,0,1,0):n.vec3.set(b,1,0,0);n.vec3.cross(c,a,b);n.vec3.normalize(b,b);n.vec3.cross(b,c,a);n.vec3.normalize(c,
c)};a.fitHemisphere=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=!0);var d=function(a,b){if(0===b[0]&&0===b[1]&&0===b[2])return!1;for(var c=0;c<a.length;++c)if(-1E-6>n.vec3.dot(b,a[c]))return!1;return!0};if(0===a.length)return!1;if(1===a.length)return b&&n.vec3.copy(b,a[0]),!0;n.vec3.set(x,0,0,0);for(var e=0;e<a.length;++e)n.vec3.add(x,x,a[e]);n.vec3.normalize(x,x);if(d(a,x))return b&&n.vec3.copy(b,x),!0;if(!c)return!1;for(e=0;e<a.length;++e)for(c=0;c<a.length;++c)if(e!==c&&(n.vec3.cross(x,
a[e],a[c]),n.vec3.normalize(x,x),d(a,x)))return b&&n.vec3.copy(b,x),!0;return!1};a.compareSets=function(a,b){if(a===b)return!0;if(a.size!==b.size)return!1;for(var c=0;c<a.size;++c)if(!b.has(a[c]))return!1;return!0}})(b||(b={}));var d=a.vec3f64.create(),k=a.vec3f64.create(),w=a.vec3f64.create(),f=new c({rings:[[d,k,w]],spatialReference:q.WGS84}),x=a.vec3f64.create();return b})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/PathChanges":function(){define(["require","exports","../support/setUtils"],
function(u,p,n){return function(){function a(){this.change="none";this.updatedVertices=new Set}a.prototype.fullChange=function(){this.change="full"};a.prototype.incrementalChange=function(a){"none"===this.change&&(this.change="incremental");this.updatedVertices.add(a)};a.prototype.clear=function(){this.change="none";this.updatedVertices.clear()};a.prototype.assign=function(a){this.change=a.change;this.updatedVertices=n.clone(a.updatedVertices)};a.prototype.merge=function(a){var c=this;switch(this.change){case "none":this.assign(a);
break;case "incremental":"incremental"===a.change?a.updatedVertices.forEach(function(a){c.updatedVertices.add(a)}):"full"===a.change&&(this.change="full")}};return a}()})},"esri/views/3d/interactive/measurementTools/support/setUtils":function(){define(["require","exports"],function(u,p){Object.defineProperty(p,"__esModule",{value:!0});p.clone=function(n){var a=new Set;n.forEach(function(l){a.add(l)});return a}})},"esri/views/3d/interactive/measurementTools/support/Path":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/Collection ../../../../../core/Evented ../../../../../core/accessorSupport/decorators".split(" "),
function(u,p,n,a,l,c,q,h){return function(e){function g(){var a=null!==e&&e.apply(this,arguments)||this;a.vertices=new c;return a}n(g,e);Object.defineProperty(g.prototype,"front",{get:function(){return this.vertices.items[0]||null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"back",{get:function(){return this.vertices.items[this.vertices.length-1]||null},enumerable:!0,configurable:!0});g.prototype.clear=function(){this.vertices.removeAll();this.emit("cleared",{});this._notifyFrontBack()};
g.prototype.vertex=function(a){return this.vertices.items[a]};g.prototype.add=function(a){this.vertices.add(a);a=this.vertices.length-1;this._notifyFrontBack();this.emit("vertex-added",{index:a});return a};g.prototype.insert=function(a,c){this.vertices.splice(a,0,c);this._notifyFrontBack();this.emit("vertex-inserted",{index:a});return a};g.prototype.remove=function(a){this.vertices.removeAt(a);this._notifyFrontBack();this.emit("vertex-removed",{index:a})};g.prototype.update=function(a,c){null!=c&&
(this.vertices.splice(a,1,c),this._notifyFrontBack());this.emit("vertex-updated",{index:a})};g.prototype._notifyFrontBack=function(){this.notifyChange("front");this.notifyChange("back")};a([h.property({readOnly:!0})],g.prototype,"vertices",void 0);a([h.property({aliasOf:"vertices.length"})],g.prototype,"length",void 0);a([h.property({readOnly:!0})],g.prototype,"front",null);a([h.property({readOnly:!0})],g.prototype,"back",null);return g=a([h.subclass("esri.views.3d.interactive.measurementTools.support.Path")],
g)}(h.declared(q.EventedMixin(l)))})},"widgets/Measurement3D/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Measurement3D/Widget.html":'\x3cdiv\x3e\r\n\t\x3cheader class\x3d"${baseClass}__header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/header\x3e\r\n\t\x3cdiv class\x3d"hidden" data-dojo-attach-point\x3d"measurementNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"${baseClass}__hint" data-dojo-attach-point\x3d"hintNode"\x3e${nls.hint}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Measurement3D/css/style.css":".esri-area-measurement-3d__container,.esri-direct-line-measurement-3d__container {padding: 0;}.esri-direct-line-measurement-3d {pointer-events: auto;}.jimu-widget-measurement .hidden {display: none !important;}.jimu-widget-measurement .esri-button {height: 32px; cursor: pointer; font-family: inherit; font-size: 14px;}.jimu-widget-measurement .measurement-button-wrapper {padding: 12px 15px;}.jimu-button-group {display: flex; flex-direction: row;}.jimu-button-group \x3e button {font-family: inherit; background: #fff; border: 1px solid #ccc; padding: 5px 10px; line-height: 20px; font-size: 1em; flex-basis: 0; flex-grow: 1; transition: background-color 125ms ease-in-out; position: relative; z-index: 1;}.jimu-button-group \x3e button:hover {background: #f0f0f0;}.jimu-button-group \x3e button.jimu-state-active {background: #24b5cc; border-color: #24b5cc; color: #fff; z-index: 2;}.jimu-button-group \x3e button.jimu-state-active:before {content: none;}.jimu-button-group \x3e button:not(:disabled) {cursor: pointer;}.jimu-button-group \x3e button + button {margin-left: -1px; border-left-width: 0;}.jimu-button-group \x3e button + button::before {content: ''; display: block; position: absolute; left: -1px; top: 4px; bottom: 4px; border-left: 1px solid #ccc;}.jimu-rtl .jimu-button-group \x3e button + button {margin-left: auto; margin-right: -1px; border-left-width: 1px; border-right-width: 0;}.jimu-rtl .jimu-button-group \x3e button + button::before {right: -1px; left: auto;}.jimu-button-group \x3e button img {vertical-align: middle; margin-right: 8px; pointer-events: none;}.jimu-rtl .jimu-button-group \x3e button img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__header {font-size: 14px; text-align: center; border-bottom: 1px solid #e7e7e7; margin-bottom: 12px;}.jimu-widget-measurement__header img {vertical-align: middle; margin-right: 8px;}.jimu-rtl .jimu-widget-measurement__header img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__hint {color: #323232; font-size: 14px;}.jimu-widget-frame.jimu-container .jimu-widget-measurement__header {margin: -14px -14px 14px; padding: 14px 14px 14px;}",
"*now":function(u){u(['dojo/i18n!*preload*widgets/Measurement3D/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/on jimu/BaseWidget ./ButtonGroup jimu/dijit/ViewStack esri/widgets/DirectLineMeasurement3D esri/widgets/AreaMeasurement3D esri/core/watchUtils".split(" "),function(u,p,n,a,l,c,q,h,e){return u([a],{baseClass:"jimu-widget-measurement",name:"Measurement",MEASURE_TYPES:{DISTANCE:"distance",AREA:"area",LOCATION:"location"},measureWidgets:{},selectedMeasureType:null,buttonGroup:null,CSS:{clearButton:"esri-direct-line-measurement-3d__clear-button"},postCreate:function(){this.inherited(arguments);
this.measureWidgets={};this.selectedMeasureType=null},startup:function(){this.inherited(arguments);this.initUI()},destroy:function(){if(this.measureWidgets)for(var a in this.measureWidgets)if(this.measureWidgets.hasOwnProperty(a)){var b=this.measureWidgets[a];b.destroy&&b.destroy()}this.buttonGroup&&this.buttonGroup.destroy&&(this.buttonGroup.destroy(),this.buttonGroup=null);this.selectedMeasureType=null;this.inherited(arguments)},onOpen:function(){this.activateWidget(this.selectedMeasureType)},onClose:function(){this.deactivateWidget(this.selectedMeasureType)},
onActive:function(){this.onOpen()},onDeActive:function(){this.onClose()},_applyConfig:function(a){if(this.config&&a){var b=this.config,c,e;switch(a.measureType){case this.MEASURE_TYPES.DISTANCE:c="lengthUnit";e="defaultLengthUnit";break;case this.MEASURE_TYPES.AREA:c="areaUnit",e="defaultAreaUnit"}b.measurement&&b.measurement[c]?a.unit=b.measurement[c]:b[e]&&(a.unit=b[e])}},_createWidget:function(a){a=this._ensureWidget(a);this._applyConfig(a);return a},_ensureWidget:function(a){var b=this.getWidget(a);
b||(b=document.createElement("div"),a===this.MEASURE_TYPES.DISTANCE?this.measureWidgets[a]=new q({container:b,view:this.sceneView,measureType:a,visible:!1}):a===this.MEASURE_TYPES.AREA&&(this.measureWidgets[a]=new h({container:b,view:this.sceneView,measureType:a})),b=this.measureWidgets[a]);return b},_initWidget:function(a){var b=this.getWidget(a);b||(b=this._createWidget(a),this._addtoViewStack(b));b.visible=!0;this.viewStack.switchView(a)},_addtoViewStack:function(a){if(a){var b=document.createElement("div");
b.label=a.measureType;b.appendChild(a.domNode);this.viewStack.addView(b)}},_initMeasurements:function(a){if(a){var b=[];a instanceof Array&&a.forEach(p.hitch(this,function(a){var c=document.createElement("img");c.title=a.value;c.src=this._getMeasurementIconSource(a.value);b.push({value:a.value,label:a.label,icon:c,content:a.label})}));a=this.buttonGroup=new l({buttons:b,selected:null});a.placeAt(this.headerNode);this.own(n(a,"Change",p.hitch(this,function(a){this._toggleWidgetSection(!!a);this._handleMeasureChanged()})))}},
_handleMeasureChanged:function(){var a=this.buttonGroup.getActiveButtonValue(),b=this.getWidget(this.selectedMeasureType);b&&(b.visible=!1);null!==a&&this._initWidget(a);this.selectedMeasureType=a},_toggleWidgetSection:function(a){a?(this.measurementNode.classList.remove("hidden"),this.hintNode.classList.add("hidden")):(this.measurementNode.classList.add("hidden"),this.hintNode.classList.remove("hidden"))},_getMeasurementIconSource:function(a){var b;switch(a){case this.MEASURE_TYPES.DISTANCE:b=this.folderUrl+
"images/Measure_Distance16.png";break;case this.MEASURE_TYPES.AREA:b=this.folderUrl+"images/Measure_Area16.png"}return b},initUI:function(){var a=this.config,b=[];this.viewStack=new c(null,this.measurementNode);a&&(a.showArea&&b.push({label:this.nls.area,value:this.MEASURE_TYPES.AREA}),a.showDistance&&b.push({label:this.nls.distance,value:this.MEASURE_TYPES.DISTANCE}));0!==b.length&&this._initMeasurements(b)},activateWidget:function(a){},deactivateWidget:function(a){var b=this.getWidget(a);a=this.buttonGroup&&
this.buttonGroup.getActiveButton();b&&("measured"!==b.viewModel.tool.model.state?a&&a.click():(b.viewModel.tool._controller.deactivate(),b.viewModel.tool._view._sceneView.cursor=null,e.once(b.viewModel.tool.model,"state",function(a){"initial"===a&&b.viewModel.tool.activate()})))},getWidget:function(a){return a&&this.measureWidgets[a]}})});