// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Measurement3D/ButtonGroup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/query dojo/dom-class dojo/on dijit/_WidgetBase".split(" "),function(z,t,k,a,f,g,q){return z([q],{baseClass:"jimu-button-group",CSS:{ACTIVE:"jimu-state-active"},buttons:[],activeButton:null,postCreate:function(){this.inherited(arguments);this._initUI()},buttonClicked:function(g){this.activeButton===g?(f.remove(g,this.CSS.ACTIVE),this.activeButton=null):(a("button",this.domNode).removeClass(this.CSS.ACTIVE),
f.add(g,this.CSS.ACTIVE),this.activeButton=g);this.onChange(this.activeButton)},getActiveButton:function(){return this.activeButton},getActiveButtonValue:function(){var a=this.getActiveButton();return a&&a.getAttribute("data-value")},_initUI:function(){k.forEach(this.buttons,function(a){this._createButton(a)},this)},_createButton:function(a){var d=document.createElement("button");d.type="button";d.title=a.label;d.setAttribute("data-value",a.value);a.icon&&d.appendChild(a.icon);d.appendChild(document.createTextNode(a.content||
a.value));this.domNode.appendChild(d);this.own(g(d,"click",t.hitch(this,function(a){this.buttonClicked(a.target)})))},onChange:function(){}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(z,t,k,a,f){return z(f,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);a.forEach(this.views,t.hitch(this,
function(a){1===a.nodeType?(k.place(a,this.domNode),k.addClass(a,"view"),k.setStyle(a,"display","none")):a.domNode&&(k.place(a.domNode,this.domNode),k.addClass(a.domNode,"view"),k.setStyle(a.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var a="",f=this.getSelectedView();f&&(a=f.label);return a},getViewByLabel:function(a){for(var g=0;g<this.views.length;g++)if(a===
this.views[g].label)return this.views[g];return null},addView:function(a){this.views.push(a);1===a.nodeType?(k.place(a,this.domNode),k.addClass(a,"view")):a.domNode&&(k.place(a.domNode,this.domNode),k.addClass(a.domNode,"view"))},removeView:function(g){var f=this.views.length;this.views=a.filter(this.views,function(a){return g!==a});f!==this.views.length&&(1===g.nodeType?k.destroy(g):g.domNode&&g.destroyRecursive())},switchView:function(a){var f,g;f="number"===typeof a?this.views[a]:"string"===typeof a?
this.getViewByLabel(a):a;this.views.forEach(t.hitch(this,function(a){a&&(1===a.nodeType?g=a:a.domNode&&(g=a.domNode),a===f?(k.setStyle(g,"display","block"),a.domNode&&!a._started&&(a.startup(),a._started=!0)):k.setStyle(g,"display","none"))}));this._currentView=f;this.onViewSwitch(f)},onViewSwitch:function(){}})})},"esri/widgets/DirectLineMeasurement3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./DirectLineMeasurement3D/nls/DirectLineMeasurement3D ../core/accessorSupport/decorators ./Widget ./DirectLineMeasurement3D/DirectLineMeasurement3DViewModel ./support/widget".split(" "),
function(z,t,k,a,f,g,q,l,d){return function(b){function c(a){a=b.call(this)||this;a.view=null;a.visible=null;a.viewModel=new l;a.unitOptions=null;a.unit=null;return a}k(c,b);c.prototype.render=function(){var a=this,b=this.viewModel.isSupported,c=this.viewModel.active,e="disabled"===this.viewModel.state,B="ready"===this.viewModel.state,g="measuring"===this.viewModel.state||"measured"===this.viewModel.state,l=this.viewModel.measurement,B=c&&B?d.tsx("section",{key:"esri-direct-line-measurement-3d__hint",
class:"esri-direct-line-measurement-3d__hint"},d.tsx("p",{class:"esri-direct-line-measurement-3d__hint-text"},f.hint)):null,x=b?null:d.tsx("section",{key:"esri-direct-line-measurement-3d__unsupported",class:"esri-direct-line-measurement-3d__panel--error"},d.tsx("p",null,f.unsupported)),p=function(b,c,e){switch(c.state){case "available":return d.tsx("div",{key:e+"-enabled",class:"esri-direct-line-measurement-3d__measurement-item"},d.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},
b),d.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-value"},c.text));case "unavailable":return d.tsx("div",{key:e+"-disabled",class:a.classes("esri-direct-line-measurement-3d__measurement-item","esri-direct-line-measurement-3d__measurement-item--disabled")},d.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},b))}},l=g?d.tsx("section",{key:"esri-direct-line-measurement-3d__measurement",class:"esri-direct-line-measurement-3d__measurement"},p(f.direct,
l.directDistance,"direct"),p(f.horizontal,l.horizontalDistance,"horizontal"),p(f.vertical,l.verticalDistance,"vertical")):null,u=this.id+"__units",p=d.tsx("label",{class:"esri-direct-line-measurement-3d__units-label",for:u},f.unit),u=d.tsx("div",{class:"esri-direct-line-measurement-3d__units-select-wrapper"},d.tsx("select",{class:"esri-direct-line-measurement-3d__units-select esri-select",id:u,onchange:this._changeUnit,bind:this},this.viewModel.unitOptions.map(function(b){return b===a.viewModel.unit?
d.tsx("option",{key:b,value:b,selected:!0},f.units[b]):d.tsx("option",{key:b,value:b},f.units[b])}))),p=d.tsx("section",{key:"esri-direct-line-measurement-3d__units",class:"esri-direct-line-measurement-3d__units"},p,u),p=g?d.tsx("div",{key:"settings",class:"esri-direct-line-measurement-3d__settings"},p):null,b=!b||c&&!g?null:d.tsx("div",{class:"esri-direct-line-measurement-3d__actions"},d.tsx("button",{disabled:e,class:this.classes("esri-button esri-button--secondary","esri-direct-line-measurement-3d__clear-button",
e&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement},f.newMeasurement)),b=this.visible?d.tsx("div",{class:"esri-direct-line-measurement-3d__container"},x,B,p,l,b):null;return d.tsx("div",{key:"",class:"esri-direct-line-measurement-3d esri-widget esri-widget--panel",role:"presentation"},b)};c.prototype._newMeasurement=function(){this.viewModel.newMeasurement()};c.prototype._changeUnit=function(a){a=a.target;if(a=a.options[a.selectedIndex])this.unit=a.value};a([g.aliasOf("viewModel.view")],
c.prototype,"view",void 0);a([g.aliasOf("viewModel.visible"),d.renderable()],c.prototype,"visible",void 0);a([g.aliasOf("viewModel.active"),d.renderable()],c.prototype,"active",void 0);a([g.property({type:l}),d.renderable(["viewModel.state","viewModel.unitOptions","viewModel.unit","viewModel.measurement"])],c.prototype,"viewModel",void 0);a([g.aliasOf("viewModel.unitOptions")],c.prototype,"unitOptions",void 0);a([g.aliasOf("viewModel.unit")],c.prototype,"unit",void 0);a([d.accessibleHandler()],c.prototype,
"_newMeasurement",null);a([d.accessibleHandler()],c.prototype,"_changeUnit",null);return c=a([g.subclass("esri.widgets.DirectLineMeasurement3D")],c)}(g.declared(q))})},"esri/widgets/DirectLineMeasurement3D/DirectLineMeasurement3DViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/Logger ../../core/unitUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool ../support/InteractiveToolViewModel".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c){var y="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" "),n=g.getLogger("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel");return function(c){function e(a){a=c.call(this,a)||this;a.supportedViewType="3d";a._handles=new f;a._userUnitOptions=null;a._userUnit=null;return a}k(e,c);e.prototype.initialize=function(){var a=this;this._handles.add([l.init(this,"unit",function(b){a.tool&&(a.tool.unit=b)})])};e.prototype.destroy=
function(){this._handles.destroy();this._handles=null};Object.defineProperty(e.prototype,"state",{get:function(){return this.isDisabled?"disabled":this.tool.state},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"measurement",{get:function(){if(!this.tool)return null;var a=this.tool.model,b=a.measurementMode,c="geodesic"===b,a=a.validMeasurement;return{mode:b,directDistance:{text:c?null:this.tool.triangleView.directLabel,state:a&&!c?"available":"unavailable"},horizontalDistance:{text:this.tool.triangleView.horizontalLabel,
state:a?"available":"unavailable"},verticalDistance:{text:this.tool.triangleView.verticalLabel,state:a?"available":"unavailable"}}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"defaultUnit",{get:function(){return this.defaultUnitFromPortal||this.defaultUnitFromSpatialReference||"metric"},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"defaultUnitFromSpatialReference",{get:function(){return q.getDefaultUnitSystem(this.view&&this.view.spatialReference)},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"defaultUnitFromPortal",{get:function(){var a=this.get("view.map.portalItem.portal");if(!a)return null;switch(a.user&&a.user.units||a.units){case "metric":return"metric";case "english":return"imperial";default:return null}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"unitOptions",{get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(a){this._userUnitOptions=a;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"unit",{get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},set:function(a){this._userUnit=a?this._findSelectableUnit(a,this._userUnit):null;this.notifyChange("unit")},enumerable:!0,configurable:!0});e.prototype.newMeasurement=function(){this.tool&&this.tool.newMeasurement()};e.prototype.clearMeasurement=function(){this.tool&&this.tool.clearMeasurement()};
e.prototype.createToolParams=function(){return{toolConstructor:b,constructorArguments:{unit:this.unit}}};e.prototype.logUnsupportedError=function(){n.error("DirectLineMeasurement3D widget is not implemented for MapView")};e.prototype.logError=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];n.error.apply(n,a)};e.prototype._findSelectableUnit=function(a,b){var c=this.unitOptions;return-1!==c.indexOf(a)?a:b?this._findSelectableUnit(b):c[0]};e.prototype._filteredOrAllUnits=function(a){if(!a)return y.slice();
a=a.filter(function(a){return-1!==y.indexOf(a)});return 0===a.length?y.slice():a};a([d.property({dependsOn:["view.ready","isDisabled","tool.state"],readOnly:!0})],e.prototype,"state",null);a([d.property({dependsOn:"view.ready tool.triangleView tool.model.directDistance tool.model.horizontalDistance tool.model.verticalDistance tool.model.geodesicDistance tool.model.measurementMode".split(" "),readOnly:!0})],e.prototype,"measurement",null);a([d.property()],e.prototype,"tool",void 0);a([d.property({readOnly:!0,
dependsOn:["defaultUnitFromPortal","defaultUnitFromSpatialReference"]})],e.prototype,"defaultUnit",null);a([d.property({readOnly:!0,dependsOn:["view.spatialReference"]})],e.prototype,"defaultUnitFromSpatialReference",null);a([d.property({readOnly:!0,dependsOn:["view.map.portalItem.portal.units","view.map.portalItem.portal.user.units"]})],e.prototype,"defaultUnitFromPortal",null);a([d.property({dependsOn:["view.spatialReference"]})],e.prototype,"unitOptions",null);a([d.property({dependsOn:["unitOptions",
"defaultUnit"]})],e.prototype,"unit",null);return e=a([d.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],e)}(d.declared(c))})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/restHelper ../../../../../core/Handles ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./DirectLineMeasurement3DController ./DirectLineMeasurement3DModel ./DirectLineMeasurement3DView ../../../../interactive/InteractiveToolBase ../../../../interactive/interactiveToolUtils".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n){return function(w){function e(a){var c=w.call(this,a)||this;c.manipulators=null;c.model=new b({sceneView:a.view});return c}k(e,w);e.prototype.normalizeCtorArgs=function(a){return f(a,["view"])};e.prototype.initialize=function(){var a=this;this._view=new c(this.model);this._controller=new d(this.model,this._view);this._handles=new g;this._handles.add([q.init(this,"state",function(){"measuring"===a.state?n.setActive(a,!0):"measured"===a.state&&n.setActive(a,!1)},
!0)])};e.prototype.destroy=function(){this._view.destroy();this._view=null;this._controller.destroy();this._controller=null;this._handles.destroy();this._handles=null};Object.defineProperty(e.prototype,"state",{get:function(){return this.model.isMeasuring?"measured"===this.model.state?"measured":"measuring":"ready"},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isSupported",{get:function(){return"3d"===this.get("view.type")},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"cursor",{get:function(){return!this.model.active||"drawing"!==this.model.state&&"initial"!==this.model.state?null:"crosshair"},enumerable:!0,configurable:!0});e.prototype.show=function(){this._view.show()};e.prototype.hide=function(){this._view.hide()};e.prototype.newMeasurement=function(){this.model.reset();n.setActive(this,!0)};e.prototype.clearMeasurement=function(){this.model.reset()};e.prototype.activate=function(){this.model.active=!0};e.prototype.deactivate=function(){this.model.active=!1;
"measured"!==this.model.state&&this.clearMeasurement()};e.prototype.onAttach=function(a){var b=this._view.createManipulators();this._controller.setup(b);a.addManipulator(b.start);a.addManipulator(b.end);this.manipulators=b};e.prototype.onDetach=function(){this.model.reset();this.manipulators=null};e.prototype.onInputEvent=function(a,b){this._controller.handleInputEvent(a,this.manipulators,b);this.manipulators.start.visible=null!=this.model.startPoint;this.manipulators.end.visible=null!=this.model.endPoint};
a([l.property({dependsOn:["model.isMeasuring","model.state"],readOnly:!0})],e.prototype,"state",null);a([l.property({dependsOn:["view.type"],readOnly:!0})],e.prototype,"isSupported",null);a([l.property({dependsOn:["model.active","model.state"],readOnly:!0})],e.prototype,"cursor",null);a([l.property({constructOnly:!0})],e.prototype,"model",void 0);a([l.aliasOf("model.sceneView")],e.prototype,"view",void 0);a([l.aliasOf("model.mode")],e.prototype,"mode",void 0);a([l.aliasOf("model.unit")],e.prototype,
"unit",void 0);a([l.aliasOf("model.directDistance")],e.prototype,"directDistance",void 0);a([l.aliasOf("model.validMeasurement")],e.prototype,"validMeasurement",void 0);a([l.aliasOf("model.horizontalDistance")],e.prototype,"horizontalDistance",void 0);a([l.aliasOf("model.verticalDistance")],e.prototype,"verticalDistance",void 0);a([l.aliasOf("model.geodesicDistance")],e.prototype,"geodesicDistance",void 0);a([l.aliasOf("model.geodesicAngle")],e.prototype,"geodesicAngle",void 0);a([l.aliasOf("model.triangleView")],
e.prototype,"triangleView",void 0);return e=a([l.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],e)}(l.declared(y))})},"esri/core/tsSupport/restHelper":function(){define([],function(){return function(z,t){var k={},a;for(a in z)Object.prototype.hasOwnProperty.call(z,a)&&0>t.indexOf(a)&&(k[a]=z[a]);if(null!=z&&"function"===typeof Object.getOwnPropertySymbols){var f=0;for(a=Object.getOwnPropertySymbols(z);f<a.length;f++)0>t.indexOf(a[f])&&(k[a[f]]=
z[a[f]])}return k}})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../geometry ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../layers/graphics/dehydratedFeatures ./DirectLineMeasurement3DView".split(" "),function(z,t,k,a,f,g,q,l,d,b){z=function(){function a(a,
c){this._handles=new g;this._cachedPickRequest=new b.PickRequest;this._cachedPickResult=new b.PickResult;this._isAnyPointerDown=!1;this.model=a;this.view=c;this.model.reset()}a.prototype.destroy=function(){this._handles.destroy();this._handles=null};a.prototype.setup=function(a){var b=this,e=a.start,g=a.end;e.on("drag",function(){var a=e.mapPoint,g=e.surfaceType;q.isSome(a)&&q.isSome(g)&&(a=d.clonePoint(a,c),b.model.startPoint=a,b.model.startPointSurfaceLocation=b._surfaceLocation(a,g))});g.on("drag",
function(){var a=g.mapPoint,e=g.surfaceType;q.isSome(a)&&q.isSome(e)&&(a=d.clonePoint(a,c),b.model.endPoint=a,b.model.endPointSurfaceLocation=b._surfaceLocation(a,e))});[e,g].forEach(function(c){b._handles.add([c.watch("grabbing",function(){var c=a.start.grabbing||a.end.grabbing;c&&"measured"===b.model.state&&(b.model.state="editing");c||(b.model.finishedMeasurement({cameraAboveGround:b.view.cameraAboveGround}),"editing"===b.model.state&&(b.model.state="measured"))},!0)])})};a.prototype.handleInputEvent=
function(a,b,c){switch(a.type){case "immediate-click":this._handleImmediateClick(a,b,c);break;case "pointer-move":this._handlePointerMove(a,b,c);break;case "pointer-down":this._handlePointerDown(a);break;case "pointer-up":this._handlePointerUp(a);break;case "key-down":this._handleKeyDown(a)}};a.prototype._handlePointerMove=function(a,b,c){this._clearCachedPickRequest();var e=l.createScreenPointFromEvent(a);"mouse"===a.pointerType&&(this._hoverAt(e),"drawing"===this.model.state&&(c.attemptManipulatorDragTo(b.end,
e),a.stopPropagation()))};a.prototype._handlePointerDown=function(a){this._isAnyPointerDown=!0};a.prototype._handlePointerUp=function(a){this._isAnyPointerDown=!1};a.prototype._handleImmediateClick=function(a,b,c){this._clearCachedPickRequest();if("mouse"!==a.pointerType||0===a.button){var e=l.createScreenPointFromEvent(a),d=!1;if(this.model.active)switch(this.model.state){case "initial":b.start.attemptDragTo({screenPoint:e})&&(b.start.interactive=!1,b.end.interactive=!1,this.model.state="drawing",
d=!0);break;case "drawing":c.attemptManipulatorDragTo(b.end,e)&&(b.start.interactive=!0,b.end.interactive=!0,this.model.finishedMeasurement({cameraAboveGround:this.view.cameraAboveGround}),d=!0)}d&&a.stopPropagation();"mouse"===a.pointerType&&this._hoverAt(e)}};a.prototype._handleKeyDown=function(a){"Escape"===a.key&&"drawing"===this.model.state&&(this.model.clearMeasurement(),a.stopPropagation())};a.prototype._hoverAt=function(a){var b=this._isAnyPointerDown&&"drawing"!==this.model.state&&"editing"!==
this.model.state;this.view.requiresCursorPoint&&!b?(a=this._pick(a),a.mapPoint&&(this.model.cursorPoint=a.mapPoint)):this.model.cursorPoint=null};a.prototype._pick=function(a){var b=this._cachedPickRequest.screenPoint;if(b&&b.x===a.x&&b.y===a.y)return this._cachedPickResult;this._cachedPickRequest.screenPoint=a;return this._cachedPickResult=this.view.pick(this._cachedPickRequest)};a.prototype._clearCachedPickRequest=function(){this._cachedPickRequest.screenPoint=null};a.prototype._surfaceLocation=
function(a,b){return"ground"===b?"on-the-surface":a.z>=this.view.getElevation(a)?"above-the-surface":"below-the-surface"};return a}();var c=new f.Point;return z})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DView":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ./LaserLineRenderer ../support/Label ../support/LabelSegment ../support/labelUtils ../support/PathSegmentInterpolator ../support/viewUtils ../../../support/mathUtils ../../../support/stack ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryData ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/Layer ../../../webgl-engine/lib/Object3D ../../../webgl-engine/materials/ColorMaterial ../../../webgl-engine/materials/MeasurementArrowMaterial ../../../webgl-engine/materials/RibbonLineMaterial ../../../webgl-engine/parts/Model ../../../../interactive/manipulatorUtils".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n,w,e,B,A,C,x,p,u,E,r,h,m,G,D,H,F,v){z=[1,.5,0,.75];var I={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,triangleColor:z,triangleLineWidth:3,triangleCornerSize:32,triangleSubdivisions:128,arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,
arrowSubdivisions:128,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:z,guideLineWidth:2,guideLineColor:z,guideStippleLengthPixels:6,labelDistance:25};z=function(){function a(a,b){void 0===b&&(b={});this._visible=!1;this._laserLineRenderer=null;this._directDistanceLabel=new n;this._horizontalDistanceLabel=new n;this._verticalDistanceLabel=new n;this._handles=new f;this._listenerHandles=null;this._cursorPosition=c.vec3f64.create();this._startPosition=c.vec3f64.create();this._endPosition=
c.vec3f64.create();this._centerPosition=c.vec3f64.create();this._cornerPosition=c.vec3f64.create();this._arrowLabelSegment=new w;this._horizontalLabelSegment=new w;this._verticalLabelSegment=new w;this._geodesicProjectionLabelSegment=new w;this._origin=c.vec3f64.create();this._originTransform=l.mat4f64.create();this._lastDraggedHandle=null;this._model=a;this._sceneView=a.sceneView;this._params=A.copyParameter(I,b);this._layer=new h("point-to-point-measurement",{isPickable:!1});this._createMaterials();
this._createObjects();this._intersector=new r(this._sceneView.viewingMode)}a.prototype.destroy=function(){this.hide();this._handles.destroy();this._handles=null};Object.defineProperty(a.prototype,"requiresCursorPoint",{get:function(){return"initial"===this._model.state&&this._model.active},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"cameraAboveGround",{get:function(){return this._sceneView.state.camera.aboveGround},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"visible",{get:function(){return this._visible},set:function(a){a?this.show():this.hide()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"testData",{get:function(){return{labels:{direct:this._directDistanceLabel,horizontal:this._horizontalDistanceLabel,vertical:this._verticalDistanceLabel},laserLineRenderer:this._laserLineRenderer}},enumerable:!0,configurable:!0});a.prototype.createManipulators=function(){var a=this,b=function(){var b=v.createSphereManipulator(a._sceneView,a._params.handleColor,
a._params.handleOpacity);b.visible=!1;b.hideOnGrab=!0;b.radius=a._params.handleRadius;return b},c=b(),e=b();this._model.startPoint&&(c.mapPoint=this._model.startPoint,c.visible=!0);this._model.endPoint&&(e.mapPoint=this._model.endPoint,e.visible=!0);var p=function(){var b=a._lastDraggedHandle;c.grabbing&&!e.grabbing&&(b="start");e.grabbing&&!c.grabbing&&(b="end");c.grabbing||e.grabbing||(b=null);var v=b!==a._lastDraggedHandle;a._lastDraggedHandle=b;v&&a._updateLaserLine()};this._handles.add([c.watch("grabbing",
function(){p()}),e.watch("grabbing",function(){p()})]);return{start:c,end:e}};a.prototype.show=function(){if(!this._visible){this._visible=!0;var a=this._sceneView._stage;this._laserLineRenderer=new y(this._sceneView.renderCoordsHelper,{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,globalAlpha:this._params.laserLineGlobalAlpha});a.addRenderPlugin(this._laserLineRenderer.renderSlots,
this._laserLineRenderer);this._addToStage(a);this._directDistanceLabel.addToView(this._sceneView);this._horizontalDistanceLabel.addToView(this._sceneView);this._verticalDistanceLabel.addToView(this._sceneView);this._initializeListeners();this._updateCursorPosition();this._updateStartPosition();this._updateEndPosition();this._updateLaserLine();this._updateView()}};a.prototype.hide=function(){if(this._visible){this._visible=!1;var a=this._sceneView._stage;a.removeRenderPlugin(this._laserLineRenderer);
this._laserLineRenderer=null;this._removeFromStage(a);this._directDistanceLabel.removeFromView(this._sceneView);this._horizontalDistanceLabel.removeFromView(this._sceneView);this._verticalDistanceLabel.removeFromView(this._sceneView);this._destroyListeners();this._sceneView.cursor=null}};a.prototype.pick=function(b){var v=this._sceneView.spatialReference;b=g.screenPointObjectToArray(b.screenPoint);b=this._sceneView.sceneIntersectionHelper.intersectToolIntersectorScreen(b,this._intersector).results.min;
var e=c.vec3f64.create();if(!b.getIntersectionPoint(e))return new a.PickResult;v=this._sceneView.renderCoordsHelper.fromRenderCoords(e,v);return new a.PickResult("TerrainRenderer"===b.intersector?"ground":"feature",e,v)};a.prototype.getElevation=function(a){return this._sceneView.basemapTerrain.ready?this._sceneView.basemapTerrain.getElevation(a)||0:0};a.prototype.overlappingHandles=function(a,b){return A.pointToPointScreenDistance(a,b,this._sceneView)<=this._params.handleRadius};a.prototype._createMaterials=
function(){this._triangleLineMaterial=new H({width:this._params.triangleLineWidth,color:this._params.triangleColor,polygonOffset:!0},"triangle-line");this._triangleLineMaterial.renderOccluded=4;this._triangleCornerMaterial=new G({color:this._params.triangleColor,transparent:!0,writeDepth:!1,polygonOffset:!0},"triangle-corner");this._triangleCornerMaterial.renderOccluded=4;this._arrowMaterial=new D({outlineColor:this._params.arrowOutlineColor,stripeEvenColor:this._params.arrowStripeEvenColor,stripeOddColor:this._params.arrowStripeOddColor,
polygonOffset:!0},"arrow");this._arrowMaterial.renderOccluded=4;this._geodesicProjectionLineMaterial=new H({width:this._params.geodesicProjectionLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0},"geodesic-line");this._geodesicProjectionLineMaterial.renderOccluded=4;this._geodesicGuideLineMaterial=new H({width:this._params.guideLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0,stippleLength:0},"geodesic-guide");this._geodesicGuideLineMaterial.renderOccluded=
4};a.prototype._createObjects=function(){this._triangleLineObject=new m;this._layer.addObject(this._triangleLineObject);this._triangleCornerObject=new m;this._layer.addObject(this._triangleCornerObject);this._arrowObject=new m;this._layer.addObject(this._arrowObject);this._geodesicProjectionLineObject=new m;this._layer.addObject(this._geodesicProjectionLineObject);this._geodesicProjectionStartGuideObject=new m;this._layer.addObject(this._geodesicProjectionStartGuideObject);this._geodesicProjectionEndGuideObject=
new m;this._layer.addObject(this._geodesicProjectionEndGuideObject)};a.prototype._addToStage=function(a){a.add(F.ContentType.LAYER,this._layer);a.add(F.ContentType.MATERIAL,this._triangleLineMaterial);a.add(F.ContentType.MATERIAL,this._triangleCornerMaterial);a.add(F.ContentType.MATERIAL,this._arrowMaterial);a.add(F.ContentType.MATERIAL,this._geodesicProjectionLineMaterial);a.add(F.ContentType.MATERIAL,this._geodesicGuideLineMaterial);a.add(F.ContentType.OBJECT,this._triangleLineObject);a.add(F.ContentType.OBJECT,
this._triangleCornerObject);a.add(F.ContentType.OBJECT,this._arrowObject);a.add(F.ContentType.OBJECT,this._geodesicProjectionLineObject);a.add(F.ContentType.OBJECT,this._geodesicProjectionStartGuideObject);a.add(F.ContentType.OBJECT,this._geodesicProjectionEndGuideObject);a.addToViewContent([this._layer.id])};a.prototype._removeFromStage=function(a){a.removeFromViewContent([this._layer.id]);a.remove(F.ContentType.LAYER,this._layer.id);a.remove(F.ContentType.MATERIAL,this._triangleLineMaterial.id);
a.remove(F.ContentType.MATERIAL,this._triangleCornerMaterial.id);a.remove(F.ContentType.MATERIAL,this._arrowMaterial.id);a.remove(F.ContentType.MATERIAL,this._geodesicProjectionLineMaterial.id);a.remove(F.ContentType.MATERIAL,this._geodesicGuideLineMaterial.id);a.remove(F.ContentType.OBJECT,this._triangleLineObject.id);a.remove(F.ContentType.OBJECT,this._triangleCornerObject.id);a.remove(F.ContentType.OBJECT,this._arrowObject.id);a.remove(F.ContentType.OBJECT,this._geodesicProjectionLineObject.id);
a.remove(F.ContentType.OBJECT,this._geodesicProjectionStartGuideObject.id);a.remove(F.ContentType.OBJECT,this._geodesicProjectionEndGuideObject.id)};a.prototype._getLabelPositions=function(a,b,c,v,p){var m=this._model.triangleView.collapsed,r=g.castRenderScreenPointArray3(x.sv3d.get()),u=g.castRenderScreenPointArray3(x.sv3d.get());p.projectPoint(c,r);p.projectPoint(b,u);r={direct:m?"top":"bottom",horizontal:"top",vertical:r[0]<u[0]?"left":"right"};m||(u=x.sv2d.get(),m=x.sv2d.get(),A.screenSpaceTangent(a,
c,u,p),A.screenSpaceTangent(a,b,m,p),d.vec2.dot(u,m)>=J?r.direct=C.sign(u[1])===C.sign(m[1])?e.mirrorPosition(r.vertical):r.vertical:(a=g.castRenderScreenPointArray(x.sv2d.get()),A.screenSpaceTangent(c,b,a,p),d.vec2.dot(a,m)>=J&&(r.direct=C.sign(a[0])===C.sign(m[0])?e.mirrorPosition(r.horizontal):r.horizontal)));"below-the-surface"===v&&(b=function(a){return"top"===a?"bottom":"top"},r.direct=b(r.direct),r.horizontal=b(r.horizontal),r.vertical=b(r.vertical));return r};a.prototype._updateView=function(){var a;
if(this._sceneView.ready){var c=this._sceneView._stage.getCamera(),v=this._sceneView.renderCoordsHelper,e=this._model.triangleView;if(e.visible){var p="camera-dependent"===this._model.measurementSurfaceLocation?this._sceneView.state.camera.aboveGround?"above-the-surface":"below-the-surface":this._model.measurementSurfaceLocation,m=this._startPosition;a=this._endPosition;var d="above-the-surface"===p?1:-1,r=d*(v.getAltitude(a)-v.getAltitude(m));0>r&&(a=[a,m],m=a[0],a=a[1]);var u=this._cornerPosition;
v.worldUpAtPosition(m,u);b.vec3.scale(u,u,d*Math.abs(r));b.vec3.add(u,u,m);v=this._centerPosition;A.midpoint([m,a,u],v);b.vec3.copy(this._origin,v);q.mat4.identity(this._originTransform);q.mat4.translate(this._originTransform,this._originTransform,this._origin);e.collapsed?(this._triangleLineObject.removeAllGeometries(),this._triangleCornerObject.removeAllGeometries()):this._updateTriangleObjects(this._triangleLineObject,this._triangleCornerObject,m,a,u,this._origin,this._originTransform,c,e.mode,
this._horizontalLabelSegment,this._verticalLabelSegment);this._updateArrowObject(this._arrowObject,this._startPosition,this._endPosition,this._origin,this._originTransform,e.stripeLength,c,e.mode,this._arrowLabelSegment);v=this._requiresGeodesicGuides(this._startPosition,this._endPosition,c,e.mode);this._updateGeodesicProjectionLineObject(this._geodesicProjectionLineObject,this._startPosition,this._endPosition,this._origin,this._originTransform,v,this._geodesicProjectionLabelSegment);this._updateGeodesicProjectionGuideObjects(c,
v);d=this._params.labelDistance;p=this._getLabelPositions(m,a,u,p,c);this._updateAuxiliaryMeasureLabels(e,c,p);"geodesic"!==e.mode?this._updateLabel(this._directDistanceLabel,this._arrowLabelSegment,d,p.direct,e.directLabel,e.visible,16,c):(this._updateLabel(this._horizontalDistanceLabel,v?this._geodesicProjectionLabelSegment:this._arrowLabelSegment,d,p.horizontal,e.horizontalLabel,e.visible,16,c),this._directDistanceLabel.visible=!1)}else this._triangleLineObject.removeAllGeometries(),this._triangleCornerObject.removeAllGeometries(),
this._arrowObject.removeAllGeometries(),this._geodesicProjectionLineObject.removeAllGeometries(),this._geodesicProjectionStartGuideObject.removeAllGeometries(),this._geodesicProjectionEndGuideObject.removeAllGeometries(),this._directDistanceLabel.visible=!1,this._horizontalDistanceLabel.visible=!1,this._verticalDistanceLabel.visible=!1}};a.prototype._updateAuxiliaryMeasureLabels=function(a,b,c){if(a.collapsed)this._horizontalDistanceLabel.visible=!1,this._verticalDistanceLabel.visible=!1;else{var v=
this._params.labelDistance;this._updateLabel(this._horizontalDistanceLabel,this._horizontalLabelSegment,v,c.horizontal,a.horizontalLabel,!0,12,b);this._updateLabel(this._verticalDistanceLabel,this._verticalLabelSegment,v,c.vertical,a.verticalLabel,!0,12,b)}};a.prototype._updateTriangleObjects=function(a,c,v,e,m,d,r,u,h,g,f){h=[b.vec3.subtract(x.sv3d.get(),v,d),b.vec3.subtract(x.sv3d.get(),m,d),b.vec3.subtract(x.sv3d.get(),e,d)];g.update(m,e);f.update(v,m);g=new p(E.createPolylineGeometry(h),"triangle-line");
a.removeAllGeometries();a.addGeometry(g,this._triangleLineMaterial,r);a=x.sv3d.get();g=x.sv3d.get();b.vec3.subtract(a,m,v);b.vec3.normalize(a,a);b.vec3.subtract(g,e,m);b.vec3.normalize(g,g);v=.33*Math.min(b.vec3.distance(m,v),b.vec3.distance(m,e));u=this._params.triangleCornerSize*u.computeScreenPixelSizeAt(m);m=new p(this._quadGeometryData(m,a,g,Math.min(v,u),d),"triangle-corner");c.removeAllGeometries();c.addGeometry(m,this._triangleCornerMaterial,r)};a.prototype._updateArrowObject=function(a,b,
c,v,e,p,m,d,r){this._createInterpolatedLineGeometry(a,this._arrowMaterial,"arrow",b,c,v,e,d,this._arrowLabelSegment);a=m.computeScreenPixelSizeAt(r.origin);this._arrowMaterial.setParameterValues({width:this._params.arrowWidth*a,stripeLength:p})};a.prototype._getSegmentInterpolator=function(a,b){var c=this._sceneView.spatialReference,v=this._sceneView.renderCoordsHelper.spatialReference;return c.isWebMercator||c.isWGS84?new B.Spherical(a,b,v,v):new B.Linear(a,b)};a.prototype._updateGeodesicProjectionLineObject=
function(a,c,v,e,p,m,d){m?(m=this._sceneView.renderCoordsHelper,c=b.vec3.copy(x.sv3d.get(),c),v=b.vec3.copy(x.sv3d.get(),v),m.setAltitude(0,c),m.setAltitude(0,v),this._createInterpolatedLineGeometry(a,this._geodesicProjectionLineMaterial,"geodesicProjectionLine",c,v,e,p,"geodesic",d)):a.removeAllGeometries()};a.prototype._requiresGeodesicGuides=function(a,b,c,v){return"geodesic"===v&&this._model.geodesicDistanceExceeded?this._requiresGeodesicGuideAt(a,c)||this._requiresGeodesicGuideAt(b,c):!1};a.prototype._requiresGeodesicGuideAt=
function(a,b){var c=this._sceneView.renderCoordsHelper;b=b.computeScreenPixelSizeAt(a);return 10<=c.getAltitude(a)/b};a.prototype._updateGeodesicProjectionGuideObjects=function(a,c){if(c){c=this._sceneView.renderCoordsHelper;var v=b.vec3.copy(x.sv3d.get(),this._startPosition),e=b.vec3.copy(x.sv3d.get(),this._endPosition);c.setAltitude(0,v);c.setAltitude(0,e);this._createInterpolatedLineGeometry(this._geodesicProjectionStartGuideObject,this._geodesicGuideLineMaterial,"geodesicGuideLine",v,this._startPosition,
this._origin,this._originTransform,"euclidean");this._createInterpolatedLineGeometry(this._geodesicProjectionEndGuideObject,this._geodesicGuideLineMaterial,"geodesicGuideLine",e,this._endPosition,this._origin,this._originTransform,"euclidean");a=Math.min(a.computeScreenPixelSizeAt(this._startPosition),a.computeScreenPixelSizeAt(v),a.computeScreenPixelSizeAt(this._endPosition),a.computeScreenPixelSizeAt(e));this._geodesicGuideLineMaterial.setParameterValues({stippleLength:this._params.guideStippleLengthPixels*
a})}else this._geodesicProjectionStartGuideObject.removeAllGeometries(),this._geodesicProjectionEndGuideObject.removeAllGeometries()};a.prototype._createInterpolatedLineGeometry=function(a,c,v,e,m,d,r,u,g){var h=this._sceneView.renderCoordsHelper,f=[],G=[],y=function(a,c){var v=x.sv3d.get();b.vec3.subtract(v,a,d);f.push(v);G.push(c)};if("euclidean"===u){var l=x.sv3d.get();A.midpoint([e,m],l);u=x.sv3d.get();h.worldUpAtPosition(l,u);y(e,u);y(m,u);g&&g.update(e,m)}else{e=this._getSegmentInterpolator(e,
m);m=this._params.arrowSubdivisions+1&-2;for(var w=l=null,n=0;n<m;++n){var I=n/(m-1),k=x.sv3d.get();u=x.sv3d.get();e.eval(I,k);h.worldUpAtPosition(k,u);n===m/2-1?l=k:n===m/2&&(w=k);y(k,u)}g&&g.update(l,w)}v=new p(E.createPolylineGeometry(f,G),v);a.removeAllGeometries();a.addGeometry(v,c,r)};a.prototype._quadGeometryData=function(a,c,v,e,m){var p=x.sv3d.get(),d=[],r=x.sv3d.get();b.vec3.scale(r,v,e);v=x.sv3d.get();b.vec3.scale(v,c,-e);for(c=0;4>c;++c)b.vec3.copy(p,a),b.vec3.subtract(p,p,m),c&1&&b.vec3.add(p,
p,r),c&2&&b.vec3.add(p,p,v),d.push(p[0],p[1],p[2]);return new u({position:{size:3,data:d}},{position:new Uint32Array([0,1,2,1,2,3])})};a.prototype._updateLabel=function(a,b,c,v,m,p,d,r){var u=g.castScreenPointArray(x.sv2d.get()),h=g.castScreenPointArray(x.sv2d.get());b=e.computeLabelPositionFromSegment(r,b,c,v,u,h);a.updatePosition(u,h);a.text=m;a.visible=b&&p;a.fontSize=d};a.prototype._updateCursorPosition=function(){this._model.cursorPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.cursorPoint,
this._cursorPosition);this._updateLaserLine()};a.prototype._updateStartPosition=function(){this._model.startPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.startPoint,this._startPosition)};a.prototype._updateEndPosition=function(){this._model.endPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.endPoint,this._endPosition)};a.prototype._getFocusPosition=function(){var a=this._model,b=a.triangleView.visible&&a.triangleView.collapsed&&"euclidean"===a.measurementMode;
switch(a.state){case "drawing":return b?this._startPosition:a.endPoint?this._endPosition:this._startPosition;case "editing":return b?"start"===this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return a.cursorPoint?this._cursorPosition:null}};a.prototype._getFocusSpherePosition=function(){return"drawing"===this._model.state||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition};a.prototype._updateLaserLine=
function(){var a=this._model,b=this._getFocusPosition(),c=this._params.laserLineEnabled&&!!b&&"measured"!==a.state&&a.active;c?(this._laserLineRenderer.focusPlaneActive=c&&"euclidean"===a.measurementMode,this._laserLineRenderer.focusSphereActive=c&&!!a.startPoint&&"geodesic"===a.measurementMode,this._laserLineRenderer.focusPosition=b,this._laserLineRenderer.focusSpherePosition=this._getFocusSpherePosition(),this._laserLineRenderer.segmentActive=c&&a.triangleView.visible&&!a.triangleView.collapsed,
this._laserLineRenderer.segmentStartPosition=this._startPosition,this._laserLineRenderer.segmentEndPosition=this._endPosition):(this._laserLineRenderer.focusPlaneActive=!1,this._laserLineRenderer.focusSphereActive=!1,this._laserLineRenderer.segmentActive=!1)};a.prototype._initializeListeners=function(){var a=this;this._listenerHandles=new f;this._listenerHandles.add([this._model.watch("state",function(){a._updateLaserLine()}),this._model.watch("measurementMode",function(){a._updateLaserLine()}),this._model.watch("hoveredHandle",
function(){a._updateView()}),this._model.watch("cursorPoint",function(){a._updateCursorPosition()}),this._model.watch("startPoint",function(){a._updateStartPosition();a._updateView();a._updateLaserLine()}),this._model.watch("endPoint",function(){a._updateEndPosition();a._updateView();a._updateLaserLine()}),this._model.watch("unit",function(){a._updateView()}),this._model.watch("active",function(){a._updateLaserLine();a._updateView()}),this._sceneView.state.watch("camera",function(){a._updateView()})])};
a.prototype._destroyListeners=function(){this._listenerHandles.destroy();this._listenerHandles=null};return a}();(function(a){var b=function(){return function(){}}();a.PickRequest=b;b=function(){return function(a,b,c){void 0===a&&(a=null);void 0===b&&(b=null);void 0===c&&(c=null);this.type=a;this.scenePoint=b;this.mapPoint=c}}();a.PickResult=b})(z||(z={}));var J=Math.cos(C.deg2rad(12));return z})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/LaserLineRenderer":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/vec4 ../../../../../core/libs/gl-matrix-2/vec4f64 ../../../webgl-engine/lib/glUtil3D ../../../webgl-engine/lib/Util ../../../webgl-engine/materials/internal/MaterialUtil ../../../webgl-engine/shaders/LaserLinePrograms ../../../../webgl/renderState".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n){function w(a,b,c,d){var p=e,r=B;f.vec3.transformMat4(p,b,d);f.vec3.copy(r,c);r[3]=0;q.vec4.transformMat4(r,r,d);q.vec4.set(a,r[0],r[1],r[2],-f.vec3.dot(r,p))}var e=g.vec3f64.create(),B=l.vec4f64.create(),A={glowColor:[1,.5,0],glowWidth:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75};return function(){function k(b,e){void 0===e&&(e={});this._projInfo=l.vec4f64.create();this._zScale=a.vec2f64.create();this._segmentActive=this._focusSphereActive=this._focusPlaneActive=
!1;this._focusPosition=g.vec3f64.create();this._focusSpherePosition=g.vec3f64.create();this._segmentStartPosition=g.vec3f64.create();this._segmentEndPosition=g.vec3f64.create();this._needsRender=!1;this._tempNormal=g.vec3f64.create();this._tempDir=g.vec3f64.create();this._tempUp=g.vec3f64.create();this._tempVec3=g.vec3f64.create();this._tempVec4=l.vec4f64.create();this.didRender=!1;this._renderCoordsHelper=b;this._params=c.copyParameters(e,A)}Object.defineProperty(k.prototype,"needsRender",{get:function(){return this._needsRender},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"renderSlots",{get:function(){return[14]},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"needsLinearDepth",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"focusPlaneActive",{get:function(){return this._focusPlaneActive},set:function(a){a!==this._focusPlaneActive&&(this._focusPlaneActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"focusSphereActive",{get:function(){return this._focusSphereActive},set:function(a){a!==this._focusSphereActive&&(this._focusSphereActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"segmentActive",{get:function(){return this._segmentActive},set:function(a){a!==this._segmentActive&&(this._segmentActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"focusPosition",{get:function(){return this._focusPosition},
set:function(a){f.vec3.copy(this._focusPosition,a);this._needsRender=!0},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"focusSpherePosition",{get:function(){return this._focusSpherePosition},set:function(a){f.vec3.copy(this._focusSpherePosition,a);this._needsRender=!0},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"segmentStartPosition",{get:function(){return this._segmentStartPosition},set:function(a){f.vec3.copy(this._segmentStartPosition,a);this._needsRender=
!0},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"segmentEndPosition",{get:function(){return this._segmentEndPosition},set:function(a){f.vec3.copy(this._segmentEndPosition,a);this._needsRender=!0},enumerable:!0,configurable:!0});k.prototype.setParameterValues=function(a){c.updateParameters(this._params,a)&&(this._needsRender=!0)};k.prototype.initializeRenderContext=function(a){this._quadVAO=d.createQuadVAO(a.rctx);this._laserLineProgram=a.programRep.getProgram(y.program);this._laserLinePipelineState=
n.makePipelineState({blending:n.simpleBlendingParams(1,771),colorWrite:n.defaultColorWriteParams})};k.prototype.uninitializeRenderContext=function(a){this._quadVAO.dispose();this._projInfo=this._laserLineProgram=this._quadVAO=null};k.prototype.resetNeedsRender=function(){this.didRender&&(this._needsRender=this.didRender=!1)};k.prototype.render=function(a){var c=a.rctx,d=a.camera,g=this._renderCoordsHelper,r=this._laserLineProgram,h=this._projInfo,m=this._zScale;c.bindProgram(r);c.setPipelineState(this._laserLinePipelineState);
b.inverseProjectionInfo(d.projectionMatrix,d.fullWidth,d.fullHeight,h,m);r.setUniform4fv("projInfo",h);r.setUniform2fv("zScale",m);r.setUniform2f("nearFar",d.near,d.far);r.setUniform1f("maxPixelDistance",2*d.computeScreenPixelSizeAt(this._focusPosition));if(this._focusPlaneActive){var h=this._focusPosition,m=this._tempVec3,G=this._tempVec4;g.worldUpAtPosition(h,m);w(G,h,m,d.viewMatrix);r.setUniform4fv("focusPlane",G)}else r.setUniform4fv("focusPlane",[0,0,0,1E10]);this._focusSphereActive?(m=this._tempVec4,
h=this._tempVec3,f.vec3.copy(m,this._focusSpherePosition),f.vec3.transformMat4(m,m,d.viewMatrix),f.vec3.copy(h,this._focusPosition),f.vec3.transformMat4(h,h,d.viewMatrix),m[3]=f.vec3.distance(m,h),r.setUniform4fv("focusSphere",m)):r.setUniform4fv("focusSphere",[0,0,0,1E10]);if(this._segmentActive){var h=this._tempVec4,m=this._tempVec3,G=this._tempUp,y=this._tempDir,x=this._tempNormal;f.vec3.lerp(m,this._segmentStartPosition,this._segmentEndPosition,.5);g.worldUpAtPosition(m,G);f.vec3.subtract(y,this._segmentEndPosition,
this._segmentStartPosition);f.vec3.normalize(y,y);f.vec3.cross(x,G,y);f.vec3.normalize(x,x);w(h,this._segmentStartPosition,x,d.viewMatrix);r.setUniform4fv("segmentPlane",h)}else r.setUniform4fv("segmentPlane",[0,0,0,1E10]);h=e;f.vec3.copy(h,this._segmentStartPosition);g.setAltitude(0,h);f.vec3.transformMat4(h,h,d.viewMatrix);r.setUniform3fv("segmentStart",h);h=e;f.vec3.copy(h,this._segmentEndPosition);g.setAltitude(0,h);f.vec3.transformMat4(h,h,d.viewMatrix);r.setUniform3fv("segmentEnd",h);r.setUniform1i("depthMap",
0);c.bindTexture(a.offscreenRenderingHelper.linearDepthTexture,0);a=a.camera.pixelRatio;r.setUniform3fv("innerColor",this._params.innerColor);r.setUniform1f("innerWidth",this._params.innerWidth*a);r.setUniform3fv("glowColor",this._params.glowColor);r.setUniform1f("glowWidth",this._params.glowWidth*a);r.setUniform1f("globalAlpha",this._params.globalAlpha);c.bindVAO(this._quadVAO);c.drawArrays(5,0,4);return!0};return k}()})},"esri/views/3d/webgl-engine/shaders/LaserLinePrograms":function(){define(["require",
"exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],function(z,t,k,a){Object.defineProperty(t,"__esModule",{value:!0});t.program={name:"laserline",shaders:{vertexShader:a.resolveIncludes("util/quad.vert"),fragmentShader:a.resolveIncludes("renderer/laserLine/laserLine.frag")},attributes:k.Default3D}})},"esri/views/3d/interactive/measurementTools/support/Label":function(){define(["require","exports","../../../../overlay/LineOverlayItem","../../../../overlay/TextOverlayItem"],function(z,
t,k,a){return function(){function f(g){this._textItem=new a({visible:!1});this._calloutItem=new k({visible:!1,width:2});this._visible=!1;this._calloutVisible=!0;g&&(this.fontSize=g)}Object.defineProperty(f.prototype,"textItem",{get:function(){return this._textItem},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"calloutItem",{get:function(){return this._calloutItem},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"text",{get:function(){return this._textItem.text},
set:function(a){this._textItem.text=a},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fontSize",{get:function(){return this._textItem.fontSize},set:function(a){this._textItem.fontSize=a},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible=a;this._updateVisibility()},enumerable:!0,configurable:!0});f.prototype.addToView=function(a){a.overlay.items.addMany([this._textItem,this._calloutItem])};
f.prototype.removeFromView=function(a){a.overlay&&!a.overlay.destroyed&&a.overlay.items.removeMany([this._textItem,this._calloutItem])};f.prototype.updatePosition=function(a,f){if(f){var g=f[0]-a[0],d=f[1]-a[1];this._textItem.position=[f[0],f[1]];this._textItem.anchor=Math.abs(g)>Math.abs(d)?0<g?"left":"right":0<d?"top":"bottom";this._calloutItem.startPosition=[a[0],a[1]];this._calloutItem.endPosition=[f[0],f[1]];this._calloutVisible=!0}else this._textItem.position=[a[0],a[1]],this._textItem.anchor=
"center",this._calloutVisible=!1};f.prototype._updateVisibility=function(){this._textItem.visible=this._visible;this._calloutItem.visible=this._visible&&this._calloutVisible};return f}()})},"esri/views/overlay/LineOverlayItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./ViewOverlayItem maquette".split(" "),function(z,t,k,a,f,g,q,l){var d={left:0,top:0,width:0,height:0,x1:0,
y1:0,x2:0,y2:0};return function(b){function c(a){a=b.call(this,a)||this;a.startX=0;a.startY=0;a.endX=0;a.endY=0;a.width=1;a.color=[0,0,0,.5];a.visible=!0;return a}k(c,b);Object.defineProperty(c.prototype,"startPosition",{get:function(){return[this.startX,this.startY]},set:function(a){this._set("startX",a[0]);this._set("startY",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"endPosition",{get:function(){return[this.endX,this.endY]},set:function(a){this._set("endX",a[0]);this._set("endY",
a[1])},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"strokeStyle",{get:function(){var a=this.color;return"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"lineCap",{get:function(){return"round"},enumerable:!0,configurable:!0});c.prototype.render=function(){var a=this.calculateCoordinates(d);return l.h("div",{classes:{"esri-line-overlay-item":!0},styles:{left:a.left+"px",top:a.top+"px",width:a.width+"px",height:a.height+
"px",visibility:this.visible?"visible":"hidden"},innerHTML:"\x3csvg width\x3d"+a.width+" height\x3d"+a.height+"\x3e"+("\x3cline x1\x3d"+a.x1+" y1\x3d"+a.y1+" x2\x3d"+a.x2+" y2\x3d"+a.y2+' style\x3d"stroke: '+this.strokeStyle+"; stroke-width: "+this.width+"; stroke-linecap: "+this.lineCap+';"\x3e\x3c/line\x3e')+"\x3c/svg\x3e"})};c.prototype.renderCanvas=function(a){if(this.visible){a.strokeStyle=this.strokeStyle;a.lineWidth=this.width;a.lineCap=this.lineCap;var b=this.calculateCoordinates(d);a.beginPath();
a.moveTo(b.left+b.x1,b.top+b.y1);a.lineTo(b.left+b.x2,b.top+b.y2);a.stroke()}};c.prototype.calculateCoordinates=function(a){var b=Math.min(this.startX,this.endX),c=Math.max(this.startX,this.endX),e=Math.min(this.startY,this.endY),d=Math.max(this.startY,this.endY),f=this.width;a.left=b-f;a.top=e-f;a.width=c-b+2*f;a.height=Math.max(20,d-e+2*f);a.x1=this.startX-b+f;a.y1=this.startY-e+f;a.x2=this.endX-b+f;a.y2=this.endY-e+f;return a};a([g.property()],c.prototype,"startX",void 0);a([g.property()],c.prototype,
"startY",void 0);a([g.property()],c.prototype,"endX",void 0);a([g.property()],c.prototype,"endY",void 0);a([g.property({dependsOn:["startX","startY"]})],c.prototype,"startPosition",null);a([g.property({dependsOn:["endX","endY"]})],c.prototype,"endPosition",null);a([g.property()],c.prototype,"width",void 0);a([g.property()],c.prototype,"color",void 0);a([g.property()],c.prototype,"visible",void 0);a([g.property({readOnly:!0,dependsOn:["color"]})],c.prototype,"strokeStyle",null);return c=a([g.subclass("esri.views.overlay.LineOverlayItem")],
c)}(g.declared(f,q))})},"esri/views/overlay/ViewOverlayItem":function(){define(["require","exports","../../core/tsSupport/declareExtendsHelper","../../core/tsSupport/decorateHelper"],function(z,t,k,a){return function(){return function(){}}()})},"esri/views/overlay/TextOverlayItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./ViewOverlayItem maquette".split(" "),function(z,
t,k,a,f,g,q,l){var d={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};z=function(f){function n(a){a=f.call(this,
a)||this;a.x=0;a.y=0;a.text="-";a.fontSize=14;a.anchor="center";a.visible=!0;a.backgroundColor="rgba(0, 0, 0, 0.6)";a.textColor="white";a.textShadowColor=[0,0,0];a.textShadowSize=1;return a}k(n,f);Object.defineProperty(n.prototype,"position",{get:function(){return[this.x,this.y]},set:function(a){this._set("x",a[0]);this._set("y",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"padding",{get:function(){return.5*this.fontSize},enumerable:!0,configurable:!0});n.prototype.render=
function(){return l.h("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",backgroundColor:this.backgroundColor,color:this.textColor,padding:this.padding+"px",borderRadius:this.padding+"px",textShadow:"0 0 "+this.textShadowSize+"px rgb("+this.textShadowColor[0]+", "+this.textShadowColor[1]+", "+this.textShadowColor[2]+")"}},[this.text])};n.prototype.renderCanvas=function(a){if(this.visible){var c=
a.font.replace(/^(.*?)px/,"");a.font=this.fontSize+"px "+c;var d=this.padding,f=this.padding,g=a.measureText(this.text).width,x=this.fontSize,c=b[this.anchor];a.textAlign="center";a.textBaseline="middle";g+=2*d;d=x+2*d;this.roundedRect(a,this.x+c.x*g,this.y+c.y*d,g,d,f);a.fillStyle=this.backgroundColor;a.fill();f=this.x+(c.x+.5)*g;c=this.y+(c.y+.5)*d;this._renderTextShadow(a,this.text,f,c);a.fillStyle=this.textColor;a.fillText(this.text,f,c)}};n.prototype._renderTextShadow=function(a,b,d,f){a.lineJoin=
"miter";a.fillStyle="rgba("+this.textShadowColor[0]+", "+this.textShadowColor[1]+", "+this.textShadowColor[2]+", "+1/c.length+")";for(var e=this.textShadowSize,g=0,p=c;g<p.length;g++){var u=p[g];a.fillText(b,d+e*u[0],f+e*u[1])}};n.prototype.roundedRect=function(a,b,c,d,f,g){a.beginPath();a.moveTo(b,c+g);a.arcTo(b,c,b+g,c,g);a.lineTo(b+d-g,c);a.arcTo(b+d,c,b+d,c+g,g);a.lineTo(b+d,c+f-g);a.arcTo(b+d,c+f,b+d-g,c+f,g);a.lineTo(b+g,c+f);a.arcTo(b,c+f,b,c+f-g,g);a.closePath()};n.prototype._cssClasses=function(){var a=
{"esri-text-overlay-item":!0},b;for(b in d)a[d[b]]=this.anchor===b;return a};a([g.property()],n.prototype,"x",void 0);a([g.property()],n.prototype,"y",void 0);a([g.property({dependsOn:["x","y"]})],n.prototype,"position",null);a([g.property()],n.prototype,"text",void 0);a([g.property()],n.prototype,"fontSize",void 0);a([g.property()],n.prototype,"anchor",void 0);a([g.property()],n.prototype,"visible",void 0);a([g.property({dependsOn:["fontSize"]})],n.prototype,"padding",null);return n=a([g.subclass("esri.views.overlay.TextOverlayItem")],
n)}(g.declared(f,q));var b={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},
"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},c=[];for(t=0;360>t;t+=22.5)c.push([Math.cos(Math.PI*t/180),Math.sin(Math.PI*t/180)]);return z})},"esri/views/3d/interactive/measurementTools/support/LabelSegment":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec3","../../../../../core/libs/gl-matrix-2/vec3f64","./viewUtils"],function(z,t,k,a,f){return function(){function g(){this.origin=a.vec3f64.create();this.start=a.vec3f64.create();this.end=a.vec3f64.create()}
g.prototype.update=function(a,g,d){k.vec3.copy(this.start,a);k.vec3.copy(this.end,g);if(d)switch(d){case "start":k.vec3.copy(this.origin,this.start);break;case "center":f.midpoint([a,g],this.origin);break;case "end":k.vec3.copy(this.origin,this.end);break;default:k.vec3.copy(this.origin,d)}else f.midpoint([a,g],this.origin)};return g}()})},"esri/views/3d/interactive/measurementTools/support/viewUtils":function(){define("require exports ../../../../../core/lang ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64".split(" "),
function(z,t,k,a,f,g,q,l){function d(b,e,d){var p=d._stage.getCamera();d.renderCoordsHelper.toRenderCoords(b,c);p.projectPoint(c,y);a.renderArrayToScreen(d,y,e)}Object.defineProperty(t,"__esModule",{value:!0});var b=l.vec3f64.create();t.copyParameter=function(a,b){a=k.mixin({},a);b=k.clone(b);k.mixin(a,b);return a};t.resizeArray=function(a,b,c,e){for(;a.length<b;)a.push(c());if(e)for(;a.length>b;)c=a.pop(),e(c);else a.length=b};t.scaleTranslateMatrix=function(a,c,e){f.mat4.identity(e);f.mat4.translate(e,
e,c);q.vec3.set(b,a,a,a);f.mat4.scale(e,e,b)};t.midpoint=function(a,b){q.vec3.set(b,0,0,0);if(0<a.length){for(var c=0;c<a.length;++c)q.vec3.add(b,b,a[c]);q.vec3.scale(b,b,1/a.length)}};t.screenSpaceTangent=function(a,b,c,d){d.projectPoint(a,n);d.projectPoint(b,e);g.vec2.subtract(c,B,w);g.vec2.normalize(c,c)};t.projectPoint=d;t.pointToPointScreenDistance=function(a,b,c){d(a,C,c);d(b,x,c);return g.vec2.distance(C,x)};t.pointToScreenPositionDistance=function(a,b,c){d(a,A,c);return g.vec2.distance(A,
b)};var c=l.vec3f64.create(),y=a.createRenderScreenPointArray3(),n=a.createRenderScreenPointArray3(),w=n,e=a.createRenderScreenPointArray3(),B=e,A=a.createScreenPointArray(),C=a.createScreenPointArray(),x=a.createScreenPointArray()})},"esri/views/3d/interactive/measurementTools/support/labelUtils":function(){define("require exports ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ./viewUtils".split(" "),
function(z,t,k,a,f,g,q){function l(a,b,c){a.projectPoint(b,e);if(0>e[2]||1<e[2])return!1;a.renderToScreen(e,c);return!0}function d(b,c,d,r,f,m){if(!c)return!1;q.screenSpaceTangent(c.start,c.end,y,b);a.vec2.set(w,-y[1],y[0]);var p=!1;switch(r){case "top":p=0>w[1];break;case "bottom":p=0<w[1];break;case "left":p=0<w[0];break;case "right":p=0>w[0]}p&&a.vec2.negate(w,w);if(0===a.vec2.length(w))switch(r){case "top":w[1]=1;break;case "bottom":w[1]=-1;break;case "left":w[0]=-1;break;case "right":w[0]=1}b.projectPoint(c.origin,
e);if(0>e[2]||1<e[2])return!1;b.renderToScreen(e,f);a.vec2.scale(w,w,d*b.pixelRatio);a.vec2.add(w,w,e);b.renderToScreen(w,m);return!0}function b(b,c,d,r,f,m){if(!c||!d)return!1;q.screenSpaceTangent(c.end,c.start,y,b);q.screenSpaceTangent(d.start,d.end,n,b);a.vec2.add(w,y,n);a.vec2.negate(w,w);a.vec2.normalize(w,w);b.projectPoint(c.end,e);if(0>e[2]||1<e[2])return!1;b.renderToScreen(e,f);a.vec2.scale(w,w,r*b.pixelRatio);a.vec2.add(w,w,e);b.renderToScreen(w,m);return!0}function c(b,c,d,r,g,m){b.projectPoint(c,
e);f.vec3.add(A,c,d);b.projectPoint(A,B);if(0>e[2]||1<e[2]||0>B[2]||1<B[2])return!1;a.vec2.subtract(w,B,e);a.vec2.normalize(w,w);b.renderToScreen(e,g);a.vec2.scale(w,w,r*b.pixelRatio);a.vec2.add(w,w,e);b.renderToScreen(w,m);return!0}Object.defineProperty(t,"__esModule",{value:!0});t.mirrorPosition=function(a){switch(a){case "top":return"bottom";case "right":return"left";case "bottom":return"top";case "left":return"right"}};t.computeLabelPositionFromPoint=l;t.positionLabelOnPoint=function(a,b,c){(b=
l(c,b,C))&&a.updatePosition(C,null);return b};t.computeLabelPositionFromSegment=d;t.positionLabelOnSegment=function(a,b,c,e,f){(b=d(f,b,c,e,C,x))&&a.updatePosition(C,x);return b};t.computeLabelPositionFromCorner=b;t.computeLabelPositionFromPlane=c;t.positionLabelOnCorner=function(a,c,e,d,f){(c=b(f,c,e,d,C,x))&&a.updatePosition(C,x);return c};t.positionLabelOnPlane=function(a,b,e,d,f,m){(b=c(m,b,e,d,C,x))&&a.updatePosition(C,x);return b};var y=k.createRenderScreenPointArray(),n=k.createRenderScreenPointArray(),
w=k.createRenderScreenPointArray(),e=k.createRenderScreenPointArray3(),B=k.createRenderScreenPointArray3(),A=g.vec3f64.create(),C=k.createScreenPointArray(),x=k.createScreenPointArray()})},"esri/views/3d/interactive/measurementTools/support/PathSegmentInterpolator":function(){define("require exports ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../geometry/SpatialReference ../../../../../geometry/support/geodesicUtils ../../../support/mathUtils ../../../support/projectionUtils".split(" "),
function(z,t,k,a,f,g,q,l){function d(a){a.x=c.normalize(a.x);a.y=y.normalize(a.y)}function b(a,b,c){l.vectorToVector(a,b,c,f.WGS84);c[0]=q.deg2rad(c[0]);c[1]=q.deg2rad(c[1])}var c=new q.Cyclical(-180,180),y=new q.Cyclical(-90,90),n;(function(c){var e=function(){function b(b,c){this._startPosition=a.vec3f64.create();this._endPosition=a.vec3f64.create();k.vec3.copy(this._startPosition,b);k.vec3.copy(this._endPosition,c)}b.prototype.eval=function(a,b){k.vec3.lerp(b,this._startPosition,this._endPosition,
a)};return b}();c.Linear=e;e=function(){function c(c,e,d,f){this._startCoords=a.vec3f64.create();this._endCoords=a.vec3f64.create();b(c,d,this._startCoords);b(e,d,this._endCoords);this._destSR=f;this._startToEnd=g.inverseGeodeticSolver(this._startCoords[1],this._startCoords[0],this._endCoords[1],this._endCoords[0]);this._endToStart=g.inverseGeodeticSolver(this._endCoords[1],this._endCoords[0],this._startCoords[1],this._startCoords[0])}c.prototype.eval=function(a,b){var c=g.directGeodeticSolver(this._startCoords[1],
this._startCoords[0],this._startToEnd.azimuth,this._startToEnd.geodesicDistance*a),e=g.directGeodeticSolver(this._endCoords[1],this._endCoords[0],this._endToStart.azimuth,this._endToStart.geodesicDistance*(1-a));d(c);d(e);b[0]=q.lerp(c.x,e.x,a);b[1]=q.lerp(c.y,e.y,a);b[2]=q.lerp(this._startCoords[2],this._endCoords[2],a);l.vectorToVector(b,f.WGS84,b,this._destSR)};return c}();c.Geodesic=e;e=function(){function b(b,c,e,d){this._startPosition=a.vec3f64.create();this._endPosition=a.vec3f64.create();
l.vectorToVector(b,e,this._startPosition,l.SphericalECEFSpatialReference);l.vectorToVector(c,e,this._endPosition,l.SphericalECEFSpatialReference);this._destSR=d}b.prototype.eval=function(a,b){q.slerp(this._startPosition,this._endPosition,a,b);l.vectorToVector(b,l.SphericalECEFSpatialReference,b,this._destSR)};return b}();c.Spherical=e})(n||(n={}));return n})},"esri/geometry/support/geodesicUtils":function(){define("require exports @dojo/framework/shim/object ../../core/Error ../../core/Logger ../../core/unitUtils ../Point ../Polygon ../Polyline ../SpatialReference".split(" "),
function(z,t,k,a,f,g,q,l,d,b){function c(a){if(!a||!a.isGeographic)return null;if(a.wkid){var b=E[a.wkid];if(b)return b}if(a.wkt){a=u.exec(a.wkt);if(!a||2!==a.length)return null;b=a[1].split(",");if(!b||3!==b.length)return null;a=parseFloat(b[1]);b=parseFloat(b[2]);return isNaN(a)||isNaN(b)?null:{a:a,f:0===b?0:1/b}}return null}function y(a){a=c(a||p);if("b"in a&&"eSq"in a&&"radius"in a)return a;var b=a.a*(1-a.f);return k.assign(a,{b:b,eSq:1-Math.pow(b/a.a,2),radius:(2*a.a+b)/3})}function n(a,b,c){var e=
y(c);c=e.a;var e=e.eSq,d=Math.sqrt(e),m=Math.sin(b[1]*x);b=c*b[0]*x;c=0<e?c*(1-e)*(m/(1-e*m*m)-1/(2*d)*Math.log((1-d*m)/(1+d*m)))*.5:c*m;a[0]=b;a[1]=c;return a}function w(a){return null!==c(a)}function e(b,c){if("polyline"!==b.type&&"polygon"!==b.type)throw C.error("invalid geometry: the input geometry is neither polyline nor polygon"),new a("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");if(!w(b.spatialReference))throw C.error("invalid spatialreference: the input geometry spatialreference is not supported"),
new a("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var e=b.spatialReference,f=y(e).radius/1E4;c<f&&(c=f);for(var f=[],g=0,p="polyline"===b.type?b.paths:b.rings;g<p.length;g++){var r=p[g],v=[];f.push(v);v.push([r[0][0],r[0][1]]);for(var h=r[0][0]*x,u=r[0][1]*x,k=void 0,n=void 0,q=0;q<r.length-1;q++)if(k=r[q+1][0]*x,n=r[q+1][1]*x,h!==k||u!==n){var n=A(u,h,n,k,e),k=n.azimuth,n=n.geodesicDistance,t=n/c;if(1<t){for(var E=1;E<=t-1;E++){var z=B(u,
h,k,E*c,e);v.push([z.x,z.y])}t=B(u,h,k,(n+Math.floor(t-1)*c)/2,e);v.push([t.x,t.y])}u=B(u,h,k,n,e);v.push([u.x,u.y]);h=u.x*x;u=u.y*x}}return"polyline"===b.type?new d({paths:f,spatialReference:e}):new l({rings:f,spatialReference:e})}function B(a,b,c,e,d){var m=y(d),f=m.a,v=m.b,m=m.f,g=Math.sin(c);c=Math.cos(c);var r=(1-m)*Math.tan(a);a=1/Math.sqrt(1+r*r);for(var h=r*a,u=Math.atan2(r,c),r=a*g,k=r*r,l=1-k,f=l*(f*f-v*v)/(v*v),G=1+f/16384*(4096+f*(-768+f*(320-175*f))),n=f/1024*(256+f*(-128+f*(74-47*f))),
f=e/(v*G),D=2*Math.PI,w,B,t,A;1E-12<Math.abs(f-D);)t=Math.cos(2*u+f),w=Math.sin(f),B=Math.cos(f),A=n*w*(t+n/4*(B*(-1+2*t*t)-n/6*t*(-3+4*w*w)*(-3+4*t*t))),D=f,f=e/(v*G)+A;e=h*w-a*B*c;v=m/16*l*(4+m*(4-3*l));return new q((b+(Math.atan2(w*g,a*B-h*w*c)-(1-v)*m*r*(f+v*w*(t+v*B*(-1+2*t*t)))))/x,Math.atan2(h*B+a*w*c,(1-m)*Math.sqrt(k+e*e))/x,d||p)}function A(a,b,c,e,d){var f=y(d),m=f.a;d=f.b;var v=f.f,g=f.radius,p=e-b,r=Math.atan((1-v)*Math.tan(a)),u=Math.atan((1-v)*Math.tan(c)),f=Math.sin(r),r=Math.cos(r),
h=Math.sin(u),u=Math.cos(u),k=1E3,l=p,G,n,x,w,q,t,D,B;do{w=Math.sin(l);q=Math.cos(l);x=Math.sqrt(u*w*u*w+(r*h-f*u*q)*(r*h-f*u*q));if(0===x)return{geodesicDistance:0};q=f*h+r*u*q;t=Math.atan2(x,q);D=r*u*w/x;n=1-D*D;w=q-2*f*h/n;isNaN(w)&&(w=0);B=v/16*n*(4+v*(4-3*n));G=l;l=p+(1-B)*v*D*(t+B*x*(w+B*q*(-1+2*w*w)))}while(1E-12<Math.abs(l-G)&&0<--k);if(0===k)return d=e-b,{azimuth:Math.atan2(Math.sin(d)*Math.cos(c),Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(d)),geodesicDistance:Math.acos(Math.sin(a)*
Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(e-b))*g};a=n*(m*m-d*d)/(d*d);b=a/1024*(256+a*(-128+a*(74-47*a)));return{azimuth:Math.atan2(u*Math.sin(l),r*h-f*u*Math.cos(l)),geodesicDistance:d*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(t-b*x*(w+b/4*(q*(-1+2*w*w)-b/6*w*(-3+4*x*x)*(-3+4*w*w)))),reverseAzimuth:Math.atan2(r*Math.sin(l),r*h*Math.cos(l)-f*u)}}Object.defineProperty(t,"__esModule",{value:!0});var C=f.getLogger("esri.geometry.support.geodesicUtils"),x=Math.PI/180,p=b.WGS84,u=/SPHEROID\[([^\]]+)]/i,
E={4326:{a:6378137,f:1/298.257223563},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:1737400,f:0},104904:{a:3393400,f:.005207166853303471},104905:{a:3396190,f:.005886007555525457},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},
104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,
f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,
f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0}};t.isSupported=w;t.geodesicAreas=function(b,c){if(b.some(function(a){return!w(a.spatialReference)}))throw C.error("invalid spatialreference: the input geometries spatialreference is not supported"),new a("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var d=[],f=0;f<b.length;f++){var p=b[f],u=p.spatialReference,
u=.0015696101447650193*y(u).radius;d.push(e(p,u))}b=[];for(var f=[0,0],p=[0,0],r=0;r<d.length;r++){for(var u=d[r],v=u.rings,u=u.spatialReference,h=0,l=0;l<v.length;l++){var k=v[l];n(f,k[0],u);n(p,k[k.length-1],u);for(var x=p[0]*f[1]-f[0]*p[1],q=0;q<k.length-1;q++)n(f,k[q+1],u),n(p,k[q],u),x+=p[0]*f[1]-f[0]*p[1];h+=x}h=g.convertUnit(h,"square-meters",c);b.push(h/-2)}return b};t.geodesicLengths=function(b,c){if(!b&&!b)throw C.error("invalid geometry type: the input geometries type is not supported"),
new a("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(b.some(function(a){return!w(a.spatialReference)}))throw C.error("invalid spatialreference: the input geometries spatialreference is not supported"),new a("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var e=[],d=0;d<b.length;d++){for(var f=b[d],p=f.spatialReference,f="polyline"===f.type?f.paths:f.rings,u=0,v=0;v<f.length;v++){for(var h=f[v],l=0,
r=1;r<h.length;r++){var k=h[r-1][0]*x,n=h[r][0]*x,y=h[r-1][1]*x,q=h[r][1]*x;if(y!==q||k!==n)k=A(y,k,q,n,p),l+=k.geodesicDistance}u+=l}u=g.convertUnit(u,"meters",c);e.push(u)}return e};t.geodesicDensify=e;t.directGeodeticSolver=B;t.inverseGeodeticSolver=A})},"esri/views/3d/webgl-engine/materials/MeasurementArrowMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../lib/Util ./internal/MaterialUtil ./renderers/MergedRenderer ../shaders/MeasurementArrowPrograms ../../../webgl/renderState".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n){z=function(a){function d(c,d){d=a.call(this,d)||this;d.params=b.copyParameters(c,e);return d}k(d,a);d.prototype.dispose=function(){};d.prototype.setParameterValues=function(a){b.updateParameters(this.params,a)&&this.notifyDirty("matChanged")};d.prototype.getParameters=function(){return this.params};d.prototype.intersect=function(a,b,c,d,e,v,f,g){};d.prototype.createBufferWriter=function(){return new E};d.prototype.createRenderer=function(a,b){return new c(a,b,this)};
d.prototype.getGLMaterials=function(){return{color:w,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};d.prototype.getAllTextureIds=function(){return[]};return d}(l);var w=function(a){function c(b,c,d){b=a.call(this,b,c)||this;b.updateParameters();return b}k(c,a);c.prototype.selectProgram=function(){this.program=this.programRep.getProgram(y.colorPass);this.pipelineState=n.makePipelineState({polygonOffset:this.params.polygonOffset&&{factor:0,units:-4},depthTest:{func:513},depthWrite:n.defaultDepthWriteParams,
colorWrite:n.defaultColorWriteParams})};c.prototype.updateParameters=function(){this.params=b.copyParameters(this.material.getParameters());this.selectProgram()};c.prototype.beginSlot=function(a){return 4===a};c.prototype.getProgram=function(){return this.program};c.prototype.getDrawMode=function(){return 5};c.prototype.bind=function(a,b){b=this.program;a.bindProgram(b);a.setPipelineState(this.pipelineState);b.setUniform1f("width",this.params.width);b.setUniform1f("outlineSize",this.params.outlineSize);
b.setUniform4fv("outlineColor",this.params.outlineColor);b.setUniform1f("stripeLength",this.params.stripeLength);b.setUniform4fv("stripeEvenColor",this.params.stripeEvenColor);b.setUniform4fv("stripeOddColor",this.params.stripeOddColor)};c.prototype.bindView=function(a,c){a=c.origin;var d=this.getProgram();b.bindView(a,c.view,d)};c.prototype.bindInstance=function(a,b){this.getProgram().setUniformMatrix4fv("model",b.transformation)};c.prototype.release=function(a){};return c}(q),e={width:32,outlineSize:.2,
outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1},B=g.newLayout().vec3f(d.VertexAttrConstants.POSITION).vec3f(d.VertexAttrConstants.NORMAL).vec2f(d.VertexAttrConstants.UV0).f32(d.VertexAttrConstants.AUXPOS1),A=f.vec3f64.create(),C=f.vec3f64.create(),x=f.vec3f64.create(),p=f.vec3f64.create(),u=f.vec3f64.create(),E=function(){function b(){this.vertexBufferLayout=B}b.prototype.allocate=function(a){return this.vertexBufferLayout.createBuffer(a)};
b.prototype.elementCount=function(a){return 2*(a.indices[d.VertexAttrConstants.POSITION].length/2+1)};b.prototype.write=function(b,c,e,f,g){var m=c.vertexAttr[d.VertexAttrConstants.POSITION].data,v=c.vertexAttr[d.VertexAttrConstants.NORMAL].data;e=m.length/3;(c=c&&c.indices&&c.indices.position)&&c.length!==2*(e-1)&&console.warn("MeasurementArrowMaterial does not support indices");c=b.transformation;for(var l=b.invTranspTransformation,k=f.position,r=f.normal,n=f.uv0,h=b=0;h<e;++h){var y=3*h;a.vec3.set(A,
m[y],m[y+1],m[y+2]);h<e-1&&(y=3*(h+1),a.vec3.set(C,m[y],m[y+1],m[y+2]),a.vec3.set(u,v[y],v[y+1],v[y+2]),a.vec3.normalize(u,u),a.vec3.subtract(x,C,A),a.vec3.normalize(x,x),a.vec3.cross(p,u,x),a.vec3.normalize(p,p));y=a.vec3.distance(A,C);c&&l&&(a.vec3.transformMat4(A,A,c),a.vec3.transformMat4(C,C,c),a.vec3.transformMat4(p,p,l));var q=g+2*h,w=q+1;k.setVec(q,A);k.setVec(w,A);r.setVec(q,p);r.setVec(w,p);n.set(q,0,b);n.set(q,1,-1);n.set(w,0,b);n.set(w,1,1);h<e-1&&(b+=y)}f=f.auxpos1;for(h=0;h<2*e;++h)f.set(g+
h,b)};return b}();return z})},"esri/views/3d/webgl-engine/shaders/MeasurementArrowPrograms":function(){define(["require","exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],function(z,t,k,a){Object.defineProperty(t,"__esModule",{value:!0});t.colorPass={name:"measurement-arrow-color",shaders:{vertexShader:a.resolveIncludes("materials/measurementArrow/measurementArrow.vert"),fragmentShader:a.resolveIncludes("materials/measurementArrow/measurementArrow.frag")},attributes:k.Default3D}})},
"esri/views/interactive/manipulatorUtils":function(){define("require exports ../../core/libs/gl-matrix-2/mat4 ../../core/libs/gl-matrix-2/vec3 ../3d/support/stack ../3d/webgl-engine/lib/Geometry ../3d/webgl-engine/lib/GeometryUtil ../3d/webgl-engine/materials/DefaultMaterial ./Manipulator3D".split(" "),function(z,t,k,a,f,g,q,l,d){function b(a,b){var c=1!==b;a=new l({diffuse:a,transparent:c,writeDepth:!c,cullFace:"back",opacity:b,castShadows:!1,instanced:["transformation"]},"manipulator");a.renderOccluded=
4;return a}function c(b,c,d,e){b=a.vec3.normalize(f.sv3d.get(),b);c=a.vec3.normalize(f.sv3d.get(),c);var g=a.vec3.cross(f.sv3d.get(),b,c);e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=0;e[4]=c[0];e[5]=c[1];e[6]=c[2];e[7]=0;e[8]=g[0];e[9]=g[1];e[10]=g[2];e[11]=0;e[12]=d[0];e[13]=d[1];e[14]=d[2];e[15]=1;return e}Object.defineProperty(t,"__esModule",{value:!0});t.createManipulatorMaterial=b;t.createSphereManipulator=function(a,c,f){return new d.Manipulator3D({view:a,renderObjects:[{geometry:new g(q.createSphereGeometry(1,
32,32),"manipulator"),material:b(c,f)}]})};t.calculateInputRotationTransform=function(b,d,g,e){b=a.vec3.subtract(f.sv3d.get(),b,g);e=a.vec3.cross(f.sv3d.get(),e,b);g=c(b,e,g,f.sm4d.get());k.mat4.invert(g,g);d=a.vec3.transformMat4(f.sv3d.get(),d,g);return Math.atan2(d[1],d[0])};t.calculateTranslateRotateFromBases=c})},"esri/views/interactive/Manipulator3D":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/Accessor ../../core/Collection ../../core/compilerUtils ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f64 ../../core/libs/gl-matrix-2/mat4 ../../core/libs/gl-matrix-2/mat4f64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec3 ../../core/libs/gl-matrix-2/vec3f64 ../../geometry/support/aaBoundingRect ../../layers/graphics/dehydratedFeatures ../3d/support/geometryUtils ../3d/support/stack ../3d/webgl-engine/lib/Intersector ../3d/webgl-engine/lib/intersectorUtils ../3d/webgl-engine/lib/Layer ../3d/webgl-engine/lib/Object3D ../3d/webgl-engine/parts/Model".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n,w,e,B,A,C,x,p,u,E,r,h,m,G,D){function H(a){return 0!==a[12]||0!==a[13]||0!==a[14]}Object.defineProperty(t,"__esModule",{value:!0});z=function(f){function h(a){a=f.call(this)||this;a.hideOnGrab=!1;a.moveOnDrag=!0;a.snapToPointer=!0;a.allowOverlap=!1;a.collisionType={type:"point"};a.renderObjects=[];a.autoScaleRenderObjects=!0;a._radius=10;a._focusMultiplier=2;a._touchMultiplier=2.5;a.interactive=!0;a.selectable=!1;a.dragging=!1;a._position=C.vec3f64.create();a._modelTransform=
w.mat4f64.create();a._dragOffset=null;a._dirtyScreenPoint=d.createScreenPoint();a._dirtyScreenPointArray=d.createScreenPointArray();a._dirtyRenderScreenPointArray=d.createRenderScreenPointArray3();a._dirtyOriginScreenPointArray=d.createScreenPointArray();a._screenPositionDirty=!0;a._engineResourcesAddedToStage=!1;a._engineResources=null;a._engineLayerId=null;a._materialIdReferences=null;a._hitResult={onSurface:!1,surfaceType:"ground"};a._handlers=new g;return a}a(h,f);y=h;h.prototype.initialize=function(){this._intersector=
new r(this.view.viewingMode);this._mapPoint=p.makeDehydratedPoint(0,0,0,this.view.spatialReference)};h.prototype.destroy=function(){this._handlers.removeAll();this._handlers=null;this._removeResourcesFromStage();this._engineResources=null;this._set("view",null);this._camera=null};Object.defineProperty(h.prototype,"alignment",{get:function(){return this._get("alignment")},set:function(a){this._set("alignment",a);this.constructed&&this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"visible",{set:function(a){a!==this._get("visible")&&(this._set("visible",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"radius",{get:function(){return this._radius},set:function(a){a!==this._radius&&(this._radius=a,this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"focusMultiplier",{get:function(){return this._focusMultiplier},set:function(a){this._focusMultiplier=a},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"touchMultiplier",{get:function(){return this._touchMultiplier},set:function(a){this._touchMultiplier=a},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"modelTransform",{get:function(){return this._modelTransform},set:function(a){H(a)&&(this._screenPositionDirty=!0);n.mat4.copy(this._modelTransform,a);this._updateEngineObject()},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"position",{get:function(){return this._position},set:function(a){this.view.renderCoordsHelper.fromRenderCoords(a,
this._mapPoint,this._mapPoint.spatialReference);this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"mapPoint",{get:function(){return this._mapPoint},set:function(a){p.clonePoint(a,this._mapPoint);this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"grabbing",{set:function(a){a!==this._get("grabbing")&&(this._set("grabbing",a),this._updateEngineObject());a||(this._dragOffset=null)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"hovering",{set:function(a){a!==this._get("hovering")&&(this._set("hovering",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"selected",{set:function(a){a!==this._get("selected")&&(this._set("selected",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"active",{set:function(a){a!==this._get("active")&&(this._set("active",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"state",{set:function(a){a!==this._get("state")&&(this._set("state",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"surfaceType",{get:function(){return this._hitResult.onSurface?this._hitResult.surfaceType:null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"focused",{get:function(){return this._focused},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_focused",{get:function(){return this._get("hovering")||this._get("grabbing")},
enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"screenPoint",{get:function(){this._updateScreenPositions();return this._dirtyScreenPoint},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_screenPointArray",{get:function(){this._updateScreenPositions();return this._dirtyScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_renderScreenPointArray",{get:function(){this._updateScreenPositions();return this._dirtyRenderScreenPointArray},
enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"_originScreenPointArray",{get:function(){this._updateScreenPositions();return this._dirtyOriginScreenPointArray},enumerable:!0,configurable:!0});h.prototype._updateScreenPositions=function(a){void 0===a&&(a=!1);if(this._screenPositionDirty){a=H(this._modelTransform);var b;a?(b=this._calculateModelTransformOffset(V),b=A.vec3.add(b,b,this._position)):b=this._position;this._screenPositionDirty=!1;this._camera.projectPoint(b,this._dirtyRenderScreenPointArray);
this._camera.renderToScreen(this._dirtyRenderScreenPointArray,this._dirtyScreenPointArray);d.screenPointArrayToObject(this._dirtyScreenPointArray,this._dirtyScreenPoint);a?(this._camera.projectPoint(this._position,I),this._camera.renderToScreen(I,this._dirtyOriginScreenPointArray)):e.vec2.copy(this._dirtyOriginScreenPointArray,this._dirtyScreenPointArray)}};h.prototype.intersectionDistance=function(a,b){if(!this._get("visible")||!this._get("active"))return null;var f=d.screenPointObjectToArray(a,
v);a=this._getCollisionRadius(b);switch(this.collisionType.type){case "point":if(e.vec2.squaredDistance(this._screenPointArray,f)<a*a)return this._renderScreenPointArray[2];break;case "line":var g=this.collisionType.paths;b=this._camera.computeScreenPixelSizeAt(this._position);b=this._calculateObjectTransform(b,K);a*=this._camera.computeScreenPixelSizeAt(this._position);for(var f=u.ray.fromScreen(this._camera,f,M),m=0,h=g;m<h.length;m++)if(g=h[m],0!==g.length)for(var p=A.vec3.transformMat4(Q,g[0],
b),l=1;l<g.length;l++){var k=A.vec3.transformMat4(P,g[l],b),r=u.lineSegment.closestRayDistance2(u.lineSegment.fromPoints(p,k,J),f);if(null!=r&&r<a*a)return b=A.vec3.add(E.sv3d.get(),p,k),A.vec3.scale(b,b,.5),a=d.castRenderScreenPointArray(E.sv3d.get()),this._camera.projectPoint(b,a),a[2];A.vec3.copy(p,k)}break;case "disc":p=this.collisionType.direction;b=this._camera.computeScreenPixelSizeAt(this._position);b=this._calculateObjectTransform(b,K);a*=this._camera.computeScreenPixelSizeAt(this._position);
f=u.ray.fromScreen(this._camera,f,M);l=c.mat3.fromMat4(O,b);l=A.vec3.transformMat3(R,p,l);p=this._calculateModelTransformPosition(S);u.plane.fromPositionAndNormal(p,l,L);m=N;if(u.plane.intersectRay(L,f,m)&&A.vec3.squaredDistance(m,p)<a*a)return this._renderScreenPointArray[2];break;case "ribbon":b=this.collisionType;g=b.paths;p=b.direction;b=this._camera.computeScreenPixelSizeAt(this._position);b=this._calculateObjectTransform(b,K);a*=this._camera.computeScreenPixelSizeAt(this._position);f=u.ray.fromScreen(this._camera,
f,M);l=c.mat3.fromMat4(O,b);l=A.vec3.transformMat3(R,p,l);p=this._calculateModelTransformPosition(S);u.plane.fromPositionAndNormal(p,l,L);m=N;if(!u.plane.intersectRay(L,f,m))break;f=0;for(h=g;f<h.length;f++)if(g=h[f],0!==g.length)for(p=A.vec3.transformMat4(Q,g[0],b),l=1;l<g.length;l++){k=A.vec3.transformMat4(P,g[l],b);r=u.lineSegment.distance2(u.lineSegment.fromPoints(p,k,J),m);if(null!=r&&r<a*a)return b=A.vec3.add(E.sv3d.get(),p,k),A.vec3.scale(b,b,.5),a=d.castRenderScreenPointArray(E.sv3d.get()),
this._camera.projectPoint(b,a),a[2];A.vec3.copy(p,k)}break;default:q.neverReached(this.collisionType)}return null};h.prototype.attemptDragTo=function(a){if(!this.moveOnDrag)return this._handlers.forEach(function(b){var c=b.handler;"drag"===b.type&&c(a)}),!1;var b=d.screenPointObjectToArray(a.screenPoint,v);l.isNone(this._dragOffset)&&this.grabbing&&!this.snapToPointer&&(this._dragOffset=e.vec2.subtract(B.vec2f32.create(),b,this._originScreenPointArray));l.isSome(this._dragOffset)&&e.vec2.subtract(b,
b,this._dragOffset);var b=this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(b,this._intersector,"on-the-ground"===this.alignment?F:null).results.min,c=N;b.getIntersectionPoint(c)?(this.position=c,this._hitResult.onSurface=!0,this._hitResult.surfaceType="TerrainRenderer"===b.intersector?"ground":"feature",this._handlers.forEach(function(b){var c=b.handler;"drag"===b.type&&c(a)})):this._hitResult.onSurface=!1;return this._hitResult.onSurface};h.prototype.click=function(a){this._handlers.forEach(function(b){var c=
b.handler;"click"===b.type&&c(a)})};h.prototype.on=function(a,b){this._handlers.push({type:a,handler:b})};h.prototype.addToEngineLayer=function(a,b){l.isSome(this._engineLayerId)||(l.isSome(a)?this._engineLayerId=a:(a=new m("manipulator-3d",{isPickable:!1}),this.view._stage.add(D.ContentType.LAYER,a),this.view._stage.addToViewContent([a.id]),this._engineLayerId=a.id),l.isSome(b)?this._materialIdReferences=b:this._materialIdReferences=new Map,this._updateEngineObject())};h.prototype.installRenderHandles=
function(a,b){var c=null,d=null;b(function(a){return a instanceof y?(c=a._engineLayerId,d=a._materialIdReferences,!1):!0});this.addToEngineLayer(c,d);this._camera=this.view.state.camera;if(!a.has("render-manipulator-3d")){var e=function(a){b(function(b){b instanceof y&&b.view.renderCoordsHelper.fromRenderCoords(b.position,T,a.spatialReference)&&x.containsPoint(a.extent,T)&&b._refreshMapPoint(!0)})};a.add([this.view.state.watch("camera",function(a){b(function(b){b instanceof y&&(b._camera=a,b._screenPositionDirty=
!0,b._updateEngineObject())})}),this.view.elevationProvider.on("elevation-change",function(a){return e(a)})],"render-manipulator-3d")}};h.prototype._refreshMapPoint=function(a){void 0===a&&(a=!1);switch(this.alignment){case "none":break;case "on-the-ground":var b=this.view.elevationProvider.getElevation(this.mapPoint,"ground");if(b===this._mapPoint.z&&a)return;this._mapPoint.z=b;break;default:q.neverReached(this.alignment)}this._screenPositionDirty=!0;this._hitResult.onSurface=!1;this.view.renderCoordsHelper.toRenderCoords(this._mapPoint,
this._position);this._updateEngineObject()};h.prototype._updateEngineObject=function(){if(!l.isNone(this._engineLayerId))if(!1===this._get("visible")||!1===this._get("active"))this._removeResourcesFromStage();else{var a=this._get("view").state.camera.computeScreenPixelSizeAt(this._position),b=K;!0===this._get("autoScaleRenderObjects")&&(a*=this._getFocusedSize(this._radius,this._focused));this._calculateObjectTransform(a,b);for(var a=this._ensureEngineResources().objectsByState,c=(this._focused?2:
1)|(this._get("selected")?8:4),d=this._get("hideOnGrab")&&this._get("grabbing"),e=0;e<a.length;e++){var v=a[e],f=v.stateMask,v=v.objects;if(d)for(var f=0,g=v;f<g.length;f++)v=g[f],v.object3D.hideAllComponents(),v.startTimeMs=0;else if(g=0===(f&15)||(c&f)===(f&15),f=0===(f&32752)||(this._get("state")&f)===(f&32752),g&&f)for(f=0,g=v;f<g.length;f++)v=g[f],v.object3D.unhideAllComponents(),v.object3D.objectTransformation=b;else for(f=0,g=v;f<g.length;f++)v=g[f],v.object3D.hideAllComponents(),v.startTimeMs=
0}}};h.prototype._ensureEngineResources=function(){if(l.isNone(this._engineResources)){var a=this.view._stage.get(D.ContentType.LAYER,l.expect(this._engineLayerId)),b=[],c=new Set;this.renderObjects.forEach(function(a){a=a.material;c.has(a)||(b.push(a),c.add(a))});var d=function(a,b){var c=b.geometry,d=b.material,e=b.transform;Array.isArray(c)?c.forEach(function(b){return a.addGeometry(b,d,e)}):a.addGeometry(c,d,e)},e=new Map;this.renderObjects.forEach(function(a){var b=new G({idHint:"manipulator"});
d(b,a);var c=a.stateMask||0,v=e.get(c)||[];v.push({object3D:b,startTimeMs:0,delayMs:a.delayMs});e.set(c,v)});var v=[];e.forEach(function(a,b){v.push({stateMask:b,objects:a})});this._engineResources={objectsByState:v,layer:a,materials:b}}this._addResourcesToStage();return this._engineResources};h.prototype._addResourcesToStage=function(){var a=this;if(!this._engineResourcesAddedToStage&&!l.isNone(this._engineResources)){var b=this._engineResources,c=b.objectsByState,d=b.layer;b.materials.forEach(function(b){var c=
l.expect(a._materialIdReferences),d=c.get(b.id)||0;0===d&&a.view._stage.add(D.ContentType.MATERIAL,b);c.set(b.id,d+1)});c.forEach(function(b){b.objects.forEach(function(b){b=b.object3D;d.addObject(b);a.view._stage.add(D.ContentType.OBJECT,b)})});this._engineResourcesAddedToStage=!0}};h.prototype._removeResourcesFromStage=function(){var a=this;if(this._engineResourcesAddedToStage&&!l.isNone(this._engineResources)){var b=this._engineResources,c=b.layer,d=b.materials;b.objectsByState.forEach(function(b){b.objects.forEach(function(b){b=
b.object3D;c.removeObject(b);a.view._stage.remove(D.ContentType.OBJECT,b.id)})});d.forEach(function(b){var c=l.expect(a._materialIdReferences),d=c.get(b.id);1===d?(a.view._stage.remove(D.ContentType.MATERIAL,b.id),c.delete(b.id)):c.set(b.id,d-1)});this._engineResourcesAddedToStage=!1}};h.prototype._getCollisionRadius=function(a){return this._getFocusedSize(this._radius,!0)*("touch"===a?this._touchMultiplier:1)};h.prototype._getFocusedSize=function(a,b){return a*(b?this._focusMultiplier:1)};h.prototype._calculateModelTransformPosition=
function(a){var b=this._camera.computeScreenPixelSizeAt(this._position),b=this._calculateObjectTransform(b,U);return A.vec3.set(a,b[12],b[13],b[14])};h.prototype._calculateModelTransformOffset=function(a){var b=this._calculateModelTransformPosition(a);return A.vec3.subtract(a,b,this._position)};h.prototype._calculateObjectTransform=function(a,b){n.mat4.set(b,a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,1);n.mat4.multiply(b,b,this._modelTransform);b[12]+=this._position[0];b[13]+=this._position[1];b[14]+=this._position[2];
b[15]=1;return b};var y;k([b.property({constructOnly:!0,nonNullable:!0})],h.prototype,"view",void 0);k([b.property({value:"none",nonNullable:!0})],h.prototype,"alignment",null);k([b.property()],h.prototype,"hideOnGrab",void 0);k([b.property()],h.prototype,"moveOnDrag",void 0);k([b.property()],h.prototype,"snapToPointer",void 0);k([b.property()],h.prototype,"allowOverlap",void 0);k([b.property()],h.prototype,"collisionType",void 0);k([b.property({constructOnly:!0})],h.prototype,"renderObjects",void 0);
k([b.property()],h.prototype,"autoScaleRenderObjects",void 0);k([b.property({value:!0})],h.prototype,"visible",null);k([b.property()],h.prototype,"radius",null);k([b.property()],h.prototype,"focusMultiplier",null);k([b.property()],h.prototype,"touchMultiplier",null);k([b.property()],h.prototype,"interactive",void 0);k([b.property()],h.prototype,"selectable",void 0);k([b.property({value:!1})],h.prototype,"grabbing",null);k([b.property()],h.prototype,"dragging",void 0);k([b.property({value:!1})],h.prototype,
"hovering",null);k([b.property({value:!1})],h.prototype,"selected",null);k([b.property({value:!0})],h.prototype,"active",null);k([b.property({value:0})],h.prototype,"state",null);k([b.property({dependsOn:["hovering","grabbing"]})],h.prototype,"focused",null);return h=y=k([b.subclass("esri.views.interactive.Manipulator3D")],h)}(b.declared(f));t.Manipulator3D=z;var F={include:new Set};F.include.add(h.TERRAIN_ID);var v=d.createScreenPointArray(),I=d.createRenderScreenPointArray3(),J=u.lineSegment.create(),
M=u.ray.create(),O=y.mat3f64.create(),U=w.mat4f64.create(),K=w.mat4f64.create(),L=u.plane.create(),Q=C.vec3f64.create(),P=C.vec3f64.create(),N=C.vec3f64.create(),R=C.vec3f64.create(),S=C.vec3f64.create(),V=C.vec3f64.create(),T=C.vec3f64.create()})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DModel":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/Handles ../../../../../core/Quantity ../../../../../core/quantityUtils ../../../../../core/unitUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../geometry/Point ../../../../../geometry/SpatialReference ../../../../../geometry/support/geodesicUtils ../support/UnitNormalizer ../../../support/earthUtils ../../../support/mathUtils ../../../support/mathUtils ../../../support/projectionUtils ../../../support/PropertiesPool".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n,w,e,B,A,C,x,p,u,E){var r=C.earthRadius*Math.PI/180;return function(f){function m(){var a=null!==f&&f.apply(this,arguments)||this;a._tempStartPosition=n.vec3f64.create();a._tempEndPosition=n.vec3f64.create();a._tempCornerPosition=n.vec3f64.create();a._unitNormalizer=new A;a._handles=new g;a._propertiesPool=new E.default({startPoint:w,endPoint:w},a);a.cursorPoint=null;a.state="initial";a.mode="auto";a.unit="metric";a.active=!1;a.directDistance=null;a.horizontalDistance=
null;a.verticalDistance=null;a.geodesicDistance=null;a.geodesicAngle=null;a.triangleCollapseRatioThreshold=.03;a.geodesicMeasurementDistanceThreshold=1E5;return a}k(m,f);m.prototype.initialize=function(){var a=this;this._handles.add(b.init(this.sceneView,"spatialReference",function(b){a._unitNormalizer.spatialReference=b;a._unitNormalizer.ignoredSpatialReferences=[e.WGS84,e.WebMercator]}),"scene-view");this.reset()};m.prototype.destroy=function(){this._handles.destroy();this._handles=null;this._propertiesPool.destroy();
this._propertiesPool=null};Object.defineProperty(m.prototype,"startPoint",{set:function(a){if(a){var b=this._propertiesPool.get("startPoint");b.copy(a);this._set("startPoint",b);this._updateMeasurement()}else this._set("startPoint",null)},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"startPointSurfaceLocation",{set:function(a){this._set("startPointSurfaceLocation",a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"endPoint",{set:function(a){if(a){var b=
this._propertiesPool.get("endPoint");b.copy(a);this._set("endPoint",b);this._updateMeasurement()}else this._set("endPoint",null)},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"endPointSurfaceLocation",{set:function(a){this._set("endPointSurfaceLocation",a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"measurementSurfaceLocation",{get:function(){var a=this.startPointSurfaceLocation,b=this.endPointSurfaceLocation;return null==a||null==
b||"above-the-surface"===a&&"below-the-surface"===b||"below-the-surface"===a&&"above-the-surface"===b||"on-the-surface"===a&&"on-the-surface"===b?"camera-dependent":"above-the-surface"===a||"above-the-surface"===b?"above-the-surface":"below-the-surface"},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"validMeasurement",{get:function(){return!!this.startPoint&&!!this.endPoint},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"isMeasuring",{get:function(){return!!this.startPoint},
enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"geodesicDistanceExceeded",{get:function(){return this.horizontalDistance&&this.horizontalDistance.value>this.geodesicMeasurementDistanceThreshold},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"measurementMode",{get:function(){var a=this.mode;if("auto"===a){a="euclidean";if("degrees"===this.unit||"degrees-minutes-seconds"===this.unit)a="geodesic";this.geodesicDistanceExceeded&&(a="geodesic")}return a},enumerable:!0,
configurable:!0});Object.defineProperty(m.prototype,"triangleView",{get:function(){var a=this._collapseTriangle(),b=null,c=null,e=null,v=this.directDistance,c="geodesic"===this.measurementMode?this.geodesicDistance:this.horizontalDistance,f=this.verticalDistance,g=null;switch(this.unit){case "metric":b=v&&l.formatMetricLength(v);c=c&&l.formatMetricLength(c);e=f&&l.formatMetricVerticalLength(f);g=v&&v.toUnit("meters");break;case "imperial":b=v&&l.formatImperialLength(v);c=c&&l.formatImperialLength(c);
e=f&&l.formatImperialVerticalLength(f);g=v&&v.toUnit(d.preferredImperialLengthUnit(v.value,v.unit));break;case "degrees":c=this.geodesicAngle&&l.formatDecimal(this.geodesicAngle,"degrees");g=this.geodesicAngle&&this.geodesicAngle.toUnit("degrees");break;case "degrees-minutes-seconds":c=this.geodesicAngle&&l.formatDMS(this.geodesicAngle);g=this.geodesicAngle&&this.geodesicAngle.toUnit("degrees");break;default:b=v&&l.formatDecimal(v,this.unit),c=c&&l.formatDecimal(c,this.unit),e=f&&l.formatDecimal(f,
this.unit),g=v&&v.toUnit(this.unit)}v=1;g&&(v=p.nextHighestPowerOfTen(g.value/30),v*="degrees"===g.unit?r:d.convertUnit(1,g.unit,"meters"),v/=this._unitNormalizer.normalizeDistance(1));return{visible:this.validMeasurement&&!this.startPoint.equals(this.endPoint),mode:this.measurementMode,collapsed:a,directLabel:b,horizontalLabel:c,verticalLabel:e,stripeLength:v}},enumerable:!0,configurable:!0});m.prototype.reset=function(){this.clearMeasurement()};m.prototype.clearMeasurement=function(){this.state=
"initial";this.cursorPoint=this.endPoint=this.startPoint=null;this._clearOverride("measurementSurfaceLocation");this._updateMeasurement()};m.prototype.finishedMeasurement=function(a){if(!this._isOverridden("measurementSurfaceLocation")){var b=this.measurementSurfaceLocation;this._override("measurementSurfaceLocation","camera-dependent"===b?a.cameraAboveGround?"above-the-surface":"below-the-surface":b)}this.state="measured"};m.prototype._collapseTriangle=function(){return!this.validMeasurement||this.startPoint.equals(this.endPoint)||
"geodesic"===this.measurementMode?!0:Math.min(this.verticalDistance.value/this.horizontalDistance.value,this.horizontalDistance.value/this.verticalDistance.value)<this.triangleCollapseRatioThreshold};m.prototype._exactGeodesicDistanceAndAngle=function(a,b){var c=p.deg2rad(a.longitude);a=p.deg2rad(a.latitude);var d=p.deg2rad(b.longitude);b=p.deg2rad(b.latitude);var e=x.acos(Math.sin(a)*Math.sin(b)+Math.cos(a)*Math.cos(b)*Math.cos(Math.abs(d-c))),e=p.rad2deg(e),c=B.inverseGeodeticSolver(a,c,b,d).geodesicDistance;
return{distance:new q(c,"meters"),angle:new q(e,"degrees")}};m.prototype._approximateGeodesicDistanceAndAngle=function(a){return{distance:new q(a,"meters"),angle:new q(a/r,"degrees")}};m.prototype._euclideanDistances=function(a,b){a.z>b.z&&(a=[a,a=b][0]);var c=a.clone();c.z=b.z;var d=this._tempStartPosition,e=this._tempEndPosition,f=this._tempCornerPosition,g=this.sceneView.spatialReference,g=g.isWGS84||g.isWebMercator?u.WGS84ECEFSpatialReference:g;u.pointToVector(a,d,g);u.pointToVector(b,e,g);u.pointToVector(c,
f,g);c=y.vec3.distance(d,e);e=y.vec3.distance(f,e);a=Math.abs(b.z-a.z);c=this._unitNormalizer.normalizeDistance(c);e=this._unitNormalizer.normalizeDistance(e);a=this._unitNormalizer.normalizeElevation(a);return{direct:new q(c,"meters"),horizontal:new q(e,"meters"),vertical:new q(a,"meters")}};m.prototype._updateMeasurement=function(){if(this.startPoint&&this.endPoint){var a=this._euclideanDistances(this.startPoint,this.endPoint),b=this.sceneView.spatialReference,b=b.isWGS84||b.isWebMercator?this._exactGeodesicDistanceAndAngle(this.startPoint,
this.endPoint):this._approximateGeodesicDistanceAndAngle(a.horizontal.value);this._set("directDistance",a.direct);this._set("horizontalDistance",a.horizontal);this._set("verticalDistance",a.vertical);this._set("geodesicDistance",b.distance);this._set("geodesicAngle",b.angle)}else this._set("directDistance",null),this._set("horizontalDistance",null),this._set("verticalDistance",null),this._set("geodesicDistance",null),this._set("geodesicAngle",null)};a([c.property({constructOnly:!0})],m.prototype,
"sceneView",void 0);a([c.property({value:null})],m.prototype,"startPoint",null);a([c.property({value:null})],m.prototype,"startPointSurfaceLocation",null);a([c.property({value:null})],m.prototype,"endPoint",null);a([c.property({value:null})],m.prototype,"endPointSurfaceLocation",null);a([c.property({dependsOn:["startPointSurfaceLocation","endPointSurfaceLocation"]})],m.prototype,"measurementSurfaceLocation",null);a([c.property()],m.prototype,"cursorPoint",void 0);a([c.property()],m.prototype,"state",
void 0);a([c.property()],m.prototype,"mode",void 0);a([c.property()],m.prototype,"unit",void 0);a([c.property()],m.prototype,"active",void 0);a([c.property({readOnly:!0,dependsOn:["startPoint","endPoint"]})],m.prototype,"validMeasurement",null);a([c.property({readOnly:!0,dependsOn:["startPoint"]})],m.prototype,"isMeasuring",null);a([c.property({readOnly:!0})],m.prototype,"directDistance",void 0);a([c.property({readOnly:!0})],m.prototype,"horizontalDistance",void 0);a([c.property({readOnly:!0})],m.prototype,
"verticalDistance",void 0);a([c.property({readOnly:!0})],m.prototype,"geodesicDistance",void 0);a([c.property({readOnly:!0})],m.prototype,"geodesicAngle",void 0);a([c.property({readOnly:!0,dependsOn:["horizontalDistance","geodesicMeasurementDistanceThreshold"]})],m.prototype,"geodesicDistanceExceeded",null);a([c.property({readOnly:!0,dependsOn:["horizontalDistance","unit","geodesicDistanceExceeded"]})],m.prototype,"measurementMode",null);a([c.property({readOnly:!0,dependsOn:["unit","measurementMode",
"startPoint","endPoint","triangleCollapseRatioThreshold"]})],m.prototype,"triangleView",null);a([c.property()],m.prototype,"triangleCollapseRatioThreshold",void 0);a([c.property()],m.prototype,"geodesicMeasurementDistanceThreshold",void 0);return m=a([c.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DModel")],m)}(c.declared(f))})},"esri/core/Quantity":function(){define(["require","exports","./unitFormatUtils","./unitUtils"],function(z,t,k,a){return function(){function f(f,
k){this.measure=a.measureForUnit(k);this.value=f;this.unit=k}Object.defineProperty(f.prototype,"isBaseUnit",{get:function(){return a.isBaseUnit(this.unit)},enumerable:!0,configurable:!0});f.prototype.toUnit=function(g){return new f(a.convertUnit(this.value,this.unit,g),g)};f.prototype.toBaseUnit=function(){return this.toUnit(a.baseUnitForUnit(this.unit))};f.prototype.toDecimalString=function(a,f){void 0===a&&(a=2);return k.formatDecimal(this.value,this.unit,a,f)};return f}()})},"esri/core/unitFormatUtils":function(){define(["require",
"exports","dojo/i18n!./nls/Units","dojo/number","./unitUtils"],function(z,t,k,a,f){function g(a,d){return k.units[a][d]}function q(f,d,b,c){void 0===b&&(b=2);void 0===c&&(c="abbr");return a.format(f,{places:b})+" "+g(d,c)}Object.defineProperty(t,"__esModule",{value:!0});t.unitName=g;t.formatDecimal=q;t.formatMetricLength=function(a,d,b,c){void 0===b&&(b=2);void 0===c&&(c="abbr");var g=f.preferredMetricLengthUnit(a,d);return q(f.convertUnit(a,d,g),g,b,c)};t.formatMetricVerticalLength=function(a,d,
b,c){void 0===b&&(b=2);void 0===c&&(c="abbr");var g=f.preferredMetricVerticalLengthUnit(a,d);return q(f.convertUnit(a,d,g),g,b,c)};t.formatImperialLength=function(a,d,b,c){void 0===b&&(b=2);void 0===c&&(c="abbr");var g=f.preferredImperialLengthUnit(a,d);return q(f.convertUnit(a,d,g),g,b,c)};t.formatImperialVerticalLength=function(a,d,b,c){void 0===b&&(b=2);void 0===c&&(c="abbr");var g=f.preferredImperialVerticalLengthUnit(a,d);return q(f.convertUnit(a,d,g),g,b,c)};t.formatMetricArea=function(a,d,
b,c){void 0===b&&(b=2);void 0===c&&(c="abbr");var g=f.preferredMetricAreaUnit(a,d);return q(f.convertUnit(a,d,g),g,b,c)};t.formatImperialArea=function(a,d,b,c){void 0===b&&(b=2);void 0===c&&(c="abbr");var g=f.preferredImperialAreaUnit(a,d);return q(f.convertUnit(a,d,g),g,b,c)};t.formatDMS=function(a,d,b){void 0===b&&(b=2);a=f.convertUnit(a,d,"degrees");d=a-Math.floor(a);a-=d;d*=60;var c=d-Math.floor(d);d-=c;c*=60;return a.toFixed()+"\u00b0 "+d.toFixed()+"' "+c.toFixed(b)+'"'}})},"esri/core/quantityUtils":function(){define(["require",
"exports","./unitFormatUtils"],function(z,t,k){Object.defineProperty(t,"__esModule",{value:!0});t.formatDecimal=function(a,f,g,q){void 0===g&&(g=2);void 0===q&&(q="abbr");return k.formatDecimal(a.toUnit(f).value,f,g,q)};t.formatMetricLength=function(a,f,g){void 0===f&&(f=2);void 0===g&&(g="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return k.formatMetricLength(a.value,a.unit,f,g)};t.formatMetricVerticalLength=function(a,f,g){void 0===f&&(f=2);void 0===g&&(g="abbr");if("length"!==
a.measure)throw Error("quantity is not a length");return k.formatMetricVerticalLength(a.value,a.unit,f,g)};t.formatMetricArea=function(a,f,g){void 0===f&&(f=2);void 0===g&&(g="abbr");if("area"!==a.measure)throw Error("quantity is not an area");return k.formatMetricArea(a.value,a.unit,f,g)};t.formatImperialLength=function(a,f,g){void 0===f&&(f=2);void 0===g&&(g="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return k.formatImperialLength(a.value,a.unit,f,g)};t.formatImperialVerticalLength=
function(a,f,g){void 0===f&&(f=2);void 0===g&&(g="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return k.formatImperialVerticalLength(a.value,a.unit,f,g)};t.formatImperialArea=function(a,f,g){void 0===f&&(f=2);void 0===g&&(g="abbr");if("area"!==a.measure)throw Error("quantity is not an area");return k.formatImperialArea(a.value,a.unit,f,g)};t.formatDMS=function(a){if("angle"!==a.measure)throw Error("quantity is not an angle");return k.formatDMS(a.value,a.unit)}})},"esri/views/3d/interactive/measurementTools/support/UnitNormalizer":function(){define(["require",
"exports","../../../../../core/unitUtils"],function(z,t,k){return function(){function a(a,g){void 0===a&&(a=null);void 0===g&&(g=null);this.spatialReference=a;this.ignoredSpatialReferences=g;this._updateNormalizationFactors}Object.defineProperty(a.prototype,"spatialReference",{get:function(){return this._spatialReference},set:function(a){a!==this._spatialReference&&(this._spatialReference=a,this._updateNormalizationFactors())},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"ignoredSpatialReferences",
{get:function(){return this._ignoredSpatialReferences},set:function(a){this._ignoredSpatialReferences=a;this._updateNormalizationFactors()},enumerable:!0,configurable:!0});a.prototype.normalizeDistance=function(a){return a*this._metersPerDistanceUnit};a.prototype.normalizeElevation=function(a){return a*this._metersPerElevationUnit};a.prototype.normalizeArea=function(a){return a*this._squareMetersPerAreaUnit};a.prototype._updateNormalizationFactors=function(){var a=this;!this._spatialReference||this._ignoredSpatialReferences&&
0!==this._ignoredSpatialReferences.filter(function(f){return f.equals(a._spatialReference)}).length?this._squareMetersPerAreaUnit=this._metersPerDistanceUnit=this._metersPerDistanceUnit=1:(this._metersPerDistanceUnit=k.getMetersPerUnitForSR(this._spatialReference),this._metersPerElevationUnit=k.getMetersPerVerticalUnitForSR(this._spatialReference),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit)};return a}()})},"esri/views/interactive/InteractiveToolBase":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./interactiveToolUtils".split(" "),
function(z,t,k,a,f,g,q){return function(f){function d(a){a=f.call(this)||this;a._attached=!1;return a}k(d,f);Object.defineProperty(d.prototype,"active",{get:function(){return this.view.activeTool===this},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSupported",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"visible",{set:function(a){this._attached&&(a?this.show():(this.hide(),q.setActive(this,!1)));this._set("visible",a)},enumerable:!0,
configurable:!0});d.prototype.attach=function(a){!this._attached&&this.isSupported&&(this._set("toolViewManager",a),this.onAttach(a),this.visible&&this.show(),this._attached=!0)};d.prototype.detach=function(){this._attached&&(this.hide(),this.onDetach(),this._set("toolViewManager",null),this._attached=!1)};d.prototype.handleInputEvent=function(a){if(this._attached)this.onInputEvent(a,this.toolViewManager)};d.prototype.show=function(){};d.prototype.hide=function(){};d.prototype.onAttach=function(a){};
d.prototype.onDetach=function(){};d.prototype.onInputEvent=function(a,c){};a([g.property({constructOnly:!0})],d.prototype,"view",void 0);a([g.property({dependsOn:["view.activeTool"],readOnly:!0})],d.prototype,"active",null);a([g.property({value:!0})],d.prototype,"visible",null);a([g.property({readOnly:!0})],d.prototype,"toolViewManager",void 0);return d=a([g.subclass("esri.views.interactive.InteractiveToolBase")],d)}(g.declared(f))})},"esri/widgets/support/InteractiveToolViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/interactive/interactiveToolUtils".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y){return function(l){function n(a){var b=l.call(this)||this;b.tool=null;b._baseHandles=new d;b._loggedUnsupportedErrorOnce=!1;b._createPromise=null;a&&null!=a.visible&&(b.visible=a.visible);return b}k(n,l);n.prototype.initialize=function(){var a=this;this._baseHandles.add(b.init(this,["view.ready","isSupported"],function(){a.view&&a.view.ready&&!a.isSupported?a._loggedUnsupportedErrorOnce||(a.logUnsupportedError(),a._loggedUnsupportedErrorOnce=!0):a._loggedUnsupportedErrorOnce=
!1}))};n.prototype.destroy=function(){this.tool&&(y.setActive(this.tool,!1),this.view&&this.view.tools.remove(this.tool),this.tool.destroy(),this._set("tool",null));this.view=null;this._baseHandles.destroy();this._createPromise=this._baseHandles=null};Object.defineProperty(n.prototype,"isSupported",{get:function(){return!this.view||this.view.type===this.supportedViewType},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"view",{get:function(){return this._get("view")},set:function(a){this._createToolOnView(a);
this._set("view",a)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"visible",{set:function(a){this._set("visible",a);this.tool&&(this.tool.visible=a)},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"active",{get:function(){return!!this.tool&&this.tool.active},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"isDisabled",{get:function(){return!this.tool||!this.view||!this.view.ready||!this.isSupported},enumerable:!0,configurable:!0});n.prototype._createToolOnView=
function(a){return g(this,void 0,void 0,function(){var b,c,d=this;return f(this,function(e){switch(e.label){case 0:return this._createPromise?[4,this._createPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return a!==this.view&&this.view&&this.tool&&(this.view.removeTool(this.tool),this.tool.destroyed||this.tool.destroy(),this._set("tool",null)),a&&(b=this.createToolParams(),c=q({visible:this.visible},b.constructorArguments),this._createPromise=a.createTool(b.toolConstructor,c,this.tool).then(function(a){d._set("tool",
a)})),[2]}})})};a([c.property({constructOnly:!0})],n.prototype,"tool",void 0);a([c.property({dependsOn:["view.type"]})],n.prototype,"isSupported",null);a([c.property({value:null})],n.prototype,"view",null);a([c.property({type:Boolean,value:!0})],n.prototype,"visible",null);a([c.property({dependsOn:["tool.active"]})],n.prototype,"active",null);a([c.property({dependsOn:["tool","view","view.ready","isSupported"]})],n.prototype,"isDisabled",null);return n=a([c.subclass("esri.widgets.support.InteractiveToolViewModel")],
n)}(c.declared(l))})},"esri/widgets/AreaMeasurement3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./AreaMeasurement3D/nls/AreaMeasurement3D ../core/accessorSupport/decorators ./Widget ./AreaMeasurement3D/AreaMeasurement3DViewModel ./support/widget".split(" "),function(z,t,k,a,f,g,q,l,d){return function(b){function c(a){a=b.call(this)||this;a.view=null;a.visible=null;a.viewModel=new l;a.unitOptions=null;a.unit=null;return a}
k(c,b);c.prototype.render=function(){var a=this,b=this.viewModel.isSupported,c=this.viewModel.active,e="disabled"===this.viewModel.state,g="ready"===this.viewModel.state,k="measuring"===this.viewModel.state||"measured"===this.viewModel.state,l=this.viewModel.measurement,g=c&&g?d.tsx("section",{key:"esri-area-measurement-3d__hint",class:"esri-area-measurement-3d__hint"},d.tsx("p",{class:"esri-area-measurement-3d__hint-text"},f.hint)):null,x=b?null:d.tsx("section",{key:"esri-area-measurement-3d__unsupported",
class:"esri-area-measurement-3d__panel--error"},d.tsx("p",null,f.unsupported)),p=function(b,c,e){switch(c.state){case "available":return d.tsx("div",{key:e+"-enabled",class:"esri-area-measurement-3d__measurement-item"},d.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b),d.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},c.text));case "unavailable":return d.tsx("div",{key:e+"-disabled",class:a.classes("esri-area-measurement-3d__measurement-item","esri-area-measurement-3d__measurement-item--disabled")},
d.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b));case "invalid":return d.tsx("div",{key:e+"-enabled",class:"esri-area-measurement-3d__measurement-item"},d.tsx("span",{class:"esri-area-measurement-3d__measurement-item-title"},b),d.tsx("span",{class:"esri-area-measurement-3d__measurement-item-value"},f.notApplicable))}},l=k?d.tsx("section",{key:"esri-area-measurement-3d__measurement",class:"esri-area-measurement-3d__measurement"},p(f.area,l.area,"area"),p(f.perimeterLength,
l.perimeterLength,"perimeter-length")):null,u=this.id+"__units",p=d.tsx("label",{class:"esri-area-measurement-3d__units-label",for:u},f.unit),u=d.tsx("div",{class:"esri-area-measurement-3d__units-select-wrapper"},d.tsx("select",{class:"esri-area-measurement-3d__units-select esri-select",id:u,onchange:this._changeUnit,bind:this},this.viewModel.unitOptions.map(function(b){return b===a.viewModel.unit?d.tsx("option",{key:b,value:b,selected:!0},f.units[b]):d.tsx("option",{key:b,value:b},f.units[b])}))),
p=k?d.tsx("section",{key:"esri-area-measurement-3d__units",class:"esri-area-measurement-3d__units"},p,u):null,p=k?d.tsx("div",{key:"settings",class:"esri-area-measurement-3d__settings"},p):null,b=!b||c&&!k?null:d.tsx("div",{class:"esri-area-measurement-3d__actions"},d.tsx("button",{disabled:e,class:this.classes("esri-button esri-button--secondary","esri-area-measurement-3d__clear-button",e&&"esri-button--disabled"),bind:this,onclick:this._newMeasurement},f.newMeasurement)),b=this.visible?d.tsx("div",
{class:"esri-area-measurement-3d__container"},x,g,p,l,b):null;return d.tsx("div",{key:"",class:"esri-area-measurement-3d esri-widget esri-widget--panel",role:"presentation"},b)};c.prototype._newMeasurement=function(){this.viewModel.newMeasurement()};c.prototype._changeUnit=function(a){a=a.target;if(a=a.options[a.selectedIndex])this.unit=a.value};a([g.aliasOf("viewModel.view")],c.prototype,"view",void 0);a([g.aliasOf("viewModel.visible"),d.renderable()],c.prototype,"visible",void 0);a([g.aliasOf("viewModel.active"),
d.renderable()],c.prototype,"active",void 0);a([g.property({type:l}),d.renderable(["viewModel.state","viewModel.unitOptions","viewModel.unit","viewModel.measurement"])],c.prototype,"viewModel",void 0);a([g.aliasOf("viewModel.unitOptions")],c.prototype,"unitOptions",void 0);a([g.aliasOf("viewModel.unit")],c.prototype,"unit",void 0);a([d.accessibleHandler()],c.prototype,"_newMeasurement",null);a([d.accessibleHandler()],c.prototype,"_changeUnit",null);return c=a([g.subclass("esri.widgets.AreaMeasurement3D")],
c)}(g.declared(q))})},"esri/widgets/AreaMeasurement3D/AreaMeasurement3DViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Handles ../../core/Logger ../../core/unitUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool ../support/InteractiveToolViewModel".split(" "),function(z,t,k,a,f,g,q,l,d,b,c){var y="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" "),
n=g.getLogger("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel");return function(c){function e(a){a=c.call(this,a)||this;a.supportedViewType="3d";a._handles=new f;a._userUnitOptions=null;a._userUnit=null;a.tool=null;return a}k(e,c);e.prototype.initialize=function(){var a=this;this._handles.add([l.init(this,"unit",function(b){a.tool&&(a.tool.unit=b)})])};Object.defineProperty(e.prototype,"state",{get:function(){return this.isDisabled?"disabled":this.tool.state},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"measurement",{get:function(){if(this.isDisabled)return null;var a=this.tool.model,b=a.measurementMode,c=a.measurementData,d=a.validMeasurement,e=(c=0===("euclidean"===b?c.intersectingSegments:c.geodesicIntersectingSegments).size)?d?"available":"unavailable":"invalid";return{mode:b,area:{text:c&&d?a.areaLabel:null,state:e},perimeterLength:{text:c&&d?a.perimeterLengthLabel:null,state:e}}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"defaultUnit",
{get:function(){return this.defaultUnitFromPortal||this.defaultUnitFromSpatialReference||"metric"},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"defaultUnitFromSpatialReference",{get:function(){return q.getDefaultUnitSystem(this.view&&this.view.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"defaultUnitFromPortal",{get:function(){var a=this.get("view.map.portalItem.portal");if(!a)return null;switch(a.user&&a.user.units||a.units){case "metric":return"metric";
case "english":return"imperial";default:return null}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"unitOptions",{get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(a){this._userUnitOptions=a;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"unit",{get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):
this._findSelectableUnit(this.defaultUnit)},set:function(a){this._userUnit=a?this._findSelectableUnit(a,this._userUnit):null;this.notifyChange("unit")},enumerable:!0,configurable:!0});e.prototype.newMeasurement=function(){this.tool&&this.tool.newMeasurement()};e.prototype.clearMeasurement=function(){this.tool&&this.tool.clearMeasurement()};e.prototype.createToolParams=function(){return{toolConstructor:b,constructorArguments:{unit:this.unit}}};e.prototype.logUnsupportedError=function(){n.error("AreaMeasurement3D widget is not implemented for MapView")};
e.prototype.logError=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];n.error.apply(n,a)};e.prototype._findSelectableUnit=function(a,b){var c=this.unitOptions;return-1!==c.indexOf(a)?a:b?this._findSelectableUnit(b):c[0]};e.prototype._filteredOrAllUnits=function(a){if(!a)return y.slice();a=a.filter(function(a){return-1!==y.indexOf(a)});return 0===a.length?y.slice():a};a([d.property({dependsOn:["view.ready","isDisabled","tool.state"],readOnly:!0})],e.prototype,"state",null);a([d.property({dependsOn:"view.ready tool.area tool.geodesicArea tool.areaLabel tool.perimeterLength tool.geodesicPerimeterLength tool.model.perimeterLengthLabel tool.model.measurementMode tool.model.measurementData".split(" "),
readOnly:!0})],e.prototype,"measurement",null);a([d.property({constructOnly:!0})],e.prototype,"tool",void 0);a([d.property({readOnly:!0,dependsOn:["defaultUnitFromPortal","defaultUnitFromSpatialReference"]})],e.prototype,"defaultUnit",null);a([d.property({readOnly:!0,dependsOn:["view.spatialReference"]})],e.prototype,"defaultUnitFromSpatialReference",null);a([d.property({readOnly:!0,dependsOn:["view.map.portalItem.portal.units","view.map.portalItem.portal.user.units"]})],e.prototype,"defaultUnitFromPortal",
null);a([d.property({dependsOn:["view.spatialReference"]})],e.prototype,"unitOptions",null);a([d.property({dependsOn:["unitOptions","defaultUnit"]})],e.prototype,"unit",null);a([d.property()],e.prototype,"clearMeasurement",null);return e=a([d.subclass("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],e)}(d.declared(c))})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/restHelper ../../../../../core/Handles ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./AreaMeasurement3DController ./AreaMeasurement3DModel ./AreaMeasurement3DView ../../../../interactive/InteractiveToolBase ../../../../interactive/interactiveToolUtils".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n){return function(t){function e(a){var c=t.call(this,a)||this;c._handles=new g;c._editable=!0;c._editingEnabled=!0;c.model=new b({sceneView:a.view});return c}k(e,t);e.prototype.normalizeCtorArgs=function(a){return f(a,["view"])};e.prototype.initialize=function(){var a=this;this._view=new c(this.model);this._controller=new d(this.model,this._view);this._handles.add([q.init(this,"state",function(){"measuring"===a.state?n.setActive(a,!0):"measured"===a.state&&n.setActive(a,
!1)},!0),this.model.draggedVertices.on("change",function(){a.notifyChange("cursor")})])};e.prototype.destroy=function(){this.detach();this._view.destroy();this._view=null;this._controller.destroy();this._controller=null;this._handles.destroy();this._handles=null};Object.defineProperty(e.prototype,"state",{get:function(){return this.model.isMeasuring?"measured"===this.model.state?"measured":"measuring":"ready"},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isSupported",{get:function(){return"3d"===
this.get("view.type")},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cursor",{get:function(){if(this.model.active&&("drawing"===this.model.state||"initial"===this.model.state))return"crosshair";if(this.model.editable&&("editing"===this.model.state||"measured"===this.model.state)){if(0<this.model.draggedVertices.length)return"grabbing";if(null!=this.model.hoveredVertexHandle)return"pointer";if(this.model.active)return"crosshair"}return null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"editable",{get:function(){return this._editable},set:function(a){this._editable=a;this._editingEnabled&&(this.model.editable=a)},enumerable:!0,configurable:!0});e.prototype.show=function(){this._view.show()};e.prototype.hide=function(){this._view.hide()};e.prototype.newMeasurement=function(){this.model.reset();n.setActive(this,!0)};e.prototype.clearMeasurement=function(){this.model.reset()};e.prototype.activate=function(){this.model.active=!0};e.prototype.deactivate=function(){this.model.active=
!1;"measured"!==this.model.state&&this.clearMeasurement()};e.prototype.disableEditing=function(){this._editingEnabled=!1;this.model.editable=!1};e.prototype.enableEditing=function(){this._editingEnabled=!0;this.model.editable=this._editable};e.prototype.onDetach=function(){this.model.reset()};e.prototype.onInputEvent=function(a){this._controller.handleInputEvent(a)};a([l.property({dependsOn:["model.isMeasuring","model.state"],readOnly:!0})],e.prototype,"state",null);a([l.property({dependsOn:["view.type"],
readOnly:!0})],e.prototype,"isSupported",null);a([l.property({dependsOn:["model.active","model.state","model.editable","model.hoveredVertexHandle"],readOnly:!0})],e.prototype,"cursor",null);a([l.property({constructOnly:!0})],e.prototype,"model",void 0);a([l.property({type:Boolean})],e.prototype,"editable",null);a([l.aliasOf("model.sceneView")],e.prototype,"view",void 0);a([l.aliasOf("model.mode")],e.prototype,"mode",void 0);a([l.aliasOf("model.unit")],e.prototype,"unit",void 0);a([l.aliasOf("model.areaLabel")],
e.prototype,"areaLabel",void 0);a([l.aliasOf("model.area")],e.prototype,"area",void 0);a([l.aliasOf("model.geodesicArea")],e.prototype,"geodesicArea",void 0);a([l.aliasOf("model.pathLengthLabel")],e.prototype,"pathLengthLabel",void 0);a([l.aliasOf("model.pathLength")],e.prototype,"pathLength",void 0);a([l.aliasOf("model.geodesicPathLength")],e.prototype,"geodesicPathLength",void 0);a([l.aliasOf("model.perimeterLengthLabel")],e.prototype,"perimeterLengthLabel",void 0);a([l.aliasOf("model.perimeterLength")],
e.prototype,"perimeterLength",void 0);a([l.aliasOf("model.geodesicPerimeterLength")],e.prototype,"geodesicPerimeterLength",void 0);a([l.aliasOf("model.validMeasurement")],e.prototype,"validMeasurement",void 0);a([l.aliasOf("model.viewData")],e.prototype,"viewData",void 0);return e=a([l.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],e)}(l.declared(y))})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/screenUtils ./AreaMeasurement3DView".split(" "),
function(z,t,k,a,f,g,q){function l(a){return"mouse"!==a.pointerType||0===a.button}return function(){function a(a,c){this._dragVertices={};this._handles=new f;this._tempPickRequest=new q.PickRequest;this._ignoreClickEventId=null;this.model=a;this.view=c;this.model.reset()}a.prototype.destroy=function(){this._handles.destroy();this._handles=null};a.prototype.handleInputEvent=function(a){switch(a.type){case "immediate-click":this._handleImmediateClick(a);break;case "click":this._handleClick(a);break;
case "double-click":this._handleDoubleClick(a);break;case "drag":this._handleDrag(a);break;case "pointer-move":this._handlePointerMove(a);break;case "pointer-down":this._handlePointerDown(a);break;case "pointer-up":this._handlePointerUp(a);break;case "pointer-drag":this._handlePointerDrag(a);break;case "key-down":this._handleKeyDown(a)}};a.prototype._handleDrag=function(a){0!==this.model.draggedVertices.length&&a.stopPropagation()};a.prototype._handlePointerMove=function(a){var b=g.createScreenPointFromEvent(a);
"mouse"===a.pointerType&&this._hoverAt(b,a.pointerType)};a.prototype._handlePointerDown=function(a){if(l(a)&&this.model.editable){var b=g.createScreenPointFromEvent(a),b=this.view.vertexHandleAt(b,a.pointerType);null==b||b in this._dragVertices||(this._dragVertices[a.pointerId]=b,this.model.draggedVertices.push(b));0<this.model.draggedVertices.length&&"measured"===this.model.state&&(this.model.state="editing");"mouse"!==a.pointerType&&this._removeHover();null!=b&&a.stopPropagation()}};a.prototype._handlePointerUp=
function(a){if(l(a)){var b=this._dragVertices[a.pointerId];null!=b&&(delete this._dragVertices[a.pointerId],this.model.draggedVertices.remove(b));0===this.model.draggedVertices.length&&"editing"===this.model.state&&(this.model.state="measured")}};a.prototype._handlePointerDrag=function(a){if(l(a)){var b=g.createScreenPointFromEvent(a),d=this._dragVertices[a.pointerId];if(null!=d){switch(a.action){case "update":this._moveVertexTo(d,b,a.pointerType);break;case "end":delete this._dragVertices[a.pointerId],
this.model.draggedVertices.remove(d)}a.stopPropagation()}}};a.prototype._handleImmediateClick=function(a){if(l(a)){var b=g.createScreenPointFromEvent(a),d=!1;if(this.model.active)switch(this.model.state){case "initial":this._addVertexAt(b,a.pointerType)&&(this.model.state="drawing",d=!0);break;case "drawing":var f=this.view.vertexHandleAt(b,a.pointerType);if(null===f){if(this._addVertexAt(b,a.pointerType)){a.stopPropagation();return}}else 0===f&&(this._updateHoveredHandle(b,a.pointerType),this.model.finishMeasurement(),
d=!0);break;case "measured":null===this.view.vertexHandleAt(b,a.pointerType)&&(this.model.clearMeasurement(),this._addVertexAt(b,a.pointerType)&&(this.model.state="drawing",d=!0))}d&&(a.stopPropagation(),this._ignoreClickEventId=a.eventId);"mouse"===a.pointerType&&this._hoverAt(b,a.pointerType)}};a.prototype._handleClick=function(a){l(a)&&(this.model.active||this._ignoreClickEventId===a.eventId)&&a.stopPropagation()};a.prototype._handleDoubleClick=function(a){if(l(a)){var b=g.createScreenPointFromEvent(a);
"drawing"===this.model.state&&null!=this.view.vertexHandleAt(b,a.pointerType)?(this.model.finishMeasurement(),a.stopPropagation()):(this.model.active||this._ignoreClickEventId===a.eventId)&&a.stopPropagation()}};a.prototype._handleKeyDown=function(a){"Escape"===a.key&&"drawing"===this.model.state&&(this.model.clearMeasurement(),a.stopPropagation());"Enter"===a.key&&"drawing"===this.model.state&&(this.model.finishMeasurement(),a.stopPropagation())};a.prototype._hoverAt=function(a,c){this._updateHoveredHandle(a,
"mouse");this.view.requiresCursorPoint?(a=this._pick(a),a.mapPoint&&(this.model.cursorPoint=a.mapPoint)):this.model.cursorPoint=null};a.prototype._removeHover=function(){this.model.cursorPoint=null;this.model.hoveredVertexHandle=null};a.prototype._addVertexAt=function(a,c){var b=this._pick(a);if(b.mapPoint)return this.model.path.add(b.mapPoint),this.model.hoveredVertexHandle="touch"!==c?this.model.path.length-1:null,!0;this._updateHoveredHandle(a,c);return!1};a.prototype._moveVertexTo=function(a,
c,d){c=this._clipToScreen(c);if(null!=a){var b=this._pick(c);if(b.mapPoint&&!this.view.overlapsAnyHandles(b.mapPoint,[a]))return this.model.path.update(a,b.mapPoint),this.model.hoveredVertexHandle="touch"!==d?a:null,!0}this._updateHoveredHandle(c,d);return!1};a.prototype._pick=function(a){var b=this._tempPickRequest;b.screenPoint=a;return this.view.pick(b)};a.prototype._clipToScreen=function(a){return g.createScreenPoint(Math.max(0,Math.min(this.model.sceneView.width,a.x)),Math.max(0,Math.min(this.model.sceneView.height,
a.y)))};a.prototype._updateHoveredHandle=function(a,c){this.model.hoveredVertexHandle="touch"!==c?this.view.vertexHandleAt(a,c):null};return a}()})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DView":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../directLineMeasurement3D/LaserLineRenderer ../support/Label ../support/LabelSegment ../support/labelUtils ../support/PathSegmentInterpolator ../support/viewUtils ../../../support/stack ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryData ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Intersector ../../../webgl-engine/lib/Layer ../../../webgl-engine/lib/Object3D ../../../webgl-engine/materials/CheckerBoardMaterial ../../../webgl-engine/materials/DefaultMaterial ../../../webgl-engine/materials/RibbonLineMaterial ../../../webgl-engine/parts/Model".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n,w,e,B,A,C,x,p,u,E,r,h,m,G,D){var H={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,
projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25};z=function(){function a(a,c){void 0===c&&(c={});this._model=a;this._visible=!1;this._laserLineRenderer=null;this._pathSegmentObjects=[];this._perimeterSegmentObjects=[];this._vertexHandleObjects=[];this._projectionLineObjects=[];this._areaLabel=new y(16);this._pathLengthLabel=new y(12);this._cursorSegmentLengthLabel=new y(12);this._perimeterLengthLabel=new y(12);this._pathLabelSegments=
[];this._perimeterLabelSegments=[];this._cursorSegmentLengthLabelSegment=new n;this._listenerHandles=null;this._origin=b.vec3f64.create();this._originTransform=l.mat4f64.create();this._tempStartPosition=b.vec3f64.create();this._tempEndPosition=b.vec3f64.create();this._tempHandlePosition=b.vec3f64.create();this._tempMat4=l.mat4f64.create();this._sceneView=this._model.sceneView;this._params=B.copyParameter(H,c);this._layer=new E("path-measurement-tool",{isPickable:!1});this._createMaterials();this._createObjects();
this._intersector=new u(this._sceneView.viewingMode)}a.prototype.destroy=function(){this.hide()};Object.defineProperty(a.prototype,"requiresCursorPoint",{get:function(){return("initial"===this._model.state||"drawing"===this._model.state)&&this._model.active},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){a?this.show():this.hide()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"testData",{get:function(){return{labels:{area:this._areaLabel,
pathLength:this._pathLengthLabel,cursorSegmentLength:this._cursorSegmentLengthLabel,perimeterLength:this._perimeterLengthLabel},laserLineRenderer:this._laserLineRenderer}},enumerable:!0,configurable:!0});a.prototype.show=function(){if(!this._visible){this._visible=!0;var a=this._sceneView._stage;this._laserLineRenderer=new c(this._sceneView.renderCoordsHelper,{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,
globalAlpha:this._params.laserLineGlobalAlpha});a.addRenderPlugin(this._laserLineRenderer.renderSlots,this._laserLineRenderer);this._addToStage(a);this._areaLabel.addToView(this._sceneView);this._pathLengthLabel.addToView(this._sceneView);this._cursorSegmentLengthLabel.addToView(this._sceneView);this._perimeterLengthLabel.addToView(this._sceneView);this._initializeListeners();this._updateAll(this._model.viewData)}};a.prototype.hide=function(){if(this._visible){this._visible=!1;var a=this._sceneView._stage;
a.removeRenderPlugin(this._laserLineRenderer);this._laserLineRenderer=null;this._destroyListeners();this._updatePathLength(0);this._removeFromStage(a);this._areaLabel.removeFromView(this._sceneView);this._pathLengthLabel.removeFromView(this._sceneView);this._cursorSegmentLengthLabel.removeFromView(this._sceneView);this._perimeterLengthLabel.removeFromView(this._sceneView);this._sceneView.cursor=null}};a.prototype.vertexHandleAt=function(a,b){a=g.screenPointObjectToArray(a);b="touch"===b?this._params.handleRadiusTouch:
this._params.handleRadiusMouse;for(var c=this._model.path,d=0;d<c.length;++d)if(B.pointToScreenPositionDistance(c.vertex(d),a,this._sceneView)<b)return d;return null};a.prototype.pick=function(c){var d=this._sceneView.spatialReference;c=g.screenPointObjectToArray(c.screenPoint);c=this._sceneView.sceneIntersectionHelper.intersectToolIntersectorScreen(c,this._intersector).results.min;var e=b.vec3f64.create();if(!c.getIntersectionPoint(e))return new a.PickResult;d=this._sceneView.renderCoordsHelper.fromRenderCoords(e,
d);return new a.PickResult("TerrainRenderer"===c.intersector?"surface":"feature",e,d)};a.prototype.overlappingHandles=function(a,b){return B.pointToPointScreenDistance(a,b,this._sceneView)<=this._params.handleRadius};a.prototype.overlapsAnyHandles=function(a,b){void 0===b&&(b=[]);for(var c=this._model.path,d=0;d<c.length;++d)if(!(0<=b.indexOf(d))&&this.overlappingHandles(a,c.vertex(d)))return!0;return!1};a.prototype._createMaterials=function(){var a=1!==this._params.handleOpacity;this._handleMaterial=
new m({diffuse:this._params.handleColor,transparent:a,writeDepth:!a,cullFace:"back",opacity:this._params.handleOpacity,castShadows:!1},"handle");this._handleMaterial.renderOccluded=4;this._pathLineMaterial=new G({width:this._params.pathLineWidth,color:this._params.pathLineColor,polygonOffset:!0},"path-line");this._pathLineMaterial.renderOccluded=4;this._intersectingPathLineMaterial=new G({width:this._params.pathLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0},"intersecting-path-line");
this._intersectingPathLineMaterial.renderOccluded=4;this._perimeterLineMaterial=new G({width:this._params.perimeterLineWidth,color:this._params.perimeterLineColor,polygonOffset:!0},"perimeter-line");this._perimeterLineMaterial.renderOccluded=4;this._intersectingPerimeterLineMaterial=new G({width:this._params.perimeterLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0},"intersecting-perimeter-line");this._intersectingPerimeterLineMaterial.renderOccluded=4;this._projectionLineMaterial=
new G({width:this._params.projectionLineWidth,color:this._params.projectionLineColor,polygonOffset:!0,stippleLength:0},"projection-line");this._projectionLineMaterial.renderOccluded=4;this._checkerBoardMaterial=new h({color1:this._params.areaColor1,color2:this._params.areaColor2,transparent:!0,writeDepth:!1,polygonOffset:!0},"checker-board");this._checkerBoardMaterial.renderOccluded=4};a.prototype._createObjects=function(){this._cursorHandleObject=new r;this._cursorSegmentObject=new r;this._areaObject=
new r};a.prototype._addToStage=function(a){a.add(D.ContentType.LAYER,this._layer);a.add(D.ContentType.MATERIAL,this._handleMaterial);a.add(D.ContentType.MATERIAL,this._pathLineMaterial);a.add(D.ContentType.MATERIAL,this._intersectingPathLineMaterial);a.add(D.ContentType.MATERIAL,this._perimeterLineMaterial);a.add(D.ContentType.MATERIAL,this._intersectingPerimeterLineMaterial);a.add(D.ContentType.MATERIAL,this._projectionLineMaterial);a.add(D.ContentType.MATERIAL,this._checkerBoardMaterial);a.addToViewContent([this._layer.id])};
a.prototype._removeFromStage=function(a){a.removeFromViewContent([this._layer.id]);a.remove(D.ContentType.LAYER,this._layer.id);a.remove(D.ContentType.MATERIAL,this._handleMaterial.id);a.remove(D.ContentType.MATERIAL,this._pathLineMaterial.id);a.remove(D.ContentType.MATERIAL,this._intersectingPathLineMaterial.id);a.remove(D.ContentType.MATERIAL,this._perimeterLineMaterial.id);a.remove(D.ContentType.MATERIAL,this._intersectingPerimeterLineMaterial.id);a.remove(D.ContentType.MATERIAL,this._projectionLineMaterial.id);
a.remove(D.ContentType.MATERIAL,this._checkerBoardMaterial.id)};a.prototype._syncViewData=function(a){var b=this;if(!this._visible)return"none";var c=a.pathChanges;"full"===c.change?this._updateAll(a):"incremental"===c.change&&(c.updatedVertices.forEach(function(c){var d=(c-1+b._model.path.length)%b._model.path.length;b._updatePathSegment(a,c);b._updatePathSegment(a,d);b._updateVertexHandle(a,c);b._updateArea(a);b._updatePerimeterSegments(a);b._updateProjectionLines(a);b._updateLaserLine();b._updateLabels(a)}),
c.updatedVertices.has(this._model.path.length-1)&&this._updateCursorSegment(a));var d=c.change;c.clear();return d};a.prototype._updateAfterSyncViewData=function(a){var b=this._model.viewData;"full"!==this._syncViewData(b)&&a&&a(b)};a.prototype._updateOrigin=function(a){B.midpoint(a.positionsRenderCoords,this._origin);q.mat4.identity(this._originTransform);q.mat4.translate(this._originTransform,this._originTransform,this._origin)};a.prototype._updateAll=function(a){this._updateOrigin(a);this._updatePathLength(a.path.length);
this._updatePathSegments(a);this._updatePerimeterSegments(a);this._updateHandles(a);this._updateArea(a);this._updateProjectionLines(a);this._updateLabels(a);this._updateLaserLine()};a.prototype._updateCameraDependent=function(a){this._updateHandles(a);this._updateProjectionLines(a);this._updateLabels(a)};a.prototype._updatePathLength=function(a){this._resizeObject3DArray(this._pathSegmentObjects,a);this._resizeObject3DArray(this._perimeterSegmentObjects,a);this._resizeObject3DArray(this._vertexHandleObjects,
a);B.resizeArray(this._pathLabelSegments,a,function(){return new n});B.resizeArray(this._perimeterLabelSegments,a,function(){return new n})};a.prototype._updatePathSegments=function(a){for(var b=0;b<this._pathSegmentObjects.length;++b)this._updatePathSegment(a,b);this._updateCursorSegment(a)};a.prototype._updatePathSegment=function(a,b){var c=a.path,d=this._pathSegmentObjects[b];a.validMeasurement||b<c.length-1?(this._createInterpolatedLineGeometry(d,a.intersectingSegments.has(b)?this._intersectingPathLineMaterial:
this._pathLineMaterial,"path-segment",a.positionsRenderCoords[b],a.positionsRenderCoords[(b+1)%c.length],this._origin,this._originTransform,this._model.measurementMode,this._pathLabelSegments[b],a.validMeasurement?"center":"end"),this._addObject3D(d)):(d.removeAllGeometries(),this._removeObject3D(d))};a.prototype._updateCursorSegment=function(a){a=this._sceneView.renderCoordsHelper;var b=this._model.path,c=this._cursorSegmentObject;0<b.length&&"drawing"===this._model.state&&this._model.cursorPoint?
(a.toRenderCoords(b.back,this._tempStartPosition),a.toRenderCoords(this._model.cursorPoint,this._tempEndPosition),this._createInterpolatedLineGeometry(c,this._pathLineMaterial,"path-segment",this._tempStartPosition,this._tempEndPosition,this._origin,this._originTransform,this._model.measurementMode,this._cursorSegmentLengthLabelSegment,"end"),this._addObject3D(c)):(c.removeAllGeometries(),this._removeObject3D(c))};a.prototype._updatePerimeterSegments=function(a){for(var b=0;b<this._perimeterSegmentObjects.length;++b)this._updatePerimeterSegment(a,
b)};a.prototype._updatePerimeterSegment=function(a,b){var c=a.path,d=this._perimeterSegmentObjects[b];a.validMeasurement&&"geodesic"!==this._model.measurementMode?(this._updatePerimeterSegmentObject(d,a.positionsFittedRenderCoords[b],a.positionsFittedRenderCoords[(b+1)%c.length],this._origin,this._originTransform,a.intersectingSegments.has(b),this._perimeterLabelSegments[b]),this._addObject3D(d)):(d.removeAllGeometries(),this._removeObject3D(d))};a.prototype._updatePerimeterSegmentObject=function(a,
b,c,d,e,f,g){this._createInterpolatedLineGeometry(a,f?this._intersectingPerimeterLineMaterial:this._perimeterLineMaterial,"perimeter-segment",b,c,d,e,this._model.measurementMode,g)};a.prototype._updateHandles=function(a){for(var b=0;b<this._vertexHandleObjects.length;++b)this._updateVertexHandle(a,b);this._updateCursorHandle(a)};a.prototype._updateVertexHandle=function(a,b){var c=this._sceneView._stage.getCamera(),d=this._vertexHandleObjects[b];this._updateHandleObject(d,a.positionsRenderCoords[b],
!0,this._model.hoveredVertexHandle===b,this._model.draggedVertices.includes(b),c);this._addObject3D(d)};a.prototype._updateCursorHandle=function(a){a=this._cursorHandleObject;if("drawing"===this._model.state&&this._model.cursorPoint){var b=this._sceneView._stage.getCamera(),c=this._tempHandlePosition;this._sceneView.renderCoordsHelper.toRenderCoords(this._model.cursorPoint,c);this._updateHandleObject(a,c,!0,!1,!1,b);this._addObject3D(a)}else a.removeAllGeometries(),this._removeObject3D(a)};a.prototype._updateHandleObject=
function(b,c,d,e,f,g){b.removeAllGeometries();d&&!f&&this._model.editable&&(B.scaleTranslateMatrix((e?this._params.handleRadiusHovered:this._params.handleRadius)*g.computeScreenPixelSizeAt(c),c,this._tempMat4),b.addGeometry(a._handleGeometry,this._handleMaterial,this._tempMat4))};a.prototype._updateArea=function(a){switch(this._model.measurementMode){case "euclidean":this._updateAreaEuclidean(a);break;case "geodesic":this._updateAreaGeodesic(a)}};a.prototype._updateAreaEuclidean=function(a){var c=
this,e=this._areaObject;if(a.validMeasurement&&0===a.intersectingSegments.size&&a.triangleIndices){var f=[],g=b.vec3f64.create();a.positionsFittedRenderCoords.forEach(function(a){d.vec3.subtract(g,a,c._origin);f.push(g[0],g[1],g[2])});var m=[];a.positionsProjected.forEach(function(a){m.push(a[0],a[1])});var p=new x({position:{size:3,data:f},uv0:{size:2,data:m}},{position:a.triangleIndices,uv0:a.triangleIndices}),p=new C(p,"area");e.removeAllGeometries();e.addGeometry(p,this._checkerBoardMaterial,
this._originTransform);this._addObject3D(e);this._checkerBoardMaterial.setParameterValues({size:[a.checkerSize,a.checkerSize]})}else e.removeAllGeometries(),this._removeObject3D(e)};a.prototype._updateAreaGeodesic=function(a){a=this._areaObject;a.removeAllGeometries();this._removeObject3D(a)};a.prototype._updateProjectionLines=function(a){var b=a.path;this._resizeObject3DArray(this._projectionLineObjects,b.length);for(var c=0;c<b.length;++c)this._updateProjectionLine(a,c);for(var d=Infinity,c=0;c<
b.length;++c)d=Math.max(this._sceneView._stage.getCamera().computeScreenPixelSizeAt(a.positionsRenderCoords[c])),d=Math.max(this._sceneView._stage.getCamera().computeScreenPixelSizeAt(a.positionsFittedRenderCoords[c]));this._projectionLineMaterial.setParameterValues({stippleLength:this._params.projectionLineStippleSize*d})};a.prototype._updateProjectionLine=function(a,c){var e=this._projectionLineObjects[c];e.removeAllGeometries();if(a.validMeasurement&&"euclidean"===this._model.measurementMode){a=
b.vec3f64.create();d.vec3.subtract(a,this._model.viewData.positionsRenderCoords[c],this._origin);var f=b.vec3f64.create();d.vec3.subtract(f,this._model.viewData.positionsFittedRenderCoords[c],this._origin);c=new C(p.createPolylineGeometry([a,f]),"projected-line");e.addGeometry(c,this._projectionLineMaterial,this._originTransform);this._addObject3D(e)}else this._removeObject3D(e)};a.prototype._updateLabels=function(a){var b=this,c=this._sceneView._stage.getCamera(),d=this._params.labelDistance,e=this._model,
f="geodesic"===e.measurementMode,g="drawing"===e.state,m=function(a,c){return a.visible&&c.visible&&b._sceneView.overlay.overlaps(a.textItem,c.textItem)},p=this._areaLabel,h=w.positionLabelOnPoint(p,a.areaCentroid,c);p.text=e.areaLabel;p.visible=h&&a.validMeasurement&&0===a.intersectingSegments.size&&null!=e.areaLabel;p=this._pathLengthLabel;h=w.positionLabelOnCorner(p,this._pathLabelSegments[a.pathLengthLabelSegmentIndex],this._cursorSegmentLengthLabelSegment,d,c);p.text=e.pathLengthLabel;p.visible=
h&&g&&0<e.path.length;p=this._cursorSegmentLengthLabel;h=this._cursorSegmentLengthLabelSegment;h=w.positionLabelOnSegment(p,h,d,"bottom",c);p.text=e.cursorSegmentLengthLabel;p.visible=h&&g&&e.cursorSegmentLength&&0!==e.cursorSegmentLength.value;m(this._cursorSegmentLengthLabel,this._pathLengthLabel)&&(this._cursorSegmentLengthLabel.visible=!1);m(this._pathLengthLabel,this._areaLabel)&&(this._pathLengthLabel.visible=!1);p=this._perimeterLengthLabel;if(e.validMeasurement&&0===a.intersectingSegments.size)for(g=
0;g<a.path.length;++g)if(h=(a.perimeterLengthLabelSegmentIndex+g)%a.path.length,h=f?this._pathLabelSegments[h]:this._perimeterLabelSegments[h],h=w.positionLabelOnSegment(p,h,d,"top",c),p.text=e.perimeterLengthLabel,p.visible=h,m(p,this._areaLabel))p.visible=!1;else break;else p.visible=!1};a.prototype._lastAddedDraggedVertex=function(){var a=this._model.draggedVertices;return 0<a.length?a.items[a.length-1]:null};a.prototype._getFocusPoint=function(){var a=this._model,b=this._lastAddedDraggedVertex();
switch(a.state){case "drawing":return a.cursorPoint?a.cursorPoint:a.path.vertex(null!=b?b:a.path.length-1);case "editing":return null!=b?a.path.vertex(b):null;default:return a.cursorPoint}};a.prototype._updateLaserLine=function(){var a=this._model,b=this._params.laserLineEnabled&&"measured"!==a.state&&a.active;this._laserLineRenderer.focusSphereActive=!1;this._laserLineRenderer.segmentActive=!1;a=this._getFocusPoint();b&&a?(b=this._tempHandlePosition,this._sceneView.renderCoordsHelper.toRenderCoords(a,
b),this._laserLineRenderer.focusPosition=b,this._laserLineRenderer.focusPlaneActive=!0):this._laserLineRenderer.focusPlaneActive=!1};a.prototype._addObject3D=function(a){a.parentLayer||(this._layer.addObject(a),this._sceneView._stage.add(D.ContentType.OBJECT,a))};a.prototype._removeObject3D=function(a){a.parentLayer&&(this._layer.removeObject(a),this._sceneView._stage.remove(D.ContentType.OBJECT,a.id))};a.prototype._resizeObject3DArray=function(a,b){var c=this;B.resizeArray(a,b,function(){return new r},
function(a){c._removeObject3D(a)})};a.prototype._createInterpolatedLineGeometry=function(a,b,c,e,f,g,m,h,u,k){var r=this._sceneView.renderCoordsHelper,l=[],v=[],n=function(a,b){var c=A.sv3d.get();d.vec3.subtract(c,a,g);l.push(c);v.push(b)};if("euclidean"===h){var x=A.sv3d.get();B.midpoint([e,f],x);h=A.sv3d.get();r.worldUpAtPosition(x,h);n(e,h);n(f,h);u&&u.update(e,f,k)}else{e=this._getSegmentInterpolator(e,f);f=this._params.lineSubdivisions+1&-2;var q=x=null,t=f/2-1,w=f/2;"start"===k?(t=0,w=1):"end"===
k&&(t=f-2,w=f-1);for(var y=0;y<f;++y){var E=y/(f-1),z=A.sv3d.get();h=A.sv3d.get();e.eval(E,z);r.worldUpAtPosition(z,h);y===t&&(x=z);y===w&&(q=z);n(z,h)}u&&u.update(x,q,k)}c=new C(p.createPolylineGeometry(l,v),c);a.removeAllGeometries();a.addGeometry(c,b,m)};a.prototype._getSegmentInterpolator=function(a,b){var c=this._sceneView.spatialReference;return c.isWebMercator||c.isWGS84?(c=this._sceneView.renderCoordsHelper.spatialReference,new e.Spherical(a,b,c,c)):new e.Linear(a,b)};a.prototype._initializeListeners=
function(){var a=this;this._listenerHandles=new f;this._listenerHandles.add([this._model.watch("state",function(){return a._updateLaserLine()}),this._model.draggedVertices.on("change",function(){return a._updateLaserLine()}),this._model.watch("hoveredVertexHandle",function(){return a._updateAfterSyncViewData(function(b){return a._updateHandles(b)})}),this._model.draggedVertices.on("change",function(){return a._updateAfterSyncViewData(function(b){return a._updateHandles(a._model.viewData)})}),this._model.watch("cursorPoint",
function(){return a._updateAfterSyncViewData(function(b){a._updateCursorSegment(b);a._updateCursorHandle(b);"drawing"===a._model.state&&a._updateLabels(b);a._updateLaserLine()})}),this._sceneView.state.watch("camera",function(){return a._updateAfterSyncViewData(function(b){return a._updateCameraDependent(a._model.viewData)})}),this._model.watch(["unit","measurementMode"],function(){return a._updateAll(a._model.viewData)}),this._model.watch(["active","editable"],function(){a._updateLaserLine();a._updateAfterSyncViewData(function(b){return a._updateHandles(b)})}),
this._model.watch("viewData",function(b){return a._syncViewData(b)})])};a.prototype._destroyListeners=function(){this._listenerHandles.destroy();this._listenerHandles=null};a._handleGeometry=new C(p.createSphereGeometry(1,32,32),"handle");return a}();(function(a){var b=function(){return function(){}}();a.PickRequest=b;b=function(){return function(a,b,c){void 0===a&&(a=null);void 0===b&&(b=null);void 0===c&&(c=null);this.type=a;this.scenePoint=b;this.mapPoint=c}}();a.PickResult=b})(z||(z={}));return z})},
"esri/views/3d/webgl-engine/materials/CheckerBoardMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../lib/Util ./internal/bufferWriters ./internal/MaterialUtil ./internal/MaterialUtil ./renderers/InstancedRenderer ../shaders/CheckerBoardPrograms ../../../webgl/renderState".split(" "),function(z,t,k,a,f,g,q,l,d,b,c,y,n){z=function(a){function f(b,c){c=a.call(this,c)||this;c.params=d.copyParameters(b,
e);return c}k(f,a);f.prototype.dispose=function(){};f.prototype.getParameterValues=function(){var a=this.params;return{size:a.size,color1:a.color1,color2:a.color2,transparent:a.transparent,writeDepth:a.writeDepth,polygonOffset:a.polygonOffset}};f.prototype.setParameterValues=function(a){d.updateParameters(this.params,a)&&this.notifyDirty("matChanged")};f.prototype.getParams=function(){return this.params};f.prototype.intersect=function(a,c,d,e,f,g,k,l){return b.intersectTriangleGeometry(a,c,d,e,f,
g,k)};f.prototype.getGLMaterials=function(){return{color:w,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};f.prototype.getAllTextureIds=function(){return[]};f.prototype.createBufferWriter=function(){return new A};f.prototype.createRenderer=function(a,b){return new c(a,b,this)};return f}(g);var w=function(a){function b(b,c,d){b=a.call(this,b,c)||this;b.programRep=c;b.updateParameters();return b}k(b,a);b.prototype.selectProgram=function(){this.program=this.programRep.getProgram(y.colorPass);
this.pipelineState=n.makePipelineState({blending:this.params.transparent&&n.separateBlendingParams(770,1,771,771),polygonOffset:this.params.polygonOffset&&{factor:0,units:-25},depthTest:{func:513},depthWrite:this.params.writeDepth&&n.defaultDepthWriteParams,colorWrite:n.defaultColorWriteParams})};b.prototype.updateParameters=function(){this.params=this.material.getParameterValues();this.selectProgram()};b.prototype.beginSlot=function(a){var b=4;this.params.transparent&&(b=this.params.writeDepth?6:
9);return a===b};b.prototype.getProgram=function(){return this.program};b.prototype.getDrawMode=function(){return 4};b.prototype.bind=function(a,b){b=this.program;a.bindProgram(b);a.setPipelineState(this.pipelineState);b.setUniform2fv("size",this.params.size);b.setUniform4fv("color1",this.params.color1);b.setUniform4fv("color2",this.params.color2)};b.prototype.bindView=function(a,b){a=b.origin;var c=this.getProgram();d.bindView(a,b.view,c)};b.prototype.bindInstance=function(a,b){this.getProgram().setUniformMatrix4fv("model",
b.transformation)};b.prototype.release=function(a){};return b}(f),e={size:[1,1],color1:[.75,.75,.75,1],color2:[.5,.5,.5,1],transparent:!1,writeDepth:!0,polygonOffset:!1},B=a.newLayout().vec3f(q.VertexAttrConstants.POSITION).vec2f(q.VertexAttrConstants.UV0),A=function(){function a(){this.vertexBufferLayout=B}a.prototype.allocate=function(a){return B.createBuffer(a)};a.prototype.elementCount=function(a){return a.indices[q.VertexAttrConstants.POSITION].length};a.prototype.write=function(a,b,c,d,e){l.writePosition(b.indices[q.VertexAttrConstants.POSITION],
b.vertexAttr[q.VertexAttrConstants.POSITION].data,a.transformation,d.position,e);l.writeBufferVec2(b.indices[q.VertexAttrConstants.UV0],b.vertexAttr[q.VertexAttrConstants.UV0].data,d.uv0,e)};return a}();return z})},"esri/views/3d/webgl-engine/shaders/CheckerBoardPrograms":function(){define(["require","exports","../lib/DefaultVertexAttributeLocations","./sources/resolver"],function(z,t,k,a){Object.defineProperty(t,"__esModule",{value:!0});t.colorPass={name:"checker-board-color",shaders:{vertexShader:a.resolveIncludes("materials/checkerBoard/checkerBoard.vert"),
fragmentShader:a.resolveIncludes("materials/checkerBoard/checkerBoard.frag")},attributes:k.Default3D}})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DModel":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/Collection ../../../../../core/compilerUtils ../../../../../core/Handles ../../../../../core/Quantity ../../../../../core/quantityUtils ../../../../../core/unitUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ../../../../../geometry/SpatialReference ./MeasurementData ./PathChanges ../support/measurementUtils ../support/Path ../support/setUtils ../support/UnitNormalizer ../../../support/mathUtils ../../../support/projectionUtils".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n,w,e,B,A,C,x,p,u,E){return function(f){function h(){var a=null!==f&&f.apply(this,arguments)||this;a._unitNormalizer=new p;a._measurementData=new e;a._measurementDataChanges=new B;a._viewDataChanges=new B;a._handles=new l;a.path=new C;a.pathVersion=0;a.cursorPoint=null;a.hoveredVertexHandle=null;a.draggedVertices=new g;a.state="initial";a.mode="auto";a.unit="metric";a.editable=!0;a.active=!1;a.maxRelativeErrorCoplanar=.005;a.maxRelativeErrorAlmostCoplanar=.01;a.verticalAngleThreshold=
80;a.geodesicMeasurementDistanceThreshold=1E5;return a}k(h,f);h.prototype.initialize=function(){var a=this;this._handles.add(y.whenTrue(this.sceneView,"ready",function(){var b=a.sceneView.spatialReference;a._worldSpatialReference=!b||b.isWGS84||b.isWebMercator?E.WGS84ECEFSpatialReference:b;a._unitNormalizer.spatialReference=b;a._unitNormalizer.ignoredSpatialReferences=[w.WGS84,w.WebMercator]}),"scene-view");this.reset();var b=function(){a._set("pathVersion",a.pathVersion+1)};this._handles.add(this.path.on("cleared",
function(){a._measurementDataChanges.fullChange();a._set("pathVersion",0)}));this._handles.add(this.path.on("vertex-added",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-inserted",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-removed",function(c){a._measurementDataChanges.fullChange();b()}));this._handles.add(this.path.on("vertex-updated",function(c){a._measurementDataChanges.incrementalChange(c.index);
b()}))};h.prototype.destroy=function(){this._handles.destroy();this._handles=null};Object.defineProperty(h.prototype,"validMeasurement",{get:function(){return 3<=this.path.length&&"measured"===this.state||"editing"===this.state},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isMeasuring",{get:function(){return 1<=this.path.length},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"measurementData",{get:function(){this._viewDataChanges.merge(this._measurementDataChanges);
var a=x.clone(this._measurementData.intersectingSegments),b=x.clone(this._measurementData.geodesicIntersectingSegments);this._measurementData.update(this.path,this._measurementDataChanges,this.sceneView,this._unitNormalizer,this.validMeasurement,this.sceneView.renderSpatialReference,this._worldSpatialReference,{maxRelativeErrorCoplanar:this.maxRelativeErrorCoplanar,maxRelativeErrorAlmostCoplanar:this.maxRelativeErrorAlmostCoplanar,verticalAngleThreshold:this.verticalAngleThreshold});A.compareSets(this._measurementData.intersectingSegments,
a)||this._viewDataChanges.fullChange();A.compareSets(this._measurementData.geodesicIntersectingSegments,b)||this._viewDataChanges.fullChange();return this._measurementData},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"area",{get:function(){return this.measurementData.area},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"geodesicArea",{get:function(){return this.measurementData.geodesicArea},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"areaLabel",{get:function(){return this._formatAreaLabel("geodesic"===this.measurementMode?this.measurementData.geodesicArea:this.measurementData.area,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"pathLength",{get:function(){return this.measurementData.pathLength},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"geodesicPathLength",{get:function(){return this.measurementData.geodesicPathLength},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"pathLengthLabel",{get:function(){return this._formatLengthLabel("geodesic"===this.measurementMode?this.measurementData.geodesicPathLength:this.measurementData.pathLength,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"perimeterLength",{get:function(){return this.measurementData.perimeterLength},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"geodesicPerimeterLength",{get:function(){return this.measurementData.geodesicPathLength},enumerable:!0,configurable:!0});
Object.defineProperty(h.prototype,"perimeterLengthLabel",{get:function(){return this.measurementData.perimeterLength&&this._formatLengthLabel("geodesic"===this.measurementMode?this.measurementData.geodesicPathLength:this.measurementData.perimeterLength,this.unit)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"cursorSegmentLength",{get:function(){return this.path.back&&this.cursorPoint&&new d(this._unitNormalizer.normalizeDistance(A.segmentLengthEuclidean(this.path.back,this.cursorPoint,
this._worldSpatialReference)),"meters")},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"geodesicCursorSegmentLength",{get:function(){return this.path.back&&this.cursorPoint&&new d(A.segmentLengthGeodesic(this.path.back,this.cursorPoint),"meters")},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"cursorSegmentLengthLabel",{get:function(){return this._formatLengthLabel("geodesic"===this.measurementMode?this.geodesicCursorSegmentLength:this.cursorSegmentLength,this.unit)},
enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"viewData",{get:function(){var a=this.measurementData,b="geodesic"===this.measurementMode,d=b?this.geodesicArea:this.area,e=1;d&&(d=this._toPreferredAreaUnit(d,this.unit),e=u.nextHighestPowerOfTen(Math.sqrt(d.value)/Math.sqrt(300)),e*=Math.sqrt(c.convertUnit(1,d.unit,"square-meters")),e/=this._unitNormalizer.normalizeDistance(1));return{validMeasurement:this.validMeasurement,path:this.path,pathChanges:this._viewDataChanges,positionsGeographic:a.positionsGeographic,
positionsRenderCoords:a.positionsRenderCoords,positionsProjected:a.positionsProjectedWorldCoords,positionsFittedRenderCoords:a.positionsFittedRenderCoords,intersectingSegments:b?a.geodesicIntersectingSegments:a.intersectingSegments,triangleIndices:b?a.geodesicTriangleIndices:a.triangleIndices,fittingMode:a.fittingMode,areaCentroid:b?a.geodesicAreaCentroidRenderCoords:a.areaCentroidRenderCoords,pathLengthLabelSegmentIndex:this.validMeasurement?0:this.path.length-2,perimeterLengthLabelSegmentIndex:0,
checkerSize:e}},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"measurementMode",{get:function(){var a=this.mode;"auto"===a&&(a="euclidean",(this.geodesicPathLength?this.geodesicPathLength.value:0)+(!this.validMeasurement&&this.geodesicCursorSegmentLength?this.geodesicCursorSegmentLength.value:0)>this.geodesicMeasurementDistanceThreshold&&(a="geodesic"));!this.sceneView.ready||this.sceneView.spatialReference.isWGS84||this.sceneView.spatialReference.isWebMercator||(a="euclidean");
return a},enumerable:!0,configurable:!0});h.prototype.reset=function(){this.clearMeasurement()};h.prototype.clearMeasurement=function(){this.path.clear();this.state="initial";this.cursorPoint=null};h.prototype.finishMeasurement=function(){3>this.path.length?this.clearMeasurement():(this._measurementDataChanges.fullChange(),this.state="measured")};h.prototype._preferredAreaUnit=function(a,b){switch(b){case "metric":return c.preferredMetricAreaUnit(a.value,a.unit);case "imperial":return c.preferredImperialAreaUnit(a.value,
a.unit);default:return b}};h.prototype._preferredLengthUnit=function(a,b){b=this._deriveLengthUnitFromAreaUnit(b);switch(b){case "metric":return c.preferredMetricLengthUnit(a.value,a.unit);case "imperial":return c.preferredImperialLengthUnit(a.value,a.unit);default:return b}};h.prototype._toPreferredAreaUnit=function(a,b){return a.toUnit(this._preferredAreaUnit(a,b))};h.prototype._toPreferredLengthUnit=function(a,b){return a.toUnit(this._preferredLengthUnit(a,b))};h.prototype._formatAreaLabel=function(a,
c){return a&&b.formatDecimal(a,this._preferredAreaUnit(a,c))};h.prototype._formatLengthLabel=function(a,c){return a&&b.formatDecimal(a,this._preferredLengthUnit(a,c))};h.prototype._deriveLengthUnitFromAreaUnit=function(a){switch(a){case "metric":return"metric";case "imperial":return"imperial";case "square-inches":return"inches";case "square-feet":return"feet";case "square-yards":return"yards";case "square-miles":return"miles";case "square-us-feet":return"us-feet";case "square-millimeters":return"millimeters";
case "square-centimeters":return"centimeters";case "square-decimeters":return"decimeters";case "square-meters":return"meters";case "square-kilometers":return"kilometers";case "acres":return"imperial";case "ares":case "hectares":return"metric";default:q.neverReached(a)}throw Error("unhandled area unit");};a([n.property({constructOnly:!0})],h.prototype,"sceneView",void 0);a([n.property({readOnly:!0})],h.prototype,"path",void 0);a([n.property({readOnly:!0})],h.prototype,"pathVersion",void 0);a([n.property()],
h.prototype,"cursorPoint",void 0);a([n.property()],h.prototype,"hoveredVertexHandle",void 0);a([n.property({readOnly:!0})],h.prototype,"draggedVertices",void 0);a([n.property()],h.prototype,"state",void 0);a([n.property()],h.prototype,"mode",void 0);a([n.property()],h.prototype,"unit",void 0);a([n.property()],h.prototype,"editable",void 0);a([n.property()],h.prototype,"active",void 0);a([n.property({readOnly:!0,dependsOn:["path.length","state"]})],h.prototype,"validMeasurement",null);a([n.property({readOnly:!0,
dependsOn:["path.length"]})],h.prototype,"isMeasuring",null);a([n.property({readOnly:!0,dependsOn:["pathVersion","validMeasurement","maxRelativeErrorCoplanar","maxRelativeErrorAlmostCoplanar","verticalAngleThreshold"]})],h.prototype,"measurementData",null);a([n.property({readOnly:!0,dependsOn:["measurementData"]})],h.prototype,"area",null);a([n.property({readOnly:!0,dependsOn:["measurementData"]})],h.prototype,"geodesicArea",null);a([n.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],
h.prototype,"areaLabel",null);a([n.property({readOnly:!0,dependsOn:["measurementData"]})],h.prototype,"pathLength",null);a([n.property({readOnly:!0,dependsOn:["measurementData"]})],h.prototype,"geodesicPathLength",null);a([n.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],h.prototype,"pathLengthLabel",null);a([n.property({readOnly:!0,dependsOn:["measurementData"]})],h.prototype,"perimeterLength",null);a([n.property({readOnly:!0,dependsOn:["measurementData"]})],h.prototype,
"geodesicPerimeterLength",null);a([n.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],h.prototype,"perimeterLengthLabel",null);a([n.property({readOnly:!0,dependsOn:["path.back","cursorPoint"]})],h.prototype,"cursorSegmentLength",null);a([n.property({readOnly:!0,dependsOn:["path.back","cursorPoint"]})],h.prototype,"geodesicCursorSegmentLength",null);a([n.property({readOnly:!0,dependsOn:["measurementData","unit","measurementMode"]})],h.prototype,"cursorSegmentLengthLabel",
null);a([n.property({readOnly:!0,dependsOn:["unit","measurementMode","measurementData"]})],h.prototype,"viewData",null);a([n.property()],h.prototype,"maxRelativeErrorCoplanar",void 0);a([n.property()],h.prototype,"maxRelativeErrorAlmostCoplanar",void 0);a([n.property()],h.prototype,"verticalAngleThreshold",void 0);a([n.property()],h.prototype,"geodesicMeasurementDistanceThreshold",void 0);a([n.property({readOnly:!0,dependsOn:["mode","validMeasurement","geodesicPathLength","geodesicCursorSegmentLength",
"geodesicMeasurementDistanceThreshold"]})],h.prototype,"measurementMode",null);return h=a([n.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DModel")],h)}(n.declared(f))})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/MeasurementData":function(){define("require exports ../../../../../core/Quantity ../../../../../core/libs/earcut/earcut ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/vec4f64 ../../../../../geometry/SpatialReference ../../../../../geometry/support/intersects ../support/measurementUtils ../support/viewUtils ../../../support/earthUtils ../../../support/mathUtils ../../../support/mathUtils ../../../support/projectionUtils".split(" "),
function(z,t,k,a,f,g,q,l,d,b,c,y,n,w,e,B,A){function C(a,b,c){b=new Float64Array(a.length*c);for(var d=0;d<a.length;++d)for(var e=a[d],f=0;f<c;++f)b[d*c+f]=e[f];return b}return function(){function x(){this.positionsWorldCoords=[];this.positionsRenderCoords=[];this.positionsProjectedWorldCoords=[];this.positionsFittedRenderCoords=[];this.positionsGeographic=[];this.positionsSpherical=[];this.positionsStereographic=[];this.pathSegmentLengths=[];this.geodesicPathSegmentLengths=[];this.perimeterSegmentLengths=
[];this.intersectingSegments=new Set;this.geodesicIntersectingSegments=new Set;this.areaCentroidWorldCoords=l.vec3f64.create();this.areaCentroidRenderCoords=l.vec3f64.create();this.geodesicAreaCentroidRenderCoords=l.vec3f64.create();this._length=0;this._centroidRenderCoords=l.vec3f64.create();this._planeWorldCoords=d.vec4f64.create();this._worldUp=l.vec3f64.create();this._worldTangent=l.vec3f64.create();this._frame=[l.vec3f64.create(),l.vec3f64.create(),l.vec3f64.create()];this._tempU=l.vec3f64.create();
this._tempV=l.vec3f64.create();this._tempVec3=l.vec3f64.create();this._tempSphere={center:l.vec3f64.create(),radius:0}}x.prototype.update=function(a,c,d,e,f,g,l,n){c.clear();this._resize(a.length);c=d.spatialReference.isWGS84||d.spatialReference.isWebMercator;for(var h=this.positionsGeographic,p=this.positionsWorldCoords,u=this.positionsRenderCoords,r=this.positionsSpherical,m=0;m<a.length;++m){var x=a.vertex(m);A.pointToVector(x,p[m],l);A.pointToVector(x,u[m],g);c&&(A.pointToVector(x,h[m],b.WGS84),
A.pointToVector(x,r[m],A.SphericalECEFSpatialReference),q.vec3.normalize(r[m],r[m]))}a=this._updatePathLengths(f);this.pathLength=0<this._length?new k(e.normalizeDistance(a),"meters"):null;c?(a=this._updateGeodesicPathLengths(f),this.geodesicPathLength=0<this._length?new k(a,"meters"):null):this.geodesicPathLength=null;f?(this._updateArea(d,e,g,l,n),c&&this._updateGeodesicArea(d,g)):(this.geodesicTriangleIndices=this.triangleIndices=this.perimeterLength=this.geodesicArea=this.area=null,this.intersectingSegments.clear(),
this.geodesicIntersectingSegments.clear())};x.prototype._resize=function(a){a<this._length&&(this.positionsWorldCoords.length=a,this.positionsRenderCoords.length=a,this.positionsProjectedWorldCoords.length=a,this.positionsFittedRenderCoords.length=a,this.positionsGeographic.length=a,this.positionsSpherical.length=a,this.positionsStereographic.length=a,this.pathSegmentLengths.length=a,this.geodesicPathSegmentLengths.length=a,this._length=this.perimeterSegmentLengths.length=a);for(;this._length<a;)this.positionsWorldCoords.push(l.vec3f64.create()),
this.positionsRenderCoords.push(l.vec3f64.create()),this.positionsProjectedWorldCoords.push(g.vec2f64.create()),this.positionsFittedRenderCoords.push(l.vec3f64.create()),this.positionsGeographic.push(l.vec3f64.create()),this.positionsSpherical.push(l.vec3f64.create()),this.positionsStereographic.push(g.vec2f64.create()),this.pathSegmentLengths.push(0),this.geodesicPathSegmentLengths.push(0),this.perimeterSegmentLengths.push(0),++this._length};x.prototype._updatePathLengths=function(a){for(var b=this.positionsWorldCoords,
c=this.pathSegmentLengths,d=0,e=0;e<this._length;++e){var f=c[e]=q.vec3.distance(b[e],b[(e+1)%this._length]);if(e<this._length-1||a)d+=f}return d};x.prototype._updateGeodesicPathLengths=function(a){for(var b=this.positionsGeographic,c=this.geodesicPathSegmentLengths,d=0,e=0;e<this._length;++e){var f=c[e]=y.segmentLengthGeodesicVector(b[e],b[(e+1)%this._length]);if(e<this._length-1||a)d+=f}return d};x.prototype._updateArea=function(a,b,c,d,e){var g=a.renderCoordsHelper;a=this.positionsWorldCoords;
var h=this.positionsRenderCoords,p=this.positionsProjectedWorldCoords,l=this.positionsFittedRenderCoords,u=this._planeWorldCoords,r=this._centroidRenderCoords;n.midpoint(h,r);g.worldUpAtPosition(r,this._worldUp);g.worldBasisAtPosition(r,0,this._worldTangent);A.transformDirection(r,this._worldUp,c,this._worldUp,d);A.transformDirection(r,this._worldTangent,c,this._worldTangent,d);y.bestFitPlane(a,u);this.fittingMode=this._selectFittingMode(u,a,this._worldUp,e);var x=0;if("horizontal"===this.fittingMode){var t=
-Infinity;h.forEach(function(a,b){a=g.getAltitude(h[b]);a>t&&(t=a,x=b)})}e=a[x];var r=u,w=this._worldTangent;"horizontal"===this.fittingMode?r=this._worldUp:"vertical"===this.fittingMode&&(r=this._tempVec3,w=this._worldUp,B.makeOrthonormal(u,this._worldUp,r));q.vec3.copy(this._frame[2],r);B.makeOrthonormal(w,r,this._frame[0]);q.vec3.cross(this._frame[1],this._frame[0],this._frame[2]);q.vec3.negate(this._frame[1],this._frame[1]);for(var u=this._tempVec3,r=this._tempU,w=this._tempV,z=0;z<this._length;++z){var E=
p[z],C=l[z];q.vec3.subtract(u,a[z],e);f.vec2.set(E,q.vec3.dot(this._frame[0],u),q.vec3.dot(this._frame[1],u));q.vec3.scale(r,this._frame[0],E[0]);q.vec3.scale(w,this._frame[1],E[1]);q.vec3.add(u,r,w);q.vec3.add(u,u,e);A.vectorToVector(u,d,C,c)}this.perimeterLength=0<this._length?new k(b.normalizeDistance(this._updatePerimeterLengths()),"meters"):null;n.midpoint(l,this.areaCentroidRenderCoords);A.vectorToVector(this.areaCentroidRenderCoords,c,this.areaCentroidWorldCoords,d);this._updateIntersectingSegments();
this.area=0===this.intersectingSegments.size?new k(b.normalizeArea(this._computeArea()),"square-meters"):null};x.prototype._updateGeodesicArea=function(a,b){a=a.renderCoordsHelper;b=this.positionsSpherical;var c=this.positionsStereographic,d=this._tempVec3,e=y.fitHemisphere(b,d);if(e){var g=this._tempU,p=this._tempV;B.tangentFrame(d,g,p);for(var l=0;l<this._length;++l){var u=q.vec3.dot(b[l],g),n=q.vec3.dot(b[l],p),x=q.vec3.dot(b[l],d);f.vec2.set(c[l],u/x,n/x)}q.vec3.scale(d,d,w.earthRadius);a.toRenderCoords(d,
A.SphericalECEFSpatialReference,this.geodesicAreaCentroidRenderCoords);this._updateGeodesicIntersectingSegments();this.geodesicArea=e&&0===this.geodesicIntersectingSegments.size?new k(this._computeGeodesicArea(),"square-meters"):null}else this.geodesicArea=null};x.prototype._updatePerimeterLengths=function(){for(var a=this.positionsProjectedWorldCoords,b=this.perimeterSegmentLengths,c=0,d=0;d<this._length;++d)var e=b[d]=f.vec2.distance(a[d],a[(d+1)%this._length]),c=c+e;return c};x.prototype._updateIntersectingSegments=
function(){var a=this.positionsProjectedWorldCoords,b=this.intersectingSegments;b.clear();for(var d=0;d<this._length;++d)for(var e=d+2;e<this._length;++e)(e+1)%this._length!==d&&c.segmentIntersects(a[d],a[(d+1)%this._length],a[e],a[(e+1)%this._length])&&(b.add(d),b.add(e))};x.prototype._computeArea=function(){for(var b=this.positionsProjectedWorldCoords,c=C(b,2,2),c=this.triangleIndices=new Uint32Array(a(c,[],2)),d=0,e=0;e<c.length;e+=3)d+=y.triangleAreaEuclidean(b[c[e]],b[c[e+1]],b[c[e+2]]);return d};
x.prototype._updateGeodesicIntersectingSegments=function(){var a=this.positionsStereographic,b=this.geodesicIntersectingSegments;b.clear();for(var d=0;d<this._length;++d)for(var e=d+2;e<this._length;++e)(e+1)%this._length!==d&&c.segmentIntersects(a[d],a[(d+1)%this._length],a[e],a[(e+1)%this._length])&&(b.add(d),b.add(e))};x.prototype._computeGeodesicArea=function(){for(var c=this.positionsGeographic,d=C(this.positionsStereographic,2,2),d=this.geodesicTriangleIndices=new Uint32Array(a(d,[],2)),e=0,
f=0;f<d.length;f+=3)e+=y.triangleAreaGeodesic(c[d[f]],c[d[f+1]],c[d[f+2]],b.WGS84);return e};x.prototype._selectFittingMode=function(a,b,c,d){var f=b.map(function(b){return Math.abs(y.planePointDistance(a,b))}).reduce(function(a,b){return Math.max(a,b)},0);y.boundingSphere(b,this._tempSphere);b=f/(2*this._tempSphere.radius);var f=b<d.maxRelativeErrorAlmostCoplanar,g="horizontal";b<d.maxRelativeErrorCoplanar?g="oblique":f&&(g=Math.abs(q.vec3.dot(c,a))>Math.cos(e.deg2rad(d.verticalAngleThreshold))?
"horizontal":"vertical");return g};return x}()})},"esri/views/3d/interactive/measurementTools/support/measurementUtils":function(){define("require exports ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../geometry/geometryEngine ../../../../../geometry/Polygon ../../../../../geometry/SpatialReference ../../../../../geometry/support/geodesicUtils ../../../support/mathUtils ../../../support/mathUtils ../../../support/projectionUtils".split(" "),function(z,
t,k,a,f,g,q,l,d,b,c){var y;(function(a){a.boundingSphere=function(a,b){var c=b.center;k.vec3.set(c,0,0,0);for(var d=0;d<a.length;++d)k.vec3.add(c,c,a[d]);k.vec3.scale(c,c,1/a.length);for(var e=0,d=0;d<a.length;++d)e=Math.max(e,k.vec3.squaredDistance(c,a[d]));b.radius=Math.sqrt(e)};a.bestFitPlane=function(a,c){if(3>a.length)throw Error("need at least 3 points to fit a plane");b.planeFromPoints(a[0],a[1],a[2],c)};a.planePointDistance=function(a,b){return k.vec3.dot(a,b)+a[3]};a.segmentLengthEuclidean=
function(a,b,d){c.pointToVector(a,n,d);c.pointToVector(b,w,d);return k.vec3.distance(n,w)};a.segmentLengthGeodesic=function(a,b){var e=q.WGS84;c.pointToVector(a,n,e);c.pointToVector(b,w,e);return l.inverseGeodeticSolver(d.deg2rad(n[1]),d.deg2rad(n[0]),d.deg2rad(w[1]),d.deg2rad(w[0])).geodesicDistance};a.segmentLengthGeodesicVector=function(a,b){return l.inverseGeodeticSolver(d.deg2rad(a[1]),d.deg2rad(a[0]),d.deg2rad(b[1]),d.deg2rad(b[0])).geodesicDistance};a.triangleAreaEuclidean=function(a,b,c){return.5*
Math.abs((b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0]))};a.triangleAreaGeodesic=function(a,b,d,g){var k=B;c.vectorToVector(a,g,n,q.WGS84);c.vectorToVector(b,g,w,q.WGS84);c.vectorToVector(d,g,e,q.WGS84);k.setPoint(0,0,n);k.setPoint(0,1,w);k.setPoint(0,2,e);return Math.abs(f.geodesicArea(k,"square-meters"))};a.tangentFrame=function(a,b,c){Math.abs(a[0])>Math.abs(a[1])?k.vec3.set(b,0,1,0):k.vec3.set(b,1,0,0);k.vec3.cross(c,a,b);k.vec3.normalize(b,b);k.vec3.cross(b,c,a);k.vec3.normalize(c,c)};a.fitHemisphere=
function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=!0);var d=function(a,b){if(0===b[0]&&0===b[1]&&0===b[2])return!1;for(var c=0;c<a.length;++c)if(-1E-6>k.vec3.dot(b,a[c]))return!1;return!0};if(0===a.length)return!1;if(1===a.length)return b&&k.vec3.copy(b,a[0]),!0;k.vec3.set(A,0,0,0);for(var e=0;e<a.length;++e)k.vec3.add(A,A,a[e]);k.vec3.normalize(A,A);if(d(a,A))return b&&k.vec3.copy(b,A),!0;if(!c)return!1;for(e=0;e<a.length;++e)for(c=0;c<a.length;++c)if(e!==c&&(k.vec3.cross(A,a[e],a[c]),k.vec3.normalize(A,
A),d(a,A)))return b&&k.vec3.copy(b,A),!0;return!1};a.compareSets=function(a,b){if(a===b)return!0;if(a.size!==b.size)return!1;for(var c=0;c<a.size;++c)if(!b.has(a[c]))return!1;return!0}})(y||(y={}));var n=a.vec3f64.create(),w=a.vec3f64.create(),e=a.vec3f64.create(),B=new g({rings:[[n,w,e]],spatialReference:q.WGS84}),A=a.vec3f64.create();return y})},"esri/views/3d/interactive/measurementTools/areaMeasurement3D/PathChanges":function(){define(["require","exports","../support/setUtils"],function(z,t,k){return function(){function a(){this.change=
"none";this.updatedVertices=new Set}a.prototype.fullChange=function(){this.change="full"};a.prototype.incrementalChange=function(a){"none"===this.change&&(this.change="incremental");this.updatedVertices.add(a)};a.prototype.clear=function(){this.change="none";this.updatedVertices.clear()};a.prototype.assign=function(a){this.change=a.change;this.updatedVertices=k.clone(a.updatedVertices)};a.prototype.merge=function(a){var f=this;switch(this.change){case "none":this.assign(a);break;case "incremental":"incremental"===
a.change?a.updatedVertices.forEach(function(a){f.updatedVertices.add(a)}):"full"===a.change&&(this.change="full")}};return a}()})},"esri/views/3d/interactive/measurementTools/support/setUtils":function(){define(["require","exports"],function(z,t){Object.defineProperty(t,"__esModule",{value:!0});t.clone=function(k){var a=new Set;k.forEach(function(f){a.add(f)});return a}})},"esri/views/3d/interactive/measurementTools/support/Path":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/Collection ../../../../../core/accessorSupport/decorators ../../../support/Evented".split(" "),
function(z,t,k,a,f,g,q,l){return function(d){function b(){var a=null!==d&&d.apply(this,arguments)||this;a.vertices=new g;return a}k(b,d);Object.defineProperty(b.prototype,"front",{get:function(){return this.vertices.items[0]||null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"back",{get:function(){return this.vertices.items[this.vertices.length-1]||null},enumerable:!0,configurable:!0});b.prototype.clear=function(){this.vertices.removeAll();this.emit("cleared",{});this._notifyFrontBack()};
b.prototype.vertex=function(a){return this.vertices.items[a]};b.prototype.add=function(a){this.vertices.add(a);a=this.vertices.length-1;this._notifyFrontBack();this.emit("vertex-added",{index:a});return a};b.prototype.insert=function(a,b){this.vertices.splice(a,0,b);this._notifyFrontBack();this.emit("vertex-inserted",{index:a});return a};b.prototype.remove=function(a){this.vertices.removeAt(a);this._notifyFrontBack();this.emit("vertex-removed",{index:a})};b.prototype.update=function(a,b){null!=b&&
(this.vertices.splice(a,1,b),this._notifyFrontBack());this.emit("vertex-updated",{index:a})};b.prototype._notifyFrontBack=function(){this.notifyChange("front");this.notifyChange("back")};a([q.property({readOnly:!0})],b.prototype,"vertices",void 0);a([q.property({aliasOf:"vertices.length"})],b.prototype,"length",void 0);a([q.property({readOnly:!0})],b.prototype,"front",null);a([q.property({readOnly:!0})],b.prototype,"back",null);return b=a([q.subclass("esri.views.3d.interactive.measurementTools.support.Path")],
b)}(q.declared(f,l.Evented))})},"widgets/Measurement3D/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Measurement3D/Widget.html":'\x3cdiv\x3e\r\n\t\x3cheader class\x3d"${baseClass}__header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/header\x3e\r\n\t\x3cdiv class\x3d"hidden" data-dojo-attach-point\x3d"measurementNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"${baseClass}__hint" data-dojo-attach-point\x3d"hintNode"\x3e${nls.hint}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Measurement3D/css/style.css":".esri-area-measurement-3d__container,.esri-direct-line-measurement-3d__container {padding: 0;}.esri-direct-line-measurement-3d {pointer-events: auto;}.jimu-widget-measurement .hidden {display: none !important;}.jimu-widget-measurement .esri-button {height: 32px; cursor: pointer; font-family: inherit; font-size: 14px;}.jimu-widget-measurement .measurement-button-wrapper {padding: 12px 15px;}.jimu-button-group {display: flex; flex-direction: row;}.jimu-button-group \x3e button {font-family: inherit; background: #fff; border: 1px solid #ccc; padding: 5px 10px; line-height: 20px; font-size: 1em; flex-basis: 0; flex-grow: 1; transition: background-color 125ms ease-in-out; position: relative; z-index: 1;}.jimu-button-group \x3e button:hover {background: #f0f0f0;}.jimu-button-group \x3e button.jimu-state-active {background: #24b5cc; border-color: #24b5cc; color: #fff; z-index: 2;}.jimu-button-group \x3e button.jimu-state-active:before {content: none;}.jimu-button-group \x3e button:not(:disabled) {cursor: pointer;}.jimu-button-group \x3e button + button {margin-left: -1px; border-left-width: 0;}.jimu-button-group \x3e button + button::before {content: ''; display: block; position: absolute; left: -1px; top: 4px; bottom: 4px; border-left: 1px solid #ccc;}.jimu-rtl .jimu-button-group \x3e button + button {margin-left: auto; margin-right: -1px; border-left-width: 1px; border-right-width: 0;}.jimu-rtl .jimu-button-group \x3e button + button::before {right: -1px; left: auto;}.jimu-button-group \x3e button img {vertical-align: middle; margin-right: 8px; pointer-events: none;}.jimu-rtl .jimu-button-group \x3e button img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__header {font-size: 14px; text-align: center; border-bottom: 1px solid #e7e7e7; margin-bottom: 12px;}.jimu-widget-measurement__header img {vertical-align: middle; margin-right: 8px;}.jimu-rtl .jimu-widget-measurement__header img {margin-left: 8px; margin-right: auto;}.jimu-widget-measurement__hint {color: #323232; font-size: 14px;}.jimu-widget-frame.jimu-container .jimu-widget-measurement__header {margin: -14px -14px 14px; padding: 14px 14px 14px;}",
"*now":function(z){z(['dojo/i18n!*preload*widgets/Measurement3D/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/on jimu/BaseWidget ./ButtonGroup jimu/dijit/ViewStack esri/widgets/DirectLineMeasurement3D esri/widgets/AreaMeasurement3D esri/core/watchUtils".split(" "),function(z,t,k,a,f,g,q,l,d){return z([a],{baseClass:"jimu-widget-measurement",name:"Measurement",MEASURE_TYPES:{DISTANCE:"distance",AREA:"area",LOCATION:"location"},measureWidgets:{},selectedMeasureType:null,buttonGroup:null,CSS:{clearButton:"esri-direct-line-measurement-3d__clear-button"},postCreate:function(){this.inherited(arguments);
this.measureWidgets={};this.selectedMeasureType=null},startup:function(){this.inherited(arguments);this.initUI()},destroy:function(){if(this.measureWidgets)for(var a in this.measureWidgets)if(this.measureWidgets.hasOwnProperty(a)){var c=this.measureWidgets[a];c.destroy&&c.destroy()}this.buttonGroup&&this.buttonGroup.destroy&&(this.buttonGroup.destroy(),this.buttonGroup=null);this.selectedMeasureType=null;this.inherited(arguments)},onOpen:function(){this.activateWidget(this.selectedMeasureType)},onClose:function(){this.deactivateWidget(this.selectedMeasureType)},
onActive:function(){this.onOpen()},onDeActive:function(){this.onClose()},_applyConfig:function(a){if(this.config&&a){var b=this.config,d,f;switch(a.measureType){case this.MEASURE_TYPES.DISTANCE:d="lengthUnit";f="defaultLengthUnit";break;case this.MEASURE_TYPES.AREA:d="areaUnit",f="defaultAreaUnit"}b.measurement&&b.measurement[d]?a.unit=b.measurement[d]:b[f]&&(a.unit=b[f])}},_createWidget:function(a){a=this._ensureWidget(a);this._applyConfig(a);return a},_ensureWidget:function(a){var b=this.getWidget(a);
b||(b=document.createElement("div"),a===this.MEASURE_TYPES.DISTANCE?this.measureWidgets[a]=new q({container:b,view:this.sceneView,measureType:a,visible:!1}):a===this.MEASURE_TYPES.AREA&&(this.measureWidgets[a]=new l({container:b,view:this.sceneView,measureType:a})),b=this.measureWidgets[a]);return b},_initWidget:function(a){var b=this.getWidget(a);b||(b=this._createWidget(a),this._addtoViewStack(b));b.visible=!0;this.viewStack.switchView(a)},_addtoViewStack:function(a){if(a){var b=document.createElement("div");
b.label=a.measureType;b.appendChild(a.domNode);this.viewStack.addView(b)}},_initMeasurements:function(a){if(a){var b=[];a instanceof Array&&a.forEach(t.hitch(this,function(a){var c=document.createElement("img");c.title=a.value;c.src=this._getMeasurementIconSource(a.value);b.push({value:a.value,label:a.label,icon:c,content:a.label})}));a=this.buttonGroup=new f({buttons:b,selected:null});a.placeAt(this.headerNode);this.own(k(a,"Change",t.hitch(this,function(a){this._toggleWidgetSection(!!a);this._handleMeasureChanged()})))}},
_handleMeasureChanged:function(){var a=this.buttonGroup.getActiveButtonValue(),c=this.getWidget(this.selectedMeasureType);c&&(c.visible=!1);null!==a&&this._initWidget(a);this.selectedMeasureType=a},_toggleWidgetSection:function(a){a?(this.measurementNode.classList.remove("hidden"),this.hintNode.classList.add("hidden")):(this.measurementNode.classList.add("hidden"),this.hintNode.classList.remove("hidden"))},_getMeasurementIconSource:function(a){var b;switch(a){case this.MEASURE_TYPES.DISTANCE:b=this.folderUrl+
"images/Measure_Distance16.png";break;case this.MEASURE_TYPES.AREA:b=this.folderUrl+"images/Measure_Area16.png"}return b},initUI:function(){var a=this.config,c=[];this.viewStack=new g(null,this.measurementNode);a&&(a.showArea&&c.push({label:this.nls.area,value:this.MEASURE_TYPES.AREA}),a.showDistance&&c.push({label:this.nls.distance,value:this.MEASURE_TYPES.DISTANCE}));0!==c.length&&this._initMeasurements(c)},activateWidget:function(a){},deactivateWidget:function(a){var b=this.getWidget(a);a=this.buttonGroup&&
this.buttonGroup.getActiveButton();b&&("measured"!==b.viewModel.tool.model.state?a&&a.click():(b.viewModel.tool._controller.deactivate(),b.viewModel.tool._view._sceneView.cursor=null,d.once(b.viewModel.tool.model,"state",function(a){"initial"===a&&b.viewModel.tool.activate()})))},getWidget:function(a){return a&&this.measureWidgets[a]}})});