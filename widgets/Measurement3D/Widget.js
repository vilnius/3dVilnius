// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/DirectLineMeasurement3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./DirectLineMeasurement3D/nls/DirectLineMeasurement3D ../core/accessorSupport/decorators ./Widget ./DirectLineMeasurement3D/DirectLineMeasurement3DViewModel ./support/widget".split(" "),function(w,t,p,a,b,e,u,h,c){return function(r){function d(c){c=r.call(this)||this;c.view=null;c.visible=null;c.viewModel=new h;c.unitOptions=null;
return c}p(d,r);d.prototype.clearMeasurement=function(){};d.prototype.render=function(){var d=this,a=!this.viewModel.isSupported,r="measuring"===this.viewModel.state,e=this.viewModel.measurement,y="ready"===this.viewModel.state?c.tsx("section",{key:"esri-direct-line-measurement-3d__hint",class:"esri-direct-line-measurement-3d__hint"},c.tsx("p",null,b.hint)):null,a=a?c.tsx("section",{key:"esri-direct-line-measurement-3d__unsupported",class:"esri-direct-line-measurement-3d__panel--error"},c.tsx("p",
null,b.unsupported)):null,z=function(d,a,b){switch(a.state){case "available":return c.tsx("div",{key:b+"-enabled",class:"esri-direct-line-measurement-3d__measurement-item"},c.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},d),c.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-value"},a.text));case "unavailable":return c.tsx("div",{key:b+"-disabled",class:c.join("esri-direct-line-measurement-3d__measurement-item","esri-direct-line-measurement-3d__measurement-item--disabled")},
c.tsx("span",{class:"esri-direct-line-measurement-3d__measurement-item-title"},d))}},e=r?c.tsx("section",{key:"esri-direct-line-measurement-3d__measurement",class:"esri-direct-line-measurement-3d__measurement"},z(b.direct,e.directDistance,"direct"),z(b.horizontal,e.horizontalDistance,"horizontal"),z(b.vertical,e.verticalDistance,"vertical")):null,C=this.id+"__units",z=c.tsx("label",{class:"esri-direct-line-measurement-3d__units-label",for:C},b.unit),C=c.tsx("div",{class:"esri-direct-line-measurement-3d__units-select-wrapper"},
c.tsx("select",{class:"esri-direct-line-measurement-3d__units-select esri-select",id:C,onchange:this._changeUnit,bind:this},this.viewModel.unitOptions.map(function(a){return a===d.viewModel.unit?c.tsx("option",{key:a,value:a,selected:!0},b.units[a]):c.tsx("option",{key:a,value:a},b.units[a])}))),z=r?c.tsx("section",{key:"esri-direct-line-measurement-3d__units",class:"esri-direct-line-measurement-3d__units"},z,C):null,r=r?c.tsx("button",{class:c.join("esri-button","esri-direct-line-measurement-3d__clear-button"),
bind:this,onclick:this._newMeasurement},b.newMeasurement):null,y=this.visible?c.tsx("div",{class:"esri-direct-line-measurement-3d__container"},a,y,e,z,r):null;return c.tsx("div",{key:"",class:"esri-direct-line-measurement-3d esri-widget esri-widget--panel",role:"presentation"},y)};d.prototype._newMeasurement=function(){this.clearMeasurement()};d.prototype._changeUnit=function(a){a=a.target;if(a=a.options[a.selectedIndex])this.unit=a.value};a([e.aliasOf("viewModel.view")],d.prototype,"view",void 0);
a([e.aliasOf("viewModel.visible"),c.renderable()],d.prototype,"visible",void 0);a([e.property({type:h}),c.renderable(["viewModel.state","viewModel.unitOptions","viewModel.unit","viewModel.measurement"])],d.prototype,"viewModel",void 0);a([e.aliasOf("viewModel.unitOptions")],d.prototype,"unitOptions",void 0);a([e.aliasOf("viewModel.unit")],d.prototype,"unit",void 0);a([e.aliasOf("viewModel.clearMeasurement")],d.prototype,"clearMeasurement",null);a([c.accessibleHandler()],d.prototype,"_newMeasurement",
null);a([c.accessibleHandler()],d.prototype,"_changeUnit",null);return d=a([e.subclass("esri.widgets.DirectLineMeasurement3D")],d)}(e.declared(u))})},"esri/widgets/DirectLineMeasurement3D/DirectLineMeasurement3DViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/Logger ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool ../../views/3d/interactive/measurementTools/support/unitUtils".split(" "),
function(w,t,p,a,b,e,u,h,c,r,d){var n="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" "),g=u.getLogger("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel");return function(b){function k(a){a=b.call(this,a)||this;a._handles=new e;a._userUnitOptions=null;a._userUnit=null;a.view=null;a.visible=!0;a.tool=null;return a}p(k,b);k.prototype.initialize=function(){var a=this;this._handles.add([h.init(this,["view.ready","visible"],function(){a._toggleTool()}),
h.init(this,"unit",function(c){a.tool&&(a.tool.unit=c)})])};k.prototype.destroy=function(){this.view=null;this._toggleTool();this._handles.destroy();this._handles=null};Object.defineProperty(k.prototype,"state",{get:function(){var a=!!this.get("view.ready"),c=this.get("view.type");if(a&&"3d"===c)return this.get("tool.isMeasuring")?"measuring":"ready";a&&"3d"!==c&&g.error("DirectLineMeasurement3D widget is not implemented for MapView");return"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"isSupported",{get:function(){return"3d"===this.get("view.type")},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"measurement",{get:function(){if(!this.tool)return null;var a=this.tool.model,c=a.measurementMode,d="geodesic"===c,a=a.validMeasurement;return{mode:c,directDistance:{text:d?null:this.tool.triangleView.directLabel,state:a&&!d?"available":"unavailable"},horizontalDistance:{text:this.tool.triangleView.horizontalLabel,state:a?"available":"unavailable"},verticalDistance:{text:this.tool.triangleView.verticalLabel,
state:a?"available":"unavailable"}}},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"defaultUnit",{get:function(){return this.defaultUnitFromPortal||this.defaultUnitFromSpatialReference||"metric"},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"defaultUnitFromSpatialReference",{get:function(){return d.defaultUnitForSpatialReference(this.view&&this.view.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"defaultUnitFromPortal",
{get:function(){var a=this.get("view.map.portalItem.portal");if(!a)return null;switch(a.user&&a.user.units||a.units){case "metric":return"metric";case "english":return"imperial";default:return null}},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"unitOptions",{get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(a){this._userUnitOptions=a;this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"unit",{get:function(){return this._userUnit?this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit):this._findSelectableUnit(this.defaultUnit)},set:function(a){this._userUnit=this._findSelectableUnit(a,this._userUnit);this.notifyChange("unit")},enumerable:!0,configurable:!0});k.prototype.clearMeasurement=function(){this.tool&&this.tool.clearMeasurement()};k.prototype._toggleTool=function(){this.view&&this.view.ready&&!this.tool&&(this._set("tool",new r({view:this.view,unit:this.unit})),
this.visible&&this.tool.start());!this.tool||this.view&&this.view.ready||(this.tool.destroy(),this._set("tool",null));this.tool&&(this.visible?this.tool.start():(this.tool.stop(),"measured"!==this.tool.model.state&&this.clearMeasurement()))};k.prototype._findSelectableUnit=function(a,c){var d=this.unitOptions;return-1!==d.indexOf(a)?a:c?this._findSelectableUnit(c):d[0]};k.prototype._filteredOrAllUnits=function(a){if(!a)return n.slice();a=a.filter(function(a){return-1!==n.indexOf(a)});return 0===a.length?
n.slice():a};a([c.property({dependsOn:["view.ready","tool.isMeasuring"],readOnly:!0})],k.prototype,"state",null);a([c.property({dependsOn:["view.type"],readOnly:!0})],k.prototype,"isSupported",null);a([c.property()],k.prototype,"view",void 0);a([c.property({dependsOn:"view.ready tool.triangleView tool.model.directDistance tool.model.horizontalDistance tool.model.verticalDistance tool.model.geodesicDistance tool.model.measurementMode".split(" "),readOnly:!0})],k.prototype,"measurement",null);a([c.property()],
k.prototype,"visible",void 0);a([c.property({readOnly:!0})],k.prototype,"tool",void 0);a([c.property({readOnly:!0,dependsOn:["defaultUnitFromPortal","defaultUnitFromSpatialReference"]})],k.prototype,"defaultUnit",null);a([c.property({readOnly:!0,dependsOn:["view.spatialReference"]})],k.prototype,"defaultUnitFromSpatialReference",null);a([c.property({readOnly:!0,dependsOn:["view.map.portalItem.portal.units","view.map.portalItem.portal.user.units"]})],k.prototype,"defaultUnitFromPortal",null);a([c.property({dependsOn:["view.spatialReference"]})],
k.prototype,"unitOptions",null);a([c.property({dependsOn:["unitOptions","defaultUnit"]})],k.prototype,"unit",null);a([c.property()],k.prototype,"clearMeasurement",null);return k=a([c.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],k)}(c.declared(b))})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/accessorSupport/decorators ../../InteractiveTool ./DirectLineMeasurement3DController ./DirectLineMeasurement3DModel ./DirectLineMeasurement3DView".split(" "),
function(w,t,p,a,b,e,u,h,c){return function(r){function d(a){var c=r.call(this,a)||this;a=new h({sceneView:a.view});c._set("model",a);return c}p(d,r);d.prototype.initialize=function(){this._view=new c(this.model,this.view);this._controller=new u(this.model,this._view)};d.prototype.destroy=function(){this.stop()};d.prototype.activate=function(){this._controller.activate(this.view);this._view.show()};d.prototype.deactivate=function(){this._controller.deactivate();this._view.hide()};d.prototype.reset=
function(){this.model.reset()};d.prototype.clearMeasurement=function(){this.model.clearMeasurement()};a([b.property({readOnly:!0})],d.prototype,"model",void 0);a([b.aliasOf("model.mode")],d.prototype,"mode",void 0);a([b.aliasOf("model.unit")],d.prototype,"unit",void 0);a([b.aliasOf("model.directDistance")],d.prototype,"directDistance",void 0);a([b.aliasOf("model.isMeasuring")],d.prototype,"isMeasuring",void 0);a([b.aliasOf("model.validMeasurement")],d.prototype,"validMeasurement",void 0);a([b.aliasOf("model.horizontalDistance")],
d.prototype,"horizontalDistance",void 0);a([b.aliasOf("model.verticalDistance")],d.prototype,"verticalDistance",void 0);a([b.aliasOf("model.geodesicDistance")],d.prototype,"geodesicDistance",void 0);a([b.aliasOf("model.geodesicAngle")],d.prototype,"geodesicAngle",void 0);a([b.aliasOf("model.triangleView")],d.prototype,"triangleView",void 0);return d=a([b.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],d)}(b.declared(e))})},"esri/views/3d/interactive/InteractiveTool":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),
function(w,t,p,a,b,e){return function(b){function h(){return null!==b&&b.apply(this,arguments)||this}p(h,b);h.prototype.start=function(){this.view.activeTool=this};h.prototype.stop=function(){this.view.ready&&this.view.activeTool===this&&(this.view.activeTool=null)};h.prototype.activate=function(){};h.prototype.deactivate=function(){};a([e.property({constructOnly:!0})],h.prototype,"view",void 0);return h=a([e.subclass("esri.views.3d.interactive.InteractiveTool")],h)}(e.declared(b))})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../.././../../geometry ../../../../../core/Handles ./DirectLineMeasurement3DView".split(" "),
function(w,t,p,a,b,e,u){function h(a){return"mouse"!==a.pointerType||0===a.button}return function(){function a(a,d){this._dragHandles={};this._viewEventHandles=new e;this._cachedPickRequest=new u.PickRequest;this._cachedPickResult=new u.PickResult;this._isAnyPointerDown=!1;this.model=a;this.view=d;this.model.reset()}a.prototype.activate=function(a){var d=this,b=this._viewEventHandles;b.add(a.on("immediate-click",function(a){return d._handleImmediateClick(a)}));b.add(a.on("click",function(a){return d._handleClick(a)}));
b.add(a.on("double-click",function(a){return d._handleDoubleClick(a)}));b.add(a.on("drag",function(a){return d._handleDrag(a)}));b.add(a.on("pointer-move",function(a){return d._handlePointerMove(a)}));b.add(a.on("pointer-down",function(a){return d._handlePointerDown(a)}));b.add(a.on("pointer-up",function(a){return d._handlePointerUp(a)}));b.add(a.on("pointer-drag",function(a){return d._handlePointerDrag(a)}));b.add(a.on("key-down",function(a){return d._handleKeyDown(a)}))};a.prototype.deactivate=
function(){this._viewEventHandles.removeAll()};a.prototype._handleDrag=function(a){0!==this.model.draggedHandles.length&&a.stopPropagation()};a.prototype._handlePointerMove=function(a){this._clearCachedPickRequest();var d=new b.ScreenPoint({x:a.x,y:a.y});"mouse"===a.pointerType&&(this._hoverAt(d),"drawing"===this.model.state&&(this._endAt(d,a.pointerType),a.stopPropagation()))};a.prototype._handlePointerDown=function(a){this._clearCachedPickRequest();this._isAnyPointerDown=!0;if(h(a)){var d=new b.ScreenPoint({x:a.x,
y:a.y}),d=this.view.handleAt(d,a.pointerType);"drawing"===this.model.state||!d||d in this._dragHandles||(this._dragHandles[a.pointerId]=d,this.model.draggedHandles.push(d));0<this.model.draggedHandles.length&&"measured"===this.model.state&&(this.model.state="editing")}};a.prototype._handlePointerUp=function(a){this._clearCachedPickRequest();this._isAnyPointerDown=!1;if(h(a)){var d=new b.ScreenPoint({x:a.x,y:a.y}),c=this._dragHandles[a.pointerId];c&&(delete this._dragHandles[a.pointerId],this.model.draggedHandles.remove(c),
0===this.model.draggedHandles.length&&this.model.finishedMeasurement({cameraAboveGround:this.view.cameraAboveGround}),this._updateHoveredHandle(d,a.pointerType));0===this.model.draggedHandles.length&&"editing"===this.model.state&&(this.model.state="measured")}};a.prototype._handlePointerDrag=function(a){this._clearCachedPickRequest();if(h(a)){var d=new b.ScreenPoint({x:a.x,y:a.y}),c=this._dragHandles[a.pointerId];null!=c&&("update"===a.action&&this._moveHandleTo(c,d,a.pointerType),a.stopPropagation())}};
a.prototype._handleImmediateClick=function(a){this._clearCachedPickRequest();if(h(a)){var d=new b.ScreenPoint({x:a.x,y:a.y});switch(this.model.state){case "initial":if(this._startAt(d,a.pointerType)){this.model.state="drawing";a.stopPropagation();return}break;case "drawing":if(this._endAt(d,a.pointerType)){this.model.finishedMeasurement({cameraAboveGround:this.view.cameraAboveGround});a.stopPropagation();return}break;case "measured":if(null===this.view.handleAt(d,a.pointerType)&&(this.model.clearMeasurement(),
this._startAt(d,a.pointerType))){this.model.state="drawing";a.stopPropagation();return}}"mouse"===a.pointerType&&this._hoverAt(d)}};a.prototype._handleClick=function(a){h(a)&&a.stopPropagation()};a.prototype._handleDoubleClick=function(a){h(a)&&a.stopPropagation()};a.prototype._handleKeyDown=function(a){"Escape"===a.key&&"drawing"===this.model.state&&(this.model.clearMeasurement(),a.stopPropagation())};a.prototype._hoverAt=function(a){this._updateHoveredHandle(a,"mouse");var b=this._isAnyPointerDown&&
"drawing"!==this.model.state&&"editing"!==this.model.state;this.view.requiresCursorPoint&&!b?(a=this._pick(a),a.mapPoint&&(this.model.cursorPoint=a.mapPoint)):this.model.cursorPoint=null};a.prototype._startAt=function(a,b){var c=this._pick(a);if(c.mapPoint)return this.model.startPoint=c.mapPoint,this.model.startPointSurfaceLocation=this._surfaceLocation(c.mapPoint,c.type),this.model.hoveredHandle="touch"!==b?"start":null,!0;this._updateHoveredHandle(a,b);return!1};a.prototype._endAt=function(a,b){var c=
this._pick(a);if(c.mapPoint&&!this.view.overlappingHandles(c.mapPoint,this.model.startPoint))return this.model.endPoint=c.mapPoint,this.model.endPointSurfaceLocation=this._surfaceLocation(c.mapPoint,c.type),this.model.hoveredHandle="touch"!==b?"end":null,!0;this._updateHoveredHandle(a,b);return!1};a.prototype._moveHandleTo=function(a,b,c){b=this._clipToScreen(b);var d=this._pick(b);if(d.mapPoint)if("start"===a){if(!this.view.overlappingHandles(d.mapPoint,this.model.endPoint))return this.model.startPoint=
d.mapPoint,this.model.startPointSurfaceLocation=this._surfaceLocation(d.mapPoint,d.type),this.model.hoveredHandle="touch"!==c?"start":null,!0}else if("end"===a&&!this.view.overlappingHandles(d.mapPoint,this.model.startPoint))return this.model.endPoint=d.mapPoint,this.model.endPointSurfaceLocation=this._surfaceLocation(d.mapPoint,d.type),this.model.hoveredHandle="touch"!==c?"end":null,!0;this._updateHoveredHandle(b,c);return!1};a.prototype._pick=function(a){var b=this._cachedPickRequest.screenPoint;
if(b&&b.x===a.x&&b.y===a.y)return this._cachedPickResult;this._cachedPickRequest.screenPoint=a;return this._cachedPickResult=this.view.pick(this._cachedPickRequest)};a.prototype._clearCachedPickRequest=function(){this._cachedPickRequest.screenPoint=null};a.prototype._clipToScreen=function(a){return new b.ScreenPoint({x:Math.max(0,Math.min(this.model.sceneView.width,a.x)),y:Math.max(0,Math.min(this.model.sceneView.height,a.y))})};a.prototype._updateHoveredHandle=function(a,b){this.model.hoveredHandle=
"touch"!==b?this.view.handleAt(a,b):null};a.prototype._surfaceLocation=function(a,b){return"surface"===b?"on-the-surface":a.z>=this.view.getElevation(a)?"above-the-surface":"below-the-surface"};return a}()})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DView":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Handles ../../../../../core/StackedObjectPool ./LaserLineRenderer ../support/Label ../support/LabelSegment ../support/labelUtils ../support/PathSegmentInterpolator ../support/viewUtils ../../../lib/glMatrix ../../../support/mathUtils ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryData ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Layer ../../../webgl-engine/lib/Object3D ../../../webgl-engine/lib/Selector ../../../webgl-engine/materials/ColorMaterial ../../../webgl-engine/materials/DefaultMaterial ../../../webgl-engine/materials/MeasurementArrowMaterial ../../../webgl-engine/materials/RibbonLineMaterial ../../../webgl-engine/parts/Model".split(" "),
function(w,t,p,a,b,e,u,h,c,r,d,n,g,x,k,y,z,C,A,E,D,l,f,m,q){var v=new e(function(){return g.vec3d.create()});w=[1,.5,0,.75];var G={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,triangleColor:w,triangleLineWidth:3,triangleCornerSize:32,triangleSubdivisions:128,arrowWidth:16,arrowOutlineColor:[1,
.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,arrowSubdivisions:128,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:w,guideLineWidth:2,guideLineColor:w,guideStippleLengthPixels:6,labelDistance:25},B;(function(a){a[a.Small=12]="Small";a[a.Large=16]="Large"})(B||(B={}));w=function(){function a(a,b,d){void 0===d&&(d={});this._visible=!1;this._laserLineRenderer=null;this._handleGeometry=new k(z.createSphereGeometry(1,32,32),"handle");
this._directDistanceLabel=new h;this._horizontalDistanceLabel=new h;this._verticalDistanceLabel=new h;this._listenerHandles=null;this._cursorPosition=g.vec3d.create();this._startPosition=g.vec3d.create();this._endPosition=g.vec3d.create();this._centerPosition=g.vec3d.create();this._cornerPosition=g.vec3d.create();this._arrowLabelSegment=new c;this._horizontalLabelSegment=new c;this._verticalLabelSegment=new c;this._geodesicProjectionLabelSegment=new c;this._origin=g.vec3d.create();this._originTransform=
g.mat4d.create();this._tempMat4=g.mat4d.create();this._model=a;this._sceneView=b;this._params=n.copyParameter(G,d);this._layer=new C("point-to-point-measurement",{},"point-to-point-measurement");this._createMaterials();this._createObjects();this._selector=new E(this._sceneView.viewingMode)}a.prototype.destroy=function(){this.hide()};Object.defineProperty(a.prototype,"requiresCursorPoint",{get:function(){return"initial"===this._model.state},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"cameraAboveGround",{get:function(){return this._sceneView.state.camera.aboveGround},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){a?this.show():this.hide()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"testData",{get:function(){return{labels:{direct:this._directDistanceLabel,horizontal:this._horizontalDistanceLabel,vertical:this._verticalDistanceLabel},laserLineRenderer:this._laserLineRenderer}},
enumerable:!0,configurable:!0});a.prototype.show=function(){if(!this._visible){this._visible=!0;var a=this._sceneView._stage;this._laserLineRenderer=new u(this._sceneView.renderCoordsHelper,{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,globalAlpha:this._params.laserLineGlobalAlpha});a.addExternalRenderer(this._laserLineRenderer.renderSlots,this._laserLineRenderer);this._addToStage(a);
this._directDistanceLabel.addToView(this._sceneView);this._horizontalDistanceLabel.addToView(this._sceneView);this._verticalDistanceLabel.addToView(this._sceneView);this._initializeListeners();this._updateCursorPosition();this._updateStartPosition();this._updateEndPosition();this._updateMouseCursor();this._updateView()}};a.prototype.hide=function(){if(this._visible){this._visible=!1;var a=this._sceneView._stage;a.removeExternalRenderer(this._laserLineRenderer);this._laserLineRenderer=null;this._removeFromStage(a);
this._directDistanceLabel.removeFromView(this._sceneView);this._horizontalDistanceLabel.removeFromView(this._sceneView);this._verticalDistanceLabel.removeFromView(this._sceneView);this._destroyListeners();this._sceneView.cursor=null}};a.prototype.handleAt=function(a,b){a=a.toArray();b="touch"===b?this._params.handleRadiusTouch:this._params.handleRadiusMouse;return this._model.endPoint&&n.pointToScreenPositionDistance(this._model.endPoint,a,this._sceneView)<b?"end":this._model.startPoint&&n.pointToScreenPositionDistance(this._model.startPoint,
a,this._sceneView)<b?"start":null};a.prototype.pick=function(b){for(var c=[],d=this._sceneView._stage.getViewContent(),m=this._sceneView._stage.getAll(q.ContentType.LAYER),f=0;f<d.length;f++){var e=m[d[f]];e&&e!==this._layer&&e.isPickable&&c.push(e.id)}d=this._sceneView.spatialReference;b=this._sceneView._stage.pick([b.screenPoint.x,this._sceneView.height-b.screenPoint.y],c,!0,this._selector).getMinResult();c=g.vec3d.create();if(!b.getIntersectionPoint(c))return new a.PickResult;d=this._sceneView.renderCoordsHelper.fromRenderCoords(c,
d);return new a.PickResult("terrain"===b.intersector?"surface":"feature",c,d)};a.prototype.getElevation=function(a){return this._sceneView.basemapTerrain.ready?this._sceneView.basemapTerrain.getElevation(a)||0:0};a.prototype.overlappingHandles=function(a,b){return n.pointToPointScreenDistance(a,b,this._sceneView)<=this._params.handleRadius};a.prototype._createMaterials=function(){this._handleMaterial=new l({diffuse:this._params.handleColor,transparent:1!==this._params.handleOpacity,opacity:this._params.handleOpacity,
castShadows:!1},"handle");this._handleMaterial.renderOccluded=!0;this._triangleLineMaterial=new m({width:this._params.triangleLineWidth,color:this._params.triangleColor,polygonOffset:!0},"triangle-line");this._triangleLineMaterial.renderOccluded=!0;this._triangleCornerMaterial=new D({color:this._params.triangleColor,transparent:!0,polygonOffset:!0},"triangle-corner");this._triangleCornerMaterial.renderOccluded=!0;this._arrowMaterial=new f({outlineColor:this._params.arrowOutlineColor,stripeEvenColor:this._params.arrowStripeEvenColor,
stripeOddColor:this._params.arrowStripeOddColor,polygonOffset:!0},"arrow");this._arrowMaterial.renderOccluded=!0;this._geodesicProjectionLineMaterial=new m({width:this._params.geodesicProjectionLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0},"geodesic-line");this._geodesicProjectionLineMaterial.renderOccluded=!0;this._geodesicGuideLineMaterial=new m({width:this._params.guideLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0,stippleLength:0},"geodesic-guide");
this._geodesicGuideLineMaterial.renderOccluded=!0};a.prototype._createObjects=function(){this._startHandleObject=new A;this._startHandleObject.addGeometry(this._handleGeometry,[this._handleMaterial],g.mat4d.identity());this._layer.addObject(this._startHandleObject);this._endHandleObject=new A;this._endHandleObject.addGeometry(this._handleGeometry,[this._handleMaterial],g.mat4d.identity());this._layer.addObject(this._endHandleObject);this._triangleLineObject=new A;this._layer.addObject(this._triangleLineObject);
this._triangleCornerObject=new A;this._layer.addObject(this._triangleCornerObject);this._arrowObject=new A;this._layer.addObject(this._arrowObject);this._geodesicProjectionLineObject=new A;this._layer.addObject(this._geodesicProjectionLineObject);this._geodesicProjectionStartGuideObject=new A;this._layer.addObject(this._geodesicProjectionStartGuideObject);this._geodesicProjectionEndGuideObject=new A;this._layer.addObject(this._geodesicProjectionEndGuideObject)};a.prototype._addToStage=function(a){a.add(q.ContentType.LAYER,
this._layer);a.add(q.ContentType.MATERIAL,this._handleMaterial);a.add(q.ContentType.MATERIAL,this._triangleLineMaterial);a.add(q.ContentType.MATERIAL,this._triangleCornerMaterial);a.add(q.ContentType.MATERIAL,this._arrowMaterial);a.add(q.ContentType.MATERIAL,this._geodesicProjectionLineMaterial);a.add(q.ContentType.MATERIAL,this._geodesicGuideLineMaterial);a.add(q.ContentType.OBJECT,this._startHandleObject);a.add(q.ContentType.OBJECT,this._endHandleObject);a.add(q.ContentType.OBJECT,this._triangleLineObject);
a.add(q.ContentType.OBJECT,this._triangleCornerObject);a.add(q.ContentType.OBJECT,this._arrowObject);a.add(q.ContentType.OBJECT,this._geodesicProjectionLineObject);a.add(q.ContentType.OBJECT,this._geodesicProjectionStartGuideObject);a.add(q.ContentType.OBJECT,this._geodesicProjectionEndGuideObject);a.addToViewContent([this._layer.id])};a.prototype._removeFromStage=function(a){a.removeFromViewContent([this._layer.id]);a.remove(q.ContentType.LAYER,this._layer.id);a.remove(q.ContentType.MATERIAL,this._handleMaterial.id);
a.remove(q.ContentType.MATERIAL,this._triangleLineMaterial.id);a.remove(q.ContentType.MATERIAL,this._triangleCornerMaterial.id);a.remove(q.ContentType.MATERIAL,this._arrowMaterial.id);a.remove(q.ContentType.MATERIAL,this._geodesicProjectionLineMaterial.id);a.remove(q.ContentType.MATERIAL,this._geodesicGuideLineMaterial.id);a.remove(q.ContentType.OBJECT,this._startHandleObject.id);a.remove(q.ContentType.OBJECT,this._endHandleObject.id);a.remove(q.ContentType.OBJECT,this._triangleLineObject.id);a.remove(q.ContentType.OBJECT,
this._triangleCornerObject.id);a.remove(q.ContentType.OBJECT,this._arrowObject.id);a.remove(q.ContentType.OBJECT,this._geodesicProjectionLineObject.id);a.remove(q.ContentType.OBJECT,this._geodesicProjectionStartGuideObject.id);a.remove(q.ContentType.OBJECT,this._geodesicProjectionEndGuideObject.id)};a.prototype._getLabelPositions=function(a,b,c,d,m){var f=this._model.triangleView.collapsed;v.push();var e=v.allocate(),l=v.allocate();m.projectPoint(c,e);m.projectPoint(b,l);e={direct:f?"top":"bottom",
horizontal:"top",vertical:e[0]<l[0]?"left":"right"};f||(l=v.allocate(),f=v.allocate(),n.screenSpaceTangent(a,c,l,m),n.screenSpaceTangent(a,b,f,m),g.vec2d.dot(l,f)>=F?e.direct=x.sign(l[1])===x.sign(f[1])?r.mirrorPosition(e.vertical):e.vertical:(a=v.allocate(),n.screenSpaceTangent(c,b,a,m),g.vec2d.dot(a,f)>=F&&(e.direct=x.sign(a[0])===x.sign(f[0])?r.mirrorPosition(e.horizontal):e.horizontal)));"below-the-surface"===d&&(b=function(a){return"top"===a?"bottom":"top"},e.direct=b(e.direct),e.horizontal=
b(e.horizontal),e.vertical=b(e.vertical));v.pop();return e};a.prototype._updateView=function(){if(this._sceneView.ready){var a=this._sceneView._stage.getCamera(),b=this._sceneView.renderCoordsHelper;this._updateHandleObject(this._startHandleObject,this._startPosition,null!==this._model.startPoint,"start"===this._model.hoveredHandle,this._model.draggedHandles.includes("start"),a);this._updateHandleObject(this._endHandleObject,this._endPosition,null!==this._model.endPoint,"end"===this._model.hoveredHandle,
this._model.draggedHandles.includes("end"),a);var c=this._model.triangleView;if(c.visible){var d="camera-dependent"===this._model.measurementSurfaceLocation?this._sceneView.state.camera.aboveGround?"above-the-surface":"below-the-surface":this._model.measurementSurfaceLocation,f=this._startPosition,m=this._endPosition,e="above-the-surface"===d?1:-1,l=e*(b.getAltitude(m)-b.getAltitude(f));0>l&&(m=[m,f],f=m[0],m=m[1]);var q=this._cornerPosition;b.worldUpAtPosition(f,q);g.vec3d.scale(q,e*Math.abs(l));
g.vec3d.add(q,f);b=this._centerPosition;n.midpoint([f,m,q],b);g.vec3d.set(b,this._origin);g.mat4d.identity(this._originTransform);g.mat4d.translate(this._originTransform,this._origin);c.collapsed?(this._triangleLineObject.removeAllGeometries(),this._triangleCornerObject.removeAllGeometries()):this._updateTriangleObjects(this._triangleLineObject,this._triangleCornerObject,f,m,q,this._origin,this._originTransform,a,c.mode,this._horizontalLabelSegment,this._verticalLabelSegment);this._updateArrowObject(this._arrowObject,
this._startPosition,this._endPosition,this._origin,this._originTransform,c.stripeLength,a,c.mode,this._arrowLabelSegment);b=this._requiresGeodesicGuides(this._startPosition,this._endPosition,a,c.mode);this._updateGeodesicProjectionLineObject(this._geodesicProjectionLineObject,this._startPosition,this._endPosition,this._origin,this._originTransform,b,this._geodesicProjectionLabelSegment);this._updateGeodesicProjectionGuideObjects(a,b);e=this._params.labelDistance;d=this._getLabelPositions(f,m,q,d,
a);this._updateAuxiliaryMeasureLabels(c,a,d);"geodesic"!==c.mode?this._updateLabel(this._directDistanceLabel,this._arrowLabelSegment,e,d.direct,c.directLabel,c.visible,B.Large,a):(this._updateLabel(this._horizontalDistanceLabel,b?this._geodesicProjectionLabelSegment:this._arrowLabelSegment,e,d.horizontal,c.horizontalLabel,c.visible,B.Large,a),this._directDistanceLabel.visible=!1)}else this._triangleLineObject.removeAllGeometries(),this._triangleCornerObject.removeAllGeometries(),this._arrowObject.removeAllGeometries(),
this._geodesicProjectionLineObject.removeAllGeometries(),this._geodesicProjectionStartGuideObject.removeAllGeometries(),this._geodesicProjectionEndGuideObject.removeAllGeometries(),this._directDistanceLabel.visible=!1,this._horizontalDistanceLabel.visible=!1,this._verticalDistanceLabel.visible=!1}};a.prototype._updateAuxiliaryMeasureLabels=function(a,b,c){if(a.collapsed)this._horizontalDistanceLabel.visible=!1,this._verticalDistanceLabel.visible=!1;else{var d=this._params.labelDistance;this._updateLabel(this._horizontalDistanceLabel,
this._horizontalLabelSegment,d,c.horizontal,a.horizontalLabel,!0,B.Small,b);this._updateLabel(this._verticalDistanceLabel,this._verticalLabelSegment,d,c.vertical,a.verticalLabel,!0,B.Small,b)}};a.prototype._updateHandleObject=function(a,b,c,d,f,m){a.removeAllGeometries();c&&!f&&(n.scaleTranslateMatrix((d?this._params.handleRadiusHovered:this._params.handleRadius)*m.computePixelSizeAt(b),b,this._tempMat4),a.addGeometry(this._handleGeometry,[this._handleMaterial],this._tempMat4))};a.prototype._updateTriangleObjects=
function(a,b,c,d,f,m,e,l,q,n,y){v.push();q=[g.vec3d.subtract(c,m,v.allocate()),g.vec3d.subtract(f,m,v.allocate()),g.vec3d.subtract(d,m,v.allocate())];n.update(f,d);y.update(c,f);n=new k(z.createPolylineGeometry(q),"triangle-line");a.removeAllGeometries();a.addGeometry(n,[this._triangleLineMaterial],e);a=v.allocate();n=v.allocate();g.vec3d.subtract(f,c,a);g.vec3d.normalize(a,a);g.vec3d.subtract(d,f,n);g.vec3d.normalize(n,n);c=.33*Math.min(g.vec3d.dist(f,c),g.vec3d.dist(f,d));l=this._params.triangleCornerSize*
l.computePixelSizeAt(f);f=new k(this._quadGeometryData(f,a,n,Math.min(c,l),m),"triangle-corner");b.removeAllGeometries();b.addGeometry(f,[this._triangleCornerMaterial],e);v.pop()};a.prototype._updateArrowObject=function(a,b,c,d,f,m,e,l,q){this._createInterpolatedLineGeometry(a,this._arrowMaterial,"arrow",b,c,d,f,l,this._arrowLabelSegment);a=e.computePixelSizeAt(q.origin);this._arrowMaterial.setParameterValues({width:this._params.arrowWidth*a,stripeLength:m})};a.prototype._getSegmentInterpolator=function(a,
b){var c=this._sceneView.spatialReference,f=this._sceneView.renderCoordsHelper.spatialReference;return c.isWebMercator||c.isWGS84?new d.Spherical(a,b,f,f):new d.Linear(a,b)};a.prototype._updateGeodesicProjectionLineObject=function(a,b,c,d,f,m,e){m?(v.push(),m=this._sceneView.renderCoordsHelper,b=g.vec3d.set(b,v.allocate()),c=g.vec3d.set(c,v.allocate()),m.setAltitude(0,b),m.setAltitude(0,c),this._createInterpolatedLineGeometry(a,this._geodesicProjectionLineMaterial,"geodesicProjectionLine",b,c,d,f,
"geodesic",e),v.pop()):a.removeAllGeometries()};a.prototype._requiresGeodesicGuides=function(a,b,c,d){return"geodesic"===d&&this._model.geodesicDistanceExceeded?this._requiresGeodesicGuideAt(a,c)||this._requiresGeodesicGuideAt(b,c):!1};a.prototype._requiresGeodesicGuideAt=function(a,b){var c=this._sceneView.renderCoordsHelper;b=b.computePixelSizeAt(a);return 10<=c.getAltitude(a)/b};a.prototype._updateGeodesicProjectionGuideObjects=function(a,b){if(b){v.push();b=this._sceneView.renderCoordsHelper;
var c=g.vec3d.set(this._startPosition,v.allocate()),d=g.vec3d.set(this._endPosition,v.allocate());b.setAltitude(0,c);b.setAltitude(0,d);this._createInterpolatedLineGeometry(this._geodesicProjectionStartGuideObject,this._geodesicGuideLineMaterial,"geodesicGuideLine",c,this._startPosition,this._origin,this._originTransform,"euclidean");this._createInterpolatedLineGeometry(this._geodesicProjectionEndGuideObject,this._geodesicGuideLineMaterial,"geodesicGuideLine",d,this._endPosition,this._origin,this._originTransform,
"euclidean");a=Math.min(a.computePixelSizeAt(this._startPosition),a.computePixelSizeAt(c),a.computePixelSizeAt(this._endPosition),a.computePixelSizeAt(d));this._geodesicGuideLineMaterial.setParameterValues({stippleLength:this._params.guideStippleLengthPixels*a});v.pop()}else this._geodesicProjectionStartGuideObject.removeAllGeometries(),this._geodesicProjectionEndGuideObject.removeAllGeometries()};a.prototype._createInterpolatedLineGeometry=function(a,b,c,d,f,m,e,l,q){v.push();var y=this._sceneView.renderCoordsHelper,
x=[],C=[],h=function(a,b){var c=v.allocate();g.vec3d.subtract(a,m,c);x.push(c);C.push(b)};if("euclidean"===l){var A=v.allocate();n.midpoint([d,f],A);l=v.allocate();y.worldUpAtPosition(A,l);h(d,l);h(f,l);q&&q.update(d,f)}else{d=this._getSegmentInterpolator(d,f);f=this._params.arrowSubdivisions+1&-2;for(var u=A=null,E=0;E<f;++E){var r=E/(f-1),D=v.allocate();l=v.allocate();d.eval(r,D);y.worldUpAtPosition(D,l);E===f/2-1?A=D:E===f/2&&(u=D);h(D,l)}q&&q.update(A,u)}c=new k(z.createPolylineGeometry(x,C),
c);a.removeAllGeometries();a.addGeometry(c,[b],e);v.pop()};a.prototype._quadGeometryData=function(a,b,c,d,f){v.push();var m=v.allocate(),e=[],l=v.allocate();g.vec3d.scale(c,d,l);c=v.allocate();g.vec3d.scale(b,-d,c);for(b=0;4>b;++b)g.vec3d.set(a,m),g.vec3d.subtract(m,f),b&1&&g.vec3d.add(m,l),b&2&&g.vec3d.add(m,c),e.push(m[0],m[1],m[2]);a=new y({position:{size:3,data:e}},{position:new Uint32Array([0,1,2,1,2,3])});v.pop();return a};a.prototype._updateLabel=function(a,b,c,d,f,m,e,l){v.push();var q=v.allocate(),
g=v.allocate();b=r.computeLabelPositionFromSegment(l,b,c,d,q,g);a.updatePosition(q,g);a.text=f;a.visible=b&&m;a.fontSize=e;v.pop()};a.prototype._updateMouseCursor=function(){if("drawing"===this._model.state||"initial"===this._model.state)this._sceneView.cursor="crosshair";else if("editing"===this._model.state||"measured"===this._model.state)this._sceneView.cursor=0<this._model.draggedHandles.length?"grabbing":this._model.hoveredHandle?"pointer":"crosshair"};a.prototype._updateCursorPosition=function(){this._model.cursorPoint&&
this._sceneView.renderCoordsHelper.toRenderCoords(this._model.cursorPoint,this._cursorPosition);this._updateLaserLine()};a.prototype._updateStartPosition=function(){this._model.startPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.startPoint,this._startPosition);this._updateLaserLine()};a.prototype._updateEndPosition=function(){this._model.endPoint&&this._sceneView.renderCoordsHelper.toRenderCoords(this._model.endPoint,this._endPosition);this._updateLaserLine()};a.prototype._lastAddedDraggedHandle=
function(){return 0<this._model.draggedHandles.length?this._model.draggedHandles.items[this._model.draggedHandles.length-1]:null};a.prototype._getFocusPosition=function(){var a=this._model,b=a.triangleView.visible&&a.triangleView.collapsed&&"euclidean"===a.measurementMode;switch(a.state){case "drawing":return b?this._startPosition:a.endPoint?this._endPosition:this._startPosition;case "editing":return b?"start"===this._lastAddedDraggedHandle()?this._endPosition:this._startPosition:"start"===this._lastAddedDraggedHandle()?
this._startPosition:this._endPosition;default:return a.cursorPoint?this._cursorPosition:null}};a.prototype._getFocusSpherePosition=function(){return"drawing"===this._model.state||"end"===this._lastAddedDraggedHandle()?this._startPosition:this._endPosition};a.prototype._updateLaserLine=function(){var a=this._model,b=this._getFocusPosition(),c=this._params.laserLineEnabled&&!!b&&"measured"!==a.state;c?(this._laserLineRenderer.focusPlaneActive=c&&"euclidean"===a.measurementMode,this._laserLineRenderer.focusSphereActive=
c&&!!a.startPoint&&"geodesic"===a.measurementMode,this._laserLineRenderer.focusPosition=b,this._laserLineRenderer.focusSpherePosition=this._getFocusSpherePosition(),this._laserLineRenderer.segmentActive=c&&a.triangleView.visible&&!a.triangleView.collapsed,this._laserLineRenderer.segmentStartPosition=this._startPosition,this._laserLineRenderer.segmentEndPosition=this._endPosition):(this._laserLineRenderer.focusPlaneActive=!1,this._laserLineRenderer.focusSphereActive=!1,this._laserLineRenderer.segmentActive=
!1)};a.prototype._initializeListeners=function(){var a=this;this._listenerHandles=new b;this._listenerHandles.add(this._model.watch("state",function(){a._updateMouseCursor();a._updateLaserLine()}));this._listenerHandles.add(this._model.watch("measurementMode",function(){a._updateLaserLine()}));this._listenerHandles.add(this._model.watch("hoveredHandle",function(){a._updateMouseCursor();a._updateView()}));this._listenerHandles.add(this._model.draggedHandles.on("change",function(){a._updateMouseCursor();
a._updateView()}));this._listenerHandles.add(this._model.watch("cursorPoint",function(){a._updateCursorPosition()}));this._listenerHandles.add(this._model.watch("startPoint",function(){a._updateStartPosition();a._updateView()}));this._listenerHandles.add(this._model.watch("endPoint",function(){a._updateEndPosition();a._updateView()}));this._listenerHandles.add(this._model.watch("unit",function(){a._updateView()}));this._listenerHandles.add(this._sceneView.state.watch("camera",function(){a._updateView()}))};
a.prototype._destroyListeners=function(){this._listenerHandles.destroy();this._listenerHandles=null};return a}();(function(a){var b=function(){return function(){}}();a.PickRequest=b;b=function(){return function(a,b,c){void 0===a&&(a=null);void 0===b&&(b=null);void 0===c&&(c=null);this.type=a;this.scenePoint=b;this.mapPoint=c}}();a.PickResult=b})(w||(w={}));var F=Math.cos(x.deg2rad(12));return w})},"esri/core/StackedObjectPool":function(){define(["require","exports"],function(w,t){return function(){function p(a,
b){void 0===b&&(b=0);this._pool=[];this._stack=[];this._index=0;this._factory=a;for(a=0;a<b;++a)this._pool.push(this._factory())}Object.defineProperty(p.prototype,"size",{get:function(){return this._pool.length},enumerable:!0,configurable:!0});p.prototype.push=function(){this._stack.push(this._index)};p.prototype.pop=function(){if(0===this._stack.length)throw Error("cannot pop empty stack");this._index=this._stack.pop()};p.prototype.allocate=function(){if(0===this._stack.length)throw Error("cannot allocate with empty stack");
this._index>=this._pool.length&&this._pool.push(this._factory());return this._pool[this._index++]};return p}()})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/LaserLineRenderer":function(){define("require exports ../../../../../core/tsSupport/extendsHelper dojo/text!./LaserLine.xml ../../../lib/glMatrix ../../../webgl-engine/lib/DefaultVertexAttributeLocations ../../../webgl-engine/lib/glUtil3D ../../../webgl-engine/lib/RenderSlot ../../../webgl-engine/materials/internal/MaterialUtil ../../../../webgl/Program".split(" "),
function(w,t,p,a,b,e,u,h,c,r){function d(a,c,d,e){var k=n,z=g;b.mat4d.multiplyVec3(e,c,k);b.vec3d.set(d,z);z[3]=0;b.mat4d.multiplyVec4(e,z);b.vec4d.set4(z[0],z[1],z[2],-b.vec3d.dot(z,k),a)}var n=b.vec3d.create(),g=b.vec4d.create(),x={glowColor:[1,.5,0],glowWidth:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75};return function(){function g(a,d){void 0===d&&(d={});this._projInfo=new Float32Array(4);this._segmentActive=this._focusSphereActive=this._focusPlaneActive=!1;this._focusPosition=b.vec3d.create();
this._focusSpherePosition=b.vec3d.create();this._segmentStartPosition=b.vec3d.create();this._segmentEndPosition=b.vec3d.create();this._needsRender=!1;this._tempNormal=b.vec3d.create();this._tempDir=b.vec3d.create();this._tempUp=b.vec3d.create();this._tempVec3=b.vec3d.create();this._tempVec4=b.vec4d.create();this.didRender=!1;this._renderCoordsHelper=a;this._params=c.copyParameters(d,x)}Object.defineProperty(g.prototype,"needsRender",{get:function(){return this._needsRender},enumerable:!0,configurable:!0});
Object.defineProperty(g.prototype,"renderSlots",{get:function(){return[h.POSTPROCESSING_EXTERNAL]},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"needsLinearDepth",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"focusPlaneActive",{get:function(){return this._focusPlaneActive},set:function(a){a!==this._focusPlaneActive&&(this._focusPlaneActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"focusSphereActive",{get:function(){return this._focusSphereActive},set:function(a){a!==this._focusSphereActive&&(this._focusSphereActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"segmentActive",{get:function(){return this._segmentActive},set:function(a){a!==this._segmentActive&&(this._segmentActive=a,this._needsRender=!0)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"focusPosition",{get:function(){return this._focusPosition},
set:function(a){b.vec3d.set(a,this._focusPosition);this._needsRender=!0},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"focusSpherePosition",{get:function(){return this._focusSpherePosition},set:function(a){b.vec3d.set(a,this._focusSpherePosition);this._needsRender=!0},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"segmentStartPosition",{get:function(){return this._segmentStartPosition},set:function(a){b.vec3d.set(a,this._segmentStartPosition);this._needsRender=
!0},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"segmentEndPosition",{get:function(){return this._segmentEndPosition},set:function(a){b.vec3d.set(a,this._segmentEndPosition);this._needsRender=!0},enumerable:!0,configurable:!0});g.prototype.setParameterValues=function(a){c.updateParameters(this._params,a)&&(this._needsRender=!0)};g.prototype.initializeRenderContext=function(b){var c=b.rctx;this._quadVAO=u.createQuadVAO(c);b.shaderSnippets.fsLaserLine||b.shaderSnippets._parse(a);
this._laserLineProgram=new r(c,b.shaderSnippets.vsUVQuad,b.shaderSnippets.fsLaserLine,e.Default3D)};g.prototype.uninitializeRenderContext=function(a){this._quadVAO.dispose();this._quadVAO=null;this._laserLineProgram.dispose();this._projInfo=this._laserLineProgram=null};g.prototype.resetNeedsRender=function(){this.didRender&&(this._needsRender=this.didRender=!1)};g.prototype.render=function(a){var c=a.rctx,e=a.camera,g=e.width,k=e.height,x=this._renderCoordsHelper,l=this._laserLineProgram,f=this._projInfo;
c.bindProgram(l);var m=e.projectionMatrix;f[0]=-2/(g*m[0]);f[1]=-2/(k*m[5]);f[2]=(1-m[2])/m[0];f[3]=(1+m[6])/m[5];l.setUniform4fv("projInfo",f);l.setUniform2f("nearFar",e.near,e.far);l.setUniform1f("maxPixelDistance",2*e.computePixelSizeAt(this._focusPosition));this._focusPlaneActive?(g=this._focusPosition,k=this._tempVec3,f=this._tempVec4,x.worldUpAtPosition(g,k),d(f,g,k,e.viewMatrix),l.setUniform4fv("focusPlane",f)):l.setUniform4fv("focusPlane",[0,0,0,1E10]);this._focusSphereActive?(k=this._tempVec4,
g=this._tempVec3,b.vec3d.set(this._focusSpherePosition,k),b.mat4d.multiplyVec3(e.viewMatrix,k),b.vec3d.set(this._focusPosition,g),b.mat4d.multiplyVec3(e.viewMatrix,g),k[3]=b.vec3d.dist(k,g),l.setUniform4fv("focusSphere",k)):l.setUniform4fv("focusSphere",[0,0,0,1E10]);if(this._segmentActive){var g=this._tempVec4,k=this._tempVec3,f=this._tempUp,m=this._tempDir,q=this._tempNormal;b.vec3d.lerp(this._segmentStartPosition,this._segmentEndPosition,.5,k);x.worldUpAtPosition(k,f);b.vec3d.subtract(this._segmentEndPosition,
this._segmentStartPosition,m);b.vec3d.normalize(m);b.vec3d.cross(f,m,q);b.vec3d.normalize(q);d(g,this._segmentStartPosition,q,e.viewMatrix);l.setUniform4fv("segmentPlane",g)}else l.setUniform4fv("segmentPlane",[0,0,0,1E10]);g=n;b.vec3d.set(this._segmentStartPosition,g);x.setAltitude(0,g);b.mat4d.multiplyVec3(e.viewMatrix,g);l.setUniform3fv("segmentStart",g);g=n;b.vec3d.set(this._segmentEndPosition,g);x.setAltitude(0,g);b.mat4d.multiplyVec3(e.viewMatrix,g);l.setUniform3fv("segmentEnd",g);l.setUniform1i("depthMap",
0);c.bindTexture(a.depth.colorTexture,0);l.setUniform3fv("innerColor",this._params.innerColor);l.setUniform1f("innerWidth",this._params.innerWidth);l.setUniform3fv("glowColor",this._params.glowColor);l.setUniform1f("glowWidth",this._params.glowWidth);l.setUniform1f("globalAlpha",this._params.globalAlpha);c.bindVAO(this._quadVAO);c.setDepthTestEnabled(!1);c.setDepthWriteEnabled(!1);c.setBlendFunctionSeparate(1,771,770,771);c.setBlendingEnabled(!0);c.drawArrays(5,0,4);c.setDepthTestEnabled(!0);c.setDepthWriteEnabled(!0);
c.setBlendingEnabled(!1);return!0};return g}()})},"esri/views/3d/interactive/measurementTools/support/Label":function(){define(["require","exports","../../../../overlay/LineOverlayItem","../../../../overlay/TextOverlayItem"],function(w,t,p,a){return function(){function b(b){this._textItem=new a({visible:!1});this._calloutItem=new p({visible:!1,width:2});this._visible=!1;this._calloutVisible=!0;b&&(this.fontSize=b)}Object.defineProperty(b.prototype,"textItem",{get:function(){return this._textItem},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"calloutItem",{get:function(){return this._calloutItem},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"text",{get:function(){return this._textItem.text},set:function(a){this._textItem.text=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"fontSize",{get:function(){return this._textItem.fontSize},set:function(a){this._textItem.fontSize=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"visible",{get:function(){return this._visible},set:function(a){this._visible=a;this._updateVisibility()},enumerable:!0,configurable:!0});b.prototype.addToView=function(a){a.overlay.items.addMany([this._textItem,this._calloutItem])};b.prototype.removeFromView=function(a){a.overlay.items.removeMany([this._textItem,this._calloutItem])};b.prototype.updatePosition=function(a,b){if(b){var e=b[0]-a[0],c=b[1]-a[1];this._textItem.position=[b[0],b[1]];this._textItem.anchor=Math.abs(e)>Math.abs(c)?0<e?"left":
"right":0<c?"top":"bottom";this._calloutItem.startPosition=[a[0],a[1]];this._calloutItem.endPosition=[b[0],b[1]];this._calloutVisible=!0}else this._textItem.position=[a[0],a[1]],this._textItem.anchor="center",this._calloutVisible=!1};b.prototype._updateVisibility=function(){this._textItem.visible=this._visible;this._calloutItem.visible=this._visible&&this._calloutVisible};return b}()})},"esri/views/overlay/LineOverlayItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./ViewOverlayItem maquette".split(" "),
function(w,t,p,a,b,e,u,h){return function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.startX=0;a.startY=0;a.endX=0;a.endY=0;a.width=1;a.color=[0,0,0,1];a.visible=!0;return a}p(c,b);Object.defineProperty(c.prototype,"startPosition",{get:function(){return[this.startX,this.startY]},set:function(a){this._set("startX",a[0]);this._set("startY",a[1])},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"endPosition",{get:function(){return[this.endX,this.endY]},set:function(a){this._set("endX",
a[0]);this._set("endY",a[1])},enumerable:!0,configurable:!0});c.prototype.render=function(){var a=Math.min(this.startX,this.endX),b=Math.min(this.startY,this.endY),c=this.width,e=Math.max(this.startX,this.endX)-a+2*c,k=Math.max(20,Math.max(this.startY,this.endY)-b+2*c);return h.h("div",{classes:{"esri-line-overlay-item":!0},styles:{left:a-c+"px",top:b-c+"px",width:e+"px",height:k+"px",visibility:this.visible?"visible":"hidden"},innerHTML:"\x3csvg width\x3d"+e+" height\x3d"+k+"\x3e"+("\x3cline x1\x3d"+
(this.startX-a+c)+" y1\x3d"+(this.startY-b+c)+" x2\x3d"+(this.endX-a+c)+" y2\x3d"+(this.endY-b+c)+' style\x3d"stroke: rgba(0, 0, 0, 0.5); stroke-width: '+this.width+'; stroke-linecap: round;"\x3e\x3c/line\x3e')+"\x3c/svg\x3e"})};a([e.property()],c.prototype,"startX",void 0);a([e.property()],c.prototype,"startY",void 0);a([e.property()],c.prototype,"endX",void 0);a([e.property()],c.prototype,"endY",void 0);a([e.property({dependsOn:["startX","startY"]})],c.prototype,"startPosition",null);a([e.property({dependsOn:["endX",
"endY"]})],c.prototype,"endPosition",null);a([e.property()],c.prototype,"width",void 0);a([e.property()],c.prototype,"color",void 0);a([e.property()],c.prototype,"visible",void 0);return c=a([e.subclass("esri.views.overlay.LineOverlayItem")],c)}(e.declared(b,u))})},"esri/views/overlay/ViewOverlayItem":function(){define(["require","exports","../../core/tsSupport/declareExtendsHelper","../../core/tsSupport/decorateHelper"],function(w,t,p,a){return function(){return function(){}}()})},"esri/views/overlay/TextOverlayItem":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./ViewOverlayItem maquette".split(" "),
function(w,t,p,a,b,e,u,h){var c={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};return function(b){function d(){var a=
null!==b&&b.apply(this,arguments)||this;a.x=0;a.y=0;a.text="-";a.fontSize=14;a.anchor="center";a.visible=!0;return a}p(d,b);Object.defineProperty(d.prototype,"position",{get:function(){return[this.x,this.y]},set:function(a){this._set("x",a[0]);this._set("y",a[1])},enumerable:!0,configurable:!0});d.prototype.render=function(){return h.h("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+
"px"}},[this.text])};d.prototype._cssClasses=function(){var a={"esri-text-overlay-item":!0},b;for(b in c)a[c[b]]=this.anchor===b;return a};a([e.property()],d.prototype,"x",void 0);a([e.property()],d.prototype,"y",void 0);a([e.property({dependsOn:["x","y"]})],d.prototype,"position",null);a([e.property()],d.prototype,"text",void 0);a([e.property()],d.prototype,"fontSize",void 0);a([e.property()],d.prototype,"anchor",void 0);a([e.property()],d.prototype,"visible",void 0);return d=a([e.subclass("esri.views.overlay.TextOverlayItem")],
d)}(e.declared(b,u))})},"esri/views/3d/interactive/measurementTools/support/LabelSegment":function(){define(["require","exports","./viewUtils","../../../lib/glMatrix"],function(w,t,p,a){return function(){function b(){this.origin=a.vec3d.create();this.start=a.vec3d.create();this.end=a.vec3d.create()}b.prototype.update=function(b,u,h){a.vec3d.set(b,this.start);a.vec3d.set(u,this.end);if(h)switch(h){case "start":a.vec3d.set(this.start,this.origin);break;case "center":p.midpoint([b,u],this.origin);break;
case "end":a.vec3d.set(this.end,this.origin);break;default:a.vec3d.set(h,this.origin)}else p.midpoint([b,u],this.origin)};return b}()})},"esri/views/3d/interactive/measurementTools/support/viewUtils":function(){define(["require","exports","dojo/_base/lang","../../../../../core/lang","../../../lib/glMatrix"],function(w,t,p,a,b){function e(a,d,e){var g=e._stage.getCamera();e.renderCoordsHelper.toRenderCoords(a,h);g.projectPoint(h,c);b.vec2d.set2(c[0],e.height-c[1],d);return[d[0],e.height-d[1]]}Object.defineProperty(t,
"__esModule",{value:!0});var u=b.vec3d.create();t.copyParameter=function(b,c){b=p.mixin({},b);c=a.clone(c);p.mixin(b,c);return b};t.resizeArray=function(a,b,c,d){for(;a.length<b;)a.push(c());if(d)for(;a.length>b;)c=a.pop(),d(c);else a.length=b};t.scaleTranslateMatrix=function(a,c,d){b.mat4d.identity(d);b.mat4d.translate(d,c);b.vec3d.set3(a,a,a,u);b.mat4d.scale(d,u)};t.midpoint=function(a,c){b.vec3d.set3(0,0,0,c);for(var d=0;d<a.length;++d)b.vec3d.add(c,a[d]);b.vec3d.scale(c,1/a.length)};t.screenSpaceTangent=
function(a,c,e,k){k.projectPoint(a,r);k.projectPoint(c,d);b.vec2d.subtract(d,r,e);b.vec2d.normalize(e)};t.projectPoint=e;t.pointToPointScreenDistance=function(a,c,h){e(a,r,h);e(c,d,h);return b.vec2d.dist(r,d)};t.pointToScreenPositionDistance=function(a,d,h){e(a,c,h);return b.vec2d.dist(c,d)};var h=b.vec3d.create(),c=b.vec3d.create(),r=b.vec2d.create(),d=b.vec2d.create()})},"esri/views/3d/interactive/measurementTools/support/labelUtils":function(){define(["require","exports","./viewUtils","../../../lib/glMatrix"],
function(w,t,p,a){function b(a,b,c){a.projectPoint(b,n);if(0>n[2]||1<n[2])return!1;c[0]=n[0];c[1]=n[1];c[1]=a.height-c[1];return!0}function e(b,e,g,k,h,l){if(!e)return!1;p.screenSpaceTangent(e.start,e.end,c,b);a.vec2d.set2(-c[1],c[0],d);var f=!1;switch(k){case "top":f=0>d[1];break;case "bottom":f=0<d[1];break;case "left":f=0<d[0];break;case "right":f=0>d[0]}f&&a.vec2d.negate(d);if(0===a.vec2d.length(d))switch(k){case "top":d[1]=1;break;case "bottom":d[1]=-1;break;case "left":d[0]=-1;break;case "right":d[0]=
1}b.projectPoint(e.origin,n);if(0>n[2]||1<n[2])return!1;h[0]=n[0];h[1]=n[1];a.vec2d.scale(d,g,l);a.vec2d.add(l,h,l);h[1]=b.height-h[1];l[1]=b.height-l[1];return!0}function u(b,e,g,k,h,l){if(!e||!g)return!1;p.screenSpaceTangent(e.end,e.start,c,b);p.screenSpaceTangent(g.start,g.end,r,b);a.vec2d.add(c,r,d);a.vec2d.negate(d);a.vec2d.normalize(d);b.projectPoint(e.end,n);if(0>n[2]||1<n[2])return!1;h[0]=n[0];h[1]=n[1];a.vec2d.scale(d,k,l);a.vec2d.add(l,h,l);h[1]=b.height-h[1];l[1]=b.height-l[1];return!0}
function h(b,c,e,k,h,l){b.projectPoint(c,n);a.vec3d.add(c,e,x);b.projectPoint(x,g);if(0>n[2]||1<n[2]||0>g[2]||1<g[2])return!1;a.vec2d.subtract(g,n,d);a.vec2d.normalize(d);a.vec2d.set(n,h);a.vec2d.scale(d,k,l);a.vec2d.add(l,h,l);h[1]=b.height-h[1];l[1]=b.height-l[1];return!0}Object.defineProperty(t,"__esModule",{value:!0});t.mirrorPosition=function(a){switch(a){case "top":return"bottom";case "right":return"left";case "bottom":return"top";case "left":return"right"}};t.computeLabelPositionFromPoint=
b;t.positionLabelOnPoint=function(a,c,d){(c=b(d,c,k))&&a.updatePosition(k,null);return c};t.computeLabelPositionFromSegment=e;t.positionLabelOnSegment=function(a,b,c,d,g){(b=e(g,b,c,d,k,y))&&a.updatePosition(k,y);return b};t.computeLabelPositionFromCorner=u;t.computeLabelPositionFromPlane=h;t.positionLabelOnCorner=function(a,b,c,d,e){(b=u(e,b,c,d,k,y))&&a.updatePosition(k,y);return b};t.positionLabelOnPlane=function(a,b,c,d,e,l){(b=h(l,b,c,d,k,y))&&a.updatePosition(k,y);return b};var c=a.vec2d.create(),
r=a.vec2d.create(),d=a.vec2d.create(),n=a.vec3d.create(),g=a.vec3d.create(),x=a.vec3d.create(),k=a.vec2d.create(),y=a.vec2d.create()})},"esri/views/3d/interactive/measurementTools/support/PathSegmentInterpolator":function(){define("require exports ../../../../../geometry/SpatialReference ../../../../../geometry/support/geodesicUtils ../../../lib/glMatrix ../../../support/mathUtils ../../../support/projectionUtils".split(" "),function(w,t,p,a,b,e,u){function h(a){a.x=r.normalize(a.x);a.y=d.normalize(a.y)}
function c(a,b,c){u.vectorToVector(a,b,c,p.WGS84);c[0]=e.deg2rad(c[0]);c[1]=e.deg2rad(c[1])}var r=new e.Cyclical(-180,180),d=new e.Cyclical(-90,90),n;(function(d){var g=function(){function a(a,c){this._startPosition=b.vec3d.create();this._endPosition=b.vec3d.create();b.vec3d.set(a,this._startPosition);b.vec3d.set(c,this._endPosition)}a.prototype.eval=function(a,c){b.vec3d.lerp(this._startPosition,this._endPosition,a,c)};return a}();d.Linear=g;g=function(){function d(d,e,g,h){this._startCoords=b.vec3d.create();
this._endCoords=b.vec3d.create();c(d,g,this._startCoords);c(e,g,this._endCoords);this._destSR=h;this._startToEnd=a.inverseGeodeticSolver(this._startCoords[1],this._startCoords[0],this._endCoords[1],this._endCoords[0]);this._endToStart=a.inverseGeodeticSolver(this._endCoords[1],this._endCoords[0],this._startCoords[1],this._startCoords[0])}d.prototype.eval=function(b,c){var d=a.directGeodeticSolver(this._startCoords[1],this._startCoords[0],this._startToEnd.azimuth,this._startToEnd.geodesicDistance*
b),g=a.directGeodeticSolver(this._endCoords[1],this._endCoords[0],this._endToStart.azimuth,this._endToStart.geodesicDistance*(1-b));h(d);h(g);c[0]=e.lerp(d.x,g.x,b);c[1]=e.lerp(d.y,g.y,b);c[2]=e.lerp(this._startCoords[2],this._endCoords[2],b);u.vectorToVector(c,p.WGS84,c,this._destSR)};return d}();d.Geodesic=g;g=function(){function a(a,c,d,e){this._startPosition=b.vec3d.create();this._endPosition=b.vec3d.create();u.vectorToVector(a,d,this._startPosition,u.SphericalECEFSpatialReference);u.vectorToVector(c,
d,this._endPosition,u.SphericalECEFSpatialReference);this._destSR=e}a.prototype.eval=function(a,b){e.slerp(this._startPosition,this._endPosition,a,b);u.vectorToVector(b,u.SphericalECEFSpatialReference,b,this._destSR)};return a}();d.Spherical=g})(n||(n={}));return n})},"esri/geometry/support/geodesicUtils":function(){define("require exports ../Point ../Polygon ../Polyline ../SpatialReference".split(" "),function(w,t,p,a,b,e){function u(a,b,c,d){var g=1/298.257223563,h=Math.sin(c);c=Math.cos(c);var k=
(1-g)*Math.tan(a);a=1/Math.sqrt(1+k*k);for(var u=k*a,l=Math.atan2(k,c),k=a*h*a*h,f=1-k,m=2.7233160610754688E11*f/4.040829998466145E13,q=1+m/16384*(4096+m*(-768+m*(320-175*m))),v=m/1024*(256+m*(-128+m*(74-47*m))),m=d/(6356752.31424518*q),n=2*Math.PI,B,x,r,y;1E-12<Math.abs(m-n);)r=Math.cos(2*l+m),B=Math.sin(m),x=Math.cos(m),y=v*B*(r+v/4*(x*(-1+2*r*r)-v/6*r*(-3+4*B*B)*(-3+4*r*r))),n=m,m=d/(6356752.31424518*q)+y;d=u*B-a*x*c;f=g/16*f*(4+g*(4-3*f));return new p((b+(Math.atan2(B*h,a*x-u*B*c)-(1-f)*g*Math.sqrt(k)*
(m+f*B*(r+f*x*(-1+2*r*r)))))/(Math.PI/180),Math.atan2(u*x+a*B*c,(1-g)*Math.sqrt(k+d*d))/(Math.PI/180),new e({wkid:4326}))}function h(a,b,c,d){var e=1/298.257223563,g=d-b,h=Math.atan((1-e)*Math.tan(a)),k=Math.atan((1-e)*Math.tan(c)),l=Math.sin(h),h=Math.cos(h),f=Math.sin(k),k=Math.cos(k),m=1E3,q=g,v,u,n,r,p,x,t,y;do{r=Math.sin(q);p=Math.cos(q);n=Math.sqrt(k*r*k*r+(h*f-l*k*p)*(h*f-l*k*p));if(0===n)return{geodesicDistance:0};p=l*f+h*k*p;x=Math.atan2(n,p);t=h*k*r/n;u=1-t*t;r=p-2*l*f/u;isNaN(r)&&(r=0);
y=e/16*u*(4+e*(4-3*u));v=q;q=g+(1-y)*e*t*(x+y*n*(r+y*p*(-1+2*r*r)))}while(1E-12<Math.abs(q-v)&&0<--m);if(0===m)return l=d-b,{geodesicDistance:6371009*Math.acos(Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(d-b)),azimuth:Math.atan2(Math.sin(l)*Math.cos(c),Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(l))};a=2.7233160610754688E11*u/4.040829998466145E13;b=a/1024*(256+a*(-128+a*(74-47*a)));return{geodesicDistance:6356752.31424518*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(x-b*n*
(r+b/4*(p*(-1+2*r*r)-b/6*r*(-3+4*n*n)*(-3+4*r*r)))),azimuth:Math.atan2(k*Math.sin(q),h*f-l*k*Math.cos(q)),reverseAzimuth:Math.atan2(h*Math.sin(q),h*f*Math.cos(q)-l*k)}}function c(c,d){var e=Math.PI/180;637.100877151506>d&&(d=637.100877151506);if("polyline"!==c.type&&"polygon"!==c.type)throw console.error("_geodesicDensify: the input geometry is neither polyline nor polygon"),Error("_geodesicDensify: the input geometry is neither polyline nor polygon");for(var g=[],k=0,n="polyline"===c.type?c.paths:
c.rings;k<n.length;k++){var r=n[k],p=[];g.push(p);p.push([r[0][0],r[0][1]]);for(var l=r[0][0]*e,f=r[0][1]*e,m=void 0,q=void 0,v=0;v<r.length-1;v++)if(m=r[v+1][0]*e,q=r[v+1][1]*e,l!==m||f!==q){var q=h(f,l,q,m),m=q.azimuth,q=q.geodesicDistance,t=q/d;if(1<t){for(var B=1;B<=t-1;B++){var x=u(f,l,m,B*d);p.push([x.x,x.y])}t=u(f,l,m,(q+Math.floor(t-1)*d)/2);p.push([t.x,t.y])}f=u(f,l,m,q);p.push([f.x,f.y]);l=f.x*e;f=f.y*e}}return"polyline"===c.type?new b({paths:g,spatialReference:c.spatialReference}):new a({rings:g,
spatialReference:c.spatialReference})}function r(a,b){var c=Math.PI/180,d=Math.sin(b[1]*c),d=.9933056200098026*(d/(1-.006694379990197414*d*d)-6.111035746609262*Math.log((1-.0818191908429643*d)/(1+.0818191908429643*d)));a[0]=6378137*b[0]*c;a[1]=3189068.5*d;return a}Object.defineProperty(t,"__esModule",{value:!0});var d={esriMiles:1,esriKilometers:1.609344,esriFeet:5280,esriMeters:1609.34,esriYards:1760,esriNauticalMiles:.869,esriCentimeters:160934,esriDecimeters:16093.4,esriInches:63360,esriMillimeters:1609340,
esriAcres:1,esriAres:40.4685642,esriSquareKilometers:.00404685642,esriSquareMiles:.0015625,esriSquareFeet:43560,esriSquareMeters:4046.85642,esriHectares:.404685642,esriSquareYards:4840,esriSquareInches:6272640,esriSquareMillimeters:4046856420,esriSquareCentimeters:4.04685642E7,esriSquareDecimeters:404685.642};t.directGeodeticSolver=u;t.inverseGeodeticSolver=h;t.geodesicDensify=c;t.geodesicLengths=function(a,b){for(var c=Math.PI/180,e=[],g=0;g<a.length;g++){for(var k=a[g].paths,r=0,u=0;u<k.length;u++){for(var l=
k[u],f=0,m=1;m<l.length;m++){var q=l[m-1][0]*c,v=l[m][0]*c,n=l[m-1][1]*c,p=l[m][1]*c;if(n!==p||q!==v)q=h(n,q,p,v),f+=q.geodesicDistance/1609.344}r+=f}r*=d[b];e.push(r)}return e};var n=[0,0],g=[0,0];t.geodesicAreas=function(a,b){for(var e=[],h=0;h<a.length;h++){var k=c(a[h],1E4);e.push(k)}a=[];for(h=0;h<e.length;h++){for(var k=e[h].rings,u=0,p=0;p<k.length;p++){var t=k[p];r(n,t[0]);r(g,t[t.length-1]);for(var l=g[0]*n[1]-n[0]*g[1],f=0;f<t.length-1;f++)r(n,t[f+1]),r(g,t[f]),l+=g[0]*n[1]-n[0]*g[1];l/=
4046.87;u+=l}u*=d[b];a.push(u/-2)}return a}})},"esri/views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DModel":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/Collection ../../../../../core/Handles ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ../../../../../geometry/SpatialReference ../../../../../geometry/support/geodesicUtils ../support/Quantity ../support/quantityUtils ../support/UnitNormalizer ../support/unitUtils ../../../lib/glMatrix ../../../support/earthUtils ../../../support/mathUtils ../../../support/projectionUtils ../../../webgl-engine/lib/Util".split(" "),
function(w,t,p,a,b,e,u,h,c,r,d,n,g,x,k,y,z,C,A,E){var D=z.earthRadius*Math.PI/180;return function(b){function f(){var a=null!==b&&b.apply(this,arguments)||this;a._tempStartPosition=y.vec3d.create();a._tempEndPosition=y.vec3d.create();a._tempCornerPosition=y.vec3d.create();a._unitNormalizer=new x;a._handles=new u;a.cursorPoint=null;a.hoveredHandle=null;a.draggedHandles=new e;a.state="initial";a.mode="auto";a.unit="metric";a.directDistance=null;a.horizontalDistance=null;a.verticalDistance=null;a.geodesicDistance=
null;a.geodesicAngle=null;a.triangleCollapseRatioThreshold=.03;a.geodesicMeasurementDistanceThreshold=1E5;return a}p(f,b);f.prototype.initialize=function(){var a=this;this._handles.add(h.init(this.sceneView,"spatialReference",function(b){a._unitNormalizer.spatialReference=b;a._unitNormalizer.ignoredSpatialReferences=[r.WGS84,r.WebMercator]}),"scene-view");this.reset()};f.prototype.destroy=function(){this._handles.destroy();this._handles=null};Object.defineProperty(f.prototype,"startPoint",{set:function(a){this._set("startPoint",
a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"startPointSurfaceLocation",{set:function(a){this._set("startPointSurfaceLocation",a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"endPoint",{set:function(a){this._set("endPoint",a);this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"endPointSurfaceLocation",{set:function(a){this._set("endPointSurfaceLocation",a);
this._updateMeasurement()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"measurementSurfaceLocation",{get:function(){var a=this.startPointSurfaceLocation,b=this.endPointSurfaceLocation;return null==a||null==b?"camera-dependent":"above-the-surface"===a&&"below-the-surface"===b||"below-the-surface"===a&&"above-the-surface"===b||"on-the-surface"===a&&"on-the-surface"===b?"camera-dependent":"above-the-surface"===a||"above-the-surface"===b?"above-the-surface":"below-the-surface"},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"validMeasurement",{get:function(){return!!this.startPoint&&!!this.endPoint},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isMeasuring",{get:function(){return!!this.startPoint},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"geodesicDistanceExceeded",{get:function(){return this.horizontalDistance&&this.horizontalDistance.value>this.geodesicMeasurementDistanceThreshold},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"measurementMode",{get:function(){var a=this.mode;if("auto"===a){a="euclidean";if("degrees"===this.unit||"degrees-minutes-seconds"===this.unit)a="geodesic";this.geodesicDistanceExceeded&&(a="geodesic")}return a},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"triangleView",{get:function(){var a=this._collapseTriangle(),b=null,c=null,d=null,e=this.directDistance,c="geodesic"===this.measurementMode?this.geodesicDistance:this.horizontalDistance,f=
this.verticalDistance,l=null;switch(this.unit){case "metric":b=e&&g.formatMetricLength(e);c=c&&g.formatMetricLength(c);d=f&&g.formatMetricVerticalLength(f);l=e&&e.toUnit("meters");break;case "imperial":b=e&&g.formatImperialLength(e);c=c&&g.formatImperialLength(c);d=f&&g.formatImperialVerticalLength(f);l=e&&e.toUnit(k.preferredImperialLengthUnit(e.value,e.unit));break;case "degrees":c=this.geodesicAngle&&g.formatDecimal(this.geodesicAngle,"degrees");l=this.geodesicAngle&&this.geodesicAngle.toUnit("degrees");
break;case "degrees-minutes-seconds":c=this.geodesicAngle&&g.formatDMS(this.geodesicAngle);l=this.geodesicAngle&&this.geodesicAngle.toUnit("degrees");break;default:b=e&&g.formatDecimal(e,this.unit),c=c&&g.formatDecimal(c,this.unit),d=f&&g.formatDecimal(f,this.unit),l=e&&e.toUnit(this.unit)}e=1;l&&(e=E.nextHighestPowerOfTen(l.value/30),e*="degrees"===l.unit?D:k.convertUnit(1,l.unit,"meters"),e/=this._unitNormalizer.normalizeDistance(1));return{visible:this.validMeasurement&&!this.startPoint.equals(this.endPoint),
mode:this.measurementMode,collapsed:a,directLabel:b,horizontalLabel:c,verticalLabel:d,stripeLength:e}},enumerable:!0,configurable:!0});f.prototype.reset=function(){this.clearMeasurement()};f.prototype.clearMeasurement=function(){this.state="initial";this.cursorPoint=this.endPoint=this.startPoint=null;this._clearOverride("measurementSurfaceLocation");this._updateMeasurement()};f.prototype.finishedMeasurement=function(a){if(!this._isOverridden("measurementSurfaceLocation")){var b=this.measurementSurfaceLocation;
this._override("measurementSurfaceLocation","camera-dependent"===b?a.cameraAboveGround?"above-the-surface":"below-the-surface":b)}this.state="measured"};f.prototype._collapseTriangle=function(){return!this.validMeasurement||this.startPoint.equals(this.endPoint)||"geodesic"===this.measurementMode?!0:Math.min(this.verticalDistance.value/this.horizontalDistance.value,this.horizontalDistance.value/this.verticalDistance.value)<this.triangleCollapseRatioThreshold};f.prototype._exactGeodesicDistanceAndAngle=
function(a,b){var c=C.deg2rad(a.longitude);a=C.deg2rad(a.latitude);var e=C.deg2rad(b.longitude),f=C.deg2rad(b.latitude);b=C.rad2deg(Math.acos(Math.sin(a)*Math.sin(f)+Math.cos(a)*Math.cos(f)*Math.cos(Math.abs(e-c))));c=d.inverseGeodeticSolver(a,c,f,e).geodesicDistance;return{distance:new n(c,"meters"),angle:new n(b,"degrees")}};f.prototype._approximateGeodesicDistanceAndAngle=function(a){return{distance:new n(a,"meters"),angle:new n(a/D,"degrees")}};f.prototype._euclideanDistances=function(a,b){a.z>
b.z&&(a=[a,a=b][0]);var c=a.clone();c.z=b.z;var d=this._tempStartPosition,e=this._tempEndPosition,f=this._tempCornerPosition,l=this.sceneView.spatialReference,l=l.isWGS84||l.isWebMercator?A.WGS84ECEFSpatialReference:l;A.pointToVector(a,d,l);A.pointToVector(b,e,l);A.pointToVector(c,f,l);c=y.vec3d.dist(d,e);e=y.vec3d.dist(f,e);a=Math.abs(b.z-a.z);c=this._unitNormalizer.normalizeDistance(c);e=this._unitNormalizer.normalizeDistance(e);a=this._unitNormalizer.normalizeElevation(a);return{direct:new n(c,
"meters"),horizontal:new n(e,"meters"),vertical:new n(a,"meters")}};f.prototype._updateMeasurement=function(){if(this.startPoint&&this.endPoint){var a=this._euclideanDistances(this.startPoint,this.endPoint),b=this.sceneView.spatialReference,b=b.isWGS84||b.isWebMercator?this._exactGeodesicDistanceAndAngle(this.startPoint,this.endPoint):this._approximateGeodesicDistanceAndAngle(a.horizontal.value);this._set("directDistance",a.direct);this._set("horizontalDistance",a.horizontal);this._set("verticalDistance",
a.vertical);this._set("geodesicDistance",b.distance);this._set("geodesicAngle",b.angle)}else this._set("directDistance",null),this._set("horizontalDistance",null),this._set("verticalDistance",null),this._set("geodesicDistance",null),this._set("geodesicAngle",null)};a([c.property({constructOnly:!0})],f.prototype,"sceneView",void 0);a([c.property({value:null})],f.prototype,"startPoint",null);a([c.property({value:null})],f.prototype,"startPointSurfaceLocation",null);a([c.property({value:null})],f.prototype,
"endPoint",null);a([c.property({value:null})],f.prototype,"endPointSurfaceLocation",null);a([c.property({dependsOn:["startPointSurfaceLocation","endPointSurfaceLocation"]})],f.prototype,"measurementSurfaceLocation",null);a([c.property()],f.prototype,"cursorPoint",void 0);a([c.property()],f.prototype,"hoveredHandle",void 0);a([c.property({readOnly:!0})],f.prototype,"draggedHandles",void 0);a([c.property()],f.prototype,"state",void 0);a([c.property()],f.prototype,"mode",void 0);a([c.property()],f.prototype,
"unit",void 0);a([c.property({readOnly:!0,dependsOn:["startPoint","endPoint"]})],f.prototype,"validMeasurement",null);a([c.property({readOnly:!0,dependsOn:["startPoint"]})],f.prototype,"isMeasuring",null);a([c.property({readOnly:!0})],f.prototype,"directDistance",void 0);a([c.property({readOnly:!0})],f.prototype,"horizontalDistance",void 0);a([c.property({readOnly:!0})],f.prototype,"verticalDistance",void 0);a([c.property({readOnly:!0})],f.prototype,"geodesicDistance",void 0);a([c.property({readOnly:!0})],
f.prototype,"geodesicAngle",void 0);a([c.property({readOnly:!0,dependsOn:["horizontalDistance","geodesicMeasurementDistanceThreshold"]})],f.prototype,"geodesicDistanceExceeded",null);a([c.property({readOnly:!0,dependsOn:["horizontalDistance","unit","geodesicDistanceExceeded"]})],f.prototype,"measurementMode",null);a([c.property({readOnly:!0,dependsOn:["unit","measurementMode","startPoint","endPoint","triangleCollapseRatioThreshold"]})],f.prototype,"triangleView",null);a([c.property()],f.prototype,
"triangleCollapseRatioThreshold",void 0);a([c.property()],f.prototype,"geodesicMeasurementDistanceThreshold",void 0);return f=a([c.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DModel")],f)}(c.declared(b))})},"esri/views/3d/interactive/measurementTools/support/Quantity":function(){define(["require","exports","./unitUtils"],function(w,t,p){return function(){function a(a,e){this.measure=p.measureForUnit(e);this.value=a;this.unit=e}Object.defineProperty(a.prototype,
"isBaseUnit",{get:function(){return p.isBaseUnit(this.unit)},enumerable:!0,configurable:!0});a.prototype.toUnit=function(b){return new a(p.convertUnit(this.value,this.unit,b),b)};a.prototype.toBaseUnit=function(){return this.toUnit(p.baseUnitForUnit(this.unit))};a.prototype.toDecimalString=function(a,e){void 0===a&&(a=2);return p.formatDecimal(this.value,this.unit,a,e)};return a}()})},"esri/views/3d/interactive/measurementTools/support/unitUtils":function(){define(["require","exports","dojo/i18n!./nls/Units",
"dojo/number","../../../../../geometry/support/scaleUtils"],function(w,t,p,a,b){w={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1853.184},"us-feet":{inBaseUnits:1200/3937}};t={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*
.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:function(a){return a*a}(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};var e={length:{baseUnit:"meters",units:w},area:{baseUnit:"square-meters",units:t},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},
"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},u=function(){var a={},b;for(b in e)for(var d in e[b].units)a[d]=
b;return a}(),h;(function(c){function h(a){if(a=u[a])return a;throw Error("unknown measure");}function d(a){return e[a].baseUnit}function n(a,b){void 0===b&&(b=null);b=b||h(a);return e[b].baseUnit===a}function g(a,b,c){if(b===c)return a;var d=h(b);if(d!==h(c))throw Error("incompatible units");a=n(b,d)?a:a*e[d].units[b].inBaseUnits;return n(c,d)?a:a/e[d].units[c].inBaseUnits}function t(a,b){return p.units[a][b]}function k(b,c,d,e){void 0===d&&(d=2);void 0===e&&(e="abbr");return a.format(b,{places:d})+
" "+t(c,e)}function w(a,b){return 3E3>g(a,b,"meters")?"meters":"kilometers"}function z(a,b){return 1E5>g(a,b,"meters")?"meters":"kilometers"}function C(a,b){return 1E3>g(a,b,"feet")?"feet":"miles"}function A(a,b){return 1E5>g(a,b,"feet")?"feet":"miles"}function E(a,b){return 3E6>g(a,b,"square-meters")?"square-meters":"square-kilometers"}function D(a,b){return 1E6>g(a,b,"square-feet")?"square-feet":"square-miles"}c.measureForUnit=h;c.baseUnitForMeasure=d;c.baseUnitForUnit=function(a){return d(h(a))};
c.isBaseUnit=n;c.convertUnit=g;c.unitName=t;c.formatDecimal=k;c.preferredMetricLengthUnit=w;c.preferredMetricVerticalLengthUnit=z;c.formatMetricLength=function(a,b,c,d){void 0===c&&(c=2);void 0===d&&(d="abbr");var e=w(a,b);return k(g(a,b,e),e,c,d)};c.formatMetricVerticalLength=function(a,b,c,d){void 0===c&&(c=2);void 0===d&&(d="abbr");var e=z(a,b);return k(g(a,b,e),e,c,d)};c.preferredImperialLengthUnit=C;c.preferredImperialVerticalLengthUnit=A;c.formatImperialLength=function(a,b,c,d){void 0===c&&
(c=2);void 0===d&&(d="abbr");var e=C(a,b);return k(g(a,b,e),e,c,d)};c.formatImperialVerticalLength=function(a,b,c,d){void 0===c&&(c=2);void 0===d&&(d="abbr");var e=A(a,b);return k(g(a,b,e),e,c,d)};c.preferredMetricAreaUnit=E;c.formatMetricArea=function(a,b,c,d){void 0===c&&(c=2);void 0===d&&(d="abbr");var e=E(a,b);return k(g(a,b,e),e,c,d)};c.preferredImperialAreaUnit=D;c.formatImperialArea=function(a,b,c,d){void 0===c&&(c=2);void 0===d&&(d="abbr");var e=D(a,b);return k(g(a,b,e),e,c,d)};c.formatDMS=
function(a,b,d){void 0===d&&(d=2);a=c.convertUnit(a,b,"degrees");b=a-Math.floor(a);a-=b;b*=60;var e=b-Math.floor(b);b-=e;e*=60;return a.toFixed()+"\u00b0 "+b.toFixed()+"' "+e.toFixed(d)+'"'};c.defaultUnitForSpatialReference=function(a){if(!a)return null;switch(b.getUnitString(a)){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric"}return null}})(h||(h={}));return h})},"esri/views/3d/interactive/measurementTools/support/quantityUtils":function(){define(["require","exports","./unitUtils"],function(w,t,p){var a;(function(a){a.formatDecimal=function(a,b,h,c){void 0===h&&(h=2);void 0===c&&(c="abbr");return p.formatDecimal(a.toUnit(b).value,b,h,c)};a.formatMetricLength=function(a,b,h){void 0===b&&(b=2);void 0===h&&(h="abbr");if("length"!==a.measure)throw Error("quantity is not a length");
return p.formatMetricLength(a.value,a.unit,b,h)};a.formatMetricVerticalLength=function(a,b,h){void 0===b&&(b=2);void 0===h&&(h="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return p.formatMetricVerticalLength(a.value,a.unit,b,h)};a.formatMetricArea=function(a,b,h){void 0===b&&(b=2);void 0===h&&(h="abbr");if("area"!==a.measure)throw Error("quantity is not an area");return p.formatMetricArea(a.value,a.unit,b,h)};a.formatImperialLength=function(a,b,h){void 0===b&&(b=2);void 0===
h&&(h="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return p.formatImperialLength(a.value,a.unit,b,h)};a.formatImperialVerticalLength=function(a,b,h){void 0===b&&(b=2);void 0===h&&(h="abbr");if("length"!==a.measure)throw Error("quantity is not a length");return p.formatImperialVerticalLength(a.value,a.unit,b,h)};a.formatImperialArea=function(a,b,h){void 0===b&&(b=2);void 0===h&&(h="abbr");if("area"!==a.measure)throw Error("quantity is not an area");return p.formatImperialArea(a.value,
a.unit,b,h)};a.formatDMS=function(a){if("angle"!==a.measure)throw Error("quantity is not an angle");return p.formatDMS(a.value,a.unit)}})(a||(a={}));return a})},"esri/views/3d/interactive/measurementTools/support/UnitNormalizer":function(){define(["require","exports","../../../../../geometry/support/scaleUtils"],function(w,t,p){return function(){function a(a,e){void 0===a&&(a=null);void 0===e&&(e=null);this.spatialReference=a;this.ignoredSpatialReferences=e;this._updateNormalizationFactors}Object.defineProperty(a.prototype,
"spatialReference",{get:function(){return this._spatialReference},set:function(a){a!==this._spatialReference&&(this._spatialReference=a,this._updateNormalizationFactors())},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"ignoredSpatialReferences",{get:function(){return this._ignoredSpatialReferences},set:function(a){this._ignoredSpatialReferences=a;this._updateNormalizationFactors()},enumerable:!0,configurable:!0});a.prototype.normalizeDistance=function(a){return a*this._metersPerDistanceUnit};
a.prototype.normalizeElevation=function(a){return a*this._metersPerElevationUnit};a.prototype.normalizeArea=function(a){return a*this._squareMetersPerAreaUnit};a.prototype._updateNormalizationFactors=function(){var a=this;!this._spatialReference||this._ignoredSpatialReferences&&0!==this._ignoredSpatialReferences.filter(function(b){return b.equals(a._spatialReference)}).length?this._squareMetersPerAreaUnit=this._metersPerDistanceUnit=this._metersPerDistanceUnit=1:(this._metersPerDistanceUnit=p.getMetersPerUnitForSR(this._spatialReference),
this._metersPerElevationUnit=p.getMetersPerVerticalUnitForSR(this._spatialReference),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit)};return a}()})},"widgets/Measurement3D/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:esri/views/3d/interactive/measurementTools/directLineMeasurement3D/LaserLine.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"fsLaserLine"\x3e\x3c![CDATA[\r\n#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\n  $fsprecisionf\r\n\r\n  varying vec2 uv;\r\n\r\n  uniform sampler2D depthMap;\r\n\r\n  uniform vec2 nearFar;\r\n  uniform vec4 projInfo;\r\n  uniform float maxPixelDistance;\r\n\r\n  // focus plane in camera space\r\n  uniform vec4 focusPlane;\r\n\r\n  // focus sphere in camera space\r\n  uniform vec4 focusSphere;\r\n\r\n  // segment plane in camera space\r\n  uniform vec4 segmentPlane;\r\n\r\n  // line segment\r\n  uniform vec3 segmentStart;\r\n  uniform vec3 segmentEnd;\r\n\r\n  // styling\r\n  uniform vec3 glowColor;\r\n  uniform float glowWidth;\r\n  uniform vec3 innerColor;\r\n  uniform float innerWidth;\r\n  uniform float globalAlpha;\r\n\r\n  #define INFINITY 100000.0\r\n\r\n  $rgba2float\r\n\r\n  // reconstruct depth value from linear depth map\r\n  float linearDepth(vec2 uv) {\r\n    return -(rgba2float(texture2D(depthMap, uv)) * (nearFar[1] - nearFar[0]) + nearFar[0]);\r\n  }\r\n\r\n  // reconstruct position in view space\r\n  vec3 reconstructPosition(vec2 fragCoord, float depth) {\r\n    return vec3((fragCoord * projInfo.xy + projInfo.zw) * depth, depth);\r\n  }\r\n\r\n#ifdef GL_OES_standard_derivatives\r\n  float planeDistancePixels(vec4 plane, vec3 pos) {\r\n    // compute distance to plane\r\n    float dist \x3d dot(plane.xyz, pos) + plane.w;\r\n    // compute derivative of distance function with respect to pixels\r\n    float width \x3d fwidth(dist);\r\n    // normalize distance by the derivative to get a measurement with respect to pixels\r\n    // the clamping is used to prevent excessive artifacts along depth discontinuities\r\n    dist /\x3d min(width, maxPixelDistance);\r\n    return abs(dist);\r\n  }\r\n\r\n  float sphereDistancePixels(vec4 sphere, vec3 pos) {\r\n    // compute distance to sphere\r\n    float dist \x3d distance(sphere.xyz, pos) - sphere.w;\r\n    // compute derivative of distance function with respect to pixels\r\n    float width \x3d fwidth(dist);\r\n    // normalize distance by the derivative to get a measurement with respect to pixels\r\n    // the clamping is used to prevent excessive artifacts along depth discontinuities\r\n    dist /\x3d min(width, maxPixelDistance);\r\n    return abs(dist);\r\n  }\r\n#endif\r\n\r\n  vec4 blendPremultiplied(vec4 source, vec4 dest) {\r\n    float oneMinusSourceAlpha \x3d 1.0 - source.a;\r\n\r\n    return vec4(\r\n      source.rgb + dest.rgb * oneMinusSourceAlpha,\r\n      source.a + dest.a * oneMinusSourceAlpha\r\n    );\r\n  }\r\n\r\n  vec4 premultipliedColor(vec3 rgb, float alpha) {\r\n    return vec4(rgb * alpha, alpha);\r\n  }\r\n\r\n  // computes laser line color based on distance in pixels\r\n  vec4 laserLineProfile(float dist) {\r\n    if (dist \x3e glowWidth) {\r\n      return vec4(0.0);\r\n    }\r\n\r\n    float innerAlpha \x3d (1.0 - smoothstep(0.0, innerWidth, dist));\r\n    float glowAlpha \x3d pow(max(0.0, 1.0 - dist / glowWidth), 8.0);\r\n\r\n    return blendPremultiplied(\r\n      premultipliedColor(innerColor, innerAlpha),\r\n      premultipliedColor(glowColor, glowAlpha)\r\n    );\r\n  }\r\n\r\n  void main() {\r\n#ifdef GL_OES_standard_derivatives\r\n    // do not draw laserline on background\r\n    float depth \x3d linearDepth(uv);\r\n    if (-depth \x3d\x3d nearFar[0]) {\r\n      discard;\r\n    }\r\n\r\n    // reconstruct position in view space\r\n    vec3 pos \x3d reconstructPosition(gl_FragCoord.xy, depth);\r\n\r\n    // empirical hack to fade out laser line in problematic areas:\r\n    // the derivatives to normalize the distance function are valid inside smooth surfaces,\r\n    // but break down at depth discontinuities (e.g. edges). We fade out the laser lines in\r\n    // areas where depth valus have large variations in order to avoid this problem.\r\n    float ddepth \x3d fwidth(depth);\r\n    float depthDiscontinuityAlpha \x3d 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);\r\n\r\n    // reconstruct normal using derivatives\r\n    vec3 normal \x3d normalize(cross(dFdx(pos), dFdy(pos)));\r\n\r\n    // distance to focus plane\r\n    float focusPlaneDistance \x3d planeDistancePixels(focusPlane, pos);\r\n\r\n    // distance to focus sphere\r\n    float focusSphereDistance \x3d sphereDistancePixels(focusSphere, pos);\r\n\r\n    // distance to segment plane\r\n    float segmentDistance \x3d INFINITY;\r\n    float segmentLength \x3d length(segmentEnd - segmentStart);\r\n    vec3 segmentDir \x3d (segmentEnd - segmentStart) / segmentLength;\r\n    float t \x3d dot(segmentDir, pos - segmentStart);\r\n\r\n    if (segmentLength \x3e 0.0 \x26\x26 t \x3e\x3d 0.0 \x26\x26 t \x3c\x3d segmentLength) {\r\n      segmentDistance \x3d planeDistancePixels(segmentPlane, pos);\r\n    }\r\n\r\n    // evaluate color profile for both planes and the sphere\r\n    vec4 focusPlaneColor \x3d laserLineProfile(focusPlaneDistance);\r\n    vec4 focusSphereColor \x3d laserLineProfile(focusSphereDistance);\r\n    vec4 segmentColor \x3d laserLineProfile(segmentDistance);\r\n\r\n    // empirical hack to fade out laser line when planes are nearly parallel\r\n    float focusPlaneAlpha \x3d 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, focusPlane.xyz)));\r\n    float focusSphereAlpha \x3d 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, normalize(pos - focusSphere.xyz))));\r\n    float segmentAlpha \x3d 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, segmentPlane.xyz)));\r\n\r\n    // combine colors\r\n    vec4 color \x3d max(\r\n      focusPlaneColor * focusPlaneAlpha,\r\n      max(\r\n        focusSphereColor * focusSphereAlpha,\r\n        segmentColor * segmentAlpha\r\n      )\r\n    );\r\n\r\n    gl_FragColor \x3d color * globalAlpha * depthDiscontinuityAlpha;\r\n#else\r\n    // we might compute the derivatives ourselves, but because\r\n    // GL_OES_standard_derivatives should be widely supported we just\r\n    // disable laser lines when support is missing.\r\n    gl_FragColor \x3d vec4(0.0);\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:widgets/Measurement3D/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"measurement-button-wrapper" data-dojo-attach-point\x3d"measurementButtonDiv"\x3e\r\n\t\t\x3cbutton data-dojo-attach-point\x3d"measurementButton"\x3e\x3c/button\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"measurementDiv" class\x3d"hidden"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Measurement3D/css/style.css":".esri-direct-line-measurement-3d {pointer-events: auto;}.jimu-widget-measurement .hidden {display: none !important;}.jimu-widget-measurement .esri-button {height: 32px; cursor: pointer; font-family: inherit; font-size: 14px;}.jimu-widget-measurement .measurement-button-wrapper {padding: 12px 15px;}",
"*now":function(w){w(['dojo/i18n!*preload*widgets/Measurement3D/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/dom-class dojo/Deferred jimu/BaseWidget esri/widgets/DirectLineMeasurement3D dojo/i18n!esri/widgets/DirectLineMeasurement3D/nls/DirectLineMeasurement3D".split(" "),function(w,t,p,a,b,e,u,h){return w([e],{baseClass:"jimu-widget-measurement",name:"Measurement",measurementWidget:null,CSS:{clearButton:"esri-direct-line-measurement-3d__clear-button"},postCreate:function(){this.inherited(arguments);this.measurementButton.textContent=h.newMeasurement;
this.measurementButton.className="esri-button "+this.CSS.clearButton;this.own(p(this.measurementButton,"click",t.hitch(this,function(){this.activate()})))},startup:function(){this.inherited(arguments)},destroy:function(){this.measurementWidget&&this.measurementWidget.destroy();this.inherited(arguments)},onClose:function(){this.measurementWidget&&(this.measurementWidget.viewModel.tool.stop(),this.measurementWidget.viewModel.tool.deactivate(),"ready"===this.measurementWidget.viewModel.state&&this.resetUI())},
onActive:function(){this.activate()},onDeActive:function(){this.onClose()},_applyConfig:function(a){a&&this.measurementWidget&&(a.measurement&&a.measurement.lengthUnit?this.measurementWidget.unit=a.measurement.lengthUnit:a.defaultLengthUnit&&(this.measurementWidget.unit=a.defaultLengthUnit))},_createWidget:function(){this._ensureWidget().then(t.hitch(this,function(a){this._applyConfig(this.config)}))},_ensureWidget:function(){var a=new b;if(!this.measurementWidget){var e=document.createElement("div");
window.test=this.measurementWidget=new u({container:e,view:this.sceneView});this.measurementDiv.appendChild(e)}a.resolve(this.measurementWidget);return a},activate:function(){a.add(this.measurementButtonDiv,"hidden");a.remove(this.measurementDiv,"hidden");this._createWidget();this.measurementWidget&&this.measurementWidget.viewModel&&this.measurementWidget.viewModel.tool&&this.measurementWidget.viewModel.tool.activate()},resetUI:function(){a.remove(this.measurementButtonDiv,"hidden");a.add(this.measurementDiv,
"hidden")}})});