// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(u,m,k,b,h){return k("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var t=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);h.parse(t,{noStart:!this._earlyTemplatedStartup,
template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(b.hitch(this,function(g){this._startupWidgets=g;for(var b=0;b<g.length;b++)this._processTemplateNode(g[b],function(g,f){return g[f]},function(g,f,e){return f in g?g.connect(g,f,e):g.on(f,e,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");
}},_processTemplateNode:function(b,g,h){return g(b,"dojoType")||g(b,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){u.forEach(this._startupWidgets,function(b){b&&!b._started&&b.startup&&b.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"widgets/3DFx/VizCards/VizCards":function(){define("dojo/Evented dojo/_base/declare dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/number dojo/on dojo/query dojox/gfx dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/VizCards.html".split(" "),
function(u,m,k,b,h,t,g,q,r,f,e,l,v,w,y,x){return m("VizCards",[w,y,u],{declaredClass:"esri.widgets.VizCards",templateString:x,css:{root:"esri-viz-cards",content:"content"},constructor:function(a,c){this.rtl=!1;this.options={view:null,features:[],vizField:null,displayField:null,color:"#ff0000",showPercent:!1};h.mixin(this.options,a);this.domNode=c;this._currentSelectedCardNode=null},postCreate:function(){this.inherited(arguments);0<l(".dj_rtl").length&&(this.rtl=!0);this.own(e(this.contentNode,"click",
h.hitch(this,this._clickCard)))},startup:function(){this.inherited(arguments);this._updateCards()},destroy:function(){this.view=null;this.inherited(arguments)},clear:function(){this.containerNode.innerHTML=""},update:function(a){h.mixin(this.options,a);this._updateCards()},selectCard:function(a){var c=this.domNode.id+"_card_"+a;this.unselectCards();if(c=l("#"+c,this.domNode)[0])g.add(c,"selected"),this._currentSelectedCardNode=c;var c=t.getContentBox(this.containerNode).w,d=180*a-c/2+90;this.rtl&&
(d=180*(this.options.features.length-a)-c/2-90);0>d&&(d=0);this.containerNode.scrollLeft=d},unselectCards:function(){this._currentSelectedCardNode&&(g.remove(this._currentSelectedCardNode,"selected"),this._currentSelectedCardNode=null)},_getTotal:function(){var a=this.options.vizField,c=0;k.forEach(this.options.features,function(d){c+=d.attributes[a]});return c},_updateCards:function(){var a=this.contentNode;r.set(a,"color",this.options.color);var c=this.options.features,d=this._getTotal();a.innerHTML=
"";var n=0;this.rtl&&(n=180*c.length);this.containerNode.scrollLeft=n;r.set(a,"width",180*c.length+"px");for(var n=c.length,p=null,b,e,h=null,m=this.options.showPercent&&400>=n,l=0;l<n;l++){p=c[l];b=p.attributes;p=b[this.options.vizField];e=f.format(p);h||(h=Math.floor(150/e.length+3),10>h&&(h=10),60<h&&(h=60));var k=b[this.options.displayField];null!==p&&(b=q.create("div",{id:this.domNode.id+"_card_"+l},a),g.add(b,"card"),k=q.create("div",{innerHTML:l+1+". "+k},b),g.add(k,"header"),e=q.create("div",
{innerHTML:e},b),m?(g.add(e,"value"),e=parseInt(p/d*100,10),k=e+"%",0<p&&1>e&&(k="\x3c1%"),b=q.create("div",{},b),g.add(b,"area"),p=q.create("div",{},b),g.add(p,"chart"),b=q.create("div",{innerHTML:k},b),g.add(b,"pct"),this._createChart(p,e)):(g.add(e,"valueBig"),r.set(e,"fontSize",h+"px")))}},_createChart:function(a,c){var d=t.getContentBox(a),n=Math.min(d.w,d.h),d=n/2,p=n/2,e=d-3;a=v.createSurface(a,n,n);a.clear();a.createCircle({cx:d,cy:p,r:e}).setStroke({width:6,color:b.fromArray([255,255,255,
.15]),cap:"round"});0<c&&(100<=c&&(c=99),n=360*c/100,c=!1,180<=n&&(c=!0),n=this._getEndPoint(e,n,d,p),p-=e,a.createPath().moveTo(d,p).arcTo(e,e,0,c,!0,n.x,n.y).setStroke({width:6,color:this.options.color,cap:"round"}))},_getEndPoint:function(a,c,d,b){var e=c;0<c&&90>c?e+=270:90<c&&(e=c-90);c=e*Math.PI/180;return{x:d+Math.cos(c)*a,y:b+Math.sin(c)*a}},_clickCard:function(a){a=a.target||a.srcElement;if(!g.contains(a,"card"))for(;a&&a.parentNode&&(a=a.parentNode,!g.contains(a,"card")););if(a){var c=a.id.replace(this.domNode.id+
"_card_",""),c=parseInt(c,10);isNaN(c)||null==c||(g.contains(a,"selected")?(this.unselectCards(),this.emit("selection",{})):(this.unselectCards(),g.add(a,"selected"),this._currentSelectedCardNode=a,this.emit("selection",{data:this.options.features[c]})))}}})})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(u,m,k){m.switchTo(k);return m})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(u,m,k,b,h,t,g,q,r){var f=m.getObject("dojox.gfx",!0),e=f._base={};f._hasClass=function(a,c){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+c+" ")};f._addClass=function(a,c){var d=a.getAttribute("className")||"";(!d||0>(" "+d+" ").indexOf(" "+c+" "))&&a.setAttribute("className",d+(d?" ":"")+c)};f._removeClass=function(a,c){var d=a.getAttribute("className");d&&a.setAttribute("className",d.replace(new RegExp("(^|\\s+)"+c+"(\\s+|$)"),"$1$2"))};e._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,d;b("ie")&&(d=h.doc.documentElement.style.fontSize||"",d||(h.doc.documentElement.style.fontSize="100%"));var e=q.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},h.body());for(c in a)e.style.fontSize=c,a[c]=16*Math.round(12*e.offsetHeight/16)/12/1E3;
b("ie")&&(h.doc.documentElement.style.fontSize=d);h.body().removeChild(e);return a};var l=null;e._getCachedFontMeasurements=function(a){if(a||!l)l=e._getFontMeasurements();return l};var v=null,w={};e._getTextBox=function(a,c,d){var e,b,g=arguments.length,f;v||(v=q.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},h.body()));e=v;e.className="";b=e.style;b.borderWidth="0";b.margin="0";b.padding="0";b.outline="0";if(1<g&&c)for(f in c)f in w||(b[f]=c[f]);2<g&&d&&(e.className=
d);e.innerHTML=a;e.getBoundingClientRect?(b=e.getBoundingClientRect(),b={l:b.left,t:b.top,w:b.width||b.right-b.left,h:b.height||b.bottom-b.top}):b=r.getMarginBox(e);e.innerHTML="";return b};e._computeTextLocation=function(a,c,d,b){var e={};switch(a.align){case "end":e.x=a.x-c;break;case "middle":e.x=a.x-c/2;break;default:e.x=a.x}e.y=a.y-d*(b?.75:1);return e};e._computeTextBoundingBox=function(a){if(!f._base._isRendered(a))return{x:0,y:0,width:0,height:0};var c;c=a.getShape();var d=a.getFont()||f.defaultFont;
a=a.getTextWidth();d=f.normalizedLength(d.size);c=e._computeTextLocation(c,a,d,!0);return{x:c.x,y:c.y,width:a,height:d}};e._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var y=0;e._getUniqueId=function(){var a;do a=u._scopeName+"xUnique"+ ++y;while(g.byId(a));return a};var x=b("pointer-events")?"touchAction":b("MSPointer")?"msTouchAction":null;e._fixMsTouchAction=x?function(a){a.rawNode.style[x]="none"}:function(){};m.mixin(f,{defaultPath:{type:"path",path:""},
defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},
defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a=
{};return function(c){var d=a[c];if(d)return new d;d=a[c]=new Function;d.prototype=f["default"+c];return new d}}(),normalizeColor:function(a){return a instanceof k?a:new k(a)},normalizeParameters:function(a,c){var d;if(c){var b={};for(d in a)d in c&&!(d in b)&&(a[d]=c[d])}return a},makeParameters:function(a,c){var d=null;if(!c)return m.delegate(a);var b={};for(d in a)d in b||(b[d]=m.clone(d in c?c[d]:a[d]));return b},formatNumber:function(a,c){var d=a.toString();if(0<=d.indexOf("e"))d=a.toFixed(4);
else{var b=d.indexOf(".");0<=b&&5<d.length-b&&(d=a.toFixed(4))}return 0>a?d:c?" "+d:d},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var c=f.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){c.style=a[0];c.variant=a[1];c.weight=a[2];var d=a[3].indexOf("/");c.size=0>d?a[3]:a[3].substring(0,d);var b=4;0>d&&("/"==a[4]?b=6:"/"==a[4].charAt(0)&&(b=5));b<a.length&&(c.family=a.slice(b).join(" "))}return c},cm_in_pt:72/2.54,mm_in_pt:7.2/
2.54,px_in_pt:function(){return f._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*f.px_in_pt()},px2pt:function(a){return a/f.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var c=f.px_in_pt(),b=parseFloat(a);switch(a.slice(-2)){case "px":return b;case "pt":return b*c;case "in":return 72*b*c;case "pc":return 12*b*c;case "mm":return b*f.mm_in_pt*c;case "cm":return b*f.cm_in_pt*c}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,
pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,c){return a&&c&&a===c},switchTo:function(a){var c="string"==typeof a?f[a]:a;c&&(t.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){f[a]=c[a]}),"string"==typeof a?f.renderer=a:t.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return f.renderer=f[a]&&f[a].Surface===f.Surface?a:null}))}});return f})},
"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(u,m,k,b,h){var t=null;k.add("vml",function(b,h,k){k.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';b="adj"in k.firstChild;k.innerHTML="";return b});return{load:function(g,q,r){function f(){q(["dojox/gfx/"+e],function(b){u.renderer=e;t=b;r(b)})}if(t&&"force"!=g)r(t);else{var e=h.forceGfxRenderer;g=!e&&(m.isString(h.gfxRenderer)?h.gfxRenderer:"svg,vml,canvas,silverlight").split(",");
for(var l,v;!e&&g.length;)switch(g.shift()){case "svg":"SVGAngle"in b.global&&(e="svg");break;case "vml":k("vml")&&(e="vml");break;case "silverlight":try{k("ie")?(l=new ActiveXObject("AgControl.AgControl"),l.IsVersionSupported("1.0"))&&(v=!0):navigator.plugins["Silverlight Plug-In"]&&(v=!0)}catch(w){v=!1}finally{l=null}v&&(e="silverlight");break;case "canvas":b.global.CanvasRenderingContext2D&&(e="canvas")}"canvas"===e&&!1!==h.canvasEvents&&(e="canvasWithEvents");h.isDebug&&console.log("gfx renderer \x3d "+
e);"svg"==e&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(f):f()}}}})},"widgets/3DFx/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/3DFx/VizCards/templates/VizCards.html":'\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"${css.root}" role\x3d"presentation"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"contentNode" class\x3d"${css.content}"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/3DFx/Widget.html":'\x3cdiv\x3e\r\n  \x3ccanvas class\x3d"labelCanvas" data-dojo-attach-point\x3d"labelCanvas"\x3e\x3c/canvas\x3e\r\n  \x3cdiv class\x3d"panelBottom"\x3e\r\n    \x3c!--Panel Container --\x3e\r\n    \x3cdiv class\x3d"panelContainer"\x3e\r\n      \x3c!-- Panel Inner --\x3e\r\n      \x3cdiv class\x3d"panelInner"\x3e\r\n        \x3c!-- Panel Content --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"panelMsgBlock"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"panelContent" class\x3d"panelContent"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Panel Footer --\x3e\r\n    \x3cdiv class\x3d"panelFooter" data-dojo-attach-point\x3d"footerNode" class\x3d"jimu-main-background"\x3e\r\n      \x3cdiv class\x3d"panelFooterContent"\x3e\r\n        \x3cdiv class\x3d"btnPlay" data-dojo-attach-point\x3d"btnPlay" data-dojo-attach-event\x3d"onclick:_toggleVizTimer"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"panelTitle" data-dojo-attach-point\x3d"titleNode"\x3eTitle\x3c/div\x3e\r\n        \x3cdiv class\x3d"panelPages"\x3e\r\n          \x3cul class\x3d"pages" data-dojo-attach-point\x3d"pages"\x3e\r\n          \x3c/ul\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"btnClose" data-dojo-attach-point\x3d"btnClose" data-dojo-attach-event\x3d"onclick:_close"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/3DFx/css/style.css":".esri-viz-cards {position: absolute; width: 100%; height: 100%; overflow-x: auto; overflow-y: hidden;}.esri-viz-cards .content {margin: 0; padding: 0; width: auto; height: 100%; white-space: nowrap; overflow: visible;}.esri-viz-cards .card {position: relative; float: left; width: 150px; height: 100%; margin-left: 10px; margin-right: 20px; overflow: hidden; text-overflow: ellipsis; cursor: pointer; display: block;}.dj_rtl .esri-viz-cards .card {float: right;}.esri-viz-cards .card.selected {color: #ffffff;}.esri-viz-cards .header {position: absolute; width: 100%; height: 20px; line-height: 20px; font-size: 12px; border-bottom: 1px solid rgba(255, 255, 255, 0.25); overflow: hidden; text-overflow: ellipsis;}.esri-viz-cards .card.selected .header {border-bottom: 1px solid #ffffff;}.esri-viz-cards .value {position: absolute; top: 20px; width: 100%; height: 17px; line-height: 17px; font-size: 12px; overflow: hidden; text-overflow: ellipsis;}.esri-viz-cards .valueBig {position: absolute; top: 20px; width: 100%; height: 60px; line-height: 60px; font-size: 20px; overflow: hidden; text-overflow: ellipsis;}.esri-viz-cards .area {position: absolute; left: 30px; top: 37px; width: 80px; height: 70px; display: block;}.esri-viz-cards .chart {position: absolute; width: 100%; height: 100%; display: block;}.esri-viz-cards .pct {position: absolute; top: 50%; margin-top: -15px; width: 100%; height: 30px; line-height: 30px; font-size: 20px; text-align: center; overflow: hidden; text-overflow: ellipsis;}.esri-viz-cards::-webkit-scrollbar {width: 6px; height: 6px; background-color: rgba(255, 255, 255, 0.25);}.esri-viz-cards::-webkit-scrollbar-thumb {background-color: rgba(255, 255, 255, 0.5);}.esri-viz-cards {scrollbar-base-color: #000000; scrollbar-3dlight-color: #000000; scrollbar-highlight-color: #000000; scrollbar-track-color: #707070; scrollbar-arrow-color: #606060; scrollbar-shadow-color: #000000; scrollbar-dark-shadow-color: #000000; scrollbar-face-color: #606060;}.jimu-widget-viz {color: #ffffff; background-color: rgba(0,0,0,0.8); left: 0px !important; right: 0px !important; bottom: 0px; height: 160px !important; display: block; z-index: 100 !important; overflow: hidden;}.jimu-widget-viz .labelCanvas {position: absolute; top: -50px; height: 50px;}.jimu-widget-viz .panelBottom {position: absolute; width: 100%; height: 160px; left: 0px; top: 0px; color: #ffffff; padding: 0px;}.jimu-widget-viz .panelFooter {position: absolute; bottom: 0px; left: 0px; right: 0px; height: 40px; line-height: 40px; overflow: hidden; background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-bottom: 1px solid #353535; border-bottom: 1px solid rgba(0, 0, 0, 0.3);}.jimu-widget-viz .panelFooterContent {position: absolute; left: 10px; right: 24px; top: 8px; height: 24px; line-height: 24px; overflow-x: hidden; overflow-y: hidden; display: inline-block; white-space: nowrap; width: auto;}.jimu-rtl .jimu-widget-viz .panelFooterContent {position: absolute; left: 24px; right: 10px;}.jimu-widget-viz .panelTitle {float: left; margin-left: 10px; font-size: 14px;}.jimu-rtl .jimu-widget-viz .panelTitle {float: right; margin-right: 10px;}.jimu-widget-viz .panelPages {float: right;}.jimu-rtl .jimu-widget-viz .panelPages {float: left;}.jimu-widget-viz .pages {list-style-type: none; height: 24px; margin: auto; padding: 2px; display: block; cursor: pointer;}.jimu-widget-viz .pages li {width: 20px; height: 20px; display: inline-block; background: url(images/dot.png); margin: 0;}.jimu-widget-viz .pages li:hover {background: url(images/doton.png);}.jimu-widget-viz .pages li.active {background: url(images/doton.png);}.jimu-widget-viz .btnPlay {float: left; width: 24px; height: 24px; display: block; cursor: pointer; background-image: url('images/play.png'); background-repeat: no-repeat; background-position: center center; background-size: 24px;}.jimu-rtl .jimu-widget-viz .btnPlay {float: right;}.jimu-widget-viz .playing {background-image: url('images/pause.png'); background-repeat: no-repeat; background-position: center center; background-size: 24px;}.jimu-widget-viz .btnClose {position: absolute; left: auto; right: 0px; width: 24px; height: 40px; line-height: 40px; text-align: center; display: block; cursor: pointer; background-image: url('images/x.png'); background-repeat: no-repeat; background-position: center center; background-size: 18px;}.jimu-rtl .jimu-widget-viz .btnClose {position: absolute; left: 0px; right: auto;}.jimu-widget-viz .panelContainer {position: absolute; width: 100%; height: 120px; overflow: hidden; display: block;}.jimu-widget-viz .panelInner {position: absolute; top: 3px; left: 0px; right: 0px; height: 117px; display: block; overflow: hidden;}.jimu-widget-viz .loading {background-image: url('images/loading.gif'); background-repeat: no-repeat; background-position: center 10px;}",
"*now":function(u){u(['dojo/i18n!*preload*widgets/3DFx/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/Color dojo/_base/html dojo/_base/lang dojo/_base/array dojo/_base/xhr dojo/Deferred dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/number dojo/on dojo/query dojo/json dijit/_WidgetsInTemplateMixin esri/request esri/Graphic esri/layers/GraphicsLayer esri/geometry/Point esri/geometry/support/webMercatorUtils esri/symbols/PictureMarkerSymbol esri/symbols/PointSymbol3D esri/symbols/ObjectSymbol3DLayer esri/tasks/QueryTask esri/tasks/support/Query jimu/BaseWidget jimu/dijit/Message jimu/utils jimu/dijit/LoadingShelter fx3d/layers/FxLayer ./VizCards/VizCards dojo/domReady!".split(" "),function(u,
m,k,b,h,t,g,q,r,f,e,l,v,w,y,x,a,c,d,n,p,E,F,G,H,I,J,z,K,A,B,C,D){return u([z,a],{baseClass:"jimu-widget-viz",name:"3DFx",postCreate:function(){this.inherited(arguments);this.vizFeatures=[];this.vizMax=0;this.vizCards=null;this.vizPage=0;this._featuresLoadedDfd=new g;this._sortedFeatures={}},startup:function(){this.inherited(arguments);this.loadingCover=new B({hidden:!0});this.loadingCover.placeAt(this.sceneView.map.id);this.loadingCover.startup();this._getStyleColor();var a=this._getStyleColor();
this.panelMsgBlock.innerHTML="";a.then(b.hitch(this,function(){this.config.vizLayer&&0!==this.config.vizFields.length?(this.loadingCover.show(),c(this.config.vizLayer.url+"/query",{query:{f:"json",returnGeometry:!1,returnCountOnly:!0,where:"1\x3d1"},callbackParamName:"callback"}).then(b.hitch(this,function(a){a.data.count?400<a.data.count?this.config.showPercent=!1:this.panelMsgBlock.innerHTML="":this.panelMsgBlock.innerHTML="";this._initUI();this._initLayers();this._initViz()}))):this.panelMsgBlock.innerHTML=
"\x3cp align\x3d'center'\x3e"+this.nls.viz_error+"\x3c/p\x3e"}))},onOpen:function(){this.inherited(arguments);this.loadingCover.hidden&&this.loadingCover.show();this._styleSync();this._showLayers()},onClose:function(){this._hideLayers();this._stopVizTimer();this.loadingCover.hide();this.vizCards&&this.vizCards.unselectCards();this.inherited(arguments)},onDeActive:function(){},destroy:function(){this._stopVizTimer();this._removeFxLayer();this._sortedFeatures={};this._featuresLoadedDfd=null;this.loadingCover.destroy();
this.inherited(arguments)},_close:function(){this.widgetManager.closeWidget(this.id)},_styleSync:function(){if(this.appConfig.theme.customStyles){var a=this.appConfig.theme.customStyles.mainBackgroundColor;l.set(this.footerNode,"backgroundColor",a);this.vizCards&&l.set(this.vizCards.contentNode,"color",a);this.config.color=a;this._updatePath();this.fxLayer&&this.fxLayer.set("renderingInfo",this._getRenderingInfo())}else this._updateUI(this.appConfig.theme.styles[0])},onAppConfigChanged:function(a,
b,c){this.appConfig=a;if("closed"!=this.state)switch(b){case "styleChange":this._styleSync()}},setPosition:function(a,b){if("BoxTheme"===this.appConfig.theme.name||"DartTheme"===this.appConfig.theme.name||"LaunchpadTheme"===this.appConfig.theme.name)this.inherited(arguments);else{this.position={left:"0px",right:"0px",bottom:"0px",height:"140px"};var c=A.getPositionStyle(this.position);c.position="absolute";b=this.sceneView.map.id;k.place(this.domNode,b);k.setStyle(this.domNode,c);this.started&&this.resize();
"TabTheme"===this.appConfig.theme.name&&(c=this.widgetManager.getControllerWidgets()[0],this.widgetManager.minimizeWidget(c.id))}},_updatePath:function(){this.vizCards&&this.vizCards.update({color:this._getColor()})},_updateUI:function(a){this._getStyleColor(a).then(b.hitch(this,function(){this.fxLayer&&(this._updatePath(),this.fxLayer.set("renderingInfo",this._getRenderingInfo()))}))},_getStyleColor:function(a){var c=new g;if(this.appConfig.theme.customStyles&&this.appConfig.theme.customStyles.mainBackgroundColor)return this.config.color=
this.appConfig.theme.customStyles.mainBackgroundColor,c.resolve(this.appConfig.theme.customStyles.mainBackgroundColor),c.promise;var d=this.appConfig.theme.name,e=this.appConfig.theme.styles[0];a&&(e=a);t.get({url:"./themes/"+d+"/manifest.json",handleAs:"json",load:b.hitch(this,function(a){a=a.styles;for(var b=0;b<a.length;b++){var d=a[b];d.name===e&&(l.set(this.footerNode,"backgroundColor",d.styleColor),this.vizCards&&l.set(this.vizCards.contentNode,"color",d.styleColor),this.config.color=d.styleColor,
c.resolve(d.styleColor))}})});return c.promise},_initUI:function(){this.vizCards=new D({view:this.sceneView,showPercent:this.config.showPercent},this.panelContent);this.vizCards.on("selection",b.hitch(this,this._featureSelection));this.vizCards.startup();"global"===this.sceneView.viewingMode?l.set(this.btnPlay,"display","block"):l.set(this.btnPlay,"display","none")},_initLayers:function(){this.sceneView.map.findLayerById(this.config.vizLayer.id).then(b.hitch(this,function(a){this.vizLayer=a;this.vizLayerVisibility=
a.visible;this.vizLayer.visible=!1;this._addFxLayer()}))},_getColor:function(){if(this.config.cycleColors){var a=this.vizPage,b=this.config.colors.length;return this.config.colors[a-Math.floor(a/b)*b]}return this.config.color},_getColors:function(){var a=this._getColor(),b=m.fromString("#ffffff"),a=m.fromString(a),c=m.blendColors(a,b,.3),b=m.blendColors(a,b,.8);return[a.toRgb(),c.toRgb(),b.toRgb()]},_getRenderingInfo:function(){var a=this._getColors(),b;switch(this.config.vizType){case "PointExtrude":b=
{visible:!0,repeat:1,animationInterval:this.config.interval/1E3,shapeType:"Cylinder",radius:this.config.maxWidth,height:this.config.maxHeight,transparency:100,bottomColor:a[0],topColors:[a[0],a[1]]};break;case "Pulse":b={visible:!0,repeat:1E3,animationInterval:this.config.interval/1E3,shapeType:"Circle",radius:this.config.maxWidth,transparency:80,solidColor:a[0],haloColor:a[1]};break;case "Bounce":b={visible:!0,repeat:1E3,animationInterval:this.config.interval/1E3,dashHeight:this.config.maxHeight,
radius:100,transparency:100,haloColors:a};break;case "GridSurface":b={visible:!0,repeat:1,animationInterval:this.config.interval/1E3,width:this.config.maxWidth,height:this.config.maxHeight,transparency:60,colors:[a[0],a[1],a[2]]};break;case "Fireball":case "JetTrail":b={visible:!0,repeat:1E3,animationInterval:this.config.interval/1E3,radius:30,transparency:90,colors:[a[0],a[0]]};break;case "AreaExtrude":b={visible:!0,repeat:1,animationInterval:this.config.interval/1E3,height:this.config.maxHeight,
transparency:100,bottomColor:a[0],topColors:[a[0],a[1]]}}"JetTrail"==this.config.vizType&&(b.showEndPoints=this.config.showJetTrailEndPoints);return b},_removeFxLayer:function(){this.fxLayer&&(this.fxLayer.remove(),this.fxLayer=null)},_addFxLayer:function(){this._removeFxLayer();var a=this._getRenderingInfo(),c=[];h.forEach(this.config.vizFields,function(a){c.push(a.field)});this.fxLayer=new C(this.config.vizLayer.url,{vizType:this.config.vizType,vizFields:c,displayField:this.config.displayField,
renderingInfo:a});this.fxLayer.on("all-features-loaded",b.hitch(this,this._allFeaturesLoaded));this.fxLayer.on("selected-feature-from-globe",b.hitch(this,this._selectedFeatureFromGlobe));this.fxLayer.on("abandon-selected-feature",b.hitch(this,this._abandonSelectedFeature));this.fxLayer.on("fx3d-ready",function(){this.loadingCover.hide()}.bind(this));this.fxLayer.watch("visible",b.hitch(this,function(a,b,c,d){!1===a&&this._stopVizTimer()}));this.sceneView.map.add(this.fxLayer)},_selectedFeatureFromGlobe:function(a){this.fxLayer&&
this.fxLayer.hideLabel();this._featuresLoadedDfd.then(function(){if(a.selectedFeature){var b=this._getFeatureIndex(a.selectedFeature);this.vizCards&&this.vizCards.selectCard(b)}}.bind(this))},_abandonSelectedFeature:function(a){this.vizCards&&this.vizCards.unselectCards()},_allFeaturesLoaded:function(a){this._featuresLoadedDfd.resolve();this.vizFeatures=a.graphics;this._setVizPage(0,!0)},_showLayers:function(){this.vizLayer&&(this.vizLayer.visible=!1);this.fxLayer&&(this.fxLayer.visible=!0);this.loadingCover.hide()},
_hideLayers:function(){this.vizLayer&&(this.vizLayer.visible=this.vizLayerVisibility);this.fxLayer&&(this.fxLayer.visible=!1)},_initViz:function(){this._initVizPages()},_initVizPages:function(){var a=this.pages;a.innerHTML="";if(1<this.config.vizFields.length){for(var c=0;c<this.config.vizFields.length;c++){var d=this.config.vizFields[c],d=f.create("li",{id:this.id+"-page"+c,title:d.label||d.alias},a);w(d,"click",b.hitch(this,this._setVizPage,c))}r.add("page0","active")}this.vizPage=0},_setVizPage:function(a,
b){this.loadingCover.hidden&&this.loadingCover.show();this._featuresLoadedDfd.then(function(){var c=this.id+"-page"+this.vizPage,d=this.id+"-page"+a;q.byId(c)&&r.remove(c,"active");this.vizPage=a;q.byId(d)&&r.add(d,"active");setTimeout(function(){this._processViz(b)}.bind(this),300)}.bind(this))},_toggleVizTimer:function(){this.playing?this._stopVizTimer():this._startVizTimer()},_startVizTimer:function(){this._stopVizTimer();this.vizTimer=setInterval(b.hitch(this,this._doViz),10*this.config.interval);
this.fxLayer&&(this.fxLayer.visible=!0,this.fxLayer.startSpinning());this.playing=!0;r.add(this.btnPlay,"playing")},_stopVizTimer:function(){this.vizTimer&&(clearInterval(this.vizTimer),this.vizTimer=null);this.fxLayer&&this.fxLayer.pauseSpinning();this.playing=!1;this.btnPlay&&r.remove(this.btnPlay,"playing")},_doViz:function(){var a=this.vizPage+1;a>=this.config.vizFields.length&&(a=0);this._setVizPage(a)},_processViz:function(a){var b=this.config.vizFields[this.vizPage],c=b.field,d=this.config.displayField;
this.titleNode.innerHTML=b.label||b.alias;if(this.fxLayer&&!0!==a){var e=this._getRenderingInfo();this.fxLayer.then(function(){this.fxLayer.switchVizField(c,e)}.bind(this))}a=this._sortedFeatures[c];a||(a=h.filter(this.vizFeatures,function(a){return null!=a.attributes[c]?!0:!1}),0<a.length&&(a.sort(function(a,b){return a.attributes[c]<b.attributes[c]?1:a.attributes[c]>b.attributes[c]?-1:0}),h.forEach(a,function(a,b){a.attributes.index=b}),this.vizMax=a[0].attributes[c]),this._sortedFeatures[c]=a);
this.filteredFeatures=a;d={features:a,vizField:c,displayField:d,color:this._getColor()};this.vizCards.update(d);this.loadingCover.hide()},_featureSelection:function(a){a.data?(a=a.data,this.playing&&this._stopVizTimer(),this.fxLayer&&this.fxLayer.showLabel(a)):this.fxLayer&&this.fxLayer.hideLabel()},_getFeatureIndex:function(a){var b=this.config.displayField,c=a.attributes[b],d=0;h.some(this.filteredFeatures,function(a){if(a.attributes[b]===c)return!0;d+=1});return d}})});