// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(r,k,l,g,f){return l("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var m=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);f.parse(m,{noStart:!this._earlyTemplatedStartup,
template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(g.hitch(this,function(d){this._startupWidgets=d;for(var f=0;f<d.length;f++)this._processTemplateNode(d[f],function(d,h){return d[h]},function(d,h,c){return h in d?d.connect(d,h,c):d.on(h,c,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");
}},_processTemplateNode:function(f,d,g){return d(f,"dojoType")||d(f,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){r.forEach(this._startupWidgets,function(f){f&&!f._started&&f.startup&&f.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"widgets/3DFx/VizCards/VizCards":function(){define("dojo/Evented dojo/_base/declare dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/number dojo/on dojo/query dojox/gfx dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/VizCards.html".split(" "),
function(r,k,l,g,f,m,d,p,q,h,c,n,t,u,w,a){return k("VizCards",[u,w,r],{declaredClass:"esri.widgets.VizCards",templateString:a,css:{root:"esri-viz-cards",content:"content"},constructor:function(a,b){this.rtl=!1;this.options={view:null,features:[],vizField:null,displayField:null,color:"#ff0000",showPercent:!1};f.mixin(this.options,a);this.domNode=b;this._currentSelectedCardNode=null},postCreate:function(){this.inherited(arguments);0<n(".dj_rtl").length&&(this.rtl=!0);this.own(c(this.contentNode,"click",
f.hitch(this,this._clickCard)))},startup:function(){this.inherited(arguments);this._updateCards()},destroy:function(){this.view=null;this.inherited(arguments)},clear:function(){this.containerNode.innerHTML=""},update:function(a){f.mixin(this.options,a);this._updateCards()},selectCard:function(a){var b=this.domNode.id+"_card_"+a;this.unselectCards();if(b=n("#"+b,this.domNode)[0])d.add(b,"selected"),this._currentSelectedCardNode=b;var b=m.getContentBox(this.containerNode).w,e=180*a-b/2+90;this.rtl&&
(e=180*(this.options.features.length-a)-b/2-90);0>e&&(e=0);this.containerNode.scrollLeft=e},unselectCards:function(){this._currentSelectedCardNode&&(d.remove(this._currentSelectedCardNode,"selected"),this._currentSelectedCardNode=null)},_getTotal:function(){var a=this.options.vizField,b=0;l.forEach(this.options.features,function(e){b+=e.attributes[a]});return b},_updateCards:function(){var a=this.contentNode;q.set(a,"color",this.options.color);var b=this.options.features,x=this._getTotal();a.innerHTML=
"";var v=0;this.rtl&&(v=180*b.length);this.containerNode.scrollLeft=v;q.set(a,"width",180*b.length+"px");for(var v=b.length,f=null,c,g,k=null,n=this.options.showPercent&&400>=v,l=0;l<v;l++){f=b[l];c=f.attributes;f=c[this.options.vizField];g=h.format(f);k||(k=Math.floor(150/g.length+3),10>k&&(k=10),60<k&&(k=60));var m=c[this.options.displayField];null!==f&&(c=p.create("div",{id:this.domNode.id+"_card_"+l},a),d.add(c,"card"),m=p.create("div",{innerHTML:l+1+". "+m},c),d.add(m,"header"),g=p.create("div",
{innerHTML:g},c),n?(d.add(g,"value"),g=parseInt(f/x*100,10),m=g+"%",0<f&&1>g&&(m="\x3c1%"),c=p.create("div",{},c),d.add(c,"area"),f=p.create("div",{},c),d.add(f,"chart"),c=p.create("div",{innerHTML:m},c),d.add(c,"pct"),this._createChart(f,g)):(d.add(g,"valueBig"),q.set(g,"fontSize",k+"px")))}},_createChart:function(a,b){var e=m.getContentBox(a),f=Math.min(e.w,e.h),e=f/2,c=f/2,d=e-3;a=t.createSurface(a,f,f);a.clear();a.createCircle({cx:e,cy:c,r:d}).setStroke({width:6,color:g.fromArray([255,255,255,
.15]),cap:"round"});0<b&&(100<=b&&(b=99),f=360*b/100,b=!1,180<=f&&(b=!0),f=this._getEndPoint(d,f,e,c),c-=d,a.createPath().moveTo(e,c).arcTo(d,d,0,b,!0,f.x,f.y).setStroke({width:6,color:this.options.color,cap:"round"}))},_getEndPoint:function(a,b,f,c){var e=b;0<b&&90>b?e+=270:90<b&&(e=b-90);b=e*Math.PI/180;return{x:f+Math.cos(b)*a,y:c+Math.sin(b)*a}},_clickCard:function(a){a=a.target||a.srcElement;if(!d.contains(a,"card"))for(;a&&a.parentNode&&(a=a.parentNode,!d.contains(a,"card")););if(a){var b=a.id.replace(this.domNode.id+
"_card_",""),b=parseInt(b,10);isNaN(b)||null==b||(d.contains(a,"selected")?(this.unselectCards(),this.emit("selection",{})):(this.unselectCards(),d.add(a,"selected"),this._currentSelectedCardNode=a,this.emit("selection",{data:this.options.features[b]})))}}})})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(r,k,l){k.switchTo(l);return k})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(r,k,l,g,f,m,d,p,q){var h=k.getObject("dojox.gfx",!0),c=h._base={};h._hasClass=function(a,e){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+e+" ")};h._addClass=function(a,e){var b=a.getAttribute("className")||"";(!b||0>(" "+b+" ").indexOf(" "+e+" "))&&a.setAttribute("className",b+(b?" ":"")+e)};h._removeClass=function(a,e){var b=a.getAttribute("className");b&&a.setAttribute("className",b.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)"),"$1$2"))};c._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},e,b;g("ie")&&(b=f.doc.documentElement.style.fontSize||"",b||(f.doc.documentElement.style.fontSize="100%"));var c=p.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},f.body());for(e in a)c.style.fontSize=e,a[e]=16*Math.round(12*c.offsetHeight/16)/12/1E3;
g("ie")&&(f.doc.documentElement.style.fontSize=b);f.body().removeChild(c);return a};var n=null;c._getCachedFontMeasurements=function(a){if(a||!n)n=c._getFontMeasurements();return n};var t=null,u={};c._getTextBox=function(a,e,b){var c,d,h=arguments.length,g;t||(t=p.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},f.body()));c=t;c.className="";d=c.style;d.borderWidth="0";d.margin="0";d.padding="0";d.outline="0";if(1<h&&e)for(g in e)g in u||(d[g]=e[g]);2<h&&b&&(c.className=
b);c.innerHTML=a;c.getBoundingClientRect?(d=c.getBoundingClientRect(),d={l:d.left,t:d.top,w:d.width||d.right-d.left,h:d.height||d.bottom-d.top}):d=q.getMarginBox(c);c.innerHTML="";return d};c._computeTextLocation=function(a,e,b,d){var c={};switch(a.align){case "end":c.x=a.x-e;break;case "middle":c.x=a.x-e/2;break;default:c.x=a.x}c.y=a.y-b*(d?.75:1);return c};c._computeTextBoundingBox=function(a){if(!h._base._isRendered(a))return{x:0,y:0,width:0,height:0};var e;e=a.getShape();var b=a.getFont()||h.defaultFont;
a=a.getTextWidth();b=h.normalizedLength(b.size);e=c._computeTextLocation(e,a,b,!0);return{x:e.x,y:e.y,width:a,height:b}};c._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var w=0;c._getUniqueId=function(){var a;do a=r._scopeName+"xUnique"+ ++w;while(d.byId(a));return a};c._fixMsTouchAction=function(a){a.rawNode.style.touchAction="none"};k.mixin(h,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,
height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},
defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(e){var b=a[e];if(b)return new b;b=a[e]=new Function;b.prototype=
h["default"+e];return new b}}(),normalizeColor:function(a){return a instanceof l?a:new l(a)},normalizeParameters:function(a,e){var b;if(e){var c={};for(b in a)b in e&&!(b in c)&&(a[b]=e[b])}return a},makeParameters:function(a,e){var b=null;if(!e)return k.delegate(a);var c={};for(b in a)b in c||(c[b]=k.clone(b in e?e[b]:a[b]));return c},formatNumber:function(a,c){var b=a.toString();if(0<=b.indexOf("e"))b=a.toFixed(4);else{var e=b.indexOf(".");0<=e&&5<b.length-e&&(b=a.toFixed(4))}return 0>a?b:c?" "+
b:b},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var c=h.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){c.style=a[0];c.variant=a[1];c.weight=a[2];var b=a[3].indexOf("/");c.size=0>b?a[3]:a[3].substring(0,b);var d=4;0>b&&("/"==a[4]?d=6:"/"==a[4].charAt(0)&&(d=5));d<a.length&&(c.family=a.slice(d).join(" "))}return c},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return h._base._getCachedFontMeasurements()["12pt"]/
12},pt2px:function(a){return a*h.px_in_pt()},px2pt:function(a){return a/h.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var c=h.px_in_pt(),b=parseFloat(a);switch(a.slice(-2)){case "px":return b;case "pt":return b*c;case "in":return 72*b*c;case "pc":return 12*b*c;case "mm":return b*h.mm_in_pt*c;case "cm":return b*h.cm_in_pt*c}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,
equalSources:function(a,c){return a&&c&&a===c},switchTo:function(a){var c="string"==typeof a?h[a]:a;c&&(m.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){h[a]=c[a]}),"string"==typeof a?h.renderer=a:m.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return h.renderer=h[a]&&h[a].Surface===h.Surface?a:null}))}});return h})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(r,k,l,g,f){var m=null;l.add("vml",function(d,f,g){g.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';d="adj"in g.firstChild;g.innerHTML="";return d});return{load:function(d,p,q){function h(){p(["dojox/gfx/"+c],function(d){r.renderer=c;m=d;q(d)})}if(m&&"force"!=d)q(m);else{var c=f.forceGfxRenderer;d=!c&&(k.isString(f.gfxRenderer)?f.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var n,t;!c&&d.length;)switch(d.shift()){case "svg":"SVGAngle"in
g.global&&(c="svg");break;case "vml":l("vml")&&(c="vml");break;case "silverlight":try{l("ie")?(n=new ActiveXObject("AgControl.AgControl"),n.IsVersionSupported("1.0"))&&(t=!0):navigator.plugins["Silverlight Plug-In"]&&(t=!0)}catch(u){t=!1}finally{n=null}t&&(c="silverlight");break;case "canvas":g.global.CanvasRenderingContext2D&&(c="canvas")}"canvas"===c&&!1!==f.canvasEvents&&(c="canvasWithEvents");f.isDebug&&console.log("gfx renderer \x3d "+c);"svg"==c&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(h):
h()}}}})},"widgets/3DFx/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/3DFx/VizCards/templates/VizCards.html":'\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"${css.root}" role\x3d"presentation"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"contentNode" class\x3d"${css.content}"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/3DFx/Widget.html":'\x3cdiv\x3e\r\n  \x3ccanvas class\x3d"labelCanvas" data-dojo-attach-point\x3d"labelCanvas"\x3e\x3c/canvas\x3e\r\n  \x3cdiv class\x3d"panelBottom"\x3e\r\n    \x3c!--Panel Container --\x3e\r\n    \x3cdiv class\x3d"panelContainer"\x3e\r\n      \x3c!-- Panel Inner --\x3e\r\n      \x3cdiv class\x3d"panelInner"\x3e\r\n        \x3c!-- Panel Content --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"panelMsgBlock"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"panelContent" class\x3d"panelContent"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Panel Footer --\x3e\r\n    \x3cdiv class\x3d"panelFooter" data-dojo-attach-point\x3d"footerNode" class\x3d"jimu-main-background"\x3e\r\n      \x3cdiv class\x3d"panelFooterContent"\x3e\r\n        \x3cdiv class\x3d"btnPlay" data-dojo-attach-point\x3d"btnPlay" data-dojo-attach-event\x3d"onclick:_toggleVizTimer"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"panelTitle" data-dojo-attach-point\x3d"titleNode"\x3eTitle\x3c/div\x3e\r\n        \x3cdiv class\x3d"panelPages"\x3e\r\n          \x3cul class\x3d"pages" data-dojo-attach-point\x3d"pages"\x3e\r\n          \x3c/ul\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"btnClose" data-dojo-attach-point\x3d"btnClose" data-dojo-attach-event\x3d"onclick:_close"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/3DFx/css/style.css":".esri-viz-cards {position: absolute; width: 100%; height: 100%; overflow-x: auto; overflow-y: hidden;}.esri-viz-cards .content {margin: 0; padding: 0; width: auto; height: 100%; white-space: nowrap; overflow: visible;}.esri-viz-cards .card {position: relative; float: left; width: 150px; height: 100%; margin-left: 10px; margin-right: 20px; overflow: hidden; text-overflow: ellipsis; cursor: pointer; display: block;}.dj_rtl .esri-viz-cards .card {float: right;}.esri-viz-cards .card.selected {color: #ffffff;}.esri-viz-cards .header {position: absolute; width: 100%; height: 20px; line-height: 20px; font-size: 12px; border-bottom: 1px solid rgba(255, 255, 255, 0.25); overflow: hidden; text-overflow: ellipsis;}.esri-viz-cards .card.selected .header {border-bottom: 1px solid #ffffff;}.esri-viz-cards .value {position: absolute; top: 20px; width: 100%; height: 17px; line-height: 17px; font-size: 12px; overflow: hidden; text-overflow: ellipsis;}.esri-viz-cards .valueBig {position: absolute; top: 20px; width: 100%; height: 60px; line-height: 60px; font-size: 20px; overflow: hidden; text-overflow: ellipsis;}.esri-viz-cards .area {position: absolute; left: 30px; top: 37px; width: 80px; height: 70px; display: block;}.esri-viz-cards .chart {position: absolute; width: 100%; height: 100%; display: block;}.esri-viz-cards .pct {position: absolute; top: 50%; margin-top: -15px; width: 100%; height: 30px; line-height: 30px; font-size: 20px; text-align: center; overflow: hidden; text-overflow: ellipsis;}.esri-viz-cards::-webkit-scrollbar {width: 6px; height: 6px; background-color: rgba(255, 255, 255, 0.25);}.esri-viz-cards::-webkit-scrollbar-thumb {background-color: rgba(255, 255, 255, 0.5);}.esri-viz-cards {scrollbar-base-color: #000000; scrollbar-3dlight-color: #000000; scrollbar-highlight-color: #000000; scrollbar-track-color: #707070; scrollbar-arrow-color: #606060; scrollbar-shadow-color: #000000; scrollbar-dark-shadow-color: #000000; scrollbar-face-color: #606060;}.jimu-widget-viz {color: #ffffff; background-color: rgba(0,0,0,0.8); left: 0px !important; right: 0px !important; bottom: 0px; height: 160px !important; display: block; z-index: 100 !important; overflow: hidden;}.jimu-widget-viz .labelCanvas {position: absolute; top: -50px; height: 50px;}.jimu-widget-viz .panelBottom {position: absolute; width: 100%; height: 160px; left: 0px; top: 0px; color: #ffffff; padding: 0px;}.jimu-widget-viz .panelFooter {position: absolute; bottom: 0px; left: 0px; right: 0px; height: 40px; line-height: 40px; overflow: hidden; background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-bottom: 1px solid #353535; border-bottom: 1px solid rgba(0, 0, 0, 0.3);}.jimu-widget-viz .panelFooterContent {position: absolute; left: 10px; right: 24px; top: 8px; height: 24px; line-height: 24px; overflow-x: hidden; overflow-y: hidden; display: inline-block; white-space: nowrap; width: auto;}.jimu-rtl .jimu-widget-viz .panelFooterContent {position: absolute; left: 24px; right: 10px;}.jimu-widget-viz .panelTitle {float: left; margin-left: 10px; font-size: 14px;}.jimu-rtl .jimu-widget-viz .panelTitle {float: right; margin-right: 10px;}.jimu-widget-viz .panelPages {float: right;}.jimu-rtl .jimu-widget-viz .panelPages {float: left;}.jimu-widget-viz .pages {list-style-type: none; height: 24px; margin: auto; padding: 2px; display: block; cursor: pointer;}.jimu-widget-viz .pages li {width: 20px; height: 20px; display: inline-block; background: url(images/dot.png); margin: 0;}.jimu-widget-viz .pages li:hover {background: url(images/doton.png);}.jimu-widget-viz .pages li.active {background: url(images/doton.png);}.jimu-widget-viz .btnPlay {float: left; width: 24px; height: 24px; display: block; cursor: pointer; background-image: url('images/play.png'); background-repeat: no-repeat; background-position: center center; background-size: 24px;}.jimu-rtl .jimu-widget-viz .btnPlay {float: right;}.jimu-widget-viz .playing {background-image: url('images/pause.png'); background-repeat: no-repeat; background-position: center center; background-size: 24px;}.jimu-widget-viz .btnClose {position: absolute; left: auto; right: 0px; width: 24px; height: 40px; line-height: 40px; text-align: center; display: block; cursor: pointer; background-image: url('images/x.png'); background-repeat: no-repeat; background-position: center center; background-size: 18px;}.jimu-rtl .jimu-widget-viz .btnClose {position: absolute; left: 0px; right: auto;}.jimu-widget-viz .panelContainer {position: absolute; width: 100%; height: 120px; overflow: hidden; display: block;}.jimu-widget-viz .panelInner {position: absolute; top: 3px; left: 0px; right: 0px; height: 117px; display: block; overflow: hidden;}.jimu-widget-viz .loading {background-image: url('images/loading.gif'); background-repeat: no-repeat; background-position: center 10px;}",
"*now":function(r){r(['dojo/i18n!*preload*widgets/3DFx/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/Color dojo/_base/html dojo/_base/lang dojo/_base/array dojo/_base/xhr dojo/Deferred dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/number dojo/on dojo/query dojo/json dijit/_WidgetsInTemplateMixin esri/request esri/Graphic esri/layers/GraphicsLayer esri/geometry/Point esri/geometry/support/webMercatorUtils esri/symbols/PictureMarkerSymbol esri/symbols/PointSymbol3D esri/symbols/ObjectSymbol3DLayer esri/tasks/QueryTask esri/tasks/support/Query jimu/BaseWidget jimu/dijit/Message jimu/utils jimu/dijit/LoadingShelter fx3d/layers/FxLayer ./VizCards/VizCards dojo/domReady!".split(" "),function(r,
k,l,g,f,m,d,p,q,h,c,n,t,u,w,a,e,b,x,v,E,F,G,H,I,J,K,z,L,A,B,C,D){return r([z,e],{baseClass:"jimu-widget-viz",name:"3DFx",postCreate:function(){this.inherited(arguments);this.vizFeatures=[];this.vizMax=0;this.vizCards=null;this.vizPage=0;this._featuresLoadedDfd=new d;this._sortedFeatures={}},startup:function(){this.inherited(arguments);this.loadingCover=new B({hidden:!0});this.loadingCover.placeAt(this.sceneView.map.id);this.loadingCover.startup();this._getStyleColor();var a=this._getStyleColor();
this.panelMsgBlock.innerHTML="";a.then(g.hitch(this,function(){this.config.vizLayer&&0!==this.config.vizFields.length?(this.loadingCover.show(),b(this.config.vizLayer.url+"/query",{query:{f:"json",returnGeometry:!1,returnCountOnly:!0,where:"1\x3d1"},callbackParamName:"callback"}).then(g.hitch(this,function(a){a.data.count?400<a.data.count?this.config.showPercent=!1:this.panelMsgBlock.innerHTML="":this.panelMsgBlock.innerHTML="";this._initUI();this._initLayers();this._initViz()}))):this.panelMsgBlock.innerHTML=
"\x3cp align\x3d'center'\x3e"+this.nls.viz_error+"\x3c/p\x3e"}))},onOpen:function(){this.inherited(arguments);this.loadingCover.hidden&&this.loadingCover.show();this._styleSync();this._showLayers()},onClose:function(){this._hideLayers();this._stopVizTimer();this.loadingCover.hide();this.vizCards&&this.vizCards.unselectCards();this.inherited(arguments)},onDeActive:function(){},destroy:function(){this._stopVizTimer();this._removeFxLayer();this._sortedFeatures={};this._featuresLoadedDfd=null;this.loadingCover.destroy();
this.inherited(arguments)},_close:function(){this.widgetManager.closeWidget(this.id)},_styleSync:function(){if(this.appConfig.theme.customStyles){var a=this.appConfig.theme.customStyles.mainBackgroundColor;n.set(this.footerNode,"backgroundColor",a);this.vizCards&&n.set(this.vizCards.contentNode,"color",a);this.config.color=a;this._updatePath();this.fxLayer&&this.fxLayer.set("renderingInfo",this._getRenderingInfo())}else this._updateUI(this.appConfig.theme.styles[0])},onAppConfigChanged:function(a,
b,c){this.appConfig=a;if("closed"!=this.state)switch(b){case "styleChange":this._styleSync()}},setPosition:function(a,b){if("BoxTheme"===this.appConfig.theme.name||"DartTheme"===this.appConfig.theme.name||"LaunchpadTheme"===this.appConfig.theme.name)this.inherited(arguments);else{this.position={left:"0px",right:"0px",bottom:"0px",height:"140px"};var c=A.getPositionStyle(this.position);c.position="absolute";b=this.sceneView.map.id;l.place(this.domNode,b);l.setStyle(this.domNode,c);this.started&&this.resize();
"TabTheme"===this.appConfig.theme.name&&(c=this.widgetManager.getControllerWidgets()[0],this.widgetManager.minimizeWidget(c.id))}},_updatePath:function(){this.vizCards&&this.vizCards.update({color:this._getColor()})},_updateUI:function(a){this._getStyleColor(a).then(g.hitch(this,function(){this.fxLayer&&(this._updatePath(),this.fxLayer.set("renderingInfo",this._getRenderingInfo()))}))},_getStyleColor:function(a){var b=new d;if(this.appConfig.theme.customStyles&&this.appConfig.theme.customStyles.mainBackgroundColor)return this.config.color=
this.appConfig.theme.customStyles.mainBackgroundColor,b.resolve(this.appConfig.theme.customStyles.mainBackgroundColor),b.promise;var c=this.appConfig.theme.name,y=this.appConfig.theme.styles[0];a&&(y=a);m.get({url:"./themes/"+c+"/manifest.json",handleAs:"json",load:g.hitch(this,function(a){a=a.styles;for(var c=0;c<a.length;c++){var d=a[c];d.name===y&&(n.set(this.footerNode,"backgroundColor",d.styleColor),this.vizCards&&n.set(this.vizCards.contentNode,"color",d.styleColor),this.config.color=d.styleColor,
b.resolve(d.styleColor))}})});return b.promise},_initUI:function(){this.vizCards=new D({view:this.sceneView,showPercent:this.config.showPercent},this.panelContent);this.vizCards.on("selection",g.hitch(this,this._featureSelection));this.vizCards.startup();"global"===this.sceneView.viewingMode?n.set(this.btnPlay,"display","block"):n.set(this.btnPlay,"display","none")},_initLayers:function(){this.sceneView.map.findLayerById(this.config.vizLayer.id).when().then(g.hitch(this,function(a){this.vizLayer=
a;this.vizLayerVisibility=a.visible;this.vizLayer.visible=!1;this._addFxLayer()}))},_getColor:function(){if(this.config.cycleColors){var a=this.vizPage,b=this.config.colors.length;return this.config.colors[a-Math.floor(a/b)*b]}return this.config.color},_getColors:function(){var a=this._getColor(),b=k.fromString("#ffffff"),a=k.fromString(a),c=k.blendColors(a,b,.3),b=k.blendColors(a,b,.8);return[a.toRgb(),c.toRgb(),b.toRgb()]},_getRenderingInfo:function(){var a=this._getColors(),b;switch(this.config.vizType){case "PointExtrude":b=
{visible:!0,repeat:1,animationInterval:this.config.interval/1E3,shapeType:"Cylinder",radius:this.config.maxWidth,height:this.config.maxHeight,transparency:100,bottomColor:a[0],topColors:[a[0],a[1]]};break;case "Pulse":b={visible:!0,repeat:1E3,animationInterval:this.config.interval/1E3,shapeType:"Circle",radius:this.config.maxWidth,transparency:80,solidColor:a[0],haloColor:a[1]};break;case "Bounce":b={visible:!0,repeat:1E3,animationInterval:this.config.interval/1E3,dashHeight:this.config.maxHeight,
radius:100,transparency:100,haloColors:a};break;case "GridSurface":b={visible:!0,repeat:1,animationInterval:this.config.interval/1E3,width:this.config.maxWidth,height:this.config.maxHeight,transparency:60,colors:[a[0],a[1],a[2]]};break;case "Fireball":case "JetTrail":b={visible:!0,repeat:1E3,animationInterval:this.config.interval/1E3,radius:30,transparency:90,colors:[a[0],a[0]]};break;case "AreaExtrude":b={visible:!0,repeat:1,animationInterval:this.config.interval/1E3,height:this.config.maxHeight,
transparency:100,bottomColor:a[0],topColors:[a[0],a[1]]}}"JetTrail"==this.config.vizType&&(b.showEndPoints=this.config.showJetTrailEndPoints);return b},_removeFxLayer:function(){this.fxLayer&&(this.fxLayer.remove(),this.fxLayer=null)},_addFxLayer:function(){this._removeFxLayer();var a=this._getRenderingInfo(),b=[];f.forEach(this.config.vizFields,function(a){b.push(a.field)});this.fxLayer=new C(this.config.vizLayer.url,{vizType:this.config.vizType,vizFields:b,displayField:this.config.displayField,
renderingInfo:a});this.fxLayer.on("all-features-loaded",g.hitch(this,this._allFeaturesLoaded));this.fxLayer.on("selected-feature-from-globe",g.hitch(this,this._selectedFeatureFromGlobe));this.fxLayer.on("abandon-selected-feature",g.hitch(this,this._abandonSelectedFeature));this.fxLayer.on("fx3d-ready",function(){this.loadingCover.hide()}.bind(this));this.fxLayer.watch("visible",g.hitch(this,function(a,b,c,d){!1===a&&this._stopVizTimer()}));this.sceneView.map.add(this.fxLayer)},_selectedFeatureFromGlobe:function(a){this.fxLayer&&
this.fxLayer.hideLabel();this._featuresLoadedDfd.then(function(){if(a.selectedFeature){var b=this._getFeatureIndex(a.selectedFeature);this.vizCards&&this.vizCards.selectCard(b)}}.bind(this))},_abandonSelectedFeature:function(a){this.vizCards&&this.vizCards.unselectCards()},_allFeaturesLoaded:function(a){this._featuresLoadedDfd.resolve();this.vizFeatures=a.graphics;this._setVizPage(0,!0)},_showLayers:function(){this.vizLayer&&(this.vizLayer.visible=!1);this.fxLayer&&(this.fxLayer.visible=!0);this.loadingCover.hide()},
_hideLayers:function(){this.vizLayer&&(this.vizLayer.visible=this.vizLayerVisibility);this.fxLayer&&(this.fxLayer.visible=!1)},_initViz:function(){this._initVizPages()},_initVizPages:function(){var a=this.pages;a.innerHTML="";if(1<this.config.vizFields.length){for(var b=0;b<this.config.vizFields.length;b++){var c=this.config.vizFields[b],c=h.create("li",{id:this.id+"-page"+b,title:c.label||c.alias},a);u(c,"click",g.hitch(this,this._setVizPage,b))}q.add("page0","active")}this.vizPage=0},_setVizPage:function(a,
b){this.loadingCover.hidden&&this.loadingCover.show();this._featuresLoadedDfd.then(function(){var c=this.id+"-page"+this.vizPage,d=this.id+"-page"+a;p.byId(c)&&q.remove(c,"active");this.vizPage=a;p.byId(d)&&q.add(d,"active");setTimeout(function(){this._processViz(b)}.bind(this),300)}.bind(this))},_toggleVizTimer:function(){this.playing?this._stopVizTimer():this._startVizTimer()},_startVizTimer:function(){this._stopVizTimer();this.vizTimer=setInterval(g.hitch(this,this._doViz),10*this.config.interval);
this.fxLayer&&(this.fxLayer.visible=!0,this.fxLayer.startSpinning());this.playing=!0;q.add(this.btnPlay,"playing")},_stopVizTimer:function(){this.vizTimer&&(clearInterval(this.vizTimer),this.vizTimer=null);this.fxLayer&&this.fxLayer.pauseSpinning();this.playing=!1;this.btnPlay&&q.remove(this.btnPlay,"playing")},_doViz:function(){var a=this.vizPage+1;a>=this.config.vizFields.length&&(a=0);this._setVizPage(a)},_processViz:function(a){var b=this.config.vizFields[this.vizPage],c=b.field,d=this.config.displayField;
this.titleNode.innerHTML=b.label||b.alias;if(this.fxLayer&&!0!==a){var e=this._getRenderingInfo();this.fxLayer.when().then(function(){this.fxLayer.switchVizField(c,e)}.bind(this))}a=this._sortedFeatures[c];a||(a=f.filter(this.vizFeatures,function(a){return null!=a.attributes[c]?!0:!1}),0<a.length&&(a.sort(function(a,b){return a.attributes[c]<b.attributes[c]?1:a.attributes[c]>b.attributes[c]?-1:0}),f.forEach(a,function(a,b){a.attributes.index=b}),this.vizMax=a[0].attributes[c]),this._sortedFeatures[c]=
a);this.filteredFeatures=a;d={features:a,vizField:c,displayField:d,color:this._getColor()};this.vizCards.update(d);this.loadingCover.hide()},_featureSelection:function(a){a.data?(a=a.data,this.playing&&this._stopVizTimer(),this.fxLayer&&this.fxLayer.showLabel(a)):this.fxLayer&&this.fxLayer.hideLabel()},_getFeatureIndex:function(a){var b=this.config.displayField,c=a.attributes[b],d=0;f.some(this.filteredFeatures,function(a){if(a.attributes[b]===c)return!0;d+=1});return d}})});