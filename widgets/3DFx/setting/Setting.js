// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/3DFx/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/3DFx/setting/Setting.html":'\x3cdiv style\x3d"width:100%;height:100%;"\x3e\r\n  \x3c!-- Viz Settings --\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv class\x3d"label" style\x3d"padding-top:0px;font-weight: bold;"\x3e\r\n      ${nls.viz_settings}\r\n    \x3c/div\x3e\r\n    \x3chr /\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv class\x3d"col-1-4"\x3e\r\n      \x3cspan class\x3d"label"\x3e${nls.viz_type}: \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-3-4"\x3e\r\n      \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"vizType"\x3e\r\n        \x3coption value\x3d"Bounce" selected\x3d"selected"\x3e${nls.bounce}\x3c/option\x3e\r\n        \x3coption value\x3d"PointExtrude" selected\x3d"selected"\x3e${nls.point_extrusion}\x3c/option\x3e\r\n        \x3coption value\x3d"Pulse" selected\x3d"selected"\x3e${nls.pulse}\x3c/option\x3e\r\n        \x3c!--\x3coption value\x3d"GridSurface" selected\x3d"selected"\x3e${nls.grid_surface}\x3c/option\x3e--\x3e\r\n        \x3coption value\x3d"Fireball" selected\x3d"selected"\x3e${nls.fireball}\x3c/option\x3e\r\n        \x3coption value\x3d"JetTrail" selected\x3d"selected"\x3e${nls.jet_trail}\x3c/option\x3e\r\n        \x3coption value\x3d"AreaExtrude" selected\x3d"selected"\x3e${nls.area_extrusion}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:15px"\x3e\r\n    \x3cdiv class\x3d"col-2-3"\x3e\r\n      \x3cdiv class\x3d"col-1-2"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"showPercent" title\x3d"${nls.show_percent}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.show_percent}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-1-2 jettrail-endpoints-container"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"showJetTrailEndPoints" title\x3d"${nls.show_jettrail_end_points}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.show_jettrail_end_points}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"cycleColors" title\x3d"${nls.cycle_colors}" /\x3e\r\n      \x3cspan class\x3d"label"\x3e${nls.cycle_colors}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:15px"\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cspan class\x3d"label" data-dojo-attach-point\x3d"maxHeightLabel"\x3e${nls.max_height}: \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cspan class\x3d"label" data-dojo-attach-point\x3d"maxWidthLabel"\x3e${nls.max_width}: \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cspan class\x3d"label"\x3e${nls.interval}: \x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:0px"\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"maxHeight" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"maxWidth" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"interval" /\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cbr/\x3e\r\n  \x3c!-- Layer Settings --\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"layerSection"\x3e\r\n    \x3cdiv class\x3d"jimu-r-row"\x3e\r\n      \x3cdiv class\x3d"label" style\x3d"padding-top:10px;font-weight: bold;"\x3e\r\n        ${nls.layer_settings}\r\n      \x3c/div\x3e\r\n      \x3chr /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-r-row"\x3e\r\n      \x3cdiv class\x3d"col-1-4"\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.viz_layer}: \x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-3-4"\x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"vizLayer"\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top: 10px"\x3e\r\n      \x3cdiv class\x3d"col-1-4"\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.display_field}: \x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-3-4"\x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"displayField"\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cdiv class\x3d"btn-add-section" data-dojo-attach-point\x3d"btnAdd"\x3e\r\n        \x3cspan class\x3d"btn-add-label"\x3e${nls.add_field}\x3c/span\x3e\r\n        \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr/\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"table" data-dojo-type\x3d"jimu/dijit/SimpleTable" data-dojo-props\x3d\'fields:[\r\n    {name:"field",title:"${nls.field}","class":"label",type:"empty"},\r\n    {name:"label",title:"${nls.label}","class":"label",type:"empty"},\r\n    {name:"actions",title:"${nls.actions}","class":"actions",type:"actions",actions:["up","down","delete"]}]\'\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/3DFx/setting/css/style.css":".jimu-widget-viz-setting .btn-add-section {display: inline-block; overflow: hidden; height: 24px; margin-left: 1px; margin-bottom: 3px; cursor: pointer; font-size: 13px; color: #538ec8; margin-top: 8px;}.jimu-widget-viz-setting .btn-add-section .btn-add-icon {float: left; height: 100%; width: 14px; background-repeat: no-repeat; background-position: center center; background-image: url(images/add.png);}.jimu-widget-viz-setting .btn-add-section .btn-add-label {float: left; height: 100%; line-height: 24px; vertical-align: middle; margin-right: 7px; text-decoration: underline;}.jimu-widget-viz-setting .label-disabled {color: #6e6e6e;}",
"*now":function(h){h(['dojo/i18n!*preload*widgets/3DFx/setting/nls/Setting*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/Deferred dojo/promise/all dojo/dom-class dojo/dom-style dojo/on dojo/query dojo/store/Memory dijit/form/Select dijit/form/ValidationTextBox dijit/_WidgetsInTemplateMixin esri/request jimu/BaseWidgetSetting jimu/dijit/Message jimu/dijit/LoadingShelter jimu/dijit/SimpleTable".split(" "),function(h,f,d,n,r,t,g,k,l,m,u,v,w,x,p,y,q,z){function A(a){var b=[],c=[],e=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle",
"esriFieldTypeDouble"],d="lat latitude y ycenter latitude83 latdecdeg POINT-Y lon lng long longitude x xcenter longitude83 longdecdeg POINT-X alt altitude z POINT-Z zcenter altitude83 altdecdeg".split(" ");f.forEach(a,function(a){b.push(a.name);var B=a.name.toLowerCase();-1<e.indexOf(a.type)&&-1===d.indexOf(B)&&c.push(a.name)});return{displayFields:b,vizFields:c}}function C(a,b){return p({url:a,content:d.mixin({f:"json"},{}),handleAs:"json",callbackParamName:"callback"}).then(function(c){c._ssl&&
(delete c._ssl,a=a.replace(/^http:/i,"https:"));if("Feature Layer"===c.type){var e={};d.mixin(e,A(c.fields));b(null,e)}else b("3DFx widget can only accecpt a feature service.")},function(a){console.log(a);b("3DFx widget can only accecpt a valid feature service.")})}function D(a){var b=new r;d.isString(a)?C(a,function(a,e){a?b.reject(a):b.resolve(e)}):b.reject("3DFx widget can only accecpt a feature service url now.");return b}return h([y,x],{baseClass:"jimu-widget-viz-setting",postCreate:function(){this.inherited(arguments);
this.layers=[];this.fldOptions=[];this._selectedLyrId=null;this.loadingCover=new z({hidden:!0});this.loadingCover.placeAt(this.domNode);this.loadingCover.startup()},startup:function(){this.inherited(arguments);this._processLayers();this._postProcessLayers()},_processLayers:function(){var a=this.sceneView.map,b,c,e=a.layers.toArray(),d;for(b=e.length-1;0<=b;b--)if("esri.layers.FeatureLayer"===e[b].declaredClass&&"show"===e[b].listMode)this.layers.push(a.findLayerById(e[b].id));else if("esri.layers.GroupLayer"===
e[b].declaredClass)for(d=e[b].layers.toArray(),c=0;c<d.length;c++)"esri.layers.FeatureLayer"===d[c].declaredClass&&"show"===d[c].listMode&&this.layers.push(a.findLayerById(d[c].id))},_postProcessLayers:function(){this.own(l(this.vizType,"change",d.hitch(this,this._changeVizType)));this.own(l(this.vizLayer,"change",d.hitch(this,this._changeVizLayer)));this.own(l(this.btnAdd,"click",d.hitch(this,this._addRow)));this.config.vizType&&(this.vizType.value!=this.config.vizType?this.vizType.set("value",d.trim(this.config.vizType)):
this._changeVizType())},_changeVizType:function(){this._refreshVizSetting();if(0===this.layers.length)k.set(this.layerSection,"display","none"),this.loadingCover.hide(),new q({message:this.nls.no_layers});else{this._refreshLayerList();var a=!1,b,c=this.vizLayer.getOptions();if(this.config.vizLayer){b=this.config.vizLayer.id;for(var e=0;e<c.length;e++)if(c[e].value===b){a=!0;break}}a&&b?this.vizLayer.set("value",d.trim(b)):c&&c[0]&&this.vizLayer.set("value",d.trim(c[0].value))}},_refreshVizSetting:function(){this._refreshVizSettingStates();
this.config.showPercent&&this.showPercent.set("value",!0);this.config.showJetTrailEndPoints&&this.showJetTrailEndPoints.set("value",!0);this.config.cycleColors&&this.cycleColors.set("value",!0);this.config.maxHeight&&this.maxHeight.set("value",this.config.maxHeight);this.config.maxWidth&&this.maxWidth.set("value",this.config.maxWidth);this.config.interval&&this.interval.set("value",this.config.interval)},_refreshVizSettingStates:function(){var a=this.vizType.value||this.config.vizType,b=m(".jettrail-endpoints-container",
this.domNode)[0];b&&("JetTrail"==a?k.set(b,"display","block"):k.set(b,"display","none"));switch(a){case "Fireball":case "JetTrail":g.add(this.maxWidthLabel,"label-disabled");g.add(this.maxHeightLabel,"label-disabled");this.maxWidth.set("disabled",!0);this.maxHeight.set("disabled",!0);this.maxWidth.set("readOnly",!0);this.maxHeight.set("readOnly",!0);break;case "Bounce":case "AreaExtrude":g.add(this.maxWidthLabel,"label-disabled");g.remove(this.maxHeightLabel,"label-disabled");this.maxWidth.set("disabled",
!0);this.maxHeight.set("disabled",!1);this.maxWidth.set("readOnly",!0);this.maxHeight.set("readOnly",!1);break;case "Pulse":g.remove(this.maxWidthLabel,"label-disabled");g.add(this.maxHeightLabel,"label-disabled");this.maxWidth.set("disabled",!1);this.maxHeight.set("disabled",!0);this.maxWidth.set("readOnly",!1);this.maxHeight.set("readOnly",!0);break;default:g.remove(this.maxWidthLabel,"label-disabled"),g.remove(this.maxHeightLabel,"label-disabled"),this.maxWidth.set("disabled",!1),this.maxHeight.set("disabled",
!1),this.maxWidth.set("readOnly",!1),this.maxHeight.set("readOnly",!1)}},_refreshLayerList:function(){this.vizLayer.removeOption(this.vizLayer.getOptions());this.vizLayer._set("value",null);this.vizLayer._lastValueReported=null;this.vizLayer._setDisplay("");var a=null,b=this.vizType.value;if(b)switch(b){case "Fireball":case "JetTrail":a="polyline";break;case "PointExtrude":case "Pulse":case "Bounce":a="point";break;case "AreaExtrude":a="polygon"}a&&f.forEach(this.layers,d.hitch(this,function(b){a==
b.geometryType&&(b={label:b.title,value:d.trim(b.id)},this.vizLayer.addOption(b))}))},_getLayerById:function(a){var b=f.filter(this.layers,function(b){return b.id===a});return 0<b.length?b[0]:null},_changeVizLayer:function(){var a=this._getLayerById(this.vizLayer.value);a&&a.id===this._selectedLyrId||(this._selectedLyrId=a.id,this.loadingCover.show(),this.displayField.removeOption(this.displayField.getOptions()),this.displayField._set("value",null),this.displayField._lastValueReported=null,this.displayField._setDisplay(""),
this.table.clear(),this._setFields(a))},_setFields:function(a){var b=[];this.fldOptions=[];var c=a.url;"number"===typeof a.layerId&&(c+="/"+a.layerId);t([p({url:c+"/query",content:d.mixin({f:"json"},{returnGeometry:!1,returnCountOnly:!0,where:"1\x3d1"}),handleAs:"json",callbackParamName:"callback"}),D(c)]).then(function(c){d.isObject(c[0])&&(400<c[0].count?(this.showPercent.set("value",!1),this.showPercent.set("disabled",!0),this.showPercent.set("title",this.nls.show_percentage_limited)):(this.showPercent.set("disabled",
!1),this.showPercent.set("title","")));d.isObject(c[1])&&(f.forEach(c[1].displayFields,d.hitch(this,function(c){b.push(this._getFieldOption(a,c))}.bind(this))),f.forEach(c[1].vizFields,d.hitch(this,function(b){this.fldOptions.push(this._getFieldOption(a,b))}.bind(this))),c=new u({idProperty:"label",data:b}),this.displayField.set("labelAttr","label"),this.displayField.setStore(c),this._refreshFields());this.loadingCover.hide()}.bind(this),function(a){console.warn(a);this.loadingCover.hide()}.bind(this))},
_refreshFields:function(){var a=!1,b,c;if(this.config.vizLayer&&this.config.vizLayer.id===this.vizLayer.value){c=this.displayField.getOptions();if(this.config.displayField){b=this.config.displayField;for(var e=0;e<c.length;e++)if(c[e].value===b){a=!0;break}}f.forEach(this.config.vizFields,d.hitch(this,function(a){this._populateTableRow(a)}))}a&&b?this.displayField.set("value",d.trim(b)):c&&c[0]&&this.displayField.set("value",d.trim(c[0].value))},_getFieldOption:function(a,b){var c={label:b,value:b};
a.popupTemplate&&a.popupTemplate.fieldInfos instanceof Array&&f.some(a.popupTemplate.fieldInfos,function(a){if(a.fieldName===b)return c.label=a.label,!0});return c},_populateTableRow:function(a){var b=this._addRow();b&&(b.selectField.set("value",a.field),b.labelText.set("value",a.label))},_addRow:function(){var a=this.table.addRow({});if(a.success&&a.tr)return a=a.tr,this._addField(a),this._addLabel(a),a},_addField:function(a){var b=d.clone(this.fldOptions),c=m(".simple-table-cell",a)[0];c&&(n.setStyle(c,
"verticalAlign","middle"),b=new v({style:{width:"100%",height:"30px"},options:b}),b.placeAt(c),b.startup(),a.selectField=b)},_addLabel:function(a){var b=m(".simple-table-cell",a)[1];n.setStyle(b,"verticalAlign","middle");var c=new w({style:{width:"100%",height:"30px"}});c.placeAt(b);c.startup();a.labelText=c},_validateVizType:function(){var a=!1;if(this.vizLayer.value){var b=this._getLayerById(this.vizLayer.value).geometryType;switch(this.vizType.value){case "Fireball":case "JetTrail":"polyline"===
b&&(a=!0);break;case "PointExtrude":case "Bounce":case "Pulse":"point"===b&&(a=!0);break;case "AreaExtrude":"polygon"===b&&(a=!0)}}a||(console.log(this.vizType),new q({message:this.vizType.attr("displayedValue")+": "+this.nls.viz_not_supported}));return a},getConfig:function(){this.config.vizType=d.trim(this.vizType.value);this.config.showPercent=this.showPercent.checked;this.config.showJetTrailEndPoints=this.showJetTrailEndPoints.checked;this.config.cycleColors=this.cycleColors.checked;this.config.maxHeight=
this.maxHeight.value;this.config.maxWidth=this.maxWidth.value;this.config.interval=this.interval.value;if(0<this.layers.length){if(!this._validateVizType())return!1;var a=this._getLayerById(this.vizLayer.value),b=a.url;"number"===typeof a.layerId&&(b+="/"+a.layerId);this.config.vizLayer={id:a.id,url:b};this.config.displayField=d.trim(this.displayField.value);var c=[],a=this.table.getRows();f.forEach(a,function(a){var b=d.trim(a.selectField.value),e=a.selectField.attr("displayedValue");a=d.trim(a.labelText.value);
c.push({field:b,alias:e,label:a})});this.config.vizFields=c}return this.config.vizLayer&&this.config.vizFields&&0!==this.config.vizFields.length?this.config:!1}})});