// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Legend/nls/Legend ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widget".split(" "),function(x,g,b,f,c,d,r,m,q,n,w,y,k){return function(h){function p(a){a=h.call(this)||this;a._handles=new d;a._styleRenderer=null;a.activeLayerInfos=
null;a.basemapLegendVisible=!1;a.groundLegendVisible=!1;a.iconClass="esri-icon-layer-list";a.label=c.widgetLabel;a.layerInfos=null;a.view=null;a.viewModel=new n;return a}b(p,h);p.prototype.postInitialize=function(){var a=this;this._updateStyleRenderer(this.style);this.own(r.on(this,"activeLayerInfos","change",function(){return a._refreshActiveLayerInfos(a.activeLayerInfos)}))};p.prototype.destroy=function(){this._handles.destroy();this._handles=null};Object.defineProperty(p.prototype,"style",{get:function(){return this._get("style")},
set:function(a){this._updateStyleRenderer(a);this._set("style",a)},enumerable:!0,configurable:!0});p.prototype.render=function(){return this._styleRenderer.render()};p.prototype._updateStyleRenderer=function(a){this._styleRenderer&&this._styleRenderer.destroy();this._styleRenderer="card"===a?new w({activeLayerInfos:this.activeLayerInfos,view:this.view}):new y({activeLayerInfos:this.activeLayerInfos})};p.prototype._refreshActiveLayerInfos=function(a){var e=this;this._handles.removeAll();a.forEach(function(a){return e._renderOnActiveLayerInfoChange(a)});
this.scheduleRender()};p.prototype._renderOnActiveLayerInfoChange=function(a){var e=this,b=r.init(a,"version",function(){return e.scheduleRender()});this._handles.add(b,"version_"+a.layer.uid);a.children.forEach(function(a){return e._renderOnActiveLayerInfoChange(a)})};f([m.aliasOf("viewModel.activeLayerInfos"),k.renderable()],p.prototype,"activeLayerInfos",void 0);f([m.aliasOf("viewModel.basemapLegendVisible"),k.renderable()],p.prototype,"basemapLegendVisible",void 0);f([m.aliasOf("viewModel.groundLegendVisible"),
k.renderable()],p.prototype,"groundLegendVisible",void 0);f([m.property()],p.prototype,"iconClass",void 0);f([m.property()],p.prototype,"label",void 0);f([m.aliasOf("viewModel.layerInfos"),k.renderable()],p.prototype,"layerInfos",void 0);f([m.property({value:"classic",dependsOn:["activeLayerInfos"]}),k.renderable()],p.prototype,"style",null);f([m.aliasOf("viewModel.view"),k.renderable()],p.prototype,"view",void 0);f([m.property(),k.renderable(["view.size"])],p.prototype,"viewModel",void 0);return p=
f([m.subclass("esri.widgets.Legend")],p)}(m.declared(q))})},"esri/widgets/Legend/LegendViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./support/ActiveLayerInfo".split(" "),function(x,g,b,f,c,d,r,m,q,n){var w=d.ofType(n),y="esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.MapImageLayer esri.layers.MapNotesLayer esri.layers.PointCloudLayer esri.layers.TileLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.ImageryLayer esri.layers.WMSLayer esri.layers.WMTSLayer".split(" "),
k=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];return function(c){function d(a){a=c.call(this,a)||this;a._handles=new r;a._layerViewByLayerId={};a._layerInfosByLayerViewId={};a._activeLayerInfosByLayerViewId={};a.activeLayerInfos=new w;a.basemapLegendVisible=!1;a.groundLegendVisible=!1;a.layerInfos=[];a.view=null;return a}b(d,c);d.prototype.initialize=function(){this._handles.add(m.init(this,"view",this._viewHandles),"view")};
d.prototype.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};Object.defineProperty(d.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});d.prototype._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(m.init(this,"state",this._stateHandles),"state")};d.prototype._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};
d.prototype._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};d.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};d.prototype._destroyViewActiveLayerInfo=function(a){this._handles.remove(a);delete this._activeLayerInfosByLayerViewId[a]};d.prototype._watchPropertiesAndAllLayerViews=function(){var a=this.view.allLayerViews;
a.length&&this._refresh();this._handles.add(a.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(m.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};d.prototype._allLayerViewsChangeHandle=function(a){var e=this;a.removed.forEach(function(a){return e._destroyViewActiveLayerInfo(a.uid)});this._refresh()};d.prototype._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();
this._refresh()};d.prototype._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};d.prototype._sortActiveLayerInfos=function(a){var e={};this.view.allLayerViews.forEach(function(a,b){return e[a.layer.uid]=b});a.sort(function(a,b){return(e[b.layer.uid]||0)-(e[a.layer.uid]||
0)})};d.prototype._generateLayerViews=function(){var a=[];k.filter(this._filterLayerViews,this).map(this.get,this).filter(function(a){return null!=a}).forEach(this._collectLayerViews("layerViews",a));return a};d.prototype._filterLayerViews=function(a){var e=!this.groundLegendVisible&&"view.groundView.layerViews"===a;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===a||"view.basemapView.referenceLayerViews"===a))&&!e};d.prototype._collectLayerViews=function(a,e){var b=function(c){c&&
c.forEach(function(c){e.push(c);b(c[a])});return e};return b};d.prototype._filterLayerViewsByLayerInfos=function(a){var e=this,b=this.layerInfos;return b&&b.length?b.some(function(b){return e._hasLayerInfo(b,a)}):!0};d.prototype._hasLayerInfo=function(a,e){var b=this._isLayerUIDMatching(a.layer,e.layer.uid);b&&(this._layerInfosByLayerViewId[e.uid]=a);return b};d.prototype._isLayerUIDMatching=function(a,e){return a&&(a.uid===e||this._hasLayerUID(a.layers,e))};d.prototype._hasLayerUID=function(a,e){var b=
this;return a&&a.some(function(a){return b._isLayerUIDMatching(a,e)})};d.prototype._isLayerViewSupported=function(a){return-1<y.indexOf(a.layer.declaredClass)?(this._layerViewByLayerId[a.layer.uid]=a,!0):!1};d.prototype._generateActiveLayerInfo=function(a){var e=this;this._isLayerActive(a)?this._buildActiveLayerInfo(a):(this._handles.remove(a.uid),this._handles.add(m.watch(a,"suspended, layer.legendEnabled",function(){return e._layerActiveHandle(a)}),a.uid))};d.prototype._layerActiveHandle=function(a){this._isLayerActive(a)&&
(this._handles.remove(a.uid),this._buildActiveLayerInfo(a))};d.prototype._isLayerActive=function(a){return!a.suspended&&a.get("layer.legendEnabled")};d.prototype._buildActiveLayerInfo=function(a){var e=this,b=a.layer,c=a.uid,d=this._layerInfosByLayerViewId[c],k=this._activeLayerInfosByLayerViewId[c];k||(k=new n({layer:b,title:d&&void 0!==d.title?d.title:b.title}),this._activeLayerInfosByLayerViewId[c]=k);k.parent||(d=(d=b.parent)&&this._layerViewByLayerId[d.uid],k.parent=d&&this._activeLayerInfosByLayerViewId[d.uid]);
if(!this._handles.has(c)){var d=m.watch(b,"title",function(b){return e._titleHandle(b,k,a)}),f=m.watch(b,"legendEnabled",function(b){return e._legendEnabledHandle(b,k,a)}),b=m.watch(b,"renderer, opacity",function(){return e._constructLegendElements(k,a)}),r=m.watch(a,"suspended",function(b){return e._suspendedHandle(b,k,a)}),t=m.whenTrue(this.view,"stationary",function(){return e._scaleHandle(k,a)});this._handles.add([d,f,b,r,t],c);this._constructLegendElements(k,a)}this._addActiveLayerInfo(k,a)};
d.prototype._titleHandle=function(a,b,c){b.title=a;this._constructLegendElements(b,c)};d.prototype._legendEnabledHandle=function(a,b,c){a?this._addActiveLayerInfo(b,c):this._removeActiveLayerInfo(b)};d.prototype._suspendedHandle=function(a,b,c){a?this._removeActiveLayerInfo(b):this._addActiveLayerInfo(b,c)};d.prototype._scaleHandle=function(a,b){a.scale!==this.view.scale&&a.isScaleDriven&&this._constructLegendElements(a,b)};d.prototype._addActiveLayerInfo=function(a,b){this._isLayerActive(b)&&-1===
this.activeLayerInfos.indexOf(a)&&((b=a.parent,b)?-1===b.children.indexOf(a)&&(b.children.push(a),this._sortActiveLayerInfos(b.children)):(this.activeLayerInfos.add(a),this._sortActiveLayerInfos(this.activeLayerInfos)))};d.prototype._removeActiveLayerInfo=function(a){var b=a.parent;b?(a=b.children.indexOf(a),-1!==a&&b.children.splice(a,1)):this.activeLayerInfos.remove(a)};d.prototype._constructLegendElements=function(a,b){b=b.layer;a.scale=this.view.scale;b.featureCollections?a.buildLegendElementsForFeatureCollections(b.featureCollections):
b.renderer?a.buildLegendElementsForRenderer():b.url&&a.buildLegendElementsForTools()};f([q.property({type:w})],d.prototype,"activeLayerInfos",void 0);f([q.property()],d.prototype,"basemapLegendVisible",void 0);f([q.property()],d.prototype,"groundLegendVisible",void 0);f([q.property()],d.prototype,"layerInfos",void 0);f([q.property({dependsOn:["view.ready"],readOnly:!0})],d.prototype,"state",null);f([q.property()],d.prototype,"view",void 0);return d=f([q.subclass("esri.widgets.Legend.LegendViewModel")],
d)}(q.declared(c))})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/io-query dojo/_base/lang ../../../Color ../../../request ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Handles ../../../core/lang ../../../core/Logger ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/support/ExportImageParameters ../../../renderers/support/jsonUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/support/gfxUtils ../../../symbols/support/symbolPreview ../../../symbols/support/symbolUtils ./colorRampUtils ./sizeRampUtils".split(" "),
function(x,g,b,f,c,d,r,m,q,n,w,y,k,h,p,a,e,l,u,v,G,C,H,t,B){function z(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function N(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function O(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function E(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function K(a){return"esri.renderers.PointCloudStretchRenderer"===a.declaredClass}function L(a){return"esri.renderers.PointCloudUniqueValueRenderer"===
a.declaredClass}var F=h.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),M=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,I=new v({size:6,outline:{color:[128,128,128,.5],width:.5}});return function(v){function h(a){a=v.call(this,a)||this;a._handles=new y;a._hasColorRamp=!1;a._hasOpacityRamp=!1;a._hasSizeRamp=!1;a._legendResponse={};a._webStyleSymbolCache=new Map;a.children=new w;a.layer=null;a.legendElements=[];a.parent=null;a.scale=null;a.title=null;return a}b(h,v);h.prototype.initialize=function(){var b=
this,e=function(){return b.notifyChange("ready")};this._handles.add([a.on(this,"children","change",function(c){var J=c.removed,d=b._handles;c.added.map(function(b){var c="activeLayerInfo-ready-watcher-"+b.layer.uid;d.add(a.init(b,"ready",e),c)});J.forEach(function(a){return d.remove(a.layer.uid)});e()})])};h.prototype.destroy=function(){this._handles.destroy();this._webStyleSymbolCache=this._legendResponse=this._handles=null};Object.defineProperty(h.prototype,"ready",{get:function(){return null===
this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isScaleDriven",{get:function(){var a=this,b=this.layer;if(null===b)return!1;if(b.renderer){var e=b.get("renderer.valueExpression");return M.test(e)?!0:(b=b.get("renderer.visualVariables"))&&b.some(function(b){return a._isScaleDrivenSizeVariable(b)})}return!0},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"version",{get:function(){return this._get("version")+
1},enumerable:!0,configurable:!0});h.prototype.buildLegendElementsForFeatureCollections=function(a){var b=this;this.legendElements=[];a.forEach(function(a){if("esri.layers.FeatureLayer"===a.declaredClass)b._buildRendererLegendElements(a.renderer,a.title,"append");else if(a.featureSet&&a.featureSet.features.length){var e=a.layerDefinition;(e=(e=e&&e.drawingInfo)&&u.fromJSON(e.renderer))?b._buildRendererLegendElements(e,a.name,"append"):F.warn("drawingInfo not available!")}})};h.prototype.buildLegendElementsForRenderer=
function(){this._buildRendererLegendElements(this.layer.renderer,null,"replace")};h.prototype.buildLegendElementsForTools=function(){var a=this,b=this.layer;"esri.layers.WMTSLayer"===b.declaredClass?this._constructLegendElementsForWMTSlayer():"esri.layers.WMSLayer"===b.declaredClass?this._constructLegendElementsForWMSSublayers():"esri.layers.MapImageLayer"===b.declaredClass?this._constructLegendElementsForSublayers():(this._handles.remove("imageryLayers-watcher"),this._getLegendLayers().then(function(e){a.legendElements=
[];e.forEach(function(e){if("esri.layers.ImageryLayer"===a.layer.declaredClass){var c=b.watch("renderingRule, bandIds",function(){a._legendResponse["default"]=null;a.buildLegendElementsForTools()});a._handles.add(c,"imageryLayers-watcher")}(e=a._generateSymbolTableElementForLegendLayer(e))&&e.infos.length&&a.legendElements.push(e);a.notifyChange("ready")});a.notifyChange("ready")}).catch(function(a){F.warn("Request to server for legend has failed!",a)}))};h.prototype._isGroupActive=function(){var a=
this.children;return a.length?a.some(function(a){return a.ready}):!1};h.prototype._isScaleDrivenSizeVariable=function(a){if(a&&"size"!==a.type)return!1;var b=a.minSize,e=a.maxSize;return"object"===typeof b&&b?this._isScaleDrivenSizeVariable(b):"object"===typeof e&&e?this._isScaleDrivenSizeVariable(e):!!a.expression||M.test(a.valueExpression)};h.prototype._buildRendererLegendElements=function(a,b,e){var c=this;this._getRendererLegendElements(a,b).then(function(a){"append"===e?Array.prototype.push.apply(c.legendElements,
a):c.legendElements=a;c.notifyChange("ready")}).catch(function(a){F.warn("error while building legend for layer!",a)})};h.prototype._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");var b=this.layer,e=b.activeLayer;this._handles.add(a.watch(this.layer,"activeLayer",this._constructLegendElementsForWMTSlayer.bind(this)),"wmts-activeLayer-watcher");if(e.styleId&&e.styles){var c=null;e.styles.some(function(a){if(e.styleId===a.id)return c=
a.legendUrl,!0});c&&(this.legendElements=[{type:"symbol-table",title:e.title,infos:[{src:c,opacity:b.opacity}]}])}this.notifyChange("ready")};h.prototype._constructLegendElementsForWMSSublayers=function(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");var b=this.layer,e=null;if(b.customParameters||b.customLayerParameters)e=k.clone(b.customParameters||{}),d.mixin(e,b.customLayerParameters||{});this._handles.add(a.watch(this.layer,"sublayers",this._constructLegendElementsForWMSSublayers.bind(this)),
"wms-sublayers-watcher");this.legendElements=this._generateLegendElementsForWMSSublayers(b.sublayers,e);this.notifyChange("ready")};h.prototype._generateLegendElementsForWMSSublayers=function(a,b){var e=this,c=[];this._handles.add(a.on("change",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");a.forEach(function(a){var d=a.watch("title, visible, legendEnabled",function(){return e._constructLegendElementsForWMSSublayers()});e._handles.add(d,"wms-sublayers-watcher");
a.visible&&a.legendEnabled&&(a=e._generateSymbolTableElementForWMSSublayer(a,b))&&a.infos.length&&c.unshift(a)});return c};h.prototype._generateSymbolTableElementForWMSSublayer=function(a,b){return!a.legendUrl&&a.sublayers?(b=this._generateLegendElementsForWMSSublayers(a.sublayers,b).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:b}):this._generateSymbolTableElementForLegendUrl(a,b)};h.prototype._generateSymbolTableElementForLegendUrl=function(a,b){var e=a.legendUrl;if(e){var d=
{type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};b&&(e+="?"+c.objectToQuery(b));d.infos.push({src:e,opacity:a.layer&&a.layer.opacity});return d}};h.prototype._getLegendLayers=function(a){var b=this,e=(a=a&&a.hasDynamicLayers?a.dynamicLayers:null)||"default",c=this._legendResponse&&this._legendResponse[e];return c?p.resolve(c):this._legendRequest(a).then(function(a){a=a.layers;return b._legendResponse[e]=a})};h.prototype._legendRequest=function(a){var b=this.layer;a={f:"json",dynamicLayers:a};
"esri.layers.ImageryLayer"===b.declaredClass&&(b.renderingRule&&(a.renderingRule=JSON.stringify(b.renderingRule.toJSON())),b.bandIds&&(a.bandIds=b.bandIds.join()));var e=b.url.replace(/(\/)+$/,"");if(10.01<=b.version){var c=e.indexOf("?"),e=-1<c?e.substring(0,c)+"/legend"+e.substring(c):e+"/legend";b.token&&(e+="?token\x3d"+b.token)}else b=e.toLowerCase().indexOf("/rest/"),b=e.substring(0,b)+e.substring(b+5,e.length),e="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(b)+"\x26returnbytes\x3dtrue";
return m(e,{query:a,callbackParamName:"callback"}).then(function(a){return a.data})};h.prototype._constructLegendElementsForSublayers=function(){var b=this;this.legendElements=[];this._handles.remove("sublayers-watcher");var e=this.layer,c=new l({layer:e});this._getLegendLayers(c).then(function(c){var d={};c.forEach(function(a){d[a.layerId]=a});b._handles.add(a.watch(e,"sublayers",b._constructLegendElementsForSublayers.bind(b)),"sublayers-watcher");b.legendElements=b._generateLegendElementsForSublayers(e.sublayers,
d,e.opacity);b.notifyChange("ready")}).catch(function(a){F.warn("Request to server for legend has failed!",a)}).then(function(){return c.destroy()});this.notifyChange("ready")};h.prototype._generateLegendElementsForSublayers=function(a,b,e){var c=this,d=[];this._handles.add(a.on("change",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher");a.forEach(function(a){var l=a.watch("renderer, opacity, title, visible",function(){return c._constructLegendElementsForSublayers()});c._handles.add(l,
"sublayers-watcher");a.visible&&a.legendEnabled&&(l=a&&null!=a.opacity?a.opacity:null,(a=c._generateSymbolTableElementForSublayer(a,b,null!=l?l*e:e))&&a.infos.length&&d.unshift(a))});return d};h.prototype._generateSymbolTableElementForSublayer=function(a,b,e){var c=b[a.id];return!c&&a.sublayers?(b=this._generateLegendElementsForSublayers(a.sublayers,b,e).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:b}):this._generateSymbolTableElementForLegendLayer(c,a,e)};h.prototype._generateSymbolTableElementForLegendLayer=
function(a,b,e){var c=this;if(a){var d=b&&b.renderer,l=b&&b.title||a.layerName;d&&(d=b&&b.title||this._getRendererTitle(d,b))&&(l&&(d.title=l),l=d);l={type:"symbol-table",title:l,infos:[]};a.legendType&&(l.legendType=a.legendType);a.legend&&this._isLegendLayerInScale(a,b)&&(b=b?this._sanitizeLegendForSublayer(a.legend.slice(),b):a.legend,l.infos=b.map(function(b){var d=b.url;if(b.imageData&&0<b.imageData.length)d="data:image/png;base64,"+b.imageData;else if(0!==d.indexOf("http")){var d=c.layer.url+
"/"+a.layerId+"/images/"+d,l=c.layer.token;l&&(d+="?token\x3d"+l)}else return null;return{label:b.label,src:d,opacity:e,width:b.width,height:b.height}}).filter(function(a){return!!a}));return l.infos.length?l:null}};h.prototype._isLegendLayerInScale=function(a,b){b=b||this.layer;var e=null,c=null,d=!0;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==b.maxScale?(0===a.minScale&&b.tileInfo&&(e=b.tileInfo.lods[0].scale),0===a.maxScale&&b.tileInfo&&(c=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(e=
Math.min(b.minScale,a.minScale)||b.minScale||a.minScale,c=Math.max(b.maxScale,a.maxScale));if(0<e&&e<this.scale||c>this.scale)d=!1;return d};h.prototype._sanitizeLegendForSublayer=function(a,b){if(10.1>this.layer.version||0===a.length)return a;b=b.renderer;var e=null,c=null;a.some(function(a){return a.values})&&a.some(function(a,b){a.values||(e=b,c=a,c.label||(c.label="others"));return null!=c});b?"unique-value"===b.type?c&&(a.splice(e,1),a.push(c)):"class-breaks"===b.type&&(c&&a.splice(e,1),a.reverse(),
c&&a.push(c)):c&&(a.splice(e,1),a.push(c));return a};h.prototype._getRendererLegendElements=function(a,b){return z(a)||N(a)||O(a)||E(a)||K(a)||L(a)?E(a)||K(a)||L(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?this._constructPointCloudRendererLegendElements(a,b):this._constructRendererLegendElements(a,b):(F.warn("Renderer not supported!"),p.resolve([]))};h.prototype._getPointCloudRendererTitle=function(a){return a.legendOptions&&a.legendOptions.title||a.field};h.prototype._constructPointCloudRendererLegendElements=
function(a,b){var e=this,c=this.layer.opacity,d=[],l=null,k=null;if(E(a))l={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(function(a){l.infos.unshift({label:a.label||a.minValue+" - "+a.maxValue,value:[a.minValue,a.maxValue],symbol:e._getAppliedCloneSymbol(I,a.color,c)})});else if(K(a)){var k=a.stops,h=null;if(k.length&&(1===k.length&&(h=k[0].color),!h)){var f=k[0].value,u=k[k.length-1].value;null!=f&&null!=u&&(h=t.getColorFromPointCloudStops(f+
(u-f)/2,k))}l={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(I,h||I.color,c)}]};k={type:"color-ramp",title:b||this._getPointCloudRendererTitle(a),borderColor:G.getStroke(I).color,overlayColor:t.getRampOverlayColor(c),infos:t.getRampStopsForPointCloud(a.stops)}}else L(a)&&(l={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos.forEach(function(a){l.infos.push({label:a.label||a.values.join(", "),value:a.values.join(", "),
symbol:e._getAppliedCloneSymbol(I,a.color,c)})}));l&&l.infos.length&&d.push(l);k&&k.infos.length&&d.push(k);a=d.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!!a.symbol}).map(function(a){return e._getSymbolPreview(a)});return p.eachAlways(a).then(function(){return d})};h.prototype._constructRendererLegendElements=function(a,b){var e=this;return this._loadRenderer(a).then(function(a){e._hasColorRamp=!1;e._hasOpacityRamp=!1;e._hasSizeRamp=!1;var c=e._getVisualVariableLegendElements(a)||
[],d={type:"symbol-table",title:b||e._getRendererTitle(a),infos:[]},l=null;if(O(a)){var k=a.field;a.uniqueValueInfos.forEach(function(a){a.symbol&&d.infos.push({label:a.label||e._getDomainName(k,a.value)||a.value,value:a.value,symbol:a.symbol})})}else N(a)?(l=e._isUnclassedRenderer(a),l&&e._hasSizeRamp||(a.classBreakInfos.forEach(function(a){a.symbol&&d.infos.unshift({label:a.label||(l?null:a.minValue+" - "+a.maxValue),value:[a.minValue,a.maxValue],symbol:a.symbol})}),l&&(d.title=null),e._updateInfosforClassedSizeRenderer(a,
d.infos))):z(a)&&a.symbol&&!e._hasSizeRamp&&d.infos.push({label:a.label,symbol:a.symbol});var h=!1,t=a.defaultLabel,f=a.defaultSymbol;f&&!l&&(d.infos.push({label:t||"others",symbol:f}),h=!0);h||z(a)||l&&!e._hasColorRamp&&!e._hasSizeRamp&&!e._hasOpacityRamp||c.push({type:"symbol-table",infos:[{label:a.defaultLabel,symbol:a.defaultSymbol}]});d.infos.length&&c.unshift(d);var u=e._getSymbolConfig(a.visualVariables),h=c.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!!a.symbol}).map(function(a){return e._getSymbolPreview(a,
u)});a=null;return p.eachAlways(h).then(function(){return c})})};h.prototype._updateInfosforClassedSizeRenderer=function(a,b){var e=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,c=a.classBreakInfos.some(function(a){return H.isVolumetricSymbol(a.symbol)});if(e&&c){var d=B.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;var l=(d-B.REAL_WORLD_MIN_SIZE)/(1<a?a-1:a);b.forEach(function(a,b){a.size=d-l*b})}};h.prototype._getSymbolConfig=function(a){var b=!1,e=!1;if(a)for(var c=0;c<a.length&&
(!b||!e);c++){var d=a[c];"size"===d.type&&("height"===d.axis&&(b=!0),"width-and-depth"===d.axis&&(e=!0))}return b&&e?"tall":null};h.prototype._getSymbolPreview=function(a,b){return C.renderPreviewHTML(a.symbol,{size:a.size,opacity:this.layer.opacity,symbolConfig:b}).then(function(b){a.preview=b;return a}).catch(function(){a.preview=null;return a})};h.prototype._loadRenderer=function(a){var b=this,e=[];a=a.clone();var c=this._getMedianColor(a),d=this.layer.opacity;if(N(a)||O(a)){var l=(a.classBreakInfos||
a.uniqueValueInfos).map(function(a){return b._fetchSymbol(a.symbol,c,d).then(function(b){a.symbol=b}).catch(function(){a.symbol=null})});Array.prototype.push.apply(e,l)}e.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:c,d).then(function(e){b._applySymbolToRenderer(a,e,z(a))}).catch(function(){b._applySymbolToRenderer(a,null,z(a))}));return p.eachAlways(e).then(function(){return a})};h.prototype._applySymbolToRenderer=function(a,b,e){e?a.symbol=b:a.defaultSymbol=b};h.prototype._getMedianColor=
function(a){if(!a.visualVariables)return null;var b=n.find(a.visualVariables,function(a){return"color"===a.type});if(!b)return null;var e=null,c=null;if(b.colors)e=b.minDataValue,c=b.maxDataValue;else if(b.stops){if(1===b.stops.length)return b.stops[0].color;e=b.stops[0].value;c=b.stops[b.stops.length-1].value}if(null!=e&&null!=c)return a.getColor(e+(c-e)/2,{colorInfo:b})};h.prototype._fetchSymbol=function(a,b,e){var c=this;if(!a)return p.reject();if("web-style"===a.type){var d=a.portal,d=a.name+
"-"+a.styleName+"-"+a.styleUrl+"-"+(d&&d.url)+"-"+(d&&d.user&&d.user.username),l=this._webStyleSymbolCache;l.has(d)||l.set(d,a.fetchSymbol());return l.get(d).then(function(a){return c._getAppliedCloneSymbol(a,b,e)}).catch(function(){F.warn("Fetching web-style failed!");return p.reject()})}return p.resolve(this._getAppliedCloneSymbol(a,b,e))};h.prototype._getAppliedCloneSymbol=function(a,b,e){if(!a)return a;a=a.clone();var c=-1<a.type.indexOf("3d");b=b&&b.toRgba();c?this._applyColorTo3dSymbol(a,b,
e):(a.color&&(a.color=this._getOpacityAppliedColor(b||a.color.toRgba(),e)),(b=a.outline)&&b.color&&(b.color=this._getOpacityAppliedColor(b.color.toRgba(),e)));return a};h.prototype._applyColorTo3dSymbol=function(a,b,e){var c=this;a.symbolLayers.forEach(function(a){a&&(b&&(a.material||(a.material={}),a.material.color=new r(b)),null!=e&&(a.material&&a.material.color&&(a.material.color=c._getOpacityAppliedColor(a.material.color.toRgba(),e)),a.outline&&a.outline.color&&(a.outline.color=c._getOpacityAppliedColor(a.outline.color.toRgba(),
e))))})};h.prototype._getOpacityAppliedColor=function(a,b){a[3]*=b;return a};h.prototype._getVisualVariableLegendElements=function(a){var b=this,e=a.visualVariables,c=[],d=[],l=[],k=this.layer.opacity;if(!e)return null;e.forEach(function(a){"color"===a.type?c.push(a):"size"===a.type?d.push(a):"opacity"===a.type&&l.push(a)});var e=c.concat(d,l),h,f;0===c.length&&N(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&(h=(h=a.classBreakInfos[0])&&h.symbol);0===c.length&&z(a)&&(h=a.symbol);h&&(-1<h.type.indexOf("3d")?
(h=h.symbolLayers.getItemAt(0),h.get("material.color")&&(f=h.material.color)):h.url||(f=h.color),f&&(f=f.toRgba()));return e.map(function(e){if(!e.legendOptions||!1!==e.legendOptions.showLegend){var c=b._getRampTitle(e,b.layer),d=t.getRampBorderColor(a),l=t.getRampOverlayColor(k),h=null;"color"===e.type?(h={type:"color-ramp",title:c,borderColor:d,overlayColor:l,infos:t.getRampStops(a,e)},b._hasColorRamp||(b._hasColorRamp=!(null==h.infos||!h.infos.length))):"size"===e.type?(h={type:"size-ramp",title:c,
infos:B.getRampStops(a,e,b._getMedianColor(a),b.scale)},b._hasSizeRamp||(b._hasSizeRamp=!(null==h.infos||!h.infos.length))):"opacity"===e.type&&(h={type:"opacity-ramp",title:c,borderColor:d,overlayColor:l,infos:t.getRampStops(a,e,f)},b._hasOpacityRamp||(b._hasOpacityRamp=!(null==h.infos||!h.infos.length)));return h.infos&&h}}).filter(function(a){return!!a})};h.prototype._getDomainName=function(a,b){if(a&&!d.isFunction(a)){var e=this.layer;return(e=(a=e.getField&&e.getField(a))&&e.getFieldDomain?e.getFieldDomain(a.name):
null)&&e.codedValues?e.getName(b):null}return null};h.prototype._getRampTitle=function(a,b){var e=a.field,c=a.normalizationField,l=!1,k=!1,h=!1,t=null,e=d.isFunction(e)?null:e,c=d.isFunction(c)?null:c;if(void 0!==(a.legendOptions&&a.legendOptions.title))t=a.legendOptions.title;else if(a.valueExpressionTitle)t=a.valueExpressionTitle;else{if(b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables)for(a=b.renderer.authoringInfo.visualVariables,t=0;t<a.length;t++){var f=a[t];if("color"===f.type)if("ratio"===
f.style){l=!0;break}else if("percent"===f.style){k=!0;break}else if("percentTotal"===f.style){h=!0;break}}t={field:e&&this._getFieldAlias(e,b),normField:c&&this._getFieldAlias(c,b),ratio:l,ratioPercent:k,ratioPercentTotal:h}}return t};h.prototype._getRendererTitle=function(a,b){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var e=this.layer,c=a.field,l=null,k=null;N(a)&&(l=a.normalizationField,k="percent-of-total"===a.normalizationType);
c=d.isFunction(c)?null:c;l=d.isFunction(l)?null:l;a=null;if(c||l)a={field:b?c:c&&this._getFieldAlias(c,e),normField:b?l:l&&this._getFieldAlias(l,e),normByPct:k};return a};h.prototype._getFieldAlias=function(a,b){var e=b.popupTemplate,e=e&&e.fieldInfos;b=d.isFunction(a)?null:b.getField&&b.getField(a);var c=null;e&&e.some(function(b){if(a===b.fieldName)return c=b,!0});var e=c||b,l=null;e&&(l=c&&c.label||b&&b.alias||e.name||e.fieldName);return l};h.prototype._isUnclassedRenderer=function(a){var b=a.visualVariables,
e=!1;N(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&b&&(e=a.field?b.some(function(b){return!(!b||a.field!==b.field||(a.normalizationField||b.normalizationField)&&a.normalizationField!==b.normalizationField)}):!!b.length);return e};f([e.property()],h.prototype,"children",void 0);f([e.property()],h.prototype,"layer",void 0);f([e.property()],h.prototype,"legendElements",void 0);f([e.property()],h.prototype,"parent",void 0);f([e.property({readOnly:!0})],h.prototype,"ready",null);f([e.property()],
h.prototype,"scale",void 0);f([e.property({dependsOn:["layer.renderer.valueExpression","layer.renderer.visualVariables"],readOnly:!0})],h.prototype,"isScaleDriven",null);f([e.property()],h.prototype,"title",void 0);f([e.property({dependsOn:["ready"],readOnly:!0,value:0})],h.prototype,"version",null);return h=f([e.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],h)}(e.declared(q))})},"esri/layers/support/ExportImageParameters":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/_base/lang ../../core/Accessor ../../core/accessorSupport/decorators ./sublayerUtils".split(" "),
function(x,g,b,f,c,d,r,m){var q={visible:"visibleSublayers",definitionExpression:"layerDefs",labelsVisible:"hasDynamicLayers",labelingInfo:"hasDynamicLayers",opacity:"hasDynamicLayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};return function(d){function g(){var b=null!==d&&d.apply(this,arguments)||this;b.scale=0;return b}b(g,d);Object.defineProperty(g.prototype,"dynamicLayers",{get:function(){if(!this.hasDynamicLayers)return null;var b=this.visibleSublayers.map(function(b){return b.toExportImageJSON()});
return b.length?JSON.stringify(b):null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"hasDynamicLayers",{get:function(){return m.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"layer",{set:function(b){var c=this;this._get("layer")!==b&&(this._set("layer",b),this._layerHandles&&(this._layerHandles.forEach(function(b){return b.remove()}),this._layerHandles.length=0),b&&(this._layerHandles=
[b.allSublayers.on("change",function(){return c.notifyChange("visibleSublayers")}),b.on("sublayer-update",function(b){return c.notifyChange(q[b.propertyName])})]))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"layers",{get:function(){var b=this.visibleSublayers;return b?b.length?"show:"+b.map(function(b){return b.id}).join(","):"show:-1":null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"layerDefs",{get:function(){var b=this.visibleSublayers.filter(function(b){return null!=
b.definitionExpression});return b.length?JSON.stringify(b.reduce(function(b,c){b[c.id]=c.definitionExpression;return b},{})):null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"version",{get:function(){return(this._get("version")||0)+1},set:function(b){this._set("version",b)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"visibleSublayers",{get:function(){var b=this,c=this.layer.sublayers,d=[],f=function(a){var e=b.scale,c=0===a.minScale||e<=a.minScale,k=0===
a.maxScale||e>=a.maxScale;a.visible&&(0===e||c&&k)&&(a.sublayers?a.sublayers.forEach(f):d.unshift(a))};c&&c.forEach(f);return d},enumerable:!0,configurable:!0});g.prototype.toJSON=function(){var b=this.layer,b={dpi:b.dpi,format:b.imageFormat,transparent:b.imageTransparency,gdbVersion:b.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?b.dynamicLayers=this.dynamicLayers:c.mixin(b,{layers:this.layers,layerDefs:this.layerDefs});return b};f([r.property({readOnly:!0,dependsOn:["hasDynamicLayers",
"visibleSublayers"]})],g.prototype,"dynamicLayers",null);f([r.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],g.prototype,"hasDynamicLayers",null);f([r.property()],g.prototype,"layer",null);f([r.property({readOnly:!0,dependsOn:["visibleSublayers"]})],g.prototype,"layers",null);f([r.property({readOnly:!0,dependsOn:["visibleSublayers"]})],g.prototype,"layerDefs",null);f([r.property({type:Number})],g.prototype,"scale",void 0);f([r.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion".split(" ")})],
g.prototype,"version",null);f([r.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],g.prototype,"visibleSublayers",null);return g=f([r.subclass("esri.layers.mixins.ExportImageParameters")],g)}(r.declared(d))})},"esri/layers/support/sublayerUtils":function(){define(["require","exports","./layerSourceUtils"],function(x,g,b){function f(b,d){function c(b){var d=b.sublayers;f.unshift(b.id);d&&d.forEach(c)}if(!b||!b.length)return!0;var f=[];d.forEach(c);if(b.length>f.length)return!1;d=0;for(var q=
f.length,g=0;g<b.length;g++){for(var w=b[g].id;d<q&&f[d]!==w;)d++;if(d>=q)return!1}return!0}Object.defineProperty(g,"__esModule",{value:!0});g.isExportDynamic=function(c,d,r){return c.some(function(c){var d=c.source;return!(!d||d.type===b.MAPLAYER&&d.mapLayerId===c.id&&(!d.gdbVersion||d.gdbVersion===r.gdbVersion))||null!=c.renderer||null!=c.labelingInfo||c.hasOwnProperty("opacity")&&null!=c.opacity||c.hasOwnProperty("labelsVisible")&&null!=c.labelsVisible})?!0:!f(c,d)};g.sameStructureAsService=function(b,
d){return d.flatten(function(b){return(b=b.sublayers)&&b.toArray().reverse()}).toArray().reverse().every(function(c,d){return(d=b[d])&&c.id===d.id&&(null==c.sublayers&&null==d.sublayers||null!=c.sublayers&&null!=d.sublayers&&c.sublayers.map(function(b){return b.id}).join(",")===d.sublayers.map(function(b){return b.id}).join(","))})}})},"esri/symbols/support/gfxUtils":function(){define("require exports dojo/_base/lang dojox/gfx/_base ../../Color ../../request ../../core/LRUMap ../../core/promiseUtils ../../core/screenUtils".split(" "),
function(x,g,b,f,c,d,r,m,q){function n(a){if(!a)return null;var b,c=a.constructor,d=q.pt2px(a.width);switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":b=n(a.outline);break;case "simple-line":a.style!==c.STYLE_NULL&&0!==d&&(b={color:a.color,style:p(a.style),width:d,cap:a.cap,join:a.join===c.JOIN_MITER?q.pt2px(a.miterLimit):a.join});break;default:b=null}return b}Object.defineProperty(g,"__esModule",{value:!0});var w=x.toUrl("../../symbols/patterns/"),y={left:"start",center:"middle",
right:"end",justify:"start"},k={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},h=new r(1E3);g.getSVGAlign=function(a){return a=(a=a.horizontalAlignment)&&y[a.toLowerCase()]||"middle"};g.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&k[a.toLowerCase()]||"alphabetic"};g.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};g.getFill=function(a){var e=a.style,c=null;if(a){var d=a.constructor;switch(a.type){case "simple-marker":e!==
d.STYLE_CROSS&&e!==d.STYLE_X&&(c=a.color);break;case "simple-fill":e===d.STYLE_SOLID?c=a.color:e!==d.STYLE_NULL&&(c=b.mixin({},f.defaultPattern,{src:w+e+".png",width:8,height:8}));break;case "picture-fill":c=b.mixin({},f.defaultPattern,{src:a.url,width:q.pt2px(a.width)*a.xscale,height:q.pt2px(a.height)*a.yscale,x:q.pt2px(a.xoffset),y:q.pt2px(a.yoffset)});break;case "text":c=a.color}}return c};g.getPatternUrlWithColor=function(a,b){var e=a+"-"+b;return h.has(e)?m.resolve(h.get(e)):d(a,{responseType:"image",
allowImageDataAccess:!0}).then(function(a){a=a.data;var c=a.naturalWidth,d=a.naturalHeight,l=document.createElement("canvas");l.width=c;l.height=d;var k=l.getContext("2d");k.fillStyle=b;k.fillRect(0,0,c,d);k.globalCompositeOperation="destination-in";k.drawImage(a,0,0);a=l.toDataURL();h.set(e,a);return a})};g.getStroke=n;var p=function(){var a={};return function(b){if(a[b])return a[b];var e=b.replace(/-/g,"");return a[b]=e}}();g.defaultThematicColor=new c([128,128,128])})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(x,g,b,f,c,d,r,m,q){var n=g.getObject("dojox.gfx",!0),w=n._base={};n._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+b+" ")};n._addClass=function(a,b){var e=a.getAttribute("className")||"";(!e||0>(" "+e+" ").indexOf(" "+b+" "))&&a.setAttribute("className",e+(e?" ":"")+b)};n._removeClass=function(a,b){var e=a.getAttribute("className");e&&a.setAttribute("className",e.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};w._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},b,d;f("ie")&&(d=c.doc.documentElement.style.fontSize||"",d||(c.doc.documentElement.style.fontSize="100%"));var k=m.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},c.body());for(b in a)k.style.fontSize=b,a[b]=16*Math.round(12*k.offsetHeight/16)/12/1E3;
f("ie")&&(c.doc.documentElement.style.fontSize=d);c.body().removeChild(k);return a};var y=null;w._getCachedFontMeasurements=function(a){if(a||!y)y=w._getFontMeasurements();return y};var k=null,h={};w._getTextBox=function(a,b,d){var e,l,f=arguments.length,r;k||(k=m.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},c.body()));e=k;e.className="";l=e.style;l.borderWidth="0";l.margin="0";l.padding="0";l.outline="0";if(1<f&&b)for(r in b)r in h||(l[r]=b[r]);2<f&&d&&(e.className=
d);e.innerHTML=a;e.getBoundingClientRect?(l=e.getBoundingClientRect(),l={l:l.left,t:l.top,w:l.width||l.right-l.left,h:l.height||l.bottom-l.top}):l=q.getMarginBox(e);e.innerHTML="";return l};w._computeTextLocation=function(a,b,c,d){var e={};switch(a.align){case "end":e.x=a.x-b;break;case "middle":e.x=a.x-b/2;break;default:e.x=a.x}e.y=a.y-c*(d?.75:1);return e};w._computeTextBoundingBox=function(a){if(!n._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var c=a.getFont()||n.defaultFont;
a=a.getTextWidth();c=n.normalizedLength(c.size);b=w._computeTextLocation(b,a,c,!0);return{x:b.x,y:b.y,width:a,height:c}};w._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var p=0;w._getUniqueId=function(){var a;do a=x._scopeName+"xUnique"+ ++p;while(r.byId(a));return a};w._fixMsTouchAction=function(a){a.rawNode.style.touchAction="none"};g.mixin(n,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,
height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},
defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var e=a[b];if(e)return new e;e=a[b]=new Function;e.prototype=
n["default"+b];return new e}}(),normalizeColor:function(a){return a instanceof b?a:new b(a)},normalizeParameters:function(a,b){var e;if(b){var c={};for(e in a)e in b&&!(e in c)&&(a[e]=b[e])}return a},makeParameters:function(a,b){var e=null;if(!b)return g.delegate(a);var c={};for(e in a)e in c||(c[e]=g.clone(e in b?b[e]:a[e]));return c},formatNumber:function(a,b){var e=a.toString();if(0<=e.indexOf("e"))e=a.toFixed(4);else{var c=e.indexOf(".");0<=c&&5<e.length-c&&(e=a.toFixed(4))}return 0>a?e:b?" "+
e:e},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=n.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var c=a[3].indexOf("/");b.size=0>c?a[3]:a[3].substring(0,c);var d=4;0>c&&("/"==a[4]?d=6:"/"==a[4].charAt(0)&&(d=5));d<a.length&&(b.family=a.slice(d).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return n._base._getCachedFontMeasurements()["12pt"]/
12},pt2px:function(a){return a*n.px_in_pt()},px2pt:function(a){return a/n.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=n.px_in_pt(),c=parseFloat(a);switch(a.slice(-2)){case "px":return c;case "pt":return c*b;case "in":return 72*c*b;case "pc":return 12*c*b;case "mm":return c*n.mm_in_pt*b;case "cm":return c*n.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,
equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?n[a]:a;b&&(d.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){n[a]=b[a]}),"string"==typeof a?n.renderer=a:d.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return n.renderer=n[a]&&n[a].Surface===n.Surface?a:null}))}});return n})},"esri/symbols/support/symbolPreview":function(){define(["require",
"exports","./previewSymbol2D","./previewSymbol3D","./previewWebStyleSymbol"],function(x,g,b,f,c){function d(r,m){switch(r.type){case "web-style":return c.previewWebStyleSymbol(r,d,m);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return f.previewSymbol3D(r,m);default:return b.previewSymbol2D(r,m)}}Object.defineProperty(g,"__esModule",{value:!0});g.renderPreviewHTML=d})},"esri/symbols/support/previewSymbol2D":function(){define("require exports dojox/gfx/_base ../../core/Error ../../core/promiseUtils ../../core/screenUtils ../SimpleMarkerSymbol ./gfxUtils ./previewUtils ./renderUtils".split(" "),
function(x,g,b,f,c,d,r,m,q,n){function w(b,c){var d=y.getContext("2d"),a=[];c&&(c.weight&&a.push(c.weight),c.size&&a.push(c.size+"px"),c.family&&a.push(c.family));d.font=a.join(" ");return d.measureText(b).width}Object.defineProperty(g,"__esModule",{value:!0});var y=document.createElement("canvas");g.previewSymbol2D=function(k,h){var p=h&&h.size?d.pt2px(h.size):null,a=h&&h.maxSize?d.pt2px(h.maxSize):null,e=m.getStroke(k),l={shape:null,fill:null,stroke:e};e&&e.width&&(e.width=Math.min(e.width,80));
var u=0,v=0,g=e&&e.width||0,C=!1,y=null;switch(k.type){case "simple-marker":var t=r.defaultProps,e=k.style,v=u=p=Math.min(p||d.pt2px(k.size||t.size),a||120);switch(e){case r.STYLE_CIRCLE:l.shape={type:"circle",cx:0,cy:0,r:.5*p};break;case r.STYLE_CROSS:l.shape={type:"path",path:[{command:"M",values:[0,.5*v]},{command:"L",values:[u,.5*v]},{command:"M",values:[.5*u,0]},{command:"L",values:[.5*u,v]},{command:"E",values:[]}]};break;case r.STYLE_DIAMOND:l.shape={type:"path",path:[{command:"M",values:[0,
.5*v]},{command:"L",values:[.5*u,0]},{command:"L",values:[u,.5*v]},{command:"L",values:[.5*u,v]},{command:"Z",values:[]}]};break;case r.STYLE_SQUARE:l.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[u,0]},{command:"L",values:[u,v]},{command:"L",values:[0,v]},{command:"Z",values:[]}]};break;case r.STYLE_X:l.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[u,v]},{command:"M",values:[u,0]},{command:"L",values:[0,v]},{command:"E",values:[]}]};break;case r.STYLE_PATH:C=
!0,l.shape={type:"path",path:k.path||""}}break;case "simple-line":g=Math.min(p||g,a||80);u=22<g?2*g:40;v=g;e.width=g;g=0;l.shape={type:"path",path:[{command:"M",values:[0,.5*v]},{command:"L",values:[u,.5*v]},{command:"E",values:[]}]};break;case "picture-fill":case "simple-fill":l.shape=q.shapes.fill[0];break;case "picture-marker":a=a||120;e=d.pt2px(k.width);t=d.pt2px(k.height);p=Math.min(p||Math.max(e,t),a);t=e/t;e=1>=t?Math.ceil(p*t):p;t=1>=t?p:Math.ceil(p/t);u=e;v=t;y=h.opacity;l.shape={type:"image",
x:-Math.round(e/2),y:-Math.round(t/2),width:e,height:t,src:k.url||""};break;case "text":var e=k.text||"Aa",t=k.font,p=Math.min(p||d.pt2px(t.size),a||120),B=w(e,{weight:t.weight,size:p,family:t.family}),u=(a=/[\uE600-\uE6FF]/.test(e))?p:B,v=p,B=.25*b.normalizedLength((t?p:0).toString());a&&(B+=5);l.shape={type:"text",text:e,x:0,y:B,align:"middle",decoration:k.decoration||t&&t.decoration,rotated:k.rotated,kerning:k.kerning};l.font=t&&{size:p,style:t.style,decoration:t.decoration,weight:t.weight,family:t.family}}if(!l.shape)return c.reject(new f("symbolPreview: renderPreviewHTML2D",
"symbol not supported."));var u=(u||22)+2*g,v=(v||22)+2*g,z=m.getFill(k),g=k.color,p=null;z&&"pattern"===z.type&&g&&"picture-fill"!==k.type?p=m.getPatternUrlWithColor(z.src,g.toCss(!0)).then(function(a){z.src=a;l.fill=z;return l}):(l.fill=z,p=c.resolve(l));return p.then(function(a){return n.renderSymbol([[a]],[u,v],{node:h&&h.node,scale:C,opacity:y})})}})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(x,g){Object.defineProperty(g,"__esModule",{value:!0});g.shapes=
{fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",
path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",
path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},
{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};g.getExtrudeSymbolShapes=function(b){b*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+b]},{command:"L",values:[0,22*.7+b-.7*11]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+b]},{command:"L",values:[22,b]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};g.getCubeShapes=function(b,f){var c=f?20:b,d=f?4:6,d=c=22>=c?c-.5*d:c-d;f=f?.35*c:.5*c;return[{type:"path",path:[{command:"M",values:[.5*d,0]},{command:"L",values:[d,
.5*f]},{command:"L",values:[.5*d,f]},{command:"L",values:[0,.5*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*f]},{command:"L",values:[.5*d,f]},{command:"L",values:[.5*d,b]},{command:"L",values:[0,b-.5*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*d,f]},{command:"L",values:[.5*d,b]},{command:"L",values:[d,b-.5*f]},{command:"L",values:[d,.5*f]},{command:"Z",values:[]}]}]};g.getCylinderShapes=function(b,f){var c=f?20:b;f=f?4:6;c=22>=c?c-.5*f:c-
f;f=.5*c;var d=.15*c;b-=d;return[{type:"ellipse",cx:.5*c,cy:b,rx:f,ry:d},{type:"path",path:[{command:"M",values:[0,d]},{command:"L",values:[0,b]},{command:"L",values:[c,b]},{command:"L",values:[c,d]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*c,cy:d,rx:f,ry:d}]};g.getConeShapes=function(b,f){var c=f?20:b;f=f?4:6;c=22>=c?c-.5*f:c-f;f=.15*c;var d=c;b-=f;return[{type:"ellipse",cx:.5*c,cy:b,rx:.5*c,ry:f},{type:"path",path:[{command:"M",values:[.5*d,0]},{command:"L",values:[d,b]},{command:"L",values:[0,
b]},{command:"Z",values:[]}]}]};g.getInvertedConeShapes=function(b){var f=b,f=22>f?f-3:f-6,c=.15*f,d=f;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[d,0]},{command:"L",values:[.5*d,b-c]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*f,cy:0,rx:.5*f,ry:c}]};g.getDiamondShapes=function(b){var f=b,f=22>f?f-2:f-4,c=Math.floor(b/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[f,.5*b-c]},{command:"L",values:[.45*f-c,.5*b+c]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[.45*f-c,.5*b+c]},{command:"L",values:[0,.5*b-c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*b-c]},{command:"L",values:[.45*f-c,.5*b+c]},{command:"L",values:[.45*f,b]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*f,b]},{command:"L",values:[f,.5*b-c]},{command:"L",values:[.45*f-c,.5*b+c]},{command:"Z",values:[]}]}]};g.getTetrahedronShapes=function(b){var f=b,f=22>
f?f-1:f-2;return[{type:"path",path:[{command:"M",values:[.45*b,0]},{command:"L",values:[b,f]},{command:"L",values:[.45*b,.6*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*b,0]},{command:"L",values:[.45*b,.6*f]},{command:"L",values:[0,f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,f]},{command:"L",values:[.45*b,.6*f]},{command:"L",values:[b,f]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports dojo/_base/lang dojox/gfx dojox/gfx/matrix ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/promiseUtils ../../core/sniff".split(" "),
function(x,g,b,f,c,d,r,m,q,n,w){function y(b){return b.map(function(a){return a.command+" "+a.values.join(",")}).join(" ").trim()}function k(d,a,e,l){var k=l&&l.node||document.createElement("div"),h=f.createSurface(k,a,e);null!=l.opacity&&(k.style.opacity=l.opacity.toString());try{d.forEach(function(d){var k=h.createGroup(),f=0;d.forEach(function(a){var b=a.shape,c=a.fill,e=a.stroke;f+=e&&e.width||0;var d=null;b&&("path"===b.type&&"string"!==typeof b.path&&(b.path=y(b.path)),d=k.createShape(b).setFill(c).setStroke(e?
e:{width:0}),"text"===b.type&&d.setFont(a.font))});var t=k.getBoundingBox();d=t.width;var r=t.height,z=-(t.x+d/2),p=-(t.y+r/2),v=h.getDimensions(),z={dx:z+v.width/2,dy:p+v.height/2},p=!1;if(l.scale&&0!==t.width&&0!==t.height){var p=t.width/t.height,u=(a>e?a:e)-2*f,g=1,m=1;isNaN(u)||(1<p?(g=u/t.width,m=u/p/t.height):(m=u/t.height,g=u*p/t.width));k.applyTransform(c.scaleAt(g,m,v.width/2,v.height/2));p=!0}!p&&(d>a||r>e)&&(t=d/a>r/e,d=((t?a:e)-5)/(t?d:r),b.mixin(z,{xx:d,yy:d}));k.applyTransform(z)})}catch(G){return h.clear(),
h.destroy(),null}return k}function h(b,a,c,d){return b?r(b,{responseType:"image",allowImageDataAccess:c}).then(function(b){b=b.data;var e=b.width,l=b.height,k=e/l,h=a;d&&(h=Math.min(h,Math.max(e,l)));return{image:c?b:null,width:1>=k?Math.ceil(h*k):h,height:1>=k?h:Math.ceil(h/k)}}).catch(function(e){if(c)return h(b,a,!1,d);throw e;}):n.reject(new q("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(g,"__esModule",{value:!0});g.renderSymbol=function(b,a,c){var e=Math.ceil(a[0]);
a=Math.ceil(a[1]);return b.some(function(a){return!!a.length})?k(b,e,a,c):null};g.tintImageWithColor=function(b,a,c,l,k){return h(b,a,!!c,k).then(function(e){var k=e.width?e.width:a,h=e.height?e.height:a,f;if(f=e.image)f=c&&"ignore"!==l?"multiply"===l&&255===c.r&&255===c.g&&255===c.b&&1===c.a?!1:!0:!1;if(f){var t=e.image.width,r=e.image.height;/\.svg$/i.test(b)&&(--t,--r);var z,p;z=Math.ceil(k);p=Math.ceil(h);f=document.createElement("canvas");f.width=z;f.height=p;f.style.width=z+"px";f.style.height=
p+"px";f=f.getContext("2d");f.clearRect(0,0,z,p);f.drawImage(e.image,0,0,t,r,0,0,k,h);e=f.getImageData(0,0,k,h);t=[c.r/255,c.g/255,c.b/255,c.a];r=m.toHSV(c);for(z=0;z<e.data.length;z+=4){p=e.data;var g=z,u=t,v=r;switch(l){case "multiply":p[g+0]*=u[0];p[g+1]*=u[1];p[g+2]*=u[2];p[g+3]*=u[3];break;default:var q=m.toHSV({r:p[g+0],g:p[g+1],b:p[g+2]});q.h=v.h;q.s=v.s;q.v=q.v/100*v.v;v=m.toRGB(q);p[g+0]=v.r;p[g+1]=v.g;p[g+2]=v.b;p[g+3]*=u[3]}}f.putImageData(e,0,0);b=f.canvas.toDataURL("image/png")}else(f=
d.id&&d.id.findCredential(b))&&f.token&&(e=-1===b.indexOf("?")?"?":"\x26",b=""+b+e+"token\x3d"+f.token);return{url:b,width:k,height:h}}).catch(function(){return{url:b,width:a,height:a}})}})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(x,g,b){g.switchTo(b);return g})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(x,g,b,f,c){var d=null;b.add("vml",function(b,c,d){d.innerHTML=
'\x3cv:shape adj\x3d"1"/\x3e';b="adj"in d.firstChild;d.innerHTML="";return b});return{load:function(r,m,q){function n(){m(["dojox/gfx/"+w],function(b){x.renderer=w;d=b;q(b)})}if(d&&"force"!=r)q(d);else{var w=c.forceGfxRenderer;r=!w&&(g.isString(c.gfxRenderer)?c.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var y,k;!w&&r.length;)switch(r.shift()){case "svg":"SVGAngle"in f.global&&(w="svg");break;case "vml":b("vml")&&(w="vml");break;case "silverlight":try{b("ie")?(y=new ActiveXObject("AgControl.AgControl"),
y.IsVersionSupported("1.0"))&&(k=!0):navigator.plugins["Silverlight Plug-In"]&&(k=!0)}catch(h){k=!1}finally{y=null}k&&(w="silverlight");break;case "canvas":f.global.CanvasRenderingContext2D&&(w="canvas")}"canvas"===w&&!1!==c.canvasEvents&&(w="canvasWithEvents");c.isDebug&&console.log("gfx renderer \x3d "+w);"svg"==w&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(n):n()}}}})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(x,g){var b=x.matrix={},f={};b._degToRad=
function(b){return f[b]||(f[b]=Math.PI*b/180)};b._radToDeg=function(b){return b/Math.PI*180};b.Matrix2D=function(c){if(c)if("number"==typeof c)this.xx=this.yy=c;else if(c instanceof Array){if(0<c.length){for(var d=b.normalize(c[0]),f=1;f<c.length;++f){var m=d,q=b.normalize(c[f]),d=new b.Matrix2D;d.xx=m.xx*q.xx+m.xy*q.yx;d.xy=m.xx*q.xy+m.xy*q.yy;d.yx=m.yx*q.xx+m.yy*q.yx;d.yy=m.yx*q.xy+m.yy*q.yy;d.dx=m.xx*q.dx+m.xy*q.dy+m.dx;d.dy=m.yx*q.dx+m.yy*q.dy+m.dy}g.mixin(this,d)}}else g.mixin(this,c)};g.extend(b.Matrix2D,
{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});g.mixin(b,{identity:new b.Matrix2D,flipX:new b.Matrix2D({xx:-1}),flipY:new b.Matrix2D({yy:-1}),flipXY:new b.Matrix2D({xx:-1,yy:-1}),translate:function(c,d){return 1<arguments.length?new b.Matrix2D({dx:c,dy:d}):new b.Matrix2D({dx:c.x,dy:c.y})},scale:function(c,d){return 1<arguments.length?new b.Matrix2D({xx:c,yy:d}):"number"==typeof c?new b.Matrix2D({xx:c,yy:c}):new b.Matrix2D({xx:c.x,yy:c.y})},rotate:function(c){var d=Math.cos(c);c=Math.sin(c);return new b.Matrix2D({xx:d,
xy:-c,yx:c,yy:d})},rotateg:function(c){return b.rotate(b._degToRad(c))},skewX:function(c){return new b.Matrix2D({xy:Math.tan(c)})},skewXg:function(c){return b.skewX(b._degToRad(c))},skewY:function(c){return new b.Matrix2D({yx:Math.tan(c)})},skewYg:function(c){return b.skewY(b._degToRad(c))},reflect:function(c,d){1==arguments.length&&(d=c.y,c=c.x);var f=c*c,g=d*d,q=f+g,n=2*c*d/q;return new b.Matrix2D({xx:2*f/q-1,xy:n,yx:n,yy:2*g/q-1})},project:function(c,d){1==arguments.length&&(d=c.y,c=c.x);var f=
c*c,g=d*d,q=f+g,n=c*d/q;return new b.Matrix2D({xx:f/q,xy:n,yx:n,yy:g/q})},normalize:function(c){return c instanceof b.Matrix2D?c:new b.Matrix2D(c)},isIdentity:function(b){return 1==b.xx&&0==b.xy&&0==b.yx&&1==b.yy&&0==b.dx&&0==b.dy},clone:function(c){var d=new b.Matrix2D,f;for(f in c)"number"==typeof c[f]&&"number"==typeof d[f]&&d[f]!=c[f]&&(d[f]=c[f]);return d},invert:function(c){c=b.normalize(c);var d=c.xx*c.yy-c.xy*c.yx;return c=new b.Matrix2D({xx:c.yy/d,xy:-c.xy/d,yx:-c.yx/d,yy:c.xx/d,dx:(c.xy*
c.dy-c.yy*c.dx)/d,dy:(c.yx*c.dx-c.xx*c.dy)/d})},_multiplyPoint:function(b,d,f){return{x:b.xx*d+b.xy*f+b.dx,y:b.yx*d+b.yy*f+b.dy}},multiplyPoint:function(c,d,f){c=b.normalize(c);return"number"==typeof d&&"number"==typeof f?b._multiplyPoint(c,d,f):b._multiplyPoint(c,d.x,d.y)},multiplyRectangle:function(c,d){var f=b.normalize(c);d=d||{x:0,y:0,width:0,height:0};if(b.isIdentity(f))return{x:d.x,y:d.y,width:d.width,height:d.height};c=b.multiplyPoint(f,d.x,d.y);var g=b.multiplyPoint(f,d.x,d.y+d.height),q=
b.multiplyPoint(f,d.x+d.width,d.y);d=b.multiplyPoint(f,d.x+d.width,d.y+d.height);var f=Math.min(c.x,g.x,q.x,d.x),n=Math.min(c.y,g.y,q.y,d.y);return{x:f,y:n,width:Math.max(c.x,g.x,q.x,d.x)-f,height:Math.max(c.y,g.y,q.y,d.y)-n}},multiply:function(c){for(var d=b.normalize(c),f=1;f<arguments.length;++f){var g=d,q=b.normalize(arguments[f]),d=new b.Matrix2D;d.xx=g.xx*q.xx+g.xy*q.yx;d.xy=g.xx*q.xy+g.xy*q.yy;d.yx=g.yx*q.xx+g.yy*q.yx;d.yy=g.yx*q.xy+g.yy*q.yy;d.dx=g.xx*q.dx+g.xy*q.dy+g.dx;d.dy=g.yx*q.dx+g.yy*
q.dy+g.dy}return d},_sandwich:function(c,d,f){return b.multiply(b.translate(d,f),c,b.translate(-d,-f))},scaleAt:function(c,d,f,g){switch(arguments.length){case 4:return b._sandwich(b.scale(c,d),f,g);case 3:return"number"==typeof f?b._sandwich(b.scale(c),d,f):b._sandwich(b.scale(c,d),f.x,f.y)}return b._sandwich(b.scale(c),d.x,d.y)},rotateAt:function(c,d,f){return 2<arguments.length?b._sandwich(b.rotate(c),d,f):b._sandwich(b.rotate(c),d.x,d.y)},rotategAt:function(c,d,f){return 2<arguments.length?b._sandwich(b.rotateg(c),
d,f):b._sandwich(b.rotateg(c),d.x,d.y)},skewXAt:function(c,d,f){return 2<arguments.length?b._sandwich(b.skewX(c),d,f):b._sandwich(b.skewX(c),d.x,d.y)},skewXgAt:function(c,d,f){return 2<arguments.length?b._sandwich(b.skewXg(c),d,f):b._sandwich(b.skewXg(c),d.x,d.y)},skewYAt:function(c,d,f){return 2<arguments.length?b._sandwich(b.skewY(c),d,f):b._sandwich(b.skewY(c),d.x,d.y)},skewYgAt:function(c,d,f){return 2<arguments.length?b._sandwich(b.skewYg(c),d,f):b._sandwich(b.skewYg(c),d.x,d.y)}});x.Matrix2D=
b.Matrix2D;return b})},"esri/core/colorUtils":function(){define([],function(){var x={COEF_RGB2XYZ:[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],COEF_XYZ2RGB:[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],matrixProduct:function(b,f){var c=[],d,g;if(b[0].length!==f.length)throw"dimensions do not match";var m=b.length,q=b[0].length,n=0;for(d=0;d<m;d++){for(g=n=0;g<q;g++)n+=b[d][g]*f[g];c.push(n)}return c},rgb2xyz:function(b){b=[b.r/255,b.g/255,b.b/255].map(function(b){return.04045>=
b?b/12.92:Math.pow((b+.055)/1.055,2.4)});b=this.matrixProduct(this.COEF_RGB2XYZ,b);return{x:100*b[0],y:100*b[1],z:100*b[2]}},xyz2rgb:function(b){b=this.matrixProduct(this.COEF_XYZ2RGB,[b.x/100,b.y/100,b.z/100]).map(function(b){return Math.min(1,Math.max(.0031308>=b?12.92*b:1.055*Math.pow(b,1/2.4)-.055,0))});return{r:Math.round(255*b[0]),g:Math.round(255*b[1]),b:Math.round(255*b[2])}},xyz2lab:function(b){b=[b.x/95.047,b.y/100,b.z/108.883].map(function(b){return b>Math.pow(6/29,3)?Math.pow(b,1/3):1/
3*Math.pow(29/6,2)*b+4/29});return{l:116*b[1]-16,a:500*(b[0]-b[1]),b:200*(b[1]-b[2])}},lab2xyz:function(b){var f=b.l;b=[(f+16)/116+b.a/500,(f+16)/116,(f+16)/116-b.b/200].map(function(b){return b>6/29?Math.pow(b,3):3*Math.pow(6/29,2)*(b-4/29)});return{x:95.047*b[0],y:100*b[1],z:108.883*b[2]}},lab2lch:function(b){var f=b.l,c=b.a,d=b.b;b=Math.sqrt(c*c+d*d);c=Math.atan2(d,c);c=0<c?c:c+2*Math.PI;return{l:f,c:b,h:c}},lch2lab:function(b){var f=b.c,c=b.h;return{l:b.l,a:f*Math.cos(c),b:f*Math.sin(c)}},rgb2lab:function(b){return this.xyz2lab(this.rgb2xyz(b))},
lab2rgb:function(b){return this.xyz2rgb(this.lab2xyz(b))},rgb2lch:function(b){return this.lab2lch(this.xyz2lab(this.rgb2xyz(b)))},lch2rgb:function(b){return this.xyz2rgb(this.lab2xyz(this.lch2lab(b)))}},g={rgb2hsv:function(b){var f=b.r,c=b.g;b=b.b;var d=Math.max(f,c,b),g=d-Math.min(f,c,b),m;0===g?m=0:d===f?m=(c-b)/g%6:d===c?m=(b-f)/g+2:d===b&&(m=(f-c)/g+4);0>m&&(m+=6);return{h:60*m,s:100*(0===g?0:g/d),v:100/255*d}},hsv2rgb:function(b){var f=b.h/60,c=b.v/100*255;b=b.s/100*c;var d=b*(1-Math.abs(f%2-
1)),g;switch(Math.floor(f)){case 0:g={r:b,g:d,b:0};break;case 1:g={r:d,g:b,b:0};break;case 2:g={r:0,g:b,b:d};break;case 3:g={r:0,g:d,b:b};break;case 4:g={r:d,g:0,b:b};break;case 5:case 6:g={r:b,g:0,b:d}}g.r=Math.round(g.r+c-b);g.g=Math.round(g.g+c-b);g.b=Math.round(g.b+c-b);return g}};return{toRGB:function(b){var f;void 0!==b.r&&void 0!==b.g&&void 0!==b.b?f=b:void 0!==b.l&&void 0!==b.c&&void 0!==b.h?f=x.lch2rgb(b):void 0!==b.l&&void 0!==b.a&&void 0!==b.b?f=x.lab2rgb(b):void 0!==b.x&&void 0!==b.y&&
void 0!==b.z?f=x.xyz2rgb(b):void 0!==b.h&&void 0!==b.s&&void 0!==b.v&&(f=g.hsv2rgb(b));return f},toHSV:function(b){if(void 0!==b.h&&void 0!==b.s&&void 0!==b.v)return b;b=this.toRGB(b);return g.rgb2hsv(b)},toLAB:function(b){return void 0!==b.l&&void 0!==b.a&&void 0!==b.b?b:x.rgb2lab(this.toRGB(b))},toLCH:function(b){return void 0!==b.l&&void 0!==b.c&&void 0!==b.h?b:x.rgb2lch(this.toRGB(b))},toXYZ:function(b){return void 0!==b.x&&void 0!==b.y&&void 0!==b.z?b:x.rgb2xyz(this.toRGB(b))}}})},"esri/symbols/support/previewSymbol3D":function(){define("require exports ../../core/Error ../../core/Logger ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils ./styleUtils ./symbolUtils".split(" "),
function(x,g,b,f,c,d,r,m,q,n,w){function y(a){var b=a.outline,c=a.get("material.color"),c=c&&c.toRgba().toString();if(!b)return"fill"===a.type&&"255,255,255,1"===c?{color:"#bdc3c7",width:.75}:null;a=d.pt2px(b.size)||0;return{color:"rgba("+(null!=b.color?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function k(a,b){var e=b&&b.resource,e=e&&e.href;return a.thumbnail&&a.thumbnail.url?c.resolve(a.thumbnail.url):e&&"object"!==b.type?c.resolve(w.getIconHref(a,b)):a.styleOrigin&&(a.styleOrigin.styleName||
a.styleOrigin.styleUrl)?n.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal}).always(function(a){return a&&a.thumbnail&&a.thumbnail.url||C}):c.resolve(C)}function h(a,b){if(!a.material||!a.material.color)return a=Math.min(Math.max(r.defaultThematicColor.r+191.25*b,0),255),[a,a,a,100];for(var c=a.material.color.toRgb(),e=0;3>e;e++)c[e]=Math.min(Math.max(c[e]+191.25*b,0),255);c.push(a.material.color.a);return c}function p(a){return a.outline?y(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}
function a(a,b){if(!a.material)return{};for(var c=a.material.color.toRgb(),e="rgba(",f=0;3>f;f++)e+=Math.min(Math.max(c[f]+191.25*b,0),255)+",";e+=a.material.color.a+");";a=a.size?d.pt2px(a.size):.75;return{color:e,width:Math.min(a,80)}}function e(a,b,e){e*=.75;return{type:"linear",x1:e?.25*e:0,y1:e?.5*e:0,x2:e||4,y2:e?.5*e:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}function l(a){var b=a.depth,e=a.height;return(a=a.width)&&b&&e&&a===b&&a<e}function u(a,b,c,d){var f=a&&a.type,l="object"===f,
k=[];if("icon"===f)switch(b){case "circle":k.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:h(a,0),stroke:y(a)});break;case "square":k.push({shape:{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[0,0]},{command:"L",values:[c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:h(a,0),stroke:y(a)});break;case "cross":k.push({shape:{type:"path",path:[{command:"M",values:[.5*c,0]},{command:"L",values:[.5*c,c]},{command:"M",values:[0,.5*c]},{command:"L",values:[c,.5*c]},
{command:"E",values:[]}]},stroke:p(a)});break;case "x":k.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[c,c]},{command:"M",values:[c,0]},{command:"L",values:[0,c]},{command:"E",values:[]}]},stroke:p(a)});break;case "kite":k.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,.5*c]},{command:"L",values:[.5*c,c]},{command:"Z",values:[]}]},fill:h(a,0),stroke:y(a)})}else if(l)switch(b){case "cone":b=h(a,0);a=
h(a,-.6);a=e(b,a,d?20:c);c=m.getConeShapes(c,d);k.push({shape:c[0],fill:a});k.push({shape:c[1],fill:a});break;case "inverted-cone":d=h(a,0);a=h(a,-.6);a=e(d,a,c);c=m.getInvertedConeShapes(c);k.push({shape:c[0],fill:a});k.push({shape:c[1],fill:d});break;case "cube":c=m.getCubeShapes(c,d);k.push({shape:c[0],fill:h(a,0)});k.push({shape:c[1],fill:h(a,-.3)});k.push({shape:c[2],fill:h(a,-.5)});break;case "cylinder":b=h(a,0);f=h(a,-.6);b=e(b,f,d?20:c);c=m.getCylinderShapes(c,d);k.push({shape:c[0],fill:b});
k.push({shape:c[1],fill:b});k.push({shape:c[2],fill:h(a,0)});break;case "diamond":c=m.getDiamondShapes(c);k.push({shape:c[0],fill:h(a,-.3)});k.push({shape:c[1],fill:h(a,0)});k.push({shape:c[2],fill:h(a,-.3)});k.push({shape:c[3],fill:h(a,-.7)});break;case "sphere":d=h(a,0);a=h(a,-.6);a=e(d,a);a.x1=0;a.y1=0;a.x2=.25*c;a.y2=.25*c;k.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:a});break;case "tetrahedron":c=m.getTetrahedronShapes(c),k.push({shape:c[0],fill:h(a,-.3)}),k.push({shape:c[1],fill:h(a,
0)}),k.push({shape:c[2],fill:h(a,-.6)})}return k}function v(a,b){var e=b&&b.size?d.pt2px(b.size):null,f=b&&b.maxSize?d.pt2px(b.maxSize):null,h=b&&b.disableUpsampling,g=a.symbolLayers,p=[],v=0,t=0,m=g.getItemAt(g.length-1),r;m&&"icon"===m.type&&(r=m.size&&d.pt2px(m.size));g.forEach(function(g,m){if("icon"===g.type||"object"===g.type){m="icon"===g.type?g.size&&d.pt2px(g.size):0;var n=e||m?Math.ceil(Math.min(e||m,f||120)):22,B=y(g),G=B?B.width:0;if(g&&g.resource&&g.resource.href)m=k(a,g).then(function(a){var b=
g.get("material.color"),c;c="icon"===g.type?"multiply":"tint";return q.tintImageWithColor(a,n,b,c,h)}).then(function(a){var b=a.width,c=a.height;v=Math.max(v,b+2*G);t=Math.max(t,c+2*G);return[{shape:{type:"image",width:b,height:c,src:a.url},fill:null,stroke:null}]}),p.unshift(m);else{(B=g.get("resource.primitive"))||(B="icon"===g.type?"circle":"sphere");var C=n;"icon"===g.type&&r&&e&&(C=m/r*n);m=b&&"tall"===b.symbolConfig||("object"===g.type?l(g):!1);v=Math.max(v,m?20:C+2*G);t=Math.max(t,C+2*G);p.unshift(c.resolve(u(g,
B,C,m)))}}});return c.eachAlways(p).then(function(a){var c=[];a.forEach(function(a){a.value?c.push(a.value):a.error&&H.warn("error while building swatchInfo!",a.error)});return q.renderSymbol(c,[v,t],{node:b&&b.node,scale:!1})})}function G(b,e){var f=b.symbolLayers,k=[];b=w.isVolumetricSymbol(b);var l=e&&e.size?d.pt2px(e.size):null,g=(e&&e.maxSize?d.pt2px(e.maxSize):null)||80,p=0,v=0,u;f.forEach(function(b,c){var e=b&&b.type,d="line"===e;if(d||"path"===e){var f=a(b,0),t=f&&f.width||0,e=[];d?(0===
c&&(u=t),b=Math.min(l||t,g),b=0===c?b:l?t/u*b:b,v=Math.max(v,b),p=Math.max(p,22<b?2*b:40),f.width=b,e.push({shape:{type:"path",path:[{command:"M",values:[0,.5*v]},{command:"L",values:[p,.5*v]},{command:"E",values:[]}]},stroke:f})):(c=Math.min(l||22,g),f=h(b,0),d=h(b,-.2),b=a(b,-.4),b.width=1,e.push({shape:m.shapes.pathSymbol3DLayer[0],fill:d,stroke:b}),e.push({shape:m.shapes.pathSymbol3DLayer[1],fill:f,stroke:b}),p=v=Math.max(v,c+2));k.push(e)}});return c.resolve(q.renderSymbol(k,[p,v],{node:e&&e.node,
scale:b}))}Object.defineProperty(g,"__esModule",{value:!0});var C=x.toUrl("../../images/Legend/legend3dsymboldefault.png"),H=f.getLogger("esri.symbols.support.previewSymbol3D");g.previewSymbol3D=function(e,f){if(0===e.symbolLayers.length)return c.reject(new b("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var k=null;switch(e.type){case "point-3d":k=v(e,f);break;case "line-3d":k=G(e,f);break;case "polygon-3d":case "mesh-3d":a:{k="mesh-3d"===e.type;e=e.symbolLayers;for(var l=
f&&f.size?d.pt2px(f.size):null,g=f&&f.maxSize?d.pt2px(f.maxSize):null,l=l||22,p=[],u=0,t=0,r=0;r<e.length;r++){var n=e.getItemAt(r),C=n.type,B="fill"===C,w="line"===C,H="extrude"===n.type,C=[];if(k&&!B){k=void 0;break a}var x=m.shapes.fill[0];B?(w=(B=y(n))&&B.width||0,u=Math.max(u,22+w),t=Math.max(t,22+w),C.push({shape:x,fill:h(n,0),stroke:B})):w?(n=(B=a(n,0))&&B.width||0,x={stroke:B,shape:x},u=Math.max(u,22+n),t=Math.max(t,22+n),C.push(x)):H&&(x=a(n,-.4),B=h(n,0),n=h(n,-.2),w=Math.min(l,g||120),
H=m.getExtrudeSymbolShapes(w),x.width=1,C.push({shape:H[0],fill:n,stroke:x}),C.push({shape:H[1],fill:n,stroke:x}),C.push({shape:H[2],fill:B,stroke:x}),n=22*.7+.5*w,u=Math.max(u,22+2*x.width),t=Math.max(t,n+2*x.width));p.push(C)}k=c.resolve(q.renderSymbol(p,[u,t],{node:f&&f.node,scale:!1}))}}return k?k:c.reject(new b("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require","exports","../../request","../../core/screenUtils"],
function(x,g,b,f){Object.defineProperty(g,"__esModule",{value:!0});g.previewWebStyleSymbol=function(c,d,g){var m=c.thumbnail&&c.thumbnail.url;return m?b(m,{responseType:"image"}).then(function(b){b=b.data;var c=!/\\.svg$/i.test(b.src)&&g&&g.disableUpsampling,d=Math.max(b.width,b.height),m=g&&null!=g.maxSize?f.pt2px(g.maxSize):120;c&&(m=Math.min(d,m));c=Math.min(m,g&&null!=g.size?f.pt2px(g.size):d);c!==d&&(d=0!==b.width&&0!==b.height?b.width/b.height:1,1<=d?(b.width=c,b.height=c/d):(b.width=c*d,b.height=
c));return g&&g.node?(g.node.appendChild(b),g.node):b}):c.fetchSymbol().then(function(b){return d(b,g)})}})},"esri/widgets/Legend/support/colorRampUtils":function(){define("require exports ../../../Color ../../../core/numberUtils ../../../symbols/support/gfxUtils ./utils".split(" "),function(x,g,b,f,c,d){function r(b,c){var d=c-b;c=[0,.25,.5,.75,1].map(function(a){return Number((b+a*d).toFixed(6))});m(0,4,c);return c}function m(b,c,d){var a=b+(c-b)/2,e=d[0],f=d[1],k=d[2],g=Math.floor(e),h=Math.floor(f),
p=Math.floor(k);g===e&&p===k&&h!==f&&g!==h&&p!==h&&(d[a]=h);b+1!==a&&m(b,a,d);a+1!==c&&m(a,c,d)}function q(c,d){c=n(c,d);var f=c.startIndex,a=c.endIndex;if(f===a)return d[f].color;d=b.blendColors(d[f].color,d[a].color,c.weight);return new b(d)}function n(b,c){var d=0,a=c.length-1;c.some(function(c,f){if(b<c.value)return a=f,!0;d=f;return!1});return{startIndex:d,endIndex:a,weight:(b-c[d].value)/(c[a].value-c[d].value)}}Object.defineProperty(g,"__esModule",{value:!0});var w=[64,64,64],y=[255,255,255];
g.getRampBorderColor=function(b){var d=null;if("simple"===b.type)d=b.symbol;else if("unique-value"===b.type||"class-breaks"===b.type)d=(b=(b=b.classBreakInfos||b.uniqueValueInfos)&&b[0])&&b.symbol;return(b=(b=d&&-1===d.type.indexOf("line-symbol")?c.getStroke(d):null)&&b.color)&&0<b.a&&!(240<=b.r&&240<=b.g&&240<=b.b)?b:null};g.getRampOverlayColor=function(c){var d=new b(y);d.a=1-c;return d};g.getRampStops=function(c,g,p){var a=!1,e=[],l=[];if(g.colors||g.opacityValues)e=r(g.minDataValue,g.maxDataValue);
else if(g.stops){var k=g.stops,e=k.map(function(a){return a.value});(a=k.some(function(a){return!!a.label}))&&(l=k.map(function(a){return a.label}))}var h=e[0],k=e[e.length-1];if(null==h&&null==k)return null;var m=k-h;return e.map(function(k,v){var u;if("opacity"===g.type){u=p;void 0===u&&(u=w);u=new b(u);var n=c.getOpacity(k,{opacityInfo:g});null!=n&&(u.a=n)}else u=c.getColor(k,{colorInfo:g});v=a?l[v]:d.getLabelPrefix(v,e.length-1)+f.format(k);return{value:k,color:u,label:v,offset:m?1-(k-h)/m:1}}).reverse()};
g.getRampStopsForPointCloud=function(b){var c=!1,k=[],a=[],k=b.map(function(a){return a.value});(c=b.some(function(a){return!!a.label}))&&(a=b.map(function(a){return a.label}));var e=k[0],l=k[k.length-1];if(null==e&&null==l)return null;var g=l-e;return k.map(function(l,h){var p=q(l,b);h=c?a[h]:d.getLabelPrefix(h,k.length-1)+f.format(l);return{value:l,color:p,label:h,offset:g?1-(l-e)/g:1}}).reverse()};g.getColorFromPointCloudStops=q})},"esri/widgets/Legend/support/utils":function(){define(["require",
"exports"],function(x,g){Object.defineProperty(g,"__esModule",{value:!0});g.getLabelPrefix=function(b,f){return 0===b?"\x3c ":b===f?"\x3e ":""}})},"esri/widgets/Legend/support/sizeRampUtils":function(){define(["require","exports","../../../core/numberUtils","../../../symbols/support/symbolUtils","./utils"],function(x,g,b,f,c){function d(b,c){var e=null,d=null;if("simple"===b.type)e=b.symbol;else if("unique-value"===b.type||"class-breaks"===b.type)e=(e=(b=b.classBreakInfos||b.uniqueValueInfos)&&b[0])&&
e.symbol,d=1<b.length;if(!e||r(e))return null;e=e.clone();if(c||d)-1<e.type.indexOf("3d")?m(e):(c=e,-1!==c.type.indexOf("line")?c.color=a:(c.color=h,"simple-marker"===c.type&&(c.outline={color:a,width:1.5})));return e}function r(a){if(a)return-1<a.type.indexOf("3d")?(a=a.symbolLayers)?a.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill")}function m(b){f.isVolumetricSymbol(b)||(-1!==b.type.indexOf("line-3d")?b.symbolLayers.forEach(function(b){b.material={color:a}}):b.symbolLayers.forEach(function(b){"icon"!==
b.type||b.resource&&b.resource.href?b.material={color:p}:(b.material={color:h},b.outline={color:a,size:1.5})}))}function q(a,c,d,f){var e=a.getSizeRangeAtScale(c,f),k=e&&n(e);if(e||k){for(var g=k.map(function(a){var b=e.minSize,d=e.maxSize,f=c.minDataValue,k=c.maxDataValue;return a<=b?f:a>=d?k:(a-b)/(d-b)*(k-f)+f}),g=b.round(g),l=1;l<g.length-1;l++){var h=w(a,c,d,g[l],g[l-1],f);h&&(g[l]=h[0],k[l]=h[1])}return g}}function n(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],e=0;5>e;e++)c.push(b+a*e);
return c}function w(a,c,d,f,k,g){var e=y(a,c,d,f,g);k=y(a,c,d,k,g);var l=b.numDigits(f),h=l.fractional,p=l.integer,u=l=null;0<f&&1>f&&(l=Math.pow(10,h),f*=l,p=b.numDigits(f).integer);for(h=p-1;0<=h;h--){var v=Math.pow(10,h),p=Math.floor(f/v)*v,v=Math.ceil(f/v)*v;null!=l&&(p/=l,v/=l);var m=(p+v)/2,m=b.round([p,m,v],{indexes:[1]}),m=m[1],n=y(a,c,d,p,g),q=y(a,c,d,v,g),r=y(a,c,d,m,g),C=b.percentChange(e,n,k,null),G=b.percentChange(e,q,k,null),w=b.percentChange(e,r,k,null),x=20>=C.previous,J=20>=G.previous;
x&&J&&(C.previous<=G.previous?(x=!0,J=!1):(J=!0,x=!1));x?u=[p,n]:J?u=[v,q]:20>=w.previous&&(u=[m,r]);if(u)break}return u}function y(a,b,c,d,f){return a.getSize(d,{sizeInfo:b,scale:f,shape:-1!==c.type.indexOf("marker-symbol")?c.style:null})}function k(a,b){a=a.clone();if("esri.symbols.Symbol3D"===a.declaredClass)f.isVolumetricSymbol(a)||a.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=b)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=b;else if("esri.symbols.PictureMarkerSymbol"===
a.declaredClass){var c=a.width,e=a.height;a.height=b;a.width=c/e*b}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=b:"esri.symbols.TextSymbol"===a.declaredClass&&a.font&&(a.font.size=b);return a}Object.defineProperty(g,"__esModule",{value:!0});g.REAL_WORLD_MAX_SIZE=30;g.REAL_WORLD_MIN_SIZE=12;var h=[255,255,255],p=[200,200,200],a=[128,128,128];g.getRampStops=function(a,l,h,p){var e=l.legendOptions,e=e&&e.customValues,m=d(a,h);h=null!=l.minSize&&null!=l.maxSize;var v=l.stops&&1<l.stops.length,
u=!!l.target;if(m&&(e||h||v&&!u)){var n=f.isVolumetricSymbol(m),r=null,w=null,x=null,w=n&&!v?[l.minDataValue,l.maxDataValue]:e||q(a,l,m,p);!w&&v&&(w=l.stops.map(function(a){return a.value}),(r=l.stops.some(function(a){return!!a.label}))&&(x=l.stops.map(function(a){return a.label})));e=!n||w&&2===w.length;if(!w||!e)return null;var E=[g.REAL_WORLD_MIN_SIZE,g.REAL_WORLD_MAX_SIZE];return w.map(function(e,d){var f=n?E[d]:y(a,l,m,e,p),g=k(m,f);d=r?x[d]:c.getLabelPrefix(d,w.length-1)+b.format(e);return{value:e,
symbol:g,label:d,size:f}}).reverse()}}})},"esri/widgets/Legend/styles/Card":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../../nls/common dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../core/lang ../../../core/accessorSupport/decorators ../../Widget ../../Legend/support/styleUtils ../../support/colorUtils ../../support/widget".split(" "),function(x,g,b,f,c,d,r,m,q,n,w,y,k){return function(g){function h(a){a=
g.call(this)||this;a._hasIndicators=!1;a._selectedSectionName=null;a._sectionNames=[];a._sectionMap=new Map;a.activeLayerInfos=null;a.view=null;return a}b(h,g);h.prototype.render=function(){var a=this;this._sectionNames.length=0;this._hasIndicators=768>=this.view.container.clientWidth;var b=this.activeLayerInfos,b=b&&b.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||
(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;var f=this._sectionNames.length,g=this._sectionNames.map(function(b,e){e=m.substitute({index:e+1,total:f},c.pagination.pageText);return k.tsx("div",{key:b,"aria-label":e,title:e,tabIndex:0,onclick:a._selectSection,onkeydown:a._selectSection,bind:a,class:a.classes("esri-legend--card__carousel-indicator",(d={},d["esri-legend--card__carousel-indicator--activated"]=a._selectedSectionName===b,d)),"data-section-name":b});
var d}),g=this._hasIndicators?k.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation"},g):null,b=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):b&&b.length?b:null;return k.tsx("div",{class:"esri-legend--card esri-widget"},g,b?b:k.tsx("div",{class:"esri-legend--card__message"},d.noLegend))};h.prototype._selectSection=function(a){if(a=a.target.getAttribute("data-section-name"))this._selectedSectionName=a};h.prototype._renderLegendForLayer=
function(a){var b=this;if(!a.ready)return null;var c="esri-legend--card__"+a.layer.uid+"-version-"+a.version;if(a.children.length){var d=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray();this._sectionNames.push(c);return k.tsx("div",{key:a.layer.uid,class:"esri-legend--card__service"},k.tsx("div",{class:"esri-legend--card__service-caption-container"},a.title),d)}if((c=a.legendElements)&&!c.length)return null;c=c.map(function(c){return b._renderLegendForElement(c,a.layer)}).filter(function(a){return!!a});
return c.length?k.tsx("div",{key:a.layer.uid,class:"esri-legend--card__service"},k.tsx("div",{class:"esri-legend--card__service-caption-container"},k.tsx("div",{class:"esri-legend--card__service-caption-text"},a.title)),k.tsx("div",{class:"esri-legend--card__service-content"},c)):null};h.prototype._renderLegendForElement=function(a,b){var c=this,d="color-ramp"===a.type,e="opacity-ramp"===a.type,f="size-ramp"===a.type,g=a.title,h=null;"string"===typeof g?h=g:g&&(h=w.getTitle(g,d||e),h=g.title?g.title+
" ("+h+")":h);var g="esri-legend--card__"+b.uid+"-type-"+a.type,p=this._hasIndicators?k.tsx("p",{class:"esri-legend--card__carousel-title"},b.title):null,m=null;"symbol-table"===a.type?(d=a.infos.map(function(d){return c._renderLegendForElementInfo(d,b,f,a.legendType)}).filter(function(a){return!!a}),this._hasIndicators||d.reverse(),d.length&&(e=d[0].properties.classes&&d[0].properties.classes["esri-legend--card__symbol-row"],e=(n={},n["esri-legend--card__label-container"]=!e,n),m=k.tsx("div",{key:g,
class:"esri-legend--card__section"},p,k.tsx("div",{class:"esri-legend--card__layer-caption"},h),k.tsx("div",{classes:e},d)))):d||e?m=k.tsx("div",{key:g,class:"esri-legend--card__section"},p,k.tsx("div",{class:"esri-legend--card__layer-caption"},h),this._renderLegendForRamp(a.infos,a.overlayColor,e)):f&&(m=k.tsx("div",{key:g,class:"esri-legend--card__section"},p,k.tsx("div",{class:"esri-legend--card__layer-caption"},h),this._renderSizeRamps(a.infos)));if(!m)return null;this._sectionNames.push(g);this._sectionMap.set(g,
m);return m;var n};h.prototype._renderLegendForElementInfo=function(a,b,c,d){if(a.type)return this._renderLegendForElement(a,b);c=w.isImageryStretchedLegend(b,d);if(a.symbol&&a.preview){if(!a.label)return-1===a.symbol.type.indexOf("simple-fill")?k.tsx("div",{bind:a.preview,afterCreate:w.attachToNode}):null;if(-1!==a.symbol.type.indexOf("marker"))return b=(m={},m["esri-legend--card__symbol-cell"]=this._hasIndicators,m),k.tsx("div",{class:this.classes("esri-legend--card__layer-row",(n={},n["esri-legend--card__symbol-row"]=
this._hasIndicators,n))},k.tsx("div",{classes:b,bind:a.preview,afterCreate:w.attachToNode}),k.tsx("div",{class:this.classes("esri-legend--card__image-label",(u={},u["esri-legend--card__label-cell"]=this._hasIndicators,u))},a.label||""));u=n=m=255;b=0;var e=d=c=255,f=0,g=a.symbol.color&&a.symbol.color.a,h=a.symbol.outline&&a.symbol.outline.color.a;g&&(m=a.symbol.color.r,n=a.symbol.color.g,u=a.symbol.color.b,b=a.symbol.color.a);h&&(c=a.symbol.outline.color.r,d=a.symbol.outline.color.g,e=a.symbol.outline.color.b,
f=a.symbol.outline.color.a);var l=y.isBright(a.symbol.color),p=l?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return k.tsx("div",{key:a.label,class:"esri-legend--card__label-element",styles:{background:g?"rgba("+m+", "+n+", "+u+", "+b+")":"none",color:l?"black":"white",textShadow:"-1px -1px 0 "+p+",\n                                              1px -1px 0 "+p+",\n                                              -1px 1px 0 "+p+",\n                                              1px 1px 0 "+p,border:h?
"1px solid rgba("+c+", "+d+", "+e+", "+f+")":"none"}}," ",a.label," ")}if(a.src)return m=this._renderImage(a,b,c),k.tsx("div",{class:"esri-legend--card__layer-row"},m,k.tsx("div",{class:"esri-legend--card__image-label"},a.label||""));var m,n,u};h.prototype._renderImage=function(a,b,c){var d=a.label,e=a.src,f=a.opacity;c=(g={},g["esri-legend--card__imagery-layer-image--stretched"]=c,g["esri-legend--card__symbol"]=!c,g);return k.tsx("img",{alt:d,src:e,border:0,width:a.width,height:a.height,classes:c,
styles:{opacity:""+(null!=f?f:b.opacity)}});var g};h.prototype._renderSizeRamps=function(a){var b=document.createElement("div"),c,d=a[a.length-1].symbol.color,f,g,h=a[0].label,p=a[a.length-1].label,m=a[0].symbol.style&&"circle"===a[0].symbol.style;try{if(this._hasIndicators)if(g=100,m){var n=a[0].symbol.size/2,q=a[a.length-1].symbol.size/2;f=2*n;var y=g-n-q,x=Math.sqrt(Math.pow(y,2)-Math.pow(n-q,2)),E=n*x/y,K=n+E,L=n+Math.sqrt(Math.pow(n,2)-Math.pow(E,2)),F=q*E/n,M=n+F,I=g-(q-Math.sqrt(Math.pow(q,
2)-Math.pow(F,2))),E=n-E,F=n-F;c=r.createSurface(b,f,g);c.createCircle({cx:n,cy:n,r:n}).setFill(d).setStroke({color:"#ddd",width:1});c.createCircle({cx:n,cy:g-q,r:q}).setFill(d).setStroke({color:"#ddd",width:1});c.createLine({x1:K,y1:L,x2:M,y2:I}).setStroke({color:"#ddd",width:1});c.createLine({x1:E,y1:L,x2:F,y2:I}).setStroke({color:"#ddd",width:1})}else{var A=Math.max(a[0].symbol.height,a[0].symbol.width),D=Math.max(a[a.length-1].symbol.height,a[a.length-1].symbol.width);f=A;c=r.createSurface(b,
f,g);c.createRect({x:0,y:0,height:A,width:A}).setStroke({color:"#ddd",width:1});c.createRect({x:A/2-D/2,y:g-D,height:D,width:D}).setStroke({color:"#ddd",width:1});c.createImage({src:a[0].symbol.url,height:A,width:A});c.createImage({src:a[a.length-1].symbol.url,height:D,width:D,y:g-D,x:A/2-D/2});c.createLine({x1:0,y1:A,x2:A/2-D/2,y2:g-D}).setStroke({color:"#ddd",width:1});c.createLine({x1:f,y1:A,x2:A/2+D/2,y2:g-D}).setStroke({color:"#ddd",width:1})}else f=180,m?(n=a[0].symbol.size/2,q=a[a.length-1].symbol.size/
2,g=2*n,y=f-n-q,x=Math.sqrt(Math.pow(y,2)-Math.pow(n-q,2)),E=n*x/y,L=n-E,K=f-(n+Math.sqrt(Math.pow(n,2)-Math.pow(E,2))),F=q*E/n,I=n-F,M=q-Math.sqrt(Math.pow(q,2)-Math.pow(F,2)),E=n+E,F=n+F,c=r.createSurface(b,f,g),c.createCircle({cx:f-n,cy:n,r:n}).setFill(d).setStroke({color:"#ddd",width:1}),c.createCircle({cx:q,cy:n,r:q}).setFill(d).setStroke({color:"#ddd",width:1}),c.createLine({x1:K,y1:L,x2:M,y2:I}).setStroke({color:"#ddd",width:1}),c.createLine({x1:K,y1:E,x2:M,y2:F}).setStroke({color:"#ddd",width:1})):
(A=Math.max(a[0].symbol.height,a[0].symbol.width),D=Math.max(a[a.length-1].symbol.height,a[a.length-1].symbol.width),c=r.createSurface(b,f,A),c.createRect({x:0,y:A/2-D/2,height:D,width:D}).setStroke({color:"#ddd",width:1}),c.createRect({x:f-A,y:0,height:A,width:A}).setStroke({color:"#ddd",width:1}),c.createImage({src:a[a.length-1].symbol.url,height:D,width:D,y:A/2-D/2}),c.createImage({src:a[0].symbol.url,height:A,width:A,x:f-A}),c.createLine({x1:D,y1:A/2-D/2,x2:f-A,y2:0}).setStroke({color:"#ddd",
width:1}),c.createLine({x1:D,y1:A/2+D/2,x2:f-A,y2:A}).setStroke({color:"#ddd",width:1})),d=h,h=p,p=d}catch(P){c.clear(),c.destroy()}return c?k.tsx("div",{class:this.classes("esri-legend--card__layer-row",(J={},J["esri-legend--card__size-ramp-row"]=this._hasIndicators,J))},k.tsx("div",{class:"esri-legend--card__ramp-label"},h),k.tsx("div",{class:"esri-legend--card__size-ramp-container"},k.tsx("div",{bind:b,afterCreate:w.attachToNode})),k.tsx("div",{class:"esri-legend--card__ramp-label"},p)):null;var J};
h.prototype._renderLegendForRamp=function(a,b,c){var d=a.length-1;c=2<d?25*d:100;var e=c+20;b=document.createElement("div");b.style.width=e+"px";var f=r.createSurface(b,e,25),g=a.slice(0).reverse();try{g.forEach(function(a,b){a.offset=b/d}),f.createPath("M0 12.5 L10 0 L10 25 Z").setFill(g[0].color).setStroke(null),f.createRect({x:10,y:0,width:c,height:25}).setFill({type:"linear",x1:10,y1:0,x2:c+10,y2:0,colors:g}).setStroke(null),f.createPath("M"+(c+10)+" 0 L"+e+" 12.5 L"+(c+10)+" 25 Z").setFill(g[g.length-
1].color).setStroke(null)}catch(H){f.clear(),f.destroy()}if(!f)return null;c=g.filter(function(a,b){return!!a.label&&0!==b&&b!==g.length-1}).map(function(a){return k.tsx("div",{class:"esri-legend--card__interval-separators-container"},k.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),k.tsx("div",{class:"esri-legend--card__ramp-label"},a.label))});return k.tsx("div",{class:"esri-legend--card__layer-row"},k.tsx("div",{class:"esri-legend--card__ramp-label"},a[a.length-1].label),k.tsx("div",
{class:"esri-legend--card__symbol-container"},k.tsx("div",{bind:b,afterCreate:w.attachToNode}),c),k.tsx("div",{class:"esri-legend--card__ramp-label"},a[0].label))};f([k.renderable(),q.property()],h.prototype,"activeLayerInfos",void 0);f([q.property()],h.prototype,"view",void 0);f([k.accessibleHandler()],h.prototype,"_selectSection",null);return h=f([q.subclass("esri.widgets.Legend.styles.Card")],h)}(q.declared(n))})},"esri/widgets/Legend/support/styleUtils":function(){define(["require","exports",
"dojo/i18n!../../Legend/nls/Legend","../../../core/lang"],function(x,g,b,f){Object.defineProperty(g,"__esModule",{value:!0});g.attachToNode=function(b){b.appendChild(this)};g.getTitle=function(c,d){var g=null;d?g=c.ratioPercentTotal?"showRatioPercentTotal":c.ratioPercent?"showRatioPercent":c.ratio?"showRatio":c.normField?"showNormField":c.field?"showField":null:d||(g=c.normField?"showNormField":c.normByPct?"showNormPct":c.field?"showField":null);return g?f.substitute({field:c.field,normField:c.normField},
b[g]):null};g.isRendererTitle=function(b,d){return!d};g.isImageryStretchedLegend=function(b,d){return!!(d&&"Stretched"===d&&10.3<=b.version&&"esri.layers.ImageryLayer"===b.declaredClass)}})},"esri/widgets/support/colorUtils":function(){define(["require","exports","../../Color"],function(x,g,b){function f(c){return new b(c)}function c(b){return!!b&&4===b.length&&n.test(b)}function d(b){return!!b&&7===b.length&&w.test(b)}function r(b){return 127<=.299*b.r+.587*b.g+.114*b.b}function m(c,d){void 0===
d&&(d=1);d=Math.pow(.7,d);return new b([Math.round(c.r*d),Math.round(c.g*d),Math.round(c.b*d),c.a])}function q(c,d){void 0===d&&(d=1);d=Math.pow(.7,d);var f=c.r,g=c.g,a=c.b;30>f&&(f=30);30>g&&(g=30);30>a&&(a=30);return new b([Math.min(255,Math.round(f/d)),Math.min(255,Math.round(g/d)),Math.min(255,Math.round(a/d)),c.a])}Object.defineProperty(g,"__esModule",{value:!0});var n=/^#[0-9A-F]{3}$/i,w=/^#[0-9A-F]{6}$/i;g.equal=function(b,c){return b&&c&&b.r===c.r&&b.g===c.g&&b.b===c.b&&b.a===c.a};g.normalizeHex=
function(b){return b?"#"+b.trim().replace(/#/g,"").substr(0,6):""};g.normalizeColor=f;g.isValidHex=function(b){return c(b)||d(b)};g.isShorthandHex=c;g.isLonghandHex=d;g.toHex=function(b){return f(b).toHex()};g.getContrastingColor=function(b){return r(b)?m(b):q(b,3)};g.isBright=r;g.darker=m;g.brighter=q})},"esri/widgets/Legend/styles/Classic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../core/accessorSupport/decorators ../../Widget ../../Legend/support/styleUtils ../../support/widget".split(" "),
function(x,g,b,f,c,d,r,m,q,n){return function(g){function m(b){b=g.call(this)||this;b.activeLayerInfos=null;return b}b(m,g);m.prototype.render=function(){var b=this,d=this.activeLayerInfos,f=n.join("esri-legend esri-widget--panel","esri-widget"),d=d&&d.toArray().map(function(a){return b._renderLegendForLayer(a)}).filter(function(a){return!!a});return n.tsx("div",{class:f},d&&d.length?d:n.tsx("div",{class:"esri-legend__message"},c.noLegend))};m.prototype._renderLegendForLayer=function(b){var c=this;
if(!b.ready)return null;var d=!!b.children.length,a="esri-legend__"+b.layer.uid+"-version-"+b.version,e=b.title?n.tsx("div",{class:"esri-legend__service-label"},b.title):null;if(d){var f=b.children.map(function(a){return c._renderLegendForLayer(a)}).toArray(),d=(g={},g["esri-legend__group-layer"]=d,g);return n.tsx("div",{key:a,class:"esri-legend__service",classes:d},e,f)}if((d=b.legendElements)&&!d.length)return null;g=d.map(function(a){return c._renderLegendForElement(a,b.layer)}).filter(function(a){return!!a});
if(!g.length)return null;d=(f={},f["esri-legend__group-layer-child"]=!!b.parent,f);return n.tsx("div",{key:a,class:"esri-legend__service",classes:d},e,n.tsx("div",{class:"esri-legend__layer"},g));var g};m.prototype._renderLegendForElement=function(b,c,d){var a=this,e="color-ramp"===b.type,f="opacity-ramp"===b.type,g="size-ramp"===b.type,k=null;if("symbol-table"===b.type||g){var h=b.infos.map(function(d){return a._renderLegendForElementInfo(d,c,g,b.legendType)}).filter(function(a){return!!a});h.length&&
(k=n.tsx("div",{class:"esri-legend__layer-body"},h))}else if(e||f)k=this._renderLegendForRamp(b.infos,b.overlayColor,f);if(!k)return null;var h=b.title,m=null;"string"===typeof h?m=h:h&&(m=q.getTitle(h,e||f),m=q.isRendererTitle(h,e||f)&&h.title?h.title+" ("+m+")":m);e=d?"esri-legend__layer-child-table":"esri-legend__layer-table";f=m?n.tsx("div",{class:"esri-legend__layer-caption"},m):null;d=(p={},p["esri-legend__layer-table--size-ramp"]=g||!d,p);return n.tsx("div",{class:e,classes:d},f,k);var p};
m.prototype._renderLegendForRamp=function(b,c,f){var a=b.length-1,e=null;2<a?e=25*a:e=50;var g=document.createElement("div");g.className="esri-legend__color-ramp "+(f?"esri-legend__opacity-ramp":"");g.style.height=e+"px";f=d.createSurface(g,"100%",e);try{b.forEach(function(b,c){b.offset=c/a}),f.createRect({x:0,y:0,width:"100%",height:e}).setFill({type:"linear",x1:0,y1:0,x2:0,y2:e,colors:b}).setStroke(null),c&&0<c.a&&f.createRect({x:0,y:0,width:"100%",height:e}).setFill(c).setStroke(null)}catch(u){f.clear(),
f.destroy()}if(!f)return null;b=b.filter(function(a){return!!a.label}).map(function(a){return n.tsx("div",{class:"esri-legend__ramp-label"},a.label)});e={height:e+"px"};return n.tsx("div",{class:"esri-legend__layer-row"},n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},n.tsx("div",{class:"esri-legend__ramps",bind:g,afterCreate:q.attachToNode})),n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},n.tsx("div",{class:"esri-legend__ramp-labels",
styles:e},b)))};m.prototype._renderLegendForElementInfo=function(b,c,d,a){if(b.type)return this._renderLegendForElement(b,c,!0);var e=null;a=q.isImageryStretchedLegend(c,a);b.symbol&&b.preview?e=n.tsx("div",{class:"esri-legend__symbol",bind:b.preview,afterCreate:q.attachToNode}):b.src&&(e=this._renderImage(b,c,a));if(!e)return null;c=(f={},f["esri-legend__imagery-layer-info--stretched"]=a,f);d=(g={},g["esri-legend__imagery-layer-info--stretched"]=a,g["esri-legend__size-ramp"]=!a&&d,g);return n.tsx("div",
{class:"esri-legend__layer-row"},n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",classes:d},e),n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info",classes:c},b.label||""));var f,g};m.prototype._renderImage=function(b,c,d){var a=b.label,e=b.src,f=b.opacity;d=(g={},g["esri-legend__imagery-layer-image--stretched"]=d,g["esri-legend__symbol"]=!d,g);return n.tsx("img",{alt:a,src:e,border:0,width:b.width,height:b.height,classes:d,styles:{opacity:""+(null!=
f?f:c.opacity)}});var g};f([n.renderable(),r.property()],m.prototype,"activeLayerInfos",void 0);return m=f([r.subclass("esri.widgets.Legend.styles.Classic")],m)}(r.declared(m))})},"widgets/Legend/_build-generate_module":function(){define(["dojo/i18n!./nls/strings"],function(){})},"*now":function(x){x(['dojo/i18n!*preload*widgets/Legend/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define(["dojo/_base/declare","jimu/BaseWidget","esri/widgets/Legend"],function(x,g,b){return x([g],{name:"Legend",baseClass:"jimu-widget-legend",templateString:"\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d'legendDiv'\x3e\x3c/div\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);this.legend=new b({container:this.legendDiv,view:this.sceneView})},destroy:function(){this.legend&&this.legend.destroy();this.inherited(arguments)}})});