// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Legend/nls/Legend ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/decorators/cast ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widget".split(" "),function(D,l,h,d,f,t,p,w,z,A,c,C,g,b,a){return function(r){function e(a){a=r.call(this)||
this;a._handles=new p;a.activeLayerInfos=null;a.basemapLegendVisible=!1;a.groundLegendVisible=!1;a.respectLayerVisibility=!0;a.iconClass="esri-icon-layer-list";a.label=t.widgetLabel;a.layerInfos=null;a.style=new b;a.view=null;a.viewModel=new C;return a}d(e,r);e.prototype.postInitialize=function(){var a=this;this.own(w.on(this,"activeLayerInfos","change",function(){return a._refreshActiveLayerInfos(a.activeLayerInfos)}),w.init(this,"style",function(b,r){r&&b!==r&&r.destroy();b&&(b.activeLayerInfos=
a.activeLayerInfos,"card"===b.type&&(b.view=a.view))}))};e.prototype.destroy=function(){this._handles.destroy();this._handles=null};e.prototype.castStyle=function(a){if(a instanceof g||a instanceof b)return a;if("string"===typeof a)return"card"===a?new g:new b;if(a&&"string"===typeof a.type){var r=h({},a);delete r.type;return new ("card"===a.type?g:b)(r)}return new b};e.prototype.render=function(){return this.style.render()};e.prototype._refreshActiveLayerInfos=function(a){var b=this;this._handles.removeAll();
a.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)});this.scheduleRender()};e.prototype._renderOnActiveLayerInfoChange=function(a){var b=this,r=w.init(a,"version",function(){return b.scheduleRender()});this._handles.add(r,"version_"+a.layer.uid);a.children.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)})};f([z.aliasOf("viewModel.activeLayerInfos"),a.renderable()],e.prototype,"activeLayerInfos",void 0);f([z.aliasOf("viewModel.basemapLegendVisible"),a.renderable()],e.prototype,
"basemapLegendVisible",void 0);f([z.aliasOf("viewModel.groundLegendVisible"),a.renderable()],e.prototype,"groundLegendVisible",void 0);f([z.aliasOf("viewModel.respectLayerVisibility"),a.renderable()],e.prototype,"respectLayerVisibility",void 0);f([z.property()],e.prototype,"iconClass",void 0);f([z.property()],e.prototype,"label",void 0);f([z.aliasOf("viewModel.layerInfos"),a.renderable()],e.prototype,"layerInfos",void 0);f([z.property(),a.renderable()],e.prototype,"style",void 0);f([A.cast("style")],
e.prototype,"castStyle",null);f([z.aliasOf("viewModel.view"),a.renderable()],e.prototype,"view",void 0);f([z.property(),a.renderable(["view.size"])],e.prototype,"viewModel",void 0);return e=f([z.subclass("esri.widgets.Legend")],e)}(z.declared(c))})},"esri/widgets/Legend/LegendViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./support/ActiveLayerInfo".split(" "),
function(D,l,h,d,f,t,p,w,z,A){var c=t.ofType(A),C="esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.HeatmapLayer esri.layers.MapImageLayer esri.layers.PointCloudLayer esri.layers.TileLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.GeoRSSLayer esri.layers.GeoJSONLayer esri.layers.GroupLayer esri.layers.ImageryLayer esri.layers.WMSLayer esri.layers.WMTSLayer".split(" "),g=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];
return function(b){function a(a){a=b.call(this,a)||this;a._handles=new p;a._layerViewByLayerId={};a._layerInfosByLayerViewId={};a._activeLayerInfosByLayerViewId={};a.activeLayerInfos=new c;a.basemapLegendVisible=!1;a.groundLegendVisible=!1;a.respectLayerVisibility=!0;a.layerInfos=[];a.view=null;return a}h(a,b);a.prototype.initialize=function(){this._handles.add(w.init(this,"view",this._viewHandles),"view")};a.prototype.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();
this.view=this._handles=null};Object.defineProperty(a.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});a.prototype._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(w.init(this,"state",this._stateHandles),"state")};a.prototype._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};a.prototype._resetAll=function(){this._handles.remove(["all-layer-views",
"legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};a.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};a.prototype._destroyViewActiveLayerInfo=function(a){this._handles.remove(a);delete this._activeLayerInfosByLayerViewId[a]};a.prototype._watchPropertiesAndAllLayerViews=function(){var a=this.view.allLayerViews;a.length&&this._refresh();this._handles.add(a.on("change",
this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(w.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};a.prototype._allLayerViewsChangeHandle=function(a){var b=this;a.removed.forEach(function(a){return b._destroyViewActiveLayerInfo(a.uid)});this._refresh()};a.prototype._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();this._refresh()};a.prototype._refresh=function(){this._layerInfosByLayerViewId=
{};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};a.prototype._sortActiveLayerInfos=function(a){var b={};this.view.allLayerViews.forEach(function(a,e){return b[a.layer.uid]=e});a.sort(function(a,e){return(b[e.layer.uid]||0)-(b[a.layer.uid]||0)})};a.prototype._generateLayerViews=function(){var a=[];g.filter(this._filterLayerViews,
this).map(this.get,this).filter(function(a){return null!=a}).forEach(this._collectLayerViews("layerViews",a));return a};a.prototype._filterLayerViews=function(a){var b=!this.groundLegendVisible&&"view.groundView.layerViews"===a;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===a||"view.basemapView.referenceLayerViews"===a))&&!b};a.prototype._collectLayerViews=function(a,b){var e=function(r){r&&r.forEach(function(r){b.push(r);e(r[a])});return b};return e};a.prototype._filterLayerViewsByLayerInfos=
function(a){var b=this,r=this.layerInfos;return r&&r.length?r.some(function(e){return b._hasLayerInfo(e,a)}):!0};a.prototype._hasLayerInfo=function(a,b){var e=this._isLayerUIDMatching(a.layer,b.layer.uid);e&&(this._layerInfosByLayerViewId[b.uid]=a);return e};a.prototype._isLayerUIDMatching=function(a,b){return a&&(a.uid===b||this._hasLayerUID(a.layers,b))};a.prototype._hasLayerUID=function(a,b){var e=this;return a&&a.some(function(a){return e._isLayerUIDMatching(a,b)})};a.prototype._isLayerViewSupported=
function(a){return-1<C.indexOf(a.layer.declaredClass)?(this._layerViewByLayerId[a.layer.uid]=a,!0):!1};a.prototype._generateActiveLayerInfo=function(a){var b=this;this._isLayerActive(a)?this._buildActiveLayerInfo(a):(this._handles.remove(a.uid),this._handles.add(w.watch(a,"suspended, layer.legendEnabled",function(){return b._layerActiveHandle(a)}),a.uid))};a.prototype._layerActiveHandle=function(a){this._isLayerActive(a)&&(this._handles.remove(a.uid),this._buildActiveLayerInfo(a))};a.prototype._isLayerActive=
function(a){return this.respectLayerVisibility?!a.suspended&&a.get("layer.legendEnabled"):!0};a.prototype._buildActiveLayerInfo=function(a){var b=this,r=a.layer,c=a.uid,d=this._layerInfosByLayerViewId[c],k=this._activeLayerInfosByLayerViewId[c];k||(k=new A({layer:r,title:d&&void 0!==d.title?d.title:r.title,view:this.view}),this._activeLayerInfosByLayerViewId[c]=k);k.parent||(d=(d=r.parent)&&this._layerViewByLayerId[d.uid],k.parent=d&&this._activeLayerInfosByLayerViewId[d.uid]);if(!this._handles.has(c)){var d=
w.watch(r,"title",function(e){return b._titleHandle(e,k,a)}),v=w.watch(r,"renderer?, opacity",function(){return b._constructLegendElements(k,a)}),n=w.whenTrue(this.view,"stationary",function(){return b._scaleHandle(k,a)}),d=[d,v,n];this.respectLayerVisibility&&(v=w.watch(a,"suspended",function(e){return b._suspendedHandle(e,k,a)}),r=w.watch(r,"legendEnabled",function(e){return b._legendEnabledHandle(e,k,a)}),d.push(v,r));this._handles.add(d,c);this._constructLegendElements(k,a)}this._addActiveLayerInfo(k,
a)};a.prototype._titleHandle=function(a,b,c){b.title=a;this._constructLegendElements(b,c)};a.prototype._legendEnabledHandle=function(a,b,c){a?this._addActiveLayerInfo(b,c):this._removeActiveLayerInfo(b)};a.prototype._suspendedHandle=function(a,b,c){a?this._removeActiveLayerInfo(b):this._addActiveLayerInfo(b,c)};a.prototype._scaleHandle=function(a,b){a.scale!==this.view.scale&&a.isScaleDriven&&this._constructLegendElements(a,b)};a.prototype._addActiveLayerInfo=function(a,b){this._isLayerActive(b)&&
-1===this.activeLayerInfos.indexOf(a)&&((b=a.parent,b)?-1===b.children.indexOf(a)&&(b.children.push(a),this._sortActiveLayerInfos(b.children)):(this.activeLayerInfos.add(a),this._sortActiveLayerInfos(this.activeLayerInfos)))};a.prototype._removeActiveLayerInfo=function(a){var b=a.parent;b?b.children.remove(a):this.activeLayerInfos.remove(a)};a.prototype._constructLegendElements=function(a,b){b=b.layer;a.scale=this.view.scale;b.featureCollections?a.buildLegendElementsForFeatureCollections(b.featureCollections):
b.renderer?a.buildLegendElementsForRenderer():b.url&&a.buildLegendElementsForTools()};d([z.property({type:c})],a.prototype,"activeLayerInfos",void 0);d([z.property()],a.prototype,"basemapLegendVisible",void 0);d([z.property()],a.prototype,"groundLegendVisible",void 0);d([z.property()],a.prototype,"respectLayerVisibility",void 0);d([z.property()],a.prototype,"layerInfos",void 0);d([z.property({dependsOn:["view.ready"],readOnly:!0})],a.prototype,"state",null);d([z.property()],a.prototype,"view",void 0);
return a=d([z.subclass("esri.widgets.Legend.LegendViewModel")],a)}(z.declared(f))})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Handles ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils @dojo/framework/shim/Promise".split(" "),
function(D,l,h,d,f,t,p,w,z,A,c,C,g,b,a,r,e,I,H,B,k,v,n,u,x,G,M,E,y,O){function m(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function K(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function Q(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function F(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function J(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function S(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function T(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}var N=a.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),R=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,L=new A.SimpleMarkerSymbol({size:6,outline:{color:[128,128,128,.5],width:.5}}),X=new A.SimpleFillSymbol({style:"solid"}),Y=new A.SimpleMarkerSymbol({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});return function(a){function c(q){q=a.call(this,
q)||this;q._handles=new b;q._hasColorRamp=!1;q._hasOpacityRamp=!1;q._hasSizeRamp=!1;q._legendResponse={};q._webStyleSymbolCache=new Map;q._dotDensityUrlCache=new Map;q.children=new g;q.layer=null;q.legendElements=[];q.parent=null;q.scale=null;q.title=null;q.view=null;return q}d(c,a);c.prototype.initialize=function(){var a=this,b=function(){return a.notifyChange("ready")};this._handles.add([H.on(this,"children","change",function(q){var m=q.removed,c=a._handles;q.added.map(function(a){var q="activeLayerInfo-ready-watcher-"+
a.layer.uid;c.add(H.init(a,"ready",b),q)});m.forEach(function(a){return c.remove(a.layer.uid)});b()})])};c.prototype.destroy=function(){this._handles.destroy();this._dotDensityUrlCache=this._webStyleSymbolCache=this._legendResponse=this._handles=null};Object.defineProperty(c.prototype,"ready",{get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isScaleDriven",{get:function(){var a=
this,b=this.layer;if(null===b)return!1;if("renderer"in b&&b.renderer){if("dot-density"===b.renderer.type)return!0;var m=b.get("renderer.valueExpression");return R.test(m)?!0:(b=b.get("renderer.visualVariables"))&&b.some(function(b){return a._isScaleDrivenSizeVariable(b)})}return!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"version",{get:function(){return this._get("version")+1},enumerable:!0,configurable:!0});c.prototype.buildLegendElementsForFeatureCollections=function(a){return t(this,
void 0,void 0,function(){var b,q=this;return p(this,function(m){this.legendElements=[];b=a.map(function(a){if("esri.layers.FeatureLayer"===a.declaredClass)return q._buildRendererLegendElements(a.renderer,a.title,"append");if(a.featureSet&&a.featureSet.features.length){var b=a.layerDefinition,b=(b=b&&b.drawingInfo)&&n.fromJSON(b.renderer);return b?q._buildRendererLegendElements(b,a.name,"append"):(N.warn("drawingInfo not available!"),null)}return null});return[2,e.eachAlways(b).then(function(){})]})})};
c.prototype.buildLegendElementsForRenderer=function(){return t(this,void 0,void 0,function(){return p(this,function(a){return[2,this._buildRendererLegendElements("renderer"in this.layer&&this.layer.renderer,null,"replace")]})})};c.prototype.buildLegendElementsForTools=function(){return t(this,void 0,void 0,function(){var a,b=this;return p(this,function(q){switch(q.label){case 0:a=this.layer;if("esri.layers.WMTSLayer"!==a.declaredClass)return[3,1];this._constructLegendElementsForWMTSlayer();return[3,
6];case 1:if("esri.layers.WMSLayer"!==a.declaredClass)return[3,2];this._constructLegendElementsForWMSSublayers();return[3,6];case 2:return"esri.layers.MapImageLayer"!==a.declaredClass?[3,4]:[4,this._constructLegendElementsForSublayers()];case 3:return q.sent(),[3,6];case 4:return this._handles.remove("imageryLayers-watcher"),[4,this._getLegendLayers().then(function(q){b.legendElements=[];q.forEach(function(q){if("esri.layers.ImageryLayer"===a.declaredClass){var m=a.watch("renderingRule, bandIds",
function(){b._legendResponse["default"]=null;b.buildLegendElementsForTools()});b._handles.add(m,"imageryLayers-watcher")}(q=b._generateSymbolTableElementForLegendLayer(q))&&q.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(q.title=a.title),b.legendElements.push(q));b.notifyChange("ready")});b.notifyChange("ready")}).catch(function(a){N.warn("Request to server for legend has failed!",a)})];case 5:q.sent(),q.label=6;case 6:return[2]}})})};c.prototype._isGroupActive=function(){var a=this.children;
return a.length?a.some(function(a){return a.ready}):!1};c.prototype._isScaleDrivenSizeVariable=function(a){if(a&&"size"!==a.type)return!1;var b=a.minSize,q=a.maxSize;return"object"===typeof b&&b?this._isScaleDrivenSizeVariable(b):"object"===typeof q&&q?this._isScaleDrivenSizeVariable(q):!!a.expression||R.test(a.valueExpression)};c.prototype._buildRendererLegendElements=function(a,b,m){return t(this,void 0,void 0,function(){var q,c;return p(this,function(e){switch(e.label){case 0:return e.trys.push([0,
2,,3]),[4,this._getRendererLegendElements(a,b)];case 1:return q=e.sent(),"append"===m?Array.prototype.push.apply(this.legendElements,q):this.legendElements=q,this.notifyChange("ready"),[3,3];case 2:return c=e.sent(),N.warn("error while building legend for layer!",c),[3,3];case 3:return[2]}})})};c.prototype._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");var a=this.layer,b=a.activeLayer;this._handles.add(H.watch(this.layer,"activeLayer",
this._constructLegendElementsForWMTSlayer.bind(this)),"wmts-activeLayer-watcher");if(b.styleId&&b.styles){var m=null;b.styles.some(function(a){return b.styleId===a.id?(m=a.legendUrl,!0):!1});m&&(this.legendElements=[{type:"symbol-table",title:b.title,infos:[{src:m,opacity:a.opacity}]}])}this.notifyChange("ready")};c.prototype._constructLegendElementsForWMSSublayers=function(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");var a=this.layer,b=null;if(a.customParameters||a.customLayerParameters)b=
h({},a.customParameters,a.customLayerParameters);this._handles.add(H.watch(this.layer,"sublayers",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");this.legendElements=this._generateLegendElementsForWMSSublayers(a.sublayers,b);this.notifyChange("ready")};c.prototype._generateLegendElementsForWMSSublayers=function(a,b){var q=this,m=[];this._handles.add(a.on("change",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");a.forEach(function(a){var c=
a.watch("title, visible, legendEnabled",function(){return q._constructLegendElementsForWMSSublayers()});q._handles.add(c,"wms-sublayers-watcher");a.visible&&a.legendEnabled&&(a=q._generateSymbolTableElementForWMSSublayer(a,b))&&a.infos.length&&m.unshift(a)});return m};c.prototype._generateSymbolTableElementForWMSSublayer=function(a,b){return!a.legendUrl&&a.sublayers?(b=this._generateLegendElementsForWMSSublayers(a.sublayers,b).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:b}):
this._generateSymbolTableElementForLegendUrl(a,b)};c.prototype._generateSymbolTableElementForLegendUrl=function(a,b){var q=a.legendUrl;if(q){var m={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};b&&(q+="?"+I.objectToQuery(b));m.infos.push({src:q,opacity:a.layer&&a.layer.opacity});return m}};c.prototype._getLegendLayers=function(a){var b=this,q=(a=a&&a.hasDynamicLayers?a.dynamicLayers:null)||"default",m=this._legendResponse&&this._legendResponse[q];return m?e.resolve(m):this._legendRequest(a).then(function(a){a=
a.layers;return b._legendResponse[q]=a})};c.prototype._legendRequest=function(a){var b=this.layer;a={f:"json",dynamicLayers:a};"esri.layers.ImageryLayer"===b.declaredClass&&(b.renderingRule&&(a.renderingRule=JSON.stringify(b.renderingRule.toJSON())),b.bandIds&&(a.bandIds=b.bandIds.join()),b.raster||b.viewId)&&(a=h({raster:b.raster,viewId:b.viewId},a));var q=b.url.replace(/(\/)+$/,"");"version"in b&&10.01<=b.version?(b=q.indexOf("?"),q=-1<b?q.substring(0,b)+"/legend"+q.substring(b):q+"/legend"):(b=
q.toLowerCase().indexOf("/rest/"),q=q.substring(0,b)+q.substring(b+5,q.length),q="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(q)+"\x26returnbytes\x3dtrue");return z(q,{query:a}).then(function(a){return a.data})};c.prototype._constructLegendElementsForSublayers=function(){var a=this;this.legendElements=[];this._handles.remove("sublayers-watcher");var b=this.layer,m=new k.ExportImageParameters({layer:b});return this._getLegendLayers(m).then(function(q){var m={};q.forEach(function(a){m[a.layerId]=
a});a._handles.add(H.watch(b,"sublayers",a._constructLegendElementsForSublayers.bind(a)),"sublayers-watcher");a.legendElements=a._generateLegendElementsForSublayers(b.sublayers,m,b.opacity);a.notifyChange("ready")}).catch(function(a){N.warn("Request to server for legend has failed!",a)}).then(function(){return m.destroy()})};c.prototype._generateLegendElementsForSublayers=function(a,b,m){var q=this,c=[];this._handles.add(a.on("change",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher");
a.forEach(function(a){var e=a.watch("renderer, opacity, title, visible",function(){return q._constructLegendElementsForSublayers()});q._handles.add(e,"sublayers-watcher");a.visible&&a.legendEnabled&&(e=a&&null!=a.opacity?a.opacity:null,(a=q._generateSymbolTableElementForSublayer(a,b,null!=e?e*m:m))&&a.infos.length&&c.unshift(a))});return c};c.prototype._generateSymbolTableElementForSublayer=function(a,b,m){var q=b[a.id];return!q&&a.sublayers?(b=this._generateLegendElementsForSublayers(a.sublayers,
b,m).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:b}):this._generateSymbolTableElementForLegendLayer(q,a,m)};c.prototype._generateSymbolTableElementForLegendLayer=function(a,b,m){var q=this;if(a){var c=b&&b.renderer,e=b&&b.title||a.layerName;c&&(c=b&&b.title||this._getRendererTitle(c,b))&&(e&&(c.title=e),e=c);e={type:"symbol-table",title:e,infos:[]};a.legendType&&(e.legendType=a.legendType);a.legend&&this._isLegendLayerInScale(a,b)&&(b=b?this._sanitizeLegendForSublayer(a.legend.slice(),
b):a.legend,e.infos=b.map(function(b){var c=b.url;if(b.imageData&&0<b.imageData.length)c="data:image/png;base64,"+b.imageData;else if(0!==c.indexOf("http"))c=I.addTokenParameter(q.layer.url+"/"+a.layerId+"/images/"+c);else return null;return{label:b.label,src:c,opacity:m,width:b.width,height:b.height}}).filter(function(a){return!!a}));return e.infos.length?e:null}};c.prototype._isLegendLayerInScale=function(a,b){b=b||this.layer;var m=null,q=null,c=!0;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==
b.maxScale?(0===a.minScale&&b.tileInfo&&(m=b.tileInfo.lods[0].scale),0===a.maxScale&&b.tileInfo&&(q=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(m=Math.min(b.minScale,a.minScale)||b.minScale||a.minScale,q=Math.max(b.maxScale,a.maxScale));if(0<m&&m<this.scale||q>this.scale)c=!1;return c};c.prototype._sanitizeLegendForSublayer=function(a,b){if("version"in this.layer&&10.1>this.layer.version||0===a.length)return a;b=b.renderer;var m=null,q=null;a.some(function(a){return a.values})&&a.some(function(a,
b){a.values||(m=b,q=a,q.label||(q.label="others"));return null!=q});b?"unique-value"===b.type?q&&(a.splice(m,1),a.push(q)):"class-breaks"===b.type&&(q&&a.splice(m,1),a.reverse(),q&&a.push(q)):q&&(a.splice(m,1),a.push(q));return a};c.prototype._getRendererLegendElements=function(a,b){return t(this,void 0,void 0,function(){return p(this,function(q){return m(a)||K(a)||Q(a)||"raster-stretch"===a.type||"raster-colormap"===a.type||F(a)||J(a)||S(a)||T(a)||"esri.renderers.DotDensityRenderer"===a.declaredClass?
J(a)||S(a)||T(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?[2,this._constructPointCloudRendererLegendElements(a,b)]:"dot-density"===a.type?[2,this._constructDotDensityRendererLegendElements(a)]:[2,this._constructRendererLegendElements(a,b)]:(N.warn("Renderer not supported!"),[2,[]])})})};c.prototype._getPointCloudRendererTitle=function(a){return a.legendOptions&&a.legendOptions.title||a.field};c.prototype._constructPointCloudRendererLegendElements=function(a,b){var m=this,c=[],q=null,
F=null;if(J(a))q={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(function(a){q.infos.unshift({label:a.label||a.minValue+" - "+a.maxValue,value:[a.minValue,a.maxValue],symbol:m._getAppliedCloneSymbol(L,a.color)})});else if(S(a)){var F=a.stops,n=null;if(F.length&&(1===F.length&&(n=F[0].color),!n)){var k=F[0].value,r=F[F.length-1].value;null!=k&&null!=r&&(n=G.getColorFromPointCloudStops(k+(r-k)/2,F))}q={type:"symbol-table",title:null,infos:[{label:null,
value:null,symbol:this._getAppliedCloneSymbol(L,n||L.color)}]};F=G.getRampStopsForPointCloud(a.stops);F={type:"color-ramp",title:b||this._getPointCloudRendererTitle(a),infos:F,preview:u.renderColorRampPreviewHTML(F.map(function(a){return a.color}))}}else T(a)&&(q={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos.forEach(function(a){q.infos.push({label:a.label||a.values.join(", "),value:a.values.join(", "),symbol:m._getAppliedCloneSymbol(L,a.color)})}));
q&&q.infos.length&&c.push(q);F&&F.infos.length&&c.push(F);a=c.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!!a.symbol}).map(function(a){return m._getSymbolPreview(a)});return e.eachAlways(a).then(function(){return c})};c.prototype._getElementInfoForDotDensity=function(a,b){var m=a.outline,m=a.dotSize+"-"+b+"-"+a.backgroundColor+"-"+(m&&JSON.stringify(m.toJSON())),c=this._dotDensityUrlCache;a=c.has(m)?c.get(m):u.renderDotDensityPreviewHTML(a,b);c.set(m,a);return{opacity:1,
src:a.src,preview:a,width:a.width,height:a.height}};c.prototype._constructDotDensityRendererLegendElements=function(a){var b=this,m=a.calculateDotValue(this.view.scale),c={type:"symbol-table",title:{value:m&&Math.round(m),unit:a.legendOptions&&a.legendOptions.unit||""},infos:[]};a.attributes.forEach(function(m){var q=b._getElementInfoForDotDensity(a,m.color);q.label=m.label||m.valueExpressionTitle||m.field;c.infos.push(q)});return e.resolve([c])};c.prototype._constructRendererLegendElements=function(a,
b){return t(this,void 0,void 0,function(){var c,q,n,k,v,d,J,f,g,x,B,Z,h,I,G,t,y,l,H,A,z,C,S,T,w,N,P,O,L,U,R,D,aa,ca,da,ba=this;return p(this,function(p){switch(p.label){case 0:return[4,this._loadRenderer(a)];case 1:return c=p.sent(),this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1,[4,this._getVisualVariableLegendElements(c)];case 2:q=p.sent()||[];n={type:"symbol-table",title:b||this._getRendererTitle(c),infos:[]};k=null;v=!1;if(!F(c))return[3,3];d=M.getHeatmapRampStops(c);q.push({type:"heatmap-ramp",
title:b,infos:d,preview:u.renderColorRampPreviewHTML(d.map(function(a){return a.color}))});return[3,10];case 3:if(!Q(c))return[3,4];if(f=(J=c&&c.authoringInfo)&&"relationship"===J.type){if(g=J.focus,x=J.numClasses,B=J.field1,Z=J.field2,x&&B&&Z){h=this.layer;I=[B,Z];G=E.getRotationAngleForFocus(g)||0;t=0;for(y=I;t<y.length;t++)l=y[t],H=l.field,A=l.normalizationField,z={field:this._getFieldAlias(H,h),normField:A&&this._getFieldAlias(A,h)},C=Y.clone(),C.angle=G,n.infos.push({label:z,symbol:C}),G+=90;
S=E.getRelationshipRampElement({focus:g,numClasses:x,infos:c.uniqueValueInfos});q.unshift(S)}}else T=c.field,c.uniqueValueInfos.forEach(function(a){a.symbol&&n.infos.push({label:a.label||ba._getDomainName(T,a.value)||a.value,value:a.value,symbol:a.symbol})});c.defaultSymbol&&(n.infos.push({label:c.defaultLabel||"others",symbol:c.defaultSymbol}),v=!0);return[3,10];case 4:if(!K(c))return[3,5];k=this._isUnclassedRenderer(c);if(w=!k||!this._hasSizeRamp)c.classBreakInfos.forEach(function(a){a.symbol&&
n.infos.unshift({label:a.label||(k?null:a.minValue+" - "+a.maxValue),value:[a.minValue,a.maxValue],symbol:a.symbol})}),k&&(n.title=null),this._updateInfosforClassedSizeRenderer(c,n.infos);c.defaultSymbol&&!k&&(n.infos.push({label:c.defaultLabel||"others",symbol:c.defaultSymbol}),v=!0);return[3,10];case 5:if("raster-stretch"!==c.type)return[3,9];h=this.layer;P=N=void 0;c.statistics&&(N=c.statistics[0].min||c.statistics[0][0],P=c.statistics[0].max||c.statistics[0][1]);O=[];U=r.unwrap;return h.renderingRule?
[4,h.generateRasterInfo(h.renderingRule)]:[3,7];case 6:return R=p.sent(),[3,8];case 7:R=h.serviceRasterInfo,p.label=8;case 8:return L=U.apply(void 0,[R]),D=L.keyProperties.BandProperties,1===L.bandCount?(N=N||L.statistics&&L.statistics[0].min,P=P||L.statistics&&L.statistics[0].max,N&&P?q.push(this._getStretchLegendElements(c,{min:N,max:P})):this.buildLegendElementsForTools()):h.bandIds&&1===h.bandIds.length?(N=N||L.statistics&&L.statistics[h.bandIds[0]].min,P=P||L.statistics&&L.statistics[h.bandIds[0]].max,
N&&P?q.push(this._getStretchLegendElements(c,{min:N,max:P})):this.buildLegendElementsForTools()):3<=L.bandCount?D&&D.length>=L.bandCount?h.bandIds&&3===h.bandIds.length?(O=h.bandIds.map(function(a){return D[a].BandName}),n.infos=this._createSymbolTableElementMultiBand(O)):"lerc"===h.format?(O=[0,1,2].map(function(a){return D[a].BandName}),n.infos=this._createSymbolTableElementMultiBand(O)):this.buildLegendElementsForTools():"lerc"===h.format?(O=["band0","band1","band2"],n.infos=this._createSymbolTableElementMultiBand(O)):
this.buildLegendElementsForTools():this.buildLegendElementsForTools(),[3,10];case 9:"raster-colormap"===c.type?c.colormapInfos.forEach(function(a){n.infos.push({label:a.label,value:a.value,symbol:ba._getAppliedCloneSymbol(X,a.color)})}):m(c)&&c.symbol&&!this._hasSizeRamp&&n.infos.push({label:c.label,symbol:c.symbol}),p.label=10;case 10:return aa=c.defaultSymbol,!aa||v||m(c)||k&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||q.push({type:"symbol-table",infos:[{label:c.defaultLabel||
"others",symbol:aa}]}),n.infos.length&&q.unshift(n),ca=this._getSymbolConfig("visualVariables"in c&&c.visualVariables),da=q.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!(!a||!a.symbol)}).map(function(a){return ba._getSymbolPreview(a,ca)}),c=null,[4,e.eachAlways(da)];case 11:return p.sent(),[2,q]}})})};c.prototype._getStretchLegendElements=function(a,b){a=G.getStrectchRampStops(a.colorRamp,b);return{type:"stretch-ramp",title:"",infos:a,preview:u.renderColorRampPreviewHTML(a.map(function(a){return a.color}))}};
c.prototype._createSymbolTableElementMultiBand=function(a){var b=[],m=["red","green","blue"];a.forEach(function(a,c){b.push({label:{colorName:m[c],bandName:a},src:O.RGB_IMG_SOURCE[c],opacity:1})});return b};c.prototype._updateInfosforClassedSizeRenderer=function(a,b){var m=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,c=a.classBreakInfos.some(function(a){return x.isVolumetricSymbol(a.symbol)});if(m&&c){var q=y.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;var e=(q-y.REAL_WORLD_MIN_SIZE)/
(1<a?a-1:a);b.forEach(function(a,b){a.size=q-e*b})}};c.prototype._getSymbolConfig=function(a){var b=!1,m=!1;if(a)for(var c=0;c<a.length&&(!b||!m);c++){var q=a[c];"size"===q.type&&("height"===q.axis&&(b=!0),"width-and-depth"===q.axis&&(m=!0))}return b&&m?"tall":null};c.prototype._getSymbolPreview=function(a,b){return u.renderPreviewHTML(a.symbol,{size:a.size,opacity:this.layer.opacity,symbolConfig:b,rotation:a.symbol.angle}).then(function(b){a.preview=b;return a}).catch(function(){a.preview=null;return a})};
c.prototype._loadRenderer=function(a){return t(this,void 0,void 0,function(){var b,c,q,F,n=this;return p(this,function(k){switch(k.label){case 0:return b=[],a=a.clone(),[4,this._getMedianColor(a)];case 1:c=k.sent();if(K(a)||Q(a))q=a.classBreakInfos||a.uniqueValueInfos,F=q.map(function(a){return n._fetchSymbol(a.symbol,c).then(function(b){a.symbol=b}).catch(function(){a.symbol=null})}),Array.prototype.push.apply(b,F);b.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:c).then(function(b){n._applySymbolToRenderer(a,
b,m(a))}).catch(function(){n._applySymbolToRenderer(a,null,m(a))}));return[2,e.eachAlways(b).then(function(){return a})]}})})};c.prototype._applySymbolToRenderer=function(a,b,m){m?a.symbol=b:a.defaultSymbol=b};c.prototype._getMedianColor=function(a){return t(this,void 0,void 0,function(){var b,m,c,e,q;return p(this,function(n){switch(n.label){case 0:if(!("visualVariables"in a&&a.visualVariables))return[2,null];b=C.find(a.visualVariables,function(a){return"color"===a.type});if(!b)return[2,null];c=
m=null;if(b.stops){if(1===b.stops.length)return[2,b.stops[0].color];m=b.stops[0].value;c=b.stops[b.stops.length-1].value}e=m+(c-m)/2;return[4,new Promise(function(a,b){D(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return q=n.sent().getColor,[2,q(b,e)]}})})};c.prototype._fetchSymbol=function(a,b){var m=this;if(!a)return e.reject();if("web-style"===a.type){var c=a.portal,c=a.name+"-"+a.styleName+"-"+a.styleUrl+"-"+(c&&c.url)+"-"+(c&&c.user&&c.user.username),n=this._webStyleSymbolCache;
n.has(c)||n.set(c,a.fetchSymbol());return n.get(c).then(function(a){return m._getAppliedCloneSymbol(a,b)}).catch(function(){N.warn("Fetching web-style failed!");return e.reject()})}return e.resolve(this._getAppliedCloneSymbol(a,b))};c.prototype._getAppliedCloneSymbol=function(a,b){if(!a)return a;a=a.clone();var c=-1<a.type.indexOf("3d");b=b&&b.toRgba();c?this._applyColorTo3dSymbol(a,b):a.color&&(a.color=new w(b||a.color));return a};c.prototype._applyColorTo3dSymbol=function(a,b){b&&a.symbolLayers.forEach(function(a){a&&
(a.material||(a.material={}),a.material.color=new w(b))})};c.prototype._getVisualVariableLegendElements=function(a){return t(this,void 0,void 0,function(){var b,c,n,F,k,q,J,d,f,g,Q=this;return p(this,function(x){switch(x.label){case 0:if(!("visualVariables"in a&&a.visualVariables))return[2,null];b=a.visualVariables;c=[];n=[];F=[];k=this.layer;b.forEach(function(a){"color"===a.type?c.push(a):"size"===a.type?n.push(a):"opacity"===a.type&&F.push(a)});q=c.concat(n,F);0===c.length&&K(a)&&a.classBreakInfos&&
1===a.classBreakInfos.length&&(J=(f=a.classBreakInfos[0])&&f.symbol);0===c.length&&m(a)&&(J=a.symbol);J&&(-1<J.type.indexOf("3d")?(g=J.symbolLayers.getItemAt(0),"water"===g.type?r.isSome(g.color)&&(d=g.color):r.isSome(g.material)&&r.isSome(g.material.color)&&(d=g.material.color)):J.url||(d=J.color));return[4,e.all(q.map(function(b){return t(Q,void 0,void 0,function(){var c,m,e,n,F,q,r,J;return p(this,function(K){switch(K.label){case 0:if(b.legendOptions&&!1===b.legendOptions.showLegend)return[3,8];
c=this._getRampTitle(b,k);m=null;n=(e="getField"in k&&k.getField&&k.getField(b.field))&&v.isDateField(e);return"color"!==b.type?[3,2]:[4,G.getRampStops(b,null,n)];case 1:return F=K.sent(),m={type:"color-ramp",title:c,infos:F,preview:u.renderColorRampPreviewHTML(F.map(function(a){return a.color}))},this._hasColorRamp||(this._hasColorRamp=!(null==m.infos||!m.infos.length)),[3,7];case 2:if("size"!==b.type)return[3,5];q={type:"size-ramp",title:c};r=y.getRampStops;J=[a,b];return[4,this._getMedianColor(a)];
case 3:return[4,r.apply(void 0,J.concat([K.sent(),this.scale,this.view,n]))];case 4:return m=(q.infos=K.sent(),q),this._hasSizeRamp||(this._hasSizeRamp=!(null==m.infos||!m.infos.length)),[3,7];case 5:return"opacity"!==b.type?[3,7]:[4,G.getRampStops(b,d,n)];case 6:F=K.sent(),m={type:"opacity-ramp",title:c,infos:F,preview:u.renderColorRampPreviewHTML(F.map(function(a){return a.color}))},this._hasOpacityRamp||(this._hasOpacityRamp=!(null==m.infos||!m.infos.length)),K.label=7;case 7:return[2,m.infos&&
m];case 8:return[2,void 0]}})})}))];case 1:return[2,x.sent().filter(function(a){return!!a})]}})})};c.prototype._getDomainName=function(a,b){if(a&&"function"!==typeof a){var c=this.layer;return(c=(a=c.getField&&c.getField(a))&&c.getFieldDomain?c.getFieldDomain(a.name):null)&&c.codedValues?c.getName(b):null}return null};c.prototype._getRampTitle=function(a,b){var c=a.field,m=a.normalizationField,e=!1,n=!1,F=!1,k=null,c="function"===typeof c?null:c,m="function"===typeof m?null:m;if(null!=(a.legendOptions&&
a.legendOptions.title))k=a.legendOptions.title;else if(a.valueExpressionTitle)k=a.valueExpressionTitle;else{if("renderer"in b&&b.renderer&&"authoringInfo"in b.renderer&&b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables)for(a=b.renderer.authoringInfo.visualVariables,k=0;k<a.length;k++){var q=a[k];if("color"===q.type){if("ratio"===q.style){e=!0;break}if("percent"===q.style){n=!0;break}if("percent-of-total"===q.style){F=!0;break}}}k={field:c&&this._getFieldAlias(c,b),normField:m&&this._getFieldAlias(m,
b),ratio:e,ratioPercent:n,ratioPercentTotal:F}}return k};c.prototype._getRendererTitle=function(a,b){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var c=this.layer,m=a.field,e=null,n=null;K(a)&&(e=a.normalizationField,n="percent-of-total"===a.normalizationType);m="function"===typeof m?null:m;e="function"===typeof e?null:e;a=null;if(m||e)a={field:b?m:m&&this._getFieldAlias(m,c),normField:b?e:e&&this._getFieldAlias(e,c),
normByPct:n};return a};c.prototype._getFieldAlias=function(a,b){var c="popupTemplate"in b&&b.popupTemplate,c=c&&c.fieldInfos;b="function"===typeof a?null:"getField"in b&&b.getField&&b.getField(a);var m=null;c&&c.some(function(b){return a===b.fieldName?(m=b,!0):!1});var c=m||b,e=null;c&&(e=m&&m.label||b&&b.alias||"name"in c&&c.name||"fieldName"in c&&c.fieldName);return e};c.prototype._isUnclassedRenderer=function(a){var b=a.visualVariables,c=!1;K(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&
b&&(c=a.field?b.some(function(b){return!(!b||a.field!==b.field||(a.normalizationField||b.normalizationField)&&a.normalizationField!==b.normalizationField)}):!!b.length);return c};f([B.property()],c.prototype,"children",void 0);f([B.property()],c.prototype,"layer",void 0);f([B.property()],c.prototype,"legendElements",void 0);f([B.property()],c.prototype,"parent",void 0);f([B.property({readOnly:!0})],c.prototype,"ready",null);f([B.property()],c.prototype,"scale",void 0);f([B.property({dependsOn:["layer.renderer?.valueExpression?",
"layer.renderer?.visualVariables?"],readOnly:!0})],c.prototype,"isScaleDriven",null);f([B.property()],c.prototype,"title",void 0);f([B.property({dependsOn:["ready"],readOnly:!0,value:0})],c.prototype,"version",null);f([B.property()],c.prototype,"view",void 0);return c=f([B.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],c)}(B.declared(c))})},"esri/layers/support/ExportImageParameters":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./sublayerUtils ./timeUtils ../../views/View".split(" "),
function(D,l,h,d,f,t,p,w,z,A){Object.defineProperty(l,"__esModule",{value:!0});var c={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};D=function(t){function g(){var b=null!==t&&t.apply(this,arguments)||this;b._scale=null;b.view=null;return b}d(g,t);Object.defineProperty(g.prototype,"dynamicLayers",
{get:function(){if(!this.hasDynamicLayers)return null;var b=this.visibleSublayers.map(function(a){return a.toExportImageJSON()});return b.length?JSON.stringify(b):null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"hasDynamicLayers",{get:function(){return this.layer&&w.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"layer",{set:function(b){var a=this;this._get("layer")!==b&&(this._set("layer",
b),this._layerHandles&&(this._layerHandles.forEach(function(a){return a.remove()}),this._layerHandles.length=0),b&&(this._layerHandles=[b.allSublayers.on("change",function(){return a.notifyChange("visibleSublayers")}),b.on("sublayer-update",function(b){return a.notifyChange(c[b.propertyName])})]))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"layers",{get:function(){var b=this.visibleSublayers;return b?b.length?"show:"+b.map(function(a){return a.id}).join(","):"show:-1":null},
enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"layerDefs",{get:function(){var b=this.visibleSublayers.filter(function(a){return null!=a.definitionExpression});return b.length?JSON.stringify(b.reduce(function(a,b){a[b.id]=b.definitionExpression;return a},{})):null},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(b){this.view||(this._scale=b,this.notifyChange("scale"))},
enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"version",{get:function(){this.layers;this.layerDefs;this.dynamicLayers;this.timeExtent;var b=this.layer;b&&(b.dpi,b.imageFormat,b.imageTransparency,b.gdbVersion);return(this._get("version")||0)+1},set:function(b){this._set("version",b)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"visibleSublayers",{get:function(){var b=this,a=[];if(!this.layer)return a;var c=this.layer.sublayers,e=function(c){var d=b.scale,r=
0===c.minScale||d<=c.minScale,k=0===c.maxScale||d>=c.maxScale;c.visible&&(0===d||r&&k)&&(c.sublayers?c.sublayers.forEach(e):a.unshift(c))};c&&c.forEach(e);c=this._get("visibleSublayers");return!c||c.length!==a.length||c.some(function(b,c){return a[c]!==b})?a:c},enumerable:!0,configurable:!0});g.prototype.toJSON=function(){var b=this.layer,b={dpi:b.dpi,format:b.imageFormat,transparent:b.imageTransparency,gdbVersion:b.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?b.dynamicLayers=this.dynamicLayers:
b=h({},b,{layers:this.layers,layerDefs:this.layerDefs});return b};f([p.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],g.prototype,"dynamicLayers",null);f([p.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],g.prototype,"hasDynamicLayers",null);f([p.property()],g.prototype,"layer",null);f([p.property({readOnly:!0,dependsOn:["visibleSublayers"]})],g.prototype,"layers",null);f([p.property({readOnly:!0,dependsOn:["visibleSublayers"]})],
g.prototype,"layerDefs",null);f([p.property({type:Number,dependsOn:["view.scale"]})],g.prototype,"scale",null);f([p.property(z.combinedViewLayerTimeExtentProperty)],g.prototype,"timeExtent",void 0);f([p.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion timeExtent".split(" ")})],g.prototype,"version",null);f([p.property({type:A})],g.prototype,"view",void 0);f([p.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],g.prototype,
"visibleSublayers",null);return g=f([p.subclass("esri.layers.mixins.ExportImageParameters")],g)}(p.declared(t));l.ExportImageParameters=D})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/compilerUtils ../../core/maybe ../../core/promiseUtils ./previewSymbol2D ./previewSymbol3D ./previewWebStyleSymbol ./utils".split(" "),function(D,l,h,d,f,t,p,w,z,A,c){function C(a,b){switch(a.type){case "web-style":return A.previewWebStyleSymbol(a,
C,b);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return z.previewSymbol3D(a,b);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":case "cim":return w.previewSymbol2D(a,b);default:f.neverReached(a)}}function g(a){return a&&"opacity"in a?a.opacity*g(a.parent):1}Object.defineProperty(l,"__esModule",{value:!0});var b=null;l.renderDotDensityPreviewHTML=function(a,c,e){var d=a.backgroundColor,r=a.outline;a=
a.dotSize;var f=e&&e.swatchSize||22,k=Math.round(f*f/Math.pow(a,2)*.8),v=window.devicePixelRatio;e=document.createElement("canvas");var n=f*v;e.width=n;e.height=n;e.style.width=e.width/v+"px";e.style.height=e.height/v+"px";var u=e.getContext("2d");d&&(u.fillStyle=d.toCss(!0),u.fillRect(0,0,n,n),u.fill());u.fillStyle=c.toCss(!0);if(b&&b.length/2===k)for(c=0;c<2*k;c+=2){var d=b[c],g=b[c+1];u.fillRect(d,g,a*v,a*v);u.fill()}else for(b=[],c=0;c<2*k;c+=2)d=Math.floor(Math.random()*(n-0+1)+0),g=Math.floor(Math.random()*
(n-0+1)+0),b.push(d,g),u.fillRect(d,g,a*v,a*v),u.fill();r&&(r.color&&(u.strokeStyle=r.color.toCss(!0)),u.lineWidth=r.width,u.strokeRect(0,0,n,n));r=new Image(f,f);r.src=e.toDataURL();return r};l.renderColorRampPreviewHTML=function(a,b){var c=b&&"horizontal"===b.align,d=b&&b.width||(c?75:24);b=b&&b.height||(c?24:75);var f=window.devicePixelRatio,g=d*f,k=b*f,f=document.createElement("canvas");f.width=g;f.height=k;f.style.width=d+"px";f.style.height=b+"px";var v=f.getContext("2d"),n=v.createLinearGradient(0,
0,c?g:0,c?0:k),r=1/(a.length-1);a.forEach(function(a,b){return n.addColorStop(b*r,a.toString())});v.fillStyle=n;v.fillRect(0,0,g,k);a=document.createElement("div");a.style.width=d+"px";a.style.height=b+"px";a.appendChild(f);return a};l.renderPreviewHTML=C;l.getDisplayedSymbol=function(a,b){return d(this,void 0,void 0,function(){var e,d,f,r,k,v,n,u,x,G,l,E,y,A,m,K;return h(this,function(Q){switch(Q.label){case 0:if(!a)return[2,void 0];e=g(a.layer||a.sourceLayer);if(t.isSome(a.symbol))return d=a.symbol.clone(),
c.applyColorToSymbol(d,null,e),[2,d];f=a.get("layer.renderer")||a.get("sourceLayer.renderer");return[4,f.getSymbolAsync(a)];case 1:r=Q.sent();if(!r)return[2,void 0];r=r.clone();return!("visualVariables"in f)||"visualVariables"in f&&!f.visualVariables||"visualVariables"in f&&f.visualVariables&&!f.visualVariables.length?[2,r]:[4,p.create(function(a){return D(["../../renderers/visualVariables/support/visualVariableUtils"],a)})];case 2:k=Q.sent();v=[];n=[];u=[];x=[];G=0;for(l=f.visualVariables;G<l.length;G++)switch(E=
l[G],E.type){case "color":v.push(E);break;case "opacity":n.push(E);break;case "rotation":x.push(E);break;case "size":u.push(E)}A=(y=!!v.length&&v[v.length-1])?k.getColor(y,a,b):null;K=(m=!!n.length&&n[n.length-1])?k.getOpacity(m,a,b):null;null!=e&&(K=null!=K?K*e:e);c.applyColorToSymbol(r,A,K);u.forEach(function(m){return c.applySizeToSymbol(r,k.getSize(m,a,b),m.axis)});x.forEach(function(m){return c.applyRotationToSymbol(r,k.getRotationAngle(m,a,b),m.axis)});return[2,r]}})})}})},"esri/symbols/support/previewSymbol2D":function(){define("require exports ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils".split(" "),
function(D,l,h,d,f,t,p,w){function z(b,a){var d=c.getContext("2d"),e=[];a&&(a.weight&&e.push(a.weight),a.size&&e.push(a.size+"px"),a.family&&e.push(a.family));d.font=e.join(" ");return d.measureText(b).width}function A(b){if(0===b.length)return 0;if(2<b.length){var a=f.px2pt(1),c=parseFloat(b);switch(b.slice(-2)){case "px":return c;case "pt":return c*a;case "in":return 72*c*a;case "pc":return 12*c*a;case "mm":return c*C*a;case "cm":return c*g*a}}return parseFloat(b)}Object.defineProperty(l,"__esModule",
{value:!0});var c=document.createElement("canvas"),C=7.2/2.54,g=72/2.54;l.previewSymbol2D=function(b,a){var c=a&&a.size?f.pt2px(a.size):null,e=a&&a.maxSize?f.pt2px(a.maxSize):null,g=a&&null!=a.opacity?a.opacity:null,l=a&&null!=a.rotation?a.rotation:null,B=t.getStroke(b),k={shape:null,fill:null,stroke:B};B&&B.width&&(B.width=Math.min(B.width,80));var v=0,n=0;switch(b.type){case "simple-marker":var B=b.style,u=f.pt2px(b.size),v=Math.min(c||u||22,e||120),n=Math.min(c||u||22,e||120);switch(B){case "circle":k.shape=
{type:"circle",cx:.5*u,cy:.5*u,r:.5*u};break;case "cross":k.shape={type:"path",path:[{command:"M",values:[0,.5*n]},{command:"L",values:[v,.5*n]},{command:"M",values:[.5*v,0]},{command:"L",values:[.5*v,n]}]};break;case "diamond":k.shape={type:"path",path:[{command:"M",values:[0,.5*n]},{command:"L",values:[.5*v,0]},{command:"L",values:[v,.5*n]},{command:"L",values:[.5*v,n]},{command:"Z",values:[]}]};break;case "square":k.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[v,0]},
{command:"L",values:[v,n]},{command:"L",values:[0,n]},{command:"Z",values:[]}]};break;case "triangle":k.shape={type:"path",path:[{command:"M",values:[.5*v,0]},{command:"L",values:[v,n]},{command:"L",values:[0,n]},{command:"Z",values:[]}]};break;case "x":k.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[v,n]},{command:"M",values:[v,0]},{command:"L",values:[0,n]}]};break;case "path":k.shape={type:"path",path:b.path||""}}break;case "simple-line":c=Math.min(c||B&&B.width||22,
e||80);B.width=c;v=22<c?2*c:40;n=c;k.shape={type:"path",path:[{command:"M",values:[0,n]},{command:"L",values:[v,n]}]};break;case "picture-fill":case "simple-fill":v=Math.min(c||22,e||120);n=Math.min(c||22,e||120);k.shape=p.shapes.fill[0];break;case "picture-marker":var B=f.pt2px(b.width),x=f.pt2px(b.height),u=Math.max(B,x),x=B/x,B=1>=x?Math.ceil(u*x):u,x=1>=x?u:Math.ceil(u/x),v=Math.min(c||B||22,e||120),n=Math.min(c||x||22,e||120);k.shape={type:"image",x:-Math.round(v/2),y:-Math.round(n/2),width:v,
height:n,src:b.url||""};break;case "text":B=b.text||"Aa",u=b.font,c=Math.min(c||f.pt2px(u.size),e||120),x=z(B,{weight:u.weight,size:c,family:u.family}),v=(e=/[\uE600-\uE6FF]/.test(B))?c:x,n=c,x=.25*A((u?c:0).toString()),e&&(x+=5),k.shape={type:"text",text:B,x:0,y:x,align:"middle",decoration:u&&u.decoration,rotated:b.rotated,kerning:b.kerning},k.font=u&&{size:c,style:u.style,decoration:u.decoration,weight:u.weight,family:u.family}}if(!k.shape)return d.reject(new h("symbolPreview: renderPreviewHTML2D",
"symbol not supported."));var G=t.getFill(b),c=b.color,e=null;G&&"pattern"===G.type&&c&&"picture-fill"!==b.type?e=t.getPatternUrlWithColor(G.src,c.toCss(!0)).then(function(a){G.src=a;k.fill=G;return k}):(k.fill=G,e=d.resolve(k));return e.then(function(b){return w.renderSymbol([[b]],[v,n],{node:a&&a.node,scale:!0,opacity:g,rotation:l})})}})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(D,l){Object.defineProperty(l,"__esModule",{value:!0});l.shapes={fill:[{type:"path",
path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],
invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",
path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],
tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};l.getPathSymbolShapes=function(h){var d=22,f=22;1>h?d*=.75:1<h&&(f*=1.25);return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,f-11]},{command:"L",values:[d-11,f-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",
values:[d-11,22]},{command:"L",values:[d-11,f-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[d-11,f-11]},{command:"L",values:[0,f-11]},{command:"L",values:[0,22]},{command:"L",values:[d-11,22]},{command:"Z",values:[]}]}]};l.getExtrudeSymbolShapes=function(h){h*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+h]},{command:"L",values:[0,22*.7+h-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+h]},{command:"L",values:[22,h]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};l.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
l.getCubeShapes=function(h,d){var f=d?20:h,t=d?4:6,t=f=22>=f?f-.5*t:f-t;d=d?.35*f:.5*f;return[{type:"path",path:[{command:"M",values:[.5*t,0]},{command:"L",values:[t,.5*d]},{command:"L",values:[.5*t,d]},{command:"L",values:[0,.5*d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[.5*t,d]},{command:"L",values:[.5*t,h]},{command:"L",values:[0,h-.5*d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*t,d]},{command:"L",values:[.5*t,
h]},{command:"L",values:[t,h-.5*d]},{command:"L",values:[t,.5*d]},{command:"Z",values:[]}]}]};l.getCylinderShapes=function(h,d){var f=d?20:h;d=d?4:6;f=22>=f?f-.5*d:f-d;d=.5*f;var t=.15*f;h-=t;return[{type:"ellipse",cx:.5*f,cy:h,rx:d,ry:t},{type:"path",path:[{command:"M",values:[0,t]},{command:"L",values:[0,h]},{command:"L",values:[f,h]},{command:"L",values:[f,t]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*f,cy:t,rx:d,ry:t}]};l.getConeShapes=function(h,d){var f=d?20:h;d=d?4:6;f=22>=f?f-.5*d:f-
d;d=.15*f;var t=f;h-=d;return[{type:"ellipse",cx:.5*f,cy:h,rx:.5*f,ry:d},{type:"path",path:[{command:"M",values:[.5*t,0]},{command:"L",values:[t,h]},{command:"L",values:[0,h]},{command:"Z",values:[]}]}]};l.getInvertedConeShapes=function(h){var d=h,d=22>d?d-3:d-6,f=.15*d,t=d;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[t,0]},{command:"L",values:[.5*t,h-f]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*d,cy:0,rx:.5*d,ry:f}]};l.getDiamondShapes=function(h){var d=h,d=22>
d?d-2:d-4,f=Math.floor(h/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*d,0]},{command:"L",values:[d,.5*h-f]},{command:"L",values:[.45*d-f,.5*h+f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*d,0]},{command:"L",values:[.45*d-f,.5*h+f]},{command:"L",values:[0,.5*h-f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*h-f]},{command:"L",values:[.45*d-f,.5*h+f]},{command:"L",values:[.45*d,h]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*d,h]},{command:"L",values:[d,.5*h-f]},{command:"L",values:[.45*d-f,.5*h+f]},{command:"Z",values:[]}]}]};l.getTetrahedronShapes=function(h){var d=h,d=22>d?d-1:d-2;return[{type:"path",path:[{command:"M",values:[.45*h,0]},{command:"L",values:[h,d]},{command:"L",values:[.45*h,.6*d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*h,0]},{command:"L",values:[.45*h,.6*d]},{command:"L",values:[0,d]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,d]},
{command:"L",values:[.45*h,.6*d]},{command:"L",values:[h,d]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils ./svgUtils maquette".split(" "),function(D,l,h,d,f,t,p,w,z,A){function c(c,b,a){return c?d(c,{responseType:"image"}).then(function(c){c=c.data;var e=c.width,d=c.height,f=e/d,g=b;a&&(g=Math.min(g,Math.max(e,d)));return{image:c,width:1>=
f?Math.ceil(g*f):g,height:1>=f?g:Math.ceil(g/f)}}):w.reject(new t("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(l,"__esModule",{value:!0});var C=A.createProjector();l.renderSymbol=function(c,b,a){var d=Math.ceil(b[0]);b=Math.ceil(b[1]);if(!c.some(function(a){return!!a.length}))return null;var e=a&&a.node||document.createElement("div");null!=a.opacity&&(e.style.opacity=a.opacity.toString());C.append(e,z.renderSVG.bind(null,c,d,b,a));return e};l.tintImageWithColor=function(d,
b,a,r,e){return c(d,b,e).then(function(c){var e=c.width?c.width:b,g=c.height?c.height:b,k;if(k=c.image)k=a&&"ignore"!==r?"multiply"===r&&255===a.r&&255===a.g&&255===a.b&&1===a.a?!1:!0:!1;if(k){var v=c.image.width,n=c.image.height;/\.svg$/i.test(d)&&(--v,--n);var u,x;u=Math.ceil(e);x=Math.ceil(g);k=document.createElement("canvas");k.width=u;k.height=x;k.style.width=u+"px";k.style.height=x+"px";k=k.getContext("2d");k.clearRect(0,0,u,x);k.drawImage(c.image,0,0,v,n,0,0,e,g);c=k.getImageData(0,0,e,g);
v=[a.r/255,a.g/255,a.b/255,a.a];n=f.toHSV(a);for(u=0;u<c.data.length;u+=4){x=c.data;var p=u,t=v,l=n;switch(r){case "multiply":x[p+0]*=t[0];x[p+1]*=t[1];x[p+2]*=t[2];x[p+3]*=t[3];break;default:var y=f.toHSV({r:x[p+0],g:x[p+1],b:x[p+2]});y.h=l.h;y.s=l.s;y.v=y.v/100*l.v;l=f.toRGB(y);x[p+0]=l.r;x[p+1]=l.g;x[p+2]=l.b;x[p+3]*=t[3]}}k.putImageData(c,0,0);d=k.canvas.toDataURL("image/png")}else(k=h.id&&h.id.findCredential(d))&&k.token&&(c=-1===d.indexOf("?")?"?":"\x26",d=""+d+c+"token\x3d"+k.token);return{url:d,
width:e,height:g}}).catch(function(){return{url:d,width:b,height:b}})}})},"esri/core/colorUtils":function(){define(["require","exports"],function(D,l){function h(c,d){var f=[],b,a;if(c[0].length!==d.length)throw"dimensions do not match";var r=c.length,e=c[0].length,h=0;for(b=0;b<r;b++){for(a=h=0;a<e;a++)h+=c[b][a]*d[a];f.push(h)}return f}function d(c){c=[c.r/255,c.g/255,c.b/255].map(function(c){return.04045>=c?c/12.92:Math.pow((c+.055)/1.055,2.4)});c=h(z,c);return{x:100*c[0],y:100*c[1],z:100*c[2]}}
function f(c){c=h(A,[c.x/100,c.y/100,c.z/100]).map(function(c){return Math.min(1,Math.max(.0031308>=c?12.92*c:1.055*Math.pow(c,1/2.4)-.055,0))});return{r:Math.round(255*c[0]),g:Math.round(255*c[1]),b:Math.round(255*c[2])}}function t(c){c=[c.x/95.047,c.y/100,c.z/108.883].map(function(c){return c>Math.pow(6/29,3)?Math.pow(c,1/3):1/3*Math.pow(29/6,2)*c+4/29});return{l:116*c[1]-16,a:500*(c[0]-c[1]),b:200*(c[1]-c[2])}}function p(c){var d=c.l;c=[(d+16)/116+c.a/500,(d+16)/116,(d+16)/116-c.b/200].map(function(c){return c>
6/29?Math.pow(c,3):3*Math.pow(6/29,2)*(c-4/29)});return{x:95.047*c[0],y:100*c[1],z:108.883*c[2]}}function w(c){if("r"in c&&"g"in c&&"b"in c)return c;if("l"in c&&"c"in c&&"h"in c){var d=c.c,g=c.h;return f(p({l:c.l,a:d*Math.cos(g),b:d*Math.sin(g)}))}if("l"in c&&"a"in c&&"b"in c)return f(p(c));if("x"in c&&"y"in c&&"z"in c)return f(c);if("h"in c&&"s"in c&&"v"in c){g=(c.h+360)%360/60;d=c.v/100*255;c=c.s/100*d;var b=c*(1-Math.abs(g%2-1));switch(Math.floor(g)){case 0:g={r:c,g:b,b:0};break;case 1:g={r:b,
g:c,b:0};break;case 2:g={r:0,g:c,b:b};break;case 3:g={r:0,g:b,b:c};break;case 4:g={r:b,g:0,b:c};break;case 5:case 6:g={r:c,g:0,b:b};break;default:g={r:0,g:0,b:0}}g.r=Math.round(g.r+d-c);g.g=Math.round(g.g+d-c);g.b=Math.round(g.b+d-c);return g}}Object.defineProperty(l,"__esModule",{value:!0});var z=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],A=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];l.toRGB=w;l.toHSV=function(c){if("h"in c&&"s"in c&&"v"in c)return c;var d=
w(c);c=d.r;var f=d.g,d=d.b,b=Math.max(c,f,d),a=b-Math.min(c,f,d),r;0===a?r=0:b===c?r=(f-d)/a%6:b===f?r=(d-c)/a+2:b===d&&(r=(c-f)/a+4);0>r&&(r+=6);return{h:60*r,s:100*(0===a?0:a/b),v:100/255*b}};l.toLAB=function(c){return"l"in c&&"a"in c&&"b"in c?c:t(d(w(c)))};l.toLCH=function(c){if(!("l"in c&&"c"in c&&"h"in c)){var f=t(d(w(c)));c=f.l;var g=f.a,b=f.b,f=Math.sqrt(g*g+b*b),g=Math.atan2(b,g),g=0<g?g:g+2*Math.PI;c={l:c,c:f,h:g}}return c};l.toXYZ=function(c){return"x"in c&&"y"in c&&"z"in c?c:d(w(c))}})},
"esri/symbols/support/svgUtils":function(){define("require exports ../../Color ../../core/has ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ../../widgets/support/widget".split(" "),function(D,l,h,d,f,t,p){function w(a){return a.map(function(a){return a.command+" "+a.values.join(" ")}).join(" ").trim()}function z(a,b,c,e){if(a){if("circle"===a.type)return p.tsx("circle",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,
"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,r:a.r});if("ellipse"===a.type)return p.tsx("ellipse",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry});if("rect"===a.type)return p.tsx("rect",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,
"stroke-miterlimit":"4",x:a.x,y:a.y,width:a.width,height:a.height});if("image"===a.type)return p.tsx("image",{href:a.src,x:a.x,y:a.y,width:a.width,height:a.height,preserveAspectRatio:"none"});if("path"===a.type)return a="string"!==typeof a.path?w(a.path):a.path,p.tsx("path",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",d:a});if("text"===a.type)return p.tsx("text",{fill:b,"fill-rule":"evenodd",
stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4","text-anchor":e.align,"text-decoration":e.decoration,kerning:e.kerning,rotate:e.rotate,"text-rendering":x,"font-style":e.font.style,"font-variant":e.font.variant,"font-weight":e.font.weight,"font-size":e.font.size,"font-family":e.font.family,x:a.x,y:a.y},a.text)}return null}function A(a){var b={fill:"none",pattern:null,linearGradient:null};if(a)if("type"in a&&
"pattern"===a.type){var c="patternId-"+ ++n;b.fill="url(#"+c+")";b.pattern={id:c,x:a.x,y:a.y,width:a.width,height:a.height,image:{x:0,y:0,width:a.width,height:a.height,href:a.src}}}else"type"in a&&"linear"===a.type?(c="linearGradientId-"+ ++u,b.fill="url(#"+c+")",b.linearGradient={id:c,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stops:a.colors.map(function(a){return{offset:a.offset,color:a.color&&(new h(a.color)).toString()}})}):a&&(a=new h(a),b.fill=a.toString());return b}function c(a){var b={color:"none",width:1,
cap:"butt",join:"4",dashArray:"none"};if(a&&(null!=a.width&&(b.width=a.width),a.cap&&(b.cap=a.cap),a.join&&(b.join=a.join.toString()),a.color&&(b.color=(new h(a.color)).toString()),a.style)){var c=null;a.style in O&&(c=O[a.style]);if(Array.isArray(c)){for(var c=c.slice(0),m=0;m<c.length;++m)c[m]*=a.width;if("butt"!==a.cap){for(m=0;m<c.length;m+=2)c[m]-=a.width,1>c[m]&&(c[m]=1);for(m=1;m<c.length;m+=2)c[m]+=a.width}c=c.join(",")}b.dashArray=c}return b}function C(a,b){var c={align:null,decoration:null,
kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};a&&(c.align=a.align,c.decoration=a.decoration,c.kerning=a.kerning?"auto":"0",c.rotate=a.rotated?"90":"0",c.font.style=b.style||"normal",c.font.variant=b.variant||"normal",c.font.weight=b.weight||"normal",c.font.size=b.size&&b.size.toString()||"10pt",c.font.family=b.family||"serif");return c}function g(a){var b=a.pattern;a=a.linearGradient;return b?p.tsx("pattern",{id:b.id,patternUnits:"userSpaceOnUse",x:b.x,
y:b.y,width:b.width,height:b.height},p.tsx("image",{x:b.image.x,y:b.image.y,width:b.image.width,height:b.image.height,href:b.image.href})):a?(b=a.stops.map(function(a,b){return p.tsx("stop",{key:b+"-stop",offset:a.offset,"stop-color":a.color})}),p.tsx("linearGradient",{id:a.id,gradientUnits:"userSpaceOnUse",x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},b)):null}function b(a,b,c){return t.translate(a,t.identity(a),[b,c])}function a(a,b,c,e,n){t.scale(a,t.identity(a),[b,c]);a[4]=a[4]*b-e*b+e;a[5]=a[5]*c-n*c+n;return a}
function r(a,b,c,e){var m=b%360*Math.PI/180;t.rotate(a,t.identity(a),m);b=Math.cos(m);var m=Math.sin(m),n=a[4],d=a[5];a[4]=n*b-d*m+e*m-c*b+c;a[5]=d*b+n*m-c*m-e*b+e;return a}function e(a,b){E&&"left"in E?(E.left>a&&(E.left=a),E.right<a&&(E.right=a),E.top>b&&(E.top=b),E.bottom<b&&(E.bottom=b)):E={left:a,bottom:b,right:a,top:b}}function I(a){var b=a.args,c=b.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=0;a<c;a+=2)e(b[a],b[a+1]);y.x=b[c-2];y.y=b[c-1];break;case "H":for(a=
0;a<c;++a)e(b[a],y.y);y.x=b[c-1];break;case "V":for(a=0;a<c;++a)e(y.x,b[a]);y.y=b[c-1];break;case "m":a=0;"x"in y||(e(y.x=b[0],y.y=b[1]),a=2);for(;a<c;a+=2)e(y.x+=b[a],y.y+=b[a+1]);break;case "l":case "t":for(a=0;a<c;a+=2)e(y.x+=b[a],y.y+=b[a+1]);break;case "h":for(a=0;a<c;++a)e(y.x+=b[a],y.y);break;case "v":for(a=0;a<c;++a)e(y.x,y.y+=b[a]);break;case "c":for(a=0;a<c;a+=6)e(y.x+b[a],y.y+b[a+1]),e(y.x+b[a+2],y.y+b[a+3]),e(y.x+=b[a+4],y.y+=b[a+5]);break;case "s":case "q":for(a=0;a<c;a+=4)e(y.x+b[a],
y.y+b[a+1]),e(y.x+=b[a+2],y.y+=b[a+3]);break;case "A":for(a=0;a<c;a+=7)e(b[a+5],b[a+6]);y.x=b[c-2];y.y=b[c-1];break;case "a":for(a=0;a<c;a+=7)e(y.x+=b[a+5],y.y+=b[a+6])}}function H(a,b,c){var e=G[a.toLowerCase()];"number"===typeof e&&(e?b.length>=e&&(a={action:a,args:b.slice(0,b.length-b.length%e)},c.push(a),I(a)):(a={action:a,args:[]},c.push(a),I(a)))}function B(a){var b={x:0,y:0,width:0,height:0};if("circle"===a.type)b.x=a.cx-a.r,b.y=a.cy-a.r,b.width=2*a.r,b.height=2*a.r;else if("ellipse"===a.type)b.x=
a.cx-a.rx,b.y=a.cy-a.ry,b.width=2*a.rx,b.height=2*a.ry;else if("image"===a.type||"rect"===a.type)b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height;else if("path"===a.type){a=("string"!==typeof a.path?w(a.path):a.path).match(M);var c=[];E={};y={};if(a){for(var e="",n=[],d=a.length,k=0;k<d;++k){var f=a[k],m=parseFloat(f);isNaN(m)?(e&&H(e,n,c),n=[],e=f):n.push(m)}H(e,n,c);a={x:0,y:0,width:0,height:0};E&&"left"in E&&(a.x=E.left,a.y=E.top,a.width=E.right-E.left,a.height=E.bottom-E.top)}else a=null;b.x=
a.x;b.y=a.y;b.width=a.width;b.height=a.height}return b}function k(a){for(var b={x:0,y:0,width:0,height:0},c=null,e=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY,d=0;d<a.length;d++){var k=a[d];c?(c.x=Math.min(c.x,k.x),c.y=Math.min(c.y,k.y),e=Math.max(e,k.x+k.width),n=Math.max(n,k.y+k.height)):(c=b,c.x=k.x,c.y=k.y,e=k.x+k.width,n=k.y+k.height)}c&&(c.width=e-c.x,c.height=n-c.y);return c}function v(c,e,n,d,k,v){var m=e/2,F=n/2,u=c.width+d,J=c.height+d,g=f.mat2df32.create(),h=f.mat2df32.create(),
x=!1;if(k&&0!==u&&0!==J){k=u/J;var x=e>n?e:n,p=1,q=1;isNaN(x)||(1<k?(p=x/u,q=x/k/J):(q=x/J,p=x*k/u));t.multiply(h,h,a(g,p,q,m,F));x=!0}k=c.x+(u-d)/2;c=c.y+(J-d)/2;t.multiply(h,h,b(g,m-k,F-c));!x&&(u>e||J>n)&&(m=u/e>J/n,e=(m?e:n)/(m?u:J),t.multiply(h,h,a(g,e,e,k,c)));v&&t.multiply(h,h,r(g,v,k,c));return"matrix("+h[0]+","+h[1]+","+h[2]+","+h[3]+","+h[4]+","+h[5]+")"}Object.defineProperty(l,"__esModule",{value:!0});var n=0,u=0,x=d("chrome")?"auto":"optimizeLegibility",G={m:2,l:2,h:1,v:1,c:6,s:4,q:4,
t:2,a:7,z:0},M=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,E={},y={},O={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};l.renderShape=z;l.generateFillAttributes=A;l.generateStrokeAttributes=c;l.generateTextAttributes=C;l.renderDef=g;l.getBoundingBox=B;l.computeBBox=k;l.getTransformMatrix=v;l.renderSVG=function(a,b,e,n){for(var d=[],f=
[],m=0;m<a.length;m++){for(var F=[],u=[],h=0,x=0,r=a[m];x<r.length;x++){var t=r[x],l=t.shape,q=t.fill,y=t.stroke,t=t.font,h=h+(y&&y.width||0),q=A(q),y=c(y),t="text"===l.type?C(l,t):null;d.push(g(q));F.push(z(l,q.fill,y,t));u.push(B(l))}u=v(k(u),b,e,h,n&&n.scale,n&&n.rotation);f.push(p.tsx("g",{transform:u},F))}return p.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:b,height:e},p.tsx("defs",null,d),f)}})},"esri/symbols/support/previewSymbol3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/colorUtils ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),
function(D,l,h,d,f,t,p,w,z,A,c,C,g,b,a,r,e){function I(a){var b=a.outline,c=w.isSome(a.material)?a.material.color:null,c=w.isSome(c)?c.toRgba().toString():null;if(w.isNone(b))return"fill"===a.type&&"255,255,255,1"===c?{color:"#bdc3c7",width:.75}:null;a=A.pt2px(b.size)||0;return{color:"rgba("+(w.isSome(b.color)?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function H(a,b){var c=b&&b.resource,c=c&&c.href;return a.thumbnail&&a.thumbnail.url?z.resolve(a.thumbnail.url):c&&"object"!==b.type?
z.resolve(e.getIconHref(a,b)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?r.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(function(a){return a}).then(function(a){return a&&a.thumbnail&&a.thumbnail.url||K}):z.resolve(K)}function B(a,b){void 0===b&&(b=1);var c=a.a;a=d.toHSV(a);b=d.toRGB({h:a.h,s:a.s/b,v:100-(100-a.v)/b});return[b.r,b.g,b.b,c]}function k(a,b){return Math.round(Math.min(Math.max(a+191.25*b,0),255))}function v(a){return"water"===
a.type?w.isNone(a.color)?null:a.color:w.isNone(a.material)||w.isNone(a.material.color)?null:a.material.color}function n(a,b){void 0===b&&(b=0);a=v(a);if(!a)return b=k(c.defaultThematicColor.r,b),[b,b,b,100];a=a.toRgba();for(var e=0;3>e;e++)a[e]=k(a[e],b);return a}function u(a){return a.outline?I(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function x(a,b){a=v(a);if(!a)return null;var c;c="rgba("+(k(a.r,b)+",");c+=k(a.g,b)+",";c+=k(a.b,b)+",";return c+a.a+");"}function G(a,b){b=x(a,b);if(!b)return{};a=
Math.min(a.size?A.pt2px(a.size):.75,80);return{color:b,width:a}}function M(a,b,c){c*=.75;return{type:"linear",x1:c?.25*c:0,y1:c?.5*c:0,x2:c||4,y2:c?.5*c:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}function E(a){var b=a.depth,c=a.height;return(a=a.width)&&b&&c&&a===b&&a<c}function y(a,c,e){var d=[];if(!a)return d;switch(a.type){case "icon":var k=a.resource&&a.resource.primitive||C.defaultPrimitive;switch(k){case "circle":d.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:n(a,0),stroke:I(a)});
break;case "square":d.push({shape:{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[0,0]},{command:"L",values:[c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:n(a,0),stroke:I(a)});break;case "triangle":d.push({shape:{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:n(a,0),stroke:I(a)});break;case "cross":d.push({shape:{type:"path",path:[{command:"M",values:[.5*c,0]},{command:"L",values:[.5*
c,c]},{command:"M",values:[0,.5*c]},{command:"L",values:[c,.5*c]}]},stroke:u(a)});break;case "x":d.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[c,c]},{command:"M",values:[c,0]},{command:"L",values:[0,c]}]},stroke:u(a)});break;case "kite":d.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,.5*c]},{command:"L",values:[.5*c,c]},{command:"Z",values:[]}]},fill:n(a,0),stroke:I(a)});break;default:f.neverReached(k)}break;
case "object":switch(k=a.resource&&a.resource.primitive||g.defaultPrimitive,k){case "cone":k=n(a,0);a=n(a,-.6);a=M(k,a,e?20:c);c=b.getConeShapes(c,e);d.push({shape:c[0],fill:a});d.push({shape:c[1],fill:a});break;case "inverted-cone":e=n(a,0);a=n(a,-.6);a=M(e,a,c);c=b.getInvertedConeShapes(c);d.push({shape:c[0],fill:a});d.push({shape:c[1],fill:e});break;case "cube":c=b.getCubeShapes(c,e);d.push({shape:c[0],fill:n(a,0)});d.push({shape:c[1],fill:n(a,-.3)});d.push({shape:c[2],fill:n(a,-.5)});break;case "cylinder":var k=
n(a,0),m=n(a,-.6),k=M(k,m,e?20:c);c=b.getCylinderShapes(c,e);d.push({shape:c[0],fill:k});d.push({shape:c[1],fill:k});d.push({shape:c[2],fill:n(a,0)});break;case "diamond":c=b.getDiamondShapes(c);d.push({shape:c[0],fill:n(a,-.3)});d.push({shape:c[1],fill:n(a,0)});d.push({shape:c[2],fill:n(a,-.3)});d.push({shape:c[3],fill:n(a,-.7)});break;case "sphere":e=n(a,0);a=n(a,-.6);a=M(e,a);a.x1=0;a.y1=0;a.x2=.25*c;a.y2=.25*c;d.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:a});break;case "tetrahedron":c=
b.getTetrahedronShapes(c);d.push({shape:c[0],fill:n(a,-.3)});d.push({shape:c[1],fill:n(a,0)});d.push({shape:c[2],fill:n(a,-.6)});break;default:f.neverReached(k)}}return d}function O(b,c){var e=c&&c.size?A.pt2px(c.size):null,d=c&&c.maxSize?A.pt2px(c.maxSize):null,n=c&&c.disableUpsampling,k=b.symbolLayers,f=[],m=0,v=0,u=k.getItemAt(k.length-1),g;u&&"icon"===u.type&&(g=u.size&&A.pt2px(u.size));k.forEach(function(k,u){if("icon"===k.type||"object"===k.type){var q="icon"===k.type?k.size&&A.pt2px(k.size):
0,h=e||q?Math.ceil(Math.min(e||q,d||120)):22;k&&k.resource&&k.resource.href?(u=H(b,k).then(function(b){var c=k.get("material.color"),e;e="icon"===k.type?"multiply":"tint";return a.tintImageWithColor(b,h,c,e,n)}).then(function(a){var b=a.width,c=a.height;m=Math.max(m,b);v=Math.max(v,c);return[{shape:{type:"image",x:0,y:0,width:b,height:c,src:a.url},fill:null,stroke:null}]}),f.unshift(u)):(u=h,"icon"===k.type&&g&&e&&(u=q/g*h),q=c&&"tall"===c.symbolConfig||("object"===k.type?E(k):!1),m=Math.max(m,q?
20:u),v=Math.max(v,u),f.unshift(z.resolve(y(k,u,q))))}});return z.eachAlways(f).then(function(b){var e=[];b.forEach(function(a){a.value?e.push(a.value):a.error&&Q.warn("error while building swatchInfo!",a.error)});return a.renderSymbol(e,[m,v],{node:c&&c.node,scale:!1,opacity:c&&c.opacity})})}function m(c,d){var k=c.symbolLayers,f=[];c=e.isVolumetricSymbol(c);var m=d&&d.size?A.pt2px(d.size):null,v=(d&&d.maxSize?A.pt2px(d.maxSize):null)||80,u=0,g=0,r;k.forEach(function(a,c){if(a&&("line"===a.type||
"path"===a.type)){var e=[];switch(a.type){case "line":var d=G(a,0),k=d&&d.width||0;0===c&&(r=k);var p=Math.min(m||k,v);c=0===c?p:m?k/r*p:p;g=Math.max(g,c);u=Math.max(u,20<c?2*c:40);d.width=c;e.push({shape:{type:"path",path:[{command:"M",values:[0,.5*g]},{command:"L",values:[u,.5*g]}]},stroke:d});break;case "path":c=Math.min(m||22,v);k=n(a,0);p=n(a,-.2);d=(d=x(a,-.4))?{color:d,width:1}:{};if("quad"===a.profile){var t=a.width||a.size;a=a.height||a.size;a=b.getPathSymbolShapes(t&&a?t/a:1);d=h({},d,{join:"bevel"});
e.push({shape:a[0],fill:p,stroke:d});e.push({shape:a[1],fill:p,stroke:d});e.push({shape:a[2],fill:k,stroke:d})}else e.push({shape:b.shapes.pathSymbol3DLayer[0],fill:p,stroke:d}),e.push({shape:b.shapes.pathSymbol3DLayer[1],fill:k,stroke:d});u=g=Math.max(g,c)}f.push(e)}});return z.resolve(a.renderSymbol(f,[u,g],{node:d&&d.node,scale:c,opacity:d&&d.opacity}))}Object.defineProperty(l,"__esModule",{value:!0});var K=D.toUrl("../../images/Legend/legend3dsymboldefault.png"),Q=p.getLogger("esri.symbols.support.previewSymbol3D");
l.getSymbolLayerFill=n;l.previewSymbol3D=function(c,e){if(0===c.symbolLayers.length)return z.reject(new t("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var d=null;switch(c.type){case "point-3d":d=O(c,e);break;case "line-3d":d=m(c,e);break;case "polygon-3d":case "mesh-3d":d="mesh-3d"===c.type;c=c.symbolLayers;for(var k=e&&e.size?A.pt2px(e.size):null,f=e&&e.maxSize?A.pt2px(e.maxSize):null,k=k||22,u=[],g=0,r=0,x=!1,p=0;p<c.length;p++){var l=c.getItemAt(p),q=[];if(!d||"fill"===
l.type){var y=b.shapes.fill[0];switch(l.type){case "fill":var E=I(l),w=Math.min(k,f||120),g=Math.max(g,w),r=Math.max(r,w),x=!0;q.push({shape:y,fill:n(l,0),stroke:E});break;case "line":y={stroke:G(l,0),shape:y};g=Math.max(g,22);r=Math.max(r,22);q.push(y);break;case "extrude":var E=h({join:"round"},G(l,-.4)),y=n(l,0),l=n(l,-.2),w=Math.min(k,f||120),M=b.getExtrudeSymbolShapes(w);E.width=1;q.push({shape:M[0],fill:l,stroke:E});q.push({shape:M[1],fill:l,stroke:E});q.push({shape:M[2],fill:y,stroke:E});y=
22*.7+.5*w;g=Math.max(g,22);r=Math.max(r,y);break;case "water":x=v(l),y=B(x),l=B(x,2),E=B(x,3),w=b.getWaterSymbolShapes(),x=!0,q.push({shape:w[0],fill:y}),q.push({shape:w[1],fill:l}),q.push({shape:w[2],fill:E}),w=Math.min(k,f||120),g=Math.max(g,w),r=Math.max(r,w)}u.push(q)}}d=z.resolve(a.renderSymbol(u,[g,r],{node:e&&e.node,scale:x,opacity:e&&e.opacity}))}return d?d:z.reject(new t("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require",
"exports","../../request","../../core/screenUtils"],function(D,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.previewWebStyleSymbol=function(f,l,p){var t=f.thumbnail&&f.thumbnail.url;return t?h(t,{responseType:"image"}).then(function(f){f=f.data;var h=!/\\.svg$/i.test(f.src)&&p&&p.disableUpsampling,c=Math.max(f.width,f.height),l=p&&null!=p.maxSize?d.pt2px(p.maxSize):120;h&&(l=Math.min(c,l));h=Math.min(l,p&&null!=p.size?d.pt2px(p.size):c);h!==c&&(c=0!==f.width&&0!==f.height?f.width/f.height:
1,1<=c?(f.width=h,f.height=h/c):(f.width=h*c,f.height=h));return p&&p.node?(p.node.appendChild(f),p.node):f}):f.fetchSymbol().then(function(d){return l(d,p)})}})},"esri/widgets/Legend/support/colorRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../core/promiseUtils ./utils @dojo/framework/shim/Promise".split(" "),function(D,l,h,d,f,t,p){function w(c,b){var a=[],d=c.length-1;5===c.length?a.push(0,2,4):
a.push(0,d);return c.map(function(c,f){return-1<a.indexOf(f)?p.createStopLabel(c,f,d,b):null})}function z(c,b,a){void 0===a&&(a=C);return h(this,void 0,void 0,function(){var g,e;return d(this,function(d){switch(d.label){case 0:return g=new f(a),[4,new Promise(function(a,b){D(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return e=d.sent().getOpacity(b,c),null!=e&&(g.a=e),[2,g]}})})}function A(d,b){d=c(d,b);var a=d.startIndex,g=d.endIndex;if(a===g)return b[a].color;
b=f.blendColors(b[a].color,b[g].color,d.weight);return new f(b)}function c(c,b){var a=0,d=b.length-1;b.some(function(b,f){if(c<b.value)return d=f,!0;a=f;return!1});return{startIndex:a,endIndex:d,weight:(c-b[a].value)/(b[d].value-b[a].value)}}Object.defineProperty(l,"__esModule",{value:!0});var C=new f([64,64,64]);l.getRampStops=function(c,b,a){return h(this,void 0,void 0,function(){var f,e,g,p,l,k,v,n,u=this;return d(this,function(x){switch(x.label){case 0:f=!1;e=[];g=[];c.stops&&(p=c.stops,e=p.map(function(a){return a.value}),
(f=p.some(function(a){return!!a.label}))&&(g=p.map(function(a){return a.label})));l=e[0];k=e[e.length-1];if(null==l&&null==k)return[2,null];v=f?null:w(e,a);return[4,t.all(e.map(function(a,e){return h(u,void 0,void 0,function(){var k,n,u;return d(this,function(d){switch(d.label){case 0:return"opacity"!==c.type?[3,2]:[4,z(a,c,b)];case 1:return n=d.sent(),[3,4];case 2:return[4,new Promise(function(a,b){D(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 3:n=d.sent().getColor(c,
a),d.label=4;case 4:return k=n,u=f?g[e]:v[e],[2,{value:a,color:k,label:u}]}})})}))];case 1:return n=x.sent(),[2,n.reverse()]}})})};l.getRampStopsForPointCloud=function(c){var b=!1,a=[],d=[],a=c.map(function(a){return a.value});(b=c.some(function(a){return!!a.label}))&&(d=c.map(function(a){return a.label}));var e=a[a.length-1];if(null==a[0]&&null==e)return null;var f=b?null:w(a,!1);return a.map(function(a,e){var k=A(a,c);return{value:a,color:k,label:b?d[e]:f[e]}}).reverse()};l.getColorFromPointCloudStops=
A;l.getStrectchRampStops=function(c,b){var a=[];if(c&&"multipart"===c.type)c.colorRamps.reverse().forEach(function(d,e){0===e?a.push({value:b.max,color:new f(d.toColor),label:"high"}):a.push({value:null,color:new f(d.toColor),label:""});e===c.colorRamps.length-1?a.push({value:b.min,color:new f(d.fromColor),label:"low"}):a.push({value:null,color:new f(d.fromColor),label:""})});else{var d=void 0,e=void 0;c&&"algorithmic"===c.type?(d=c.fromColor,e=c.toColor):(d=[0,0,0,1],e=[255,255,255,1]);a=[{value:b.max,
color:new f(e),label:"high"},{value:b.min,color:new f(d),label:"low"}]}return a}})},"esri/widgets/Legend/support/utils":function(){define(["require","exports","../../../intl/date","../../../renderers/support/numberUtils"],function(D,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});var f=h.convertDateFormatToIntlOptions("short-date");l.createStopLabel=function(l,p,w,z){var t="";0===p?t="\x3c ":p===w&&(t="\x3e ");p=null;p=z?h.formatDate(l,f):d.format(l);return t+p};l.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"]})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["require","exports","../../../renderers/support/HeatmapColorStop"],
function(D,l,h){Object.defineProperty(l,"__esModule",{value:!0});l.getHeatmapRampStops=function(d){d=d.colorStops;var f=d.length-1;if(d&&d[0]){var l=d[f];l&&1!==l.ratio&&(d=d.slice(0),d.push(new h.HeatmapColorStop({ratio:1,color:l.color})),f++)}return d.map(function(d,h){var l="";0===h?l="low":h===f&&(l="high");return{color:d.color,label:l,ratio:d.ratio}}).reverse()}})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["require","exports","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],
function(D,l,h,d){function f(f){if(f){var c=f.type;return-1<c.indexOf("3d")?d.getSymbolLayerFill(f.symbolLayers.getItemAt(0)):"simple-line"===c||"simple-marker"===f.type&&("x"===f.style||"cross"===f.style)?(f=h.getStroke(f))&&f.color:h.getFill(f)}}function t(d,c){var f=c.HH.label,h=c.LL.label,b=c.HL.label;c=c.LH.label;switch(d){case "HH":return{top:f,bottom:h,left:b,right:c};case "HL":return{top:b,bottom:c,left:h,right:f};case "LL":return{top:h,bottom:f,left:c,right:b};case "LH":return{top:c,bottom:b,
left:f,right:h};default:return{top:f,bottom:h,left:b,right:c}}}function p(d){var c=w[d];d&&null==c&&(c=w.HH);return c||0}Object.defineProperty(l,"__esModule",{value:!0});var w={HH:315,HL:45,LL:135,LH:225},z={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};l.getRelationshipRampElement=function(d){var c=d.focus,h=d.numClasses,g=z[h],b={};d.infos.forEach(function(a){b[a.value]=
{label:a.label,fill:f(a.symbol)}});d=[];for(var a=0;a<h;a++){for(var l=[],e=0;e<h;e++)l.push(b[g[a][e]].fill);d.push(l)}g=t(c,b);return{type:"relationship-ramp",numClasses:h,focus:c,colors:d,labels:g,rotation:p(c)}};l.getRotationAngleForFocus=p})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../symbols ../../../core/promiseUtils ../../../renderers/support/numberUtils ../../../symbols/support/utils ./utils @dojo/framework/shim/Promise".split(" "),
function(D,l,h,d,f,t,p,w,z){function A(a,b){var c=a.length-1;return a.map(function(a,d){return z.createStopLabel(a,d,c,b)})}function c(a,b){var c=null,d=null;"simple"===a.type?c=a.symbol:"class-breaks"===a.type?(c=(a=a.classBreakInfos)&&a[0]&&a[0].symbol,d=1<a.length):"unique-value"===a.type&&(c=(a=a.uniqueValueInfos)&&a[0]&&a[0].symbol,d=1<a.length);if(!c||C(c))return null;c=c.clone();if(b||d)-1<c.type.indexOf("3d")?g(c):(b=c,-1!==b.type.indexOf("line")?b.color=k:(b.color=H,"simple-marker"===b.type&&
(b.outline={color:k,width:1.5})));return c}function C(a){return a?f.isSymbol3D(a)?a.symbolLayers?a.symbolLayers.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill"):!1}function g(a){w.isVolumetricSymbol(a)||("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:k}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:B}:(a.material={color:H},a.outline={color:k,size:1.5})}))}function b(b,c,e,k){return h(this,void 0,
void 0,function(){var f,n,u,h,v;return d(this,function(d){switch(d.label){case 0:return[4,new Promise(function(a,b){D(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:n=(f=d.sent().getSizeRangeAtScale(b,e,k))&&a(f);if(!f&&!n)return[2,void 0];u=n.map(function(a){var c=f.minSize,d=f.maxSize,e=b.minDataValue,k=b.maxDataValue;return a<=c?e:a>=d?k:(a-c)/(d-c)*(k-e)+e});u=p.round(u);h=1;d.label=2;case 2:return h<u.length-1?[4,r(b,c,u[h],u[h-1],e,k)]:[3,5];case 3:if(v=d.sent())u[h]=
v[0],n[h]=v[1];d.label=4;case 4:return h++,[3,2];case 5:return[2,u]}})})}function a(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],d=0;5>d;d++)c.push(b+a*d);return c}function r(a,b,c,k,f,g){return h(this,void 0,void 0,function(){var n,u,h,m,v,l,x,r,t,B,w,z,G,A,M,I,H,q,D,C,V,W;return d(this,function(d){switch(d.label){case 0:return[4,e(a,b,c,f,g)];case 1:return u=d.sent(),[4,e(a,b,k,f,g)];case 2:h=d.sent(),m=p.numDigits(c),v=m.fractional,l=20,x=m.integer,t=r=null,0<c&&1>c&&(r=Math.pow(10,v),c*=
r,x=p.numDigits(c).integer),B=x-1,d.label=3;case 3:if(!(0<=B))return[3,8];w=Math.pow(10,B);z=Math.floor(c/w)*w;G=Math.ceil(c/w)*w;null!=r&&(z/=r,G/=r);A=(z+G)/2;n=p.round([z,A,G],{indexes:[1]});A=n[1];return[4,e(a,b,z,f,g)];case 4:return M=d.sent(),[4,e(a,b,G,f,g)];case 5:return I=d.sent(),[4,e(a,b,A,f,g)];case 6:H=d.sent();q=p.percentChange(u,M,h,null);D=p.percentChange(u,I,h,null);C=p.percentChange(u,H,h,null);V=q.previous<=l;W=D.previous<=l;V&&W&&(q.previous<=D.previous?(V=!0,W=!1):(W=!0,V=!1));
V?t=[z,M]:W?t=[G,I]:C.previous<=l&&(t=[A,H]);if(t)return[3,8];d.label=7;case 7:return B--,[3,3];case 8:return[2,t]}})})}function e(a,b,c,e,k){return h(this,void 0,void 0,function(){var f;return d(this,function(d){switch(d.label){case 0:return[4,new Promise(function(a,b){D(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=d.sent().getSize,[2,f(a,c,{scale:e,view:k,shape:"simple-marker"===b.type?b.style:null})]}})})}function I(a,b){a=a.clone();if(f.isSymbol3D(a))w.isVolumetricSymbol(a)||
a.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=b)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=b;else if("esri.symbols.PictureMarkerSymbol"===a.declaredClass){var c=a.width,d=a.height;a.height=b;a.width=c/d*b}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=b:"esri.symbols.TextSymbol"===a.declaredClass&&a.font&&(a.font.size=b);return a}Object.defineProperty(l,"__esModule",{value:!0});l.REAL_WORLD_MAX_SIZE=30;l.REAL_WORLD_MIN_SIZE=12;var H=[255,255,
255],B=[200,200,200],k=[128,128,128];l.getRampStops=function(a,k,f,g,r,B){return h(this,void 0,void 0,function(){var n,u,v,m,x,z,G,M,H,D,C,R,L,X,Y,P,U,q=this;return d(this,function(y){switch(y.label){case 0:u=(n=k.legendOptions)&&n.customValues;v=c(a,f);m=!!v;x=!!u;z=null!=k.minSize&&null!=k.maxSize;G=k.stops&&1<k.stops.length;M=!!k.target;if(!m||!(x||z||G&&!M))return[2,void 0];H=w.isVolumetricSymbol(v);R=C=D=null;if(!H||G)return[3,1];C=p.round([k.minDataValue,k.maxDataValue]);return[3,4];case 1:return(L=
u)?[3,3]:[4,b(k,v,g,r)];case 2:L=y.sent(),y.label=3;case 3:C=L,y.label=4;case 4:!C&&G&&(C=k.stops.map(function(a){return a.value}),(D=k.stops.some(function(a){return!!a.label}))&&(R=k.stops.map(function(a){return a.label})));H&&C&&2<C.length&&(C=[C[0],C[C.length-1]]);if(!C)return[2,null];X=[l.REAL_WORLD_MIN_SIZE,l.REAL_WORLD_MAX_SIZE];Y=w.getSymbolOutlineSize(v);P=D?null:A(C,B);return[4,t.all(C.map(function(a,b){return h(q,void 0,void 0,function(){var c,f,n,m;return d(this,function(d){switch(d.label){case 0:if(!H)return[3,
1];n=X[b];return[3,3];case 1:return[4,e(k,v,a,g,r)];case 2:n=d.sent(),d.label=3;case 3:return c=n,f=I(v,c),m=D?R[b]:P[b],[2,{value:a,symbol:f,label:m,size:c,outlineSize:Y}]}})})}))];case 5:return U=y.sent(),[2,U.reverse()]}})})}})},"esri/widgets/Legend/styles/Card":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/assignHelper dojo/i18n!../../../nls/common dojo/i18n!../../Legend/nls/Legend ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators ../../../symbols/support/svgUtils ../../Widget ./support/utils ../support/styleUtils ../../support/colorUtils ../../support/widget".split(" "),
function(D,l,h,d,f,t,p,w,z,A,c,C,g,b,a,r,e){var I=window.devicePixelRatio;return function(f){function g(a){a=f.call(this)||this;a._handles=new z;a._hasIndicators=!1;a._selectedSectionName=null;a._sectionNames=[];a._sectionMap=new Map;a.activeLayerInfos=null;a.layout="stack";a.type="card";a.view=null;return a}h(g,f);g.prototype.postInitialize=function(){var a=this;this.own([this.watch("activeLayerInfos",function(b){a._handles.removeAll();a._watchForSectionChanges(b)})])};g.prototype.destroy=function(){this._handles.destroy();
this._handles=null};g.prototype.render=function(){var a=this,b;this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var c=this.activeLayerInfos,d=c&&c.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;
var f=this._sectionNames.length,c=this._sectionNames.map(function(b,c){var d;c=w.substitute(t.pagination.pageText,{index:c+1,total:f});return e.tsx("div",{key:b,"aria-label":c,title:c,tabIndex:0,onclick:a._selectSection,onkeydown:a._selectSection,bind:a,class:a.classes("esri-legend--card__carousel-indicator",(d={},d["esri-legend--card__carousel-indicator--activated"]=a._selectedSectionName===b,d)),"data-section-name":b})}),c=this._hasIndicators&&1<f?e.tsx("div",{class:"esri-legend--card__carousel-indicator-container",
key:"carousel-navigation"},c):null,d=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):d&&d.length?d:null,g=(b={},b["esri-legend--stacked"]=this._hasIndicators,b);return e.tsx("div",{class:this.classes("esri-legend--card esri-widget",g)},c,d?d:e.tsx("div",{class:"esri-legend--card__message"},p.noLegend))};g.prototype._selectSection=function(a){if(a=a.target.getAttribute("data-section-name"))this._selectedSectionName=a};g.prototype._watchForSectionChanges=function(a){var b=this;this._generateSectionNames();
a&&(a.forEach(function(a){var c="activeLayerInfo-"+a.layer.uid+"-version-change";b._handles.remove(c);b._watchForSectionChanges(a.children);b._handles.add(a.watch("version",function(){return b._generateSectionNames()}),c)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(a.on("change",function(){return b._watchForSectionChanges(a)}),"activeLayerInfos-collection-change"))};g.prototype._generateSectionNames=function(){this._sectionNames.length=0;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,
this)};g.prototype._generateSectionNamesForActiveLayerInfo=function(a){var b=this;a.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);a.legendElements&&a.legendElements.forEach(function(c,d){b._sectionNames.push("esri-legend--card__"+a.layer.uid+"-type-"+c.type+"-"+d)})};g.prototype._renderLegendForLayer=function(a){var b=this,c;if(!a.ready)return null;if(a.children.length)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),e.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},e.tsx("div",{class:"esri-legend--card__service-caption-container"},a.title),c);var d=a.legendElements;if(d&&!d.length)return null;var f=d.some(function(a){return"relationship-ramp"===a.type}),d=d.map(function(c,d){return b._renderLegendForElement(c,a,d,f)}).filter(function(a){return!!a});if(!d.length)return null;var k=(c={},c["esri-legend--card__group-layer-child"]=!!a.parent,c);return e.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service",k)},e.tsx("div",{class:"esri-legend--card__service-caption-container"},e.tsx("div",{class:"esri-legend--card__service-caption-text"},a.title)),e.tsx("div",{class:"esri-legend--card__service-content"},d))};g.prototype._renderLegendForElement=function(c,d,f,g){var k=this;void 0===g&&(g=!1);var n,h="color-ramp"===c.type,u="opacity-ramp"===c.type,l="size-ramp"===c.type,p=d.layer,m=c.title,r=null;"string"===typeof m?r=m:m&&(r=a.getTitle(m,h||u),r=m.title?
m.title+" ("+r+")":r);f="esri-legend--card__"+p.uid+"-type-"+c.type+"-"+f;m=this._hasIndicators?e.tsx("div",null,e.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend--card__carousel-title")},d.title),e.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},r)):r?e.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},r):null;r=null;"symbol-table"===c.type?(l=c.infos.map(function(a,b){return k._renderLegendForElementInfo(a,
d,c.legendType,b)}).filter(function(a){return!!a}),l.length&&(p=l[0].properties.classes&&l[0].properties.classes["esri-legend--card__symbol-row"],g=(n={},n["esri-legend--card__label-container"]=!p&&!g,n["esri-legend--card__relationship-label-container"]=g,n),r=e.tsx("div",{key:f,class:"esri-legend--card__section"},m,e.tsx("div",{class:this.classes(g)},l)))):"color-ramp"===c.type||"opacity-ramp"===c.type||"heatmap-ramp"===c.type?r=e.tsx("div",{key:f,class:"esri-legend--card__section"},m,this._renderLegendForRamp(c,
p.opacity)):l?r=e.tsx("div",{key:f,class:"esri-legend--card__section"},m,this._renderSizeRamps(c,p.opacity)):"relationship-ramp"===c.type&&(r=e.tsx("div",{key:f,class:this.classes("esri-legend--card__section","esri-legend--card__relationship-section")},m,b.renderRelationshipRamp(c,this.id,p.opacity)));if(!r)return null;this._sectionMap.set(f,r);return r};g.prototype._renderLegendForElementInfo=function(b,c,d,f){var k,n,g,h=c.layer;if(b.type)return this._renderLegendForElement(b,c,f);c=a.isImageryStretchedLegend(h,
d);if(b.symbol&&b.preview){if(-1===b.symbol.type.indexOf("simple-fill")){if(!b.label)return e.tsx("div",{key:f,bind:b.preview,afterCreate:a.attachToNode});h=(k={},k["esri-legend--card__symbol-cell"]=this._hasIndicators,k);return e.tsx("div",{key:f,class:this.classes("esri-legend--card__layer-row",(n={},n["esri-legend--card__symbol-row"]=this._hasIndicators,n))},e.tsx("div",{class:this.classes(h),bind:b.preview,afterCreate:a.attachToNode}),e.tsx("div",{class:this.classes("esri-legend--card__image-label",
(g={},g["esri-legend--card__label-cell"]=this._hasIndicators,g))},a.getTitle(b.label,!1)||""))}g=n=k=255;c=0;var l=d=255,u=255,m=0,p=b.symbol.color&&b.symbol.color.a,t=b.symbol.outline&&b.symbol.outline.color&&b.symbol.outline.color.a;p&&(k=b.symbol.color.r,n=b.symbol.color.g,g=b.symbol.color.b,c=b.symbol.color.a*h.opacity);t&&(d=b.symbol.outline.color.r,l=b.symbol.outline.color.g,u=b.symbol.outline.color.b,m=b.symbol.outline.color.a*h.opacity);var v=(h=b.symbol.color?r.isBright(b.symbol.color):!0)?
"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return e.tsx("div",{key:f,class:"esri-legend--card__layer-row"},e.tsx("div",{class:"esri-legend--card__label-element",styles:{background:p?"rgba("+k+", "+n+", "+g+", "+c+")":"none",color:h?"black":"white",textShadow:"-1px -1px 0 "+v+",\n                                              1px -1px 0 "+v+",\n                                              -1px 1px 0 "+v+",\n                                              1px 1px 0 "+v,border:t?"1px solid rgba("+d+
", "+l+", "+u+", "+m+")":"none"}}," ",b.label," "))}if(b.src)return h=this._renderImage(b,h,c),e.tsx("div",{key:f,class:"esri-legend--card__layer-row"},h,e.tsx("div",{class:"esri-legend--card__image-label"},b.label||""))};g.prototype._renderImage=function(b,c,d){var f,k=b.label,n=b.src,g=b.opacity;d=(f={},f["esri-legend--card__imagery-layer-image--stretched"]=d,f["esri-legend--card__symbol"]=!d,f);c={opacity:""+(null!=g?g:c.opacity)};return e.tsx("img",{alt:a.getTitle(k,!1),src:n,border:0,width:b.width,
height:b.height,class:this.classes(d),styles:c})};g.prototype._drawImageOnSizeRamp=function(a,b,c){var d=c.x,e=c.y,f=c.width,k=c.height,n=new Image;n.src=b;n.onload=function(){a.drawImage(n,d,e,f,k);URL.revokeObjectURL(b)}};g.prototype._attachSizeRampToNode=function(a){var b=a["data-layer-opacity"];null!=b&&(a.style.opacity=b.toString());var b=a["data-legend-element"].infos,c=b[0],d=b[b.length-1],e=c.symbol,f=d.symbol,k="picture-marker"===e.type;e?-1<e.type.indexOf("3d")?(b=e.symbolLayers&&e.symbolLayers.length)?
(b=e.symbolLayers.getItemAt(b-1).get("resource.primitive"),b="triangle"===b||"cone"===b||"tetrahedron"===b):b=void 0:b="triangle"===e.style:b=void 0;var g;e?-1<e.type.indexOf("3d")?(g=e.symbolLayers&&e.symbolLayers.length)?(g=e.symbolLayers.getItemAt(g-1),g=g.resource&&g.resource.primitive,g="circle"===g||"cross"===g||"kite"===g||"sphere"===g||"cube"===g||"diamond"===g):g=void 0:(g=e.style,g="circle"===g||"diamond"===g||"cross"===g):g=void 0;var h,l;k?(h=e.url,l=f.url):(c.preview&&(h=new Blob([c.preview.innerHTML],
{type:"image/svg+xml"}),h=URL.createObjectURL(h)),d.preview&&(l=new Blob([d.preview.innerHTML],{type:"image/svg+xml"}),l=URL.createObjectURL(l)));var m=A.pt2px(c.size+c.outlineSize)*I,e=A.pt2px(d.size+d.outlineSize)*I,f=this._hasIndicators?m:m+100*I,k=this._hasIndicators?f+50*I:m,c=document.createElement("canvas");c.width=f;c.height=k;c.style.width=c.width/I+"px";c.style.height=c.height/I+"px";d=c.getContext("2d");this._hasIndicators?(this._drawImageOnSizeRamp(d,h,{x:0,y:0,width:m,height:m}),this._drawImageOnSizeRamp(d,
l,{x:f/2-e/2,y:k-e,width:e,height:e}),d.beginPath(),h=f/2-e/2,l=k-(b?0:g?e/2:e),d.moveTo(0,g?f/2:f),d.lineTo(h,l),h=f/2+e/2,b=k-(b?0:g?e/2:e),d.moveTo(f,g?f/2:f),d.lineTo(h,b)):(this._drawImageOnSizeRamp(d,h,{x:f-m,y:0,width:m,height:m}),this._drawImageOnSizeRamp(d,l,{x:0,y:k/2-e/2,width:e,height:e}),d.beginPath(),h=f-(g||b?m/2:m),d.moveTo(e-(g||b?e/2:0),k/2-e/2),d.lineTo(h,0),b=f-(g?m/2:m),d.moveTo(e-(g?e/2:0),k/2+e/2),d.lineTo(b,k));d.strokeStyle="#ddd";d.stroke();a.appendChild(c)};g.prototype._renderSizeRamps=
function(a,b){var c,d=a.infos,f=d[0].label,d=d[d.length-1].label;return e.tsx("div",{class:this.classes("esri-legend--card__layer-row",(c={},c["esri-legend--card__size-ramp-row"]=this._hasIndicators,c))},e.tsx("div",{class:"esri-legend--card__ramp-label"},this._hasIndicators?f:d),e.tsx("div",{class:"esri-legend--card__size-ramp-container"},e.tsx("div",{bind:this,"data-layer-opacity":b,"data-legend-element":a,afterCreate:this._attachSizeRampToNode})),e.tsx("div",{class:"esri-legend--card__ramp-label"},
this._hasIndicators?d:f))};g.prototype._renderLegendForRamp=function(a,b){var c=a.infos,d="heatmap-ramp"===a.type,f=c.length-1;a=2<f&&!d?25*f:100;var k=a+20,g=c.slice(0).reverse();g.forEach(function(a,b){a.offset=d?a.ratio:b/f});var h=g.length-1,l=0!==g.length%2&&g[g.length/2|0],l=l&&e.tsx("div",{class:"esri-legend--card__interval-separators-container"},e.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),e.tsx("div",{class:"esri-legend--card__ramp-label"},l.label)),r=c[c.length-1].label,
c=c[0].label,m=null;null!=b&&(m="opacity: "+b);b=C.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:g[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:a,height:25},fill:{type:"linear",x1:10,y1:0,x2:a+10,y2:0,colors:g},stroke:{width:0}},{shape:{type:"path",path:"M"+(a+10)+" 0 L"+k+" 12.5 L"+(a+10)+" 25 Z"},fill:g[h].color,stroke:{width:0}}]],k,25);return e.tsx("div",{class:"esri-legend--card__layer-row"},e.tsx("div",{class:"esri-legend--card__ramp-label"},d?p[r]:r),
e.tsx("div",{class:"esri-legend--card__symbol-container"},e.tsx("div",{style:m},b),l),e.tsx("div",{class:"esri-legend--card__ramp-label"},d?p[c]:c))};d([e.renderable(),c.property()],g.prototype,"activeLayerInfos",void 0);d([c.property()],g.prototype,"layout",void 0);d([c.property({readOnly:!0})],g.prototype,"type",void 0);d([c.property()],g.prototype,"view",void 0);d([e.accessibleHandler()],g.prototype,"_selectSection",null);return g=d([c.subclass("esri.widgets.Legend.styles.Card")],g)}(c.declared(g))})},
"esri/widgets/Legend/styles/support/utils":function(){define(["require","exports","../../../../symbols/support/svgUtils","../../../support/widget"],function(D,l,h,d){function f(d,f,h){var l=h+"_arrowStart";h+="_arrowEnd";d="left"===d;var p={markerStart:null,markerEnd:null};switch(f){case "HL":d?p.markerStart="url(#"+h+")":p.markerEnd="url(#"+l+")";break;case "LL":p.markerStart="url(#"+h+")";break;case "LH":d?p.markerEnd="url(#"+l+")":p.markerStart="url(#"+h+")";break;default:p.markerEnd="url(#"+l+
")"}return p}Object.defineProperty(l,"__esModule",{value:!0});l.renderRelationshipRamp=function(l,p,w){var t=l.labels,A=!!l.focus,c=void 0;void 0===c&&(c=60);var C=l.focus,g=l.numClasses,b=l.colors,a=l.rotation;l=!!C;var r=Math.sqrt(Math.pow(c,2)+Math.pow(c,2))+(l?0:5),e=null;null!=w&&(e="opacity: "+w);w=[];for(var I=[],H=[],B=(c||75)/g,k=0;k<g;k++)for(var v=k*B,n=0;n<g;n++){var u=n*B,x=h.generateFillAttributes(b[k][n]),D=h.generateStrokeAttributes(null),u={type:"rect",x:u,y:v,width:B,height:B};w.push(h.renderDef(x));
I.push(h.renderShape(u,x.fill,D,null));H.push(h.getBoundingBox(u))}g=null;l||(g="margin: -15px -15px -18px -15px");b=f("left",C,p);C=f("right",C,p);H=h.computeBBox(H);a=h.getTransformMatrix(H,r,r,0,!1,a);H=h.getTransformMatrix(H,r,r,0,!1,l?-45:null);p=d.tsx("div",{style:e,class:l?"esri-relationship-ramp--diamond__middle-column--ramp":"esri-relationship-ramp--square__table-cell"},d.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,height:r,style:g},d.tsx("defs",null,d.tsx("marker",{id:p+"_arrowStart",
markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},d.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),d.tsx("marker",{id:p+"_arrowEnd",markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},d.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),w),d.tsx("g",{transform:a},I),d.tsx("g",{transform:H},d.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1",
"marker-start":b.markerStart,"marker-end":b.markerEnd,x1:-10,y1:c-15,x2:-10,y2:15}),d.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":C.markerStart,"marker-end":C.markerEnd,x1:15,y1:c+10,x2:c-15,y2:c+10}))));return A?d.tsx("div",{class:"esri-relationship-ramp--diamond__container"},d.tsx("div",{class:"esri-relationship-ramp--diamond__left-column"},t.left),d.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column"},d.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},
t.top),p,d.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},t.bottom)),d.tsx("div",{class:"esri-relationship-ramp--diamond__right-column"},t.right)):d.tsx("div",{class:"esri-relationship-ramp--square__table"},d.tsx("div",{class:"esri-relationship-ramp--square__table-row"},d.tsx("div",{class:d.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-bottom")},t.left),d.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),
d.tsx("div",{class:d.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-bottom")},t.top)),d.tsx("div",{class:"esri-relationship-ramp--square__table-row"},d.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),p,d.tsx("div",{class:"esri-relationship-ramp--square__table-cell"})),d.tsx("div",{class:"esri-relationship-ramp--square__table-row"},d.tsx("div",{class:d.classes("esri-relationship-ramp--square__table-cell",
"esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-top")},t.bottom),d.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),d.tsx("div",{class:d.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-top")},t.right)))}})},"esri/widgets/Legend/support/styleUtils":function(){define(["require","exports","dojo/i18n!../../Legend/nls/Legend","../../../intl"],
function(D,l,h,d){Object.defineProperty(l,"__esModule",{value:!0});l.attachToNode=function(d){d.appendChild(this)};l.getTitle=function(f,l){if(f){if("string"===typeof f)return f;if("value"in f||"unit"in f)return d.substitute(h.dotValue,f);if("colorName"in f||"bandName"in f)return h[f.colorName]+": "+(h[f.bandName]||f.bandName);var p=null;l?p=f.ratioPercentTotal?"showRatioPercentTotal":f.ratioPercent?"showRatioPercent":f.ratio?"showRatio":f.normField?"showNormField":f.field?"showField":null:l||(p=
f.normField?"showNormField":f.normByPct?"showNormPct":f.field?"showField":null);return p?d.substitute("showField"===p?"{field}":h[p],{field:f.field,normField:f.normField}):null}};l.isRendererTitle=function(d,h){return!h};l.isImageryStretchedLegend=function(d,h){return!!(h&&"Stretched"===h&&10.3<=d.version&&"esri.layers.ImageryLayer"===d.declaredClass)}})},"esri/widgets/support/colorUtils":function(){define(["require","exports","../../Color"],function(D,l,h){function d(b){return new h(b)}function f(b){return!!b&&
4===b.length&&c.test(b)}function t(b){return!!b&&7===b.length&&C.test(b)}function p(b){return 127<=.299*b.r+.587*b.g+.114*b.b}function w(b,a){void 0===a&&(a=1);a=Math.pow(.7,a);return new h([Math.round(b.r*a),Math.round(b.g*a),Math.round(b.b*a),b.a])}function z(b,a){void 0===a&&(a=1);a=Math.pow(.7,a);var c=b.r,d=b.g,f=b.b;30>c&&(c=30);30>d&&(d=30);30>f&&(f=30);return new h([Math.min(255,Math.round(c/a)),Math.min(255,Math.round(d/a)),Math.min(255,Math.round(f/a)),b.a])}function A(b,a){var c=b.r,d=
b.g,f=b.b;b=b.a;1>b&&(c=Math.round(b*c+(1-b)*a.r),d=Math.round(b*d+(1-b)*a.g),f=Math.round(b*f+(1-b)*a.b));return new h({r:c,g:d,b:f})}Object.defineProperty(l,"__esModule",{value:!0});var c=/^#[0-9A-F]{3}$/i,C=/^#[0-9A-F]{6}$/i,g=new h({r:255,g:255,b:255});l.equal=function(b,a){return b&&a&&b.r===a.r&&b.g===a.g&&b.b===a.b&&b.a===a.a};l.normalizeHex=function(b){return b?"#"+b.trim().replace(/#/g,"").substr(0,6):""};l.normalizeColor=d;l.isValidHex=function(b){return f(b)||t(b)};l.isShorthandHex=f;l.isLonghandHex=
t;l.toHex=function(b){return d(b).toHex()};l.getContrastingColor=function(b){return p(b)?w(b):z(b,3)};l.isBright=p;l.darker=w;l.brighter=z;l.blendWithBackground=A;l.getColorTheme=function(b,a){void 0===a&&(a=g);b=A(b,a);return p(b)?"light":"dark"}})},"esri/widgets/Legend/styles/Classic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend ../../../intl ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),
function(D,l,h,d,f,t,p,w,z,A,c){return function(l){function g(b){b=l.call(this)||this;b.activeLayerInfos=null;b.type="classic";return b}h(g,l);g.prototype.render=function(){var b=this,a=this.activeLayerInfos,d=this.classes("esri-legend esri-widget--panel","esri-widget"),a=a&&a.toArray().map(function(a){return b._renderLegendForLayer(a)}).filter(function(a){return!!a});return c.tsx("div",{class:d},a&&a.length?a:c.tsx("div",{class:"esri-legend__message"},f.noLegend))};g.prototype._renderLegendForLayer=
function(b){var a=this,d;if(!b.ready)return null;var e=!!b.children.length,f="esri-legend__"+b.layer.uid+"-version-"+b.version,g=b.title?c.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},b.title):null;if(e)return d=b.children.map(function(b){return a._renderLegendForLayer(b)}).toArray(),c.tsx("div",{key:f,class:this.classes("esri-legend__service","esri-legend__group-layer")},g,d);if((e=b.legendElements)&&!e.length)return null;e=e.map(function(c){return a._renderLegendForElement(c,
b.layer)}).filter(function(a){return!!a});if(!e.length)return null;var h=(d={},d["esri-legend__group-layer-child"]=!!b.parent,d);return c.tsx("div",{key:f,class:this.classes("esri-legend__service",h)},g,c.tsx("div",{class:"esri-legend__layer"},e))};g.prototype._renderLegendForElement=function(b,a,d){var e=this,f,g="color-ramp"===b.type,h="opacity-ramp"===b.type,k="size-ramp"===b.type,l=null;if("symbol-table"===b.type||k){var n=b.infos.map(function(c){return e._renderLegendForElementInfo(c,a,k,b.legendType)}).filter(function(a){return!!a});
n.length&&(l=c.tsx("div",{class:"esri-legend__layer-body"},n))}else"color-ramp"===b.type||"opacity-ramp"===b.type||"heatmap-ramp"===b.type||"stretch-ramp"===b.type?l=this._renderLegendForRamp(b,a.opacity):"relationship-ramp"===b.type&&(l=z.renderRelationshipRamp(b,this.id,a.opacity));if(!l)return null;var n=b.title,p=null;"string"===typeof n?p=n:n&&(p=A.getTitle(n,g||h),p=A.isRendererTitle(n,g||h)&&n.title?n.title+" ("+p+")":p);g=d?"esri-legend__layer-child-table":"esri-legend__layer-table";h=p?c.tsx("div",
{class:"esri-legend__layer-caption"},p):null;d=(f={},f["esri-legend__layer-table--size-ramp"]=k||!d,f);return c.tsx("div",{class:this.classes(g,d)},h,l)};g.prototype._renderLegendForRamp=function(b,a){var d=this,e=b.infos,g="heatmap-ramp"===b.type,h="stretch-ramp"===b.type,l=b.preview;l.className="esri-legend__color-ramp "+("opacity-ramp"===b.type?"esri-legend__opacity-ramp":"");null!=a&&(l.style.opacity=a.toString());b=e.map(function(a){return c.tsx("div",{class:a.label?"esri-legend__ramp-label":
null},g?f[a.label]:h?d._getStretchStopLabel(a):a.label)});a={height:l.style.height};return c.tsx("div",{class:"esri-legend__layer-row"},c.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},c.tsx("div",{class:"esri-legend__ramps",bind:l,afterCreate:A.attachToNode})),c.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},c.tsx("div",{class:"esri-legend__ramp-labels",styles:a},b)))};g.prototype._getStretchStopLabel=function(b){return b.label?
f[b.label]+": "+t.formatNumber(b.value,{style:"decimal"}):""};g.prototype._renderLegendForElementInfo=function(b,a,d,e){var f,g;if(b.type)return this._renderLegendForElement(b,a,!0);var h=null;e=A.isImageryStretchedLegend(a,e);b.symbol&&b.preview?h=c.tsx("div",{class:"esri-legend__symbol",bind:b.preview,afterCreate:A.attachToNode}):b.src&&(h=this._renderImage(b,a,e));if(!h)return null;a=(f={},f["esri-legend__imagery-layer-info--stretched"]=e,f);d=(g={},g["esri-legend__imagery-layer-info--stretched"]=
e,g["esri-legend__size-ramp"]=!e&&d,g);return c.tsx("div",{class:"esri-legend__layer-row"},c.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",d)},h),c.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",a)},A.getTitle(b.label,!1)||""))};g.prototype._renderImage=function(b,a,d){var e,f=b.label,g=b.src,h=b.opacity;d=(e={},e["esri-legend__imagery-layer-image--stretched"]=d,e["esri-legend__symbol"]=!d,e);a={opacity:""+(null!=h?
h:a.opacity)};return c.tsx("img",{alt:A.getTitle(f,!1),src:g,border:0,width:b.width,height:b.height,class:this.classes(d),styles:a})};d([c.renderable(),p.property()],g.prototype,"activeLayerInfos",void 0);d([p.property({readOnly:!0})],g.prototype,"type",void 0);return g=d([p.subclass("esri.widgets.Legend.styles.Classic")],g)}(p.declared(w))})},"widgets/Legend/_build-generate_module":function(){define(["dojo/i18n!./nls/strings"],function(){})},"*now":function(D){D(['dojo/i18n!*preload*widgets/Legend/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define(["dojo/_base/declare","jimu/BaseWidget","esri/widgets/Legend"],function(D,l,h){return D([l],{name:"Legend",baseClass:"jimu-widget-legend",templateString:"\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d'legendDiv'\x3e\x3c/div\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);this.legend=new h({container:this.legendDiv,view:this.sceneView})},destroy:function(){this.legend&&this.legend.destroy();this.inherited(arguments)}})});