// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Legend/nls/Legend ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/decorators/cast ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widget".split(" "),function(A,l,f,g,a,k,t,m,n,v,e,y,u,h,d){return function(b){function c(c){c=b.call(this)||
this;c._handles=new t;c.activeLayerInfos=null;c.basemapLegendVisible=!1;c.groundLegendVisible=!1;c.iconClass="esri-icon-layer-list";c.label=k.widgetLabel;c.layerInfos=null;c.style=new h;c.view=null;c.viewModel=new y;return c}g(c,b);c.prototype.postInitialize=function(){var b=this;this.own(m.on(this,"activeLayerInfos","change",function(){return b._refreshActiveLayerInfos(b.activeLayerInfos)}),m.init(this,"style",function(c,a){a&&c!==a&&a.destroy();c&&(c.activeLayerInfos=b.activeLayerInfos,"card"===
c.type&&(c.view=b.view))}))};c.prototype.destroy=function(){this._handles.destroy();this._handles=null};c.prototype.castStyle=function(b){if(b instanceof u||b instanceof h)return b;if("string"===typeof b)return"card"===b?new u:new h;if(b&&"string"===typeof b.type){var c=f({},b);delete c.type;return new ("card"===b.type?u:h)(c)}return new h};c.prototype.render=function(){return this.style.render()};c.prototype._refreshActiveLayerInfos=function(b){var c=this;this._handles.removeAll();b.forEach(function(b){return c._renderOnActiveLayerInfoChange(b)});
this.scheduleRender()};c.prototype._renderOnActiveLayerInfoChange=function(b){var c=this,a=m.init(b,"version",function(){return c.scheduleRender()});this._handles.add(a,"version_"+b.layer.uid);b.children.forEach(function(b){return c._renderOnActiveLayerInfoChange(b)})};a([n.aliasOf("viewModel.activeLayerInfos"),d.renderable()],c.prototype,"activeLayerInfos",void 0);a([n.aliasOf("viewModel.basemapLegendVisible"),d.renderable()],c.prototype,"basemapLegendVisible",void 0);a([n.aliasOf("viewModel.groundLegendVisible"),
d.renderable()],c.prototype,"groundLegendVisible",void 0);a([n.property()],c.prototype,"iconClass",void 0);a([n.property()],c.prototype,"label",void 0);a([n.aliasOf("viewModel.layerInfos"),d.renderable()],c.prototype,"layerInfos",void 0);a([n.property(),d.renderable()],c.prototype,"style",void 0);a([v.cast("style")],c.prototype,"castStyle",null);a([n.aliasOf("viewModel.view"),d.renderable()],c.prototype,"view",void 0);a([n.property(),d.renderable(["view.size"])],c.prototype,"viewModel",void 0);return c=
a([n.subclass("esri.widgets.Legend")],c)}(n.declared(e))})},"esri/widgets/Legend/LegendViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./support/ActiveLayerInfo".split(" "),function(A,l,f,g,a,k,t,m,n,v){var e=k.ofType(v),y="esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.HeatmapLayer esri.layers.MapImageLayer esri.layers.PointCloudLayer esri.layers.TileLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.GeoRSSLayer esri.layers.GeoJSONLayer esri.layers.GroupLayer esri.layers.ImageryLayer esri.layers.WMSLayer esri.layers.WMTSLayer".split(" "),
u=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];return function(a){function d(b){b=a.call(this,b)||this;b._handles=new t;b._layerViewByLayerId={};b._layerInfosByLayerViewId={};b._activeLayerInfosByLayerViewId={};b.activeLayerInfos=new e;b.basemapLegendVisible=!1;b.groundLegendVisible=!1;b.layerInfos=[];b.view=null;return b}f(d,a);d.prototype.initialize=function(){this._handles.add(m.init(this,"view",this._viewHandles),"view")};
d.prototype.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};Object.defineProperty(d.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});d.prototype._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(m.init(this,"state",this._stateHandles),"state")};d.prototype._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};
d.prototype._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};d.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};d.prototype._destroyViewActiveLayerInfo=function(b){this._handles.remove(b);delete this._activeLayerInfosByLayerViewId[b]};d.prototype._watchPropertiesAndAllLayerViews=function(){var b=this.view.allLayerViews;
b.length&&this._refresh();this._handles.add(b.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(m.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};d.prototype._allLayerViewsChangeHandle=function(b){var c=this;b.removed.forEach(function(b){return c._destroyViewActiveLayerInfo(b.uid)});this._refresh()};d.prototype._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();
this._refresh()};d.prototype._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};d.prototype._sortActiveLayerInfos=function(b){var c={};this.view.allLayerViews.forEach(function(b,a){return c[b.layer.uid]=a});b.sort(function(b,a){return(c[a.layer.uid]||0)-(c[b.layer.uid]||
0)})};d.prototype._generateLayerViews=function(){var b=[];u.filter(this._filterLayerViews,this).map(this.get,this).filter(function(b){return null!=b}).forEach(this._collectLayerViews("layerViews",b));return b};d.prototype._filterLayerViews=function(b){var c=!this.groundLegendVisible&&"view.groundView.layerViews"===b;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===b||"view.basemapView.referenceLayerViews"===b))&&!c};d.prototype._collectLayerViews=function(b,c){var a=function(d){d&&
d.forEach(function(d){c.push(d);a(d[b])});return c};return a};d.prototype._filterLayerViewsByLayerInfos=function(b){var c=this,a=this.layerInfos;return a&&a.length?a.some(function(a){return c._hasLayerInfo(a,b)}):!0};d.prototype._hasLayerInfo=function(b,c){var a=this._isLayerUIDMatching(b.layer,c.layer.uid);a&&(this._layerInfosByLayerViewId[c.uid]=b);return a};d.prototype._isLayerUIDMatching=function(b,c){return b&&(b.uid===c||this._hasLayerUID(b.layers,c))};d.prototype._hasLayerUID=function(b,c){var a=
this;return b&&b.some(function(b){return a._isLayerUIDMatching(b,c)})};d.prototype._isLayerViewSupported=function(b){return-1<y.indexOf(b.layer.declaredClass)?(this._layerViewByLayerId[b.layer.uid]=b,!0):!1};d.prototype._generateActiveLayerInfo=function(b){var c=this;this._isLayerActive(b)?this._buildActiveLayerInfo(b):(this._handles.remove(b.uid),this._handles.add(m.watch(b,"suspended, layer.legendEnabled",function(){return c._layerActiveHandle(b)}),b.uid))};d.prototype._layerActiveHandle=function(b){this._isLayerActive(b)&&
(this._handles.remove(b.uid),this._buildActiveLayerInfo(b))};d.prototype._isLayerActive=function(b){return!b.suspended&&b.get("layer.legendEnabled")};d.prototype._buildActiveLayerInfo=function(b){var c=this,a=b.layer,d=b.uid,h=this._layerInfosByLayerViewId[d],p=this._activeLayerInfosByLayerViewId[d];p||(p=new v({layer:a,title:h&&void 0!==h.title?h.title:a.title,view:this.view}),this._activeLayerInfosByLayerViewId[d]=p);p.parent||(h=(h=a.parent)&&this._layerViewByLayerId[h.uid],p.parent=h&&this._activeLayerInfosByLayerViewId[h.uid]);
if(!this._handles.has(d)){var h=m.watch(a,"title",function(a){return c._titleHandle(a,p,b)}),q=m.watch(a,"legendEnabled",function(a){return c._legendEnabledHandle(a,p,b)}),a=m.watch(a,"renderer?, opacity",function(){return c._constructLegendElements(p,b)}),r=m.watch(b,"suspended",function(a){return c._suspendedHandle(a,p,b)}),k=m.whenTrue(this.view,"stationary",function(){return c._scaleHandle(p,b)});this._handles.add([h,q,a,r,k],d);this._constructLegendElements(p,b)}this._addActiveLayerInfo(p,b)};
d.prototype._titleHandle=function(b,c,a){c.title=b;this._constructLegendElements(c,a)};d.prototype._legendEnabledHandle=function(b,a,d){b?this._addActiveLayerInfo(a,d):this._removeActiveLayerInfo(a)};d.prototype._suspendedHandle=function(b,a,d){b?this._removeActiveLayerInfo(a):this._addActiveLayerInfo(a,d)};d.prototype._scaleHandle=function(b,a){b.scale!==this.view.scale&&b.isScaleDriven&&this._constructLegendElements(b,a)};d.prototype._addActiveLayerInfo=function(b,a){this._isLayerActive(a)&&-1===
this.activeLayerInfos.indexOf(b)&&((a=b.parent,a)?-1===a.children.indexOf(b)&&(a.children.push(b),this._sortActiveLayerInfos(a.children)):(this.activeLayerInfos.add(b),this._sortActiveLayerInfos(this.activeLayerInfos)))};d.prototype._removeActiveLayerInfo=function(b){var a=b.parent;a?a.children.remove(b):this.activeLayerInfos.remove(b)};d.prototype._constructLegendElements=function(b,a){a=a.layer;b.scale=this.view.scale;a.featureCollections?b.buildLegendElementsForFeatureCollections(a.featureCollections):
a.renderer?b.buildLegendElementsForRenderer():a.url&&b.buildLegendElementsForTools()};g([n.property({type:e})],d.prototype,"activeLayerInfos",void 0);g([n.property()],d.prototype,"basemapLegendVisible",void 0);g([n.property()],d.prototype,"groundLegendVisible",void 0);g([n.property()],d.prototype,"layerInfos",void 0);g([n.property({dependsOn:["view.ready"],readOnly:!0})],d.prototype,"state",null);g([n.property()],d.prototype,"view",void 0);return d=g([n.subclass("esri.widgets.Legend.LegendViewModel")],
d)}(n.declared(a))})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Handles ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../symbols/support/gfxUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils @dojo/framework/shim/Promise".split(" "),
function(A,l,f,g,a,k,t,m,n,v,e,y,u,h,d,b,c,z,F,w,p,q,r,x,E,B,D,C,R,O){function K(b){return"esri.renderers.SimpleRenderer"===b.declaredClass}function I(b){return"esri.renderers.ClassBreaksRenderer"===b.declaredClass}function S(b){return"esri.renderers.UniqueValueRenderer"===b.declaredClass}function L(b){return"esri.renderers.HeatmapRenderer"===b.declaredClass}function J(b){return"esri.renderers.PointCloudClassBreaksRenderer"===b.declaredClass}function P(b){return"esri.renderers.PointCloudStretchRenderer"===
b.declaredClass}function M(b){return"esri.renderers.PointCloudUniqueValueRenderer"===b.declaredClass}var G=d.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),Q=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,N=new v.SimpleMarkerSymbol({size:6,outline:{color:[128,128,128,.5],width:.5}}),V=new v.SimpleMarkerSymbol({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",outline:{width:1,color:[85,85,85,1]}});return function(d){function e(b){b=d.call(this,b)||this;b._handles=new h;b._hasColorRamp=!1;b._hasOpacityRamp=
!1;b._hasSizeRamp=!1;b._legendResponse={};b._webStyleSymbolCache=new Map;b._dotDensityUrlCache=new Map;b.children=new u;b.layer=null;b.legendElements=[];b.parent=null;b.scale=null;b.title=null;b.view=null;return b}g(e,d);e.prototype.initialize=function(){var b=this,a=function(){return b.notifyChange("ready")};this._handles.add([F.on(this,"children","change",function(c){var d=c.removed,H=b._handles;c.added.map(function(b){var c="activeLayerInfo-ready-watcher-"+b.layer.uid;H.add(F.init(b,"ready",a),
c)});d.forEach(function(b){return H.remove(b.layer.uid)});a()})])};e.prototype.destroy=function(){this._handles.destroy();this._dotDensityUrlCache=this._webStyleSymbolCache=this._legendResponse=this._handles=null};Object.defineProperty(e.prototype,"ready",{get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isScaleDriven",{get:function(){var b=this,a=this.layer;if(null===
a)return!1;if("renderer"in a&&a.renderer){if("dot-density"===a.renderer.type)return!0;var c=a.get("renderer.valueExpression");return Q.test(c)?!0:(a=a.get("renderer.visualVariables"))&&a.some(function(a){return b._isScaleDrivenSizeVariable(a)})}return!0},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"version",{get:function(){return this._get("version")+1},enumerable:!0,configurable:!0});e.prototype.buildLegendElementsForFeatureCollections=function(b){var a=this;this.legendElements=
[];b.forEach(function(b){if("esri.layers.FeatureLayer"===b.declaredClass)a._buildRendererLegendElements(b.renderer,b.title,"append");else if(b.featureSet&&b.featureSet.features.length){var c=b.layerDefinition;(c=(c=c&&c.drawingInfo)&&r.fromJSON(c.renderer))?a._buildRendererLegendElements(c,b.name,"append"):G.warn("drawingInfo not available!")}})};e.prototype.buildLegendElementsForRenderer=function(){this._buildRendererLegendElements("renderer"in this.layer&&this.layer.renderer,null,"replace")};e.prototype.buildLegendElementsForTools=
function(){return k(this,void 0,void 0,function(){var b,a=this;return t(this,function(c){switch(c.label){case 0:b=this.layer;if("esri.layers.WMTSLayer"!==b.declaredClass)return[3,1];this._constructLegendElementsForWMTSlayer();return[3,6];case 1:if("esri.layers.WMSLayer"!==b.declaredClass)return[3,2];this._constructLegendElementsForWMSSublayers();return[3,6];case 2:return"esri.layers.MapImageLayer"!==b.declaredClass?[3,4]:[4,this._constructLegendElementsForSublayers()];case 3:return c.sent(),[3,6];
case 4:return this._handles.remove("imageryLayers-watcher"),[4,this._getLegendLayers().then(function(c){a.legendElements=[];c.forEach(function(c){if("esri.layers.ImageryLayer"===a.layer.declaredClass){var d=b.watch("renderingRule, bandIds",function(){a._legendResponse["default"]=null;a.buildLegendElementsForTools()});a._handles.add(d,"imageryLayers-watcher")}(c=a._generateSymbolTableElementForLegendLayer(c))&&c.infos.length&&a.legendElements.push(c);a.notifyChange("ready")});a.notifyChange("ready")}).catch(function(b){G.warn("Request to server for legend has failed!",
b)})];case 5:c.sent(),c.label=6;case 6:return[2]}})})};e.prototype._isGroupActive=function(){var b=this.children;return b.length?b.some(function(b){return b.ready}):!1};e.prototype._isScaleDrivenSizeVariable=function(b){if(b&&"size"!==b.type)return!1;var a=b.minSize,c=b.maxSize;return"object"===typeof a&&a?this._isScaleDrivenSizeVariable(a):"object"===typeof c&&c?this._isScaleDrivenSizeVariable(c):!!b.expression||Q.test(b.valueExpression)};e.prototype._buildRendererLegendElements=function(b,a,c){var d=
this;this._getRendererLegendElements(b,a).then(function(b){"append"===c?Array.prototype.push.apply(d.legendElements,b):d.legendElements=b;d.notifyChange("ready")}).catch(function(b){G.warn("error while building legend for layer!",b)})};e.prototype._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");var b=this.layer,a=b.activeLayer;this._handles.add(F.watch(this.layer,"activeLayer",this._constructLegendElementsForWMTSlayer.bind(this)),
"wmts-activeLayer-watcher");if(a.styleId&&a.styles){var c=null;a.styles.some(function(b){if(a.styleId===b.id)return c=b.legendUrl,!0});c&&(this.legendElements=[{type:"symbol-table",title:a.title,infos:[{src:c,opacity:b.opacity}]}])}this.notifyChange("ready")};e.prototype._constructLegendElementsForWMSSublayers=function(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");var b=this.layer,a=null;if(b.customParameters||b.customLayerParameters)a=f({},b.customParameters,b.customLayerParameters);
this._handles.add(F.watch(this.layer,"sublayers",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");this.legendElements=this._generateLegendElementsForWMSSublayers(b.sublayers,a);this.notifyChange("ready")};e.prototype._generateLegendElementsForWMSSublayers=function(b,a){var c=this,d=[];this._handles.add(b.on("change",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");b.forEach(function(b){var H=b.watch("title, visible, legendEnabled",
function(){return c._constructLegendElementsForWMSSublayers()});c._handles.add(H,"wms-sublayers-watcher");b.visible&&b.legendEnabled&&(b=c._generateSymbolTableElementForWMSSublayer(b,a))&&b.infos.length&&d.unshift(b)});return d};e.prototype._generateSymbolTableElementForWMSSublayer=function(b,a){return!b.legendUrl&&b.sublayers?(a=this._generateLegendElementsForWMSSublayers(b.sublayers,a).filter(function(b){return b}),{type:"symbol-table",title:b.title,infos:a}):this._generateSymbolTableElementForLegendUrl(b,
a)};e.prototype._generateSymbolTableElementForLegendUrl=function(b,a){var c=b.legendUrl;if(c){var d={type:"symbol-table",title:b.title||b.name||b.id&&b.id+"",infos:[]};a&&(c+="?"+z.objectToQuery(a));d.infos.push({src:c,opacity:b.layer&&b.layer.opacity});return d}};e.prototype._getLegendLayers=function(b){var a=this,d=(b=b&&b.hasDynamicLayers?b.dynamicLayers:null)||"default",H=this._legendResponse&&this._legendResponse[d];return H?c.resolve(H):this._legendRequest(b).then(function(b){b=b.layers;return a._legendResponse[d]=
b})};e.prototype._legendRequest=function(b){var a=this.layer;b={f:"json",dynamicLayers:b};"esri.layers.ImageryLayer"===a.declaredClass&&("renderingRule"in a&&a.renderingRule&&(b.renderingRule=JSON.stringify(a.renderingRule.toJSON())),"bandIds"in a&&a.bandIds&&(b.bandIds=a.bandIds.join()));var c=a.url.replace(/(\/)+$/,"");"version"in a&&10.01<=a.version?(a=c.indexOf("?"),c=-1<a?c.substring(0,a)+"/legend"+c.substring(a):c+"/legend"):(a=c.toLowerCase().indexOf("/rest/"),c=c.substring(0,a)+c.substring(a+
5,c.length),c="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(c)+"\x26returnbytes\x3dtrue");return n(c,{query:b}).then(function(b){return b.data})};e.prototype._constructLegendElementsForSublayers=function(){var b=this;this.legendElements=[];this._handles.remove("sublayers-watcher");var a=this.layer,c=new p.ExportImageParameters({layer:a});return this._getLegendLayers(c).then(function(c){var d={};c.forEach(function(b){d[b.layerId]=b});b._handles.add(F.watch(a,"sublayers",b._constructLegendElementsForSublayers.bind(b)),
"sublayers-watcher");b.legendElements=b._generateLegendElementsForSublayers(a.sublayers,d,a.opacity);b.notifyChange("ready")}).catch(function(b){G.warn("Request to server for legend has failed!",b)}).then(function(){return c.destroy()})};e.prototype._generateLegendElementsForSublayers=function(b,a,c){var d=this,h=[];this._handles.add(b.on("change",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher");b.forEach(function(b){var H=b.watch("renderer, opacity, title, visible",function(){return d._constructLegendElementsForSublayers()});
d._handles.add(H,"sublayers-watcher");b.visible&&b.legendEnabled&&(H=b&&null!=b.opacity?b.opacity:null,(b=d._generateSymbolTableElementForSublayer(b,a,null!=H?H*c:c))&&b.infos.length&&h.unshift(b))});return h};e.prototype._generateSymbolTableElementForSublayer=function(b,a,c){var d=a[b.id];return!d&&b.sublayers?(a=this._generateLegendElementsForSublayers(b.sublayers,a,c).filter(function(b){return b}),{type:"symbol-table",title:b.title,infos:a}):this._generateSymbolTableElementForLegendLayer(d,b,c)};
e.prototype._generateSymbolTableElementForLegendLayer=function(b,a,c){var d=this;if(b){var h=a&&a.renderer,e=a&&a.title||b.layerName;h&&(h=a&&a.title||this._getRendererTitle(h,a))&&(e&&(h.title=e),e=h);e={type:"symbol-table",title:e,infos:[]};b.legendType&&(e.legendType=b.legendType);b.legend&&this._isLegendLayerInScale(b,a)&&(a=a?this._sanitizeLegendForSublayer(b.legend.slice(),a):b.legend,e.infos=a.map(function(a){var h=a.url;if(a.imageData&&0<a.imageData.length)h="data:image/png;base64,"+a.imageData;
else if(0!==h.indexOf("http"))h=z.addTokenParameter(d.layer.url+"/"+b.layerId+"/images/"+h);else return null;return{label:a.label,src:h,opacity:c,width:a.width,height:a.height}}).filter(function(b){return!!b}));return e.infos.length?e:null}};e.prototype._isLegendLayerInScale=function(b,a){a=a||this.layer;var c=null,d=null,h=!0;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0===b.minScale&&a.tileInfo&&(c=a.tileInfo.lods[0].scale),0===b.maxScale&&a.tileInfo&&(d=a.tileInfo.lods[a.tileInfo.lods.length-
1].scale)):(c=Math.min(a.minScale,b.minScale)||a.minScale||b.minScale,d=Math.max(a.maxScale,b.maxScale));if(0<c&&c<this.scale||d>this.scale)h=!1;return h};e.prototype._sanitizeLegendForSublayer=function(b,a){if("version"in this.layer&&10.1>this.layer.version||0===b.length)return b;a=a.renderer;var c=null,d=null;b.some(function(b){return b.values})&&b.some(function(b,a){b.values||(c=a,d=b,d.label||(d.label="others"));return null!=d});a?"unique-value"===a.type?d&&(b.splice(c,1),b.push(d)):"class-breaks"===
a.type&&(d&&b.splice(c,1),b.reverse(),d&&b.push(d)):d&&(b.splice(c,1),b.push(d));return b};e.prototype._getRendererLegendElements=function(b,a){return k(this,void 0,void 0,function(){return t(this,function(c){return K(b)||I(b)||S(b)||L(b)||J(b)||P(b)||M(b)||"esri.renderers.DotDensityRenderer"===b.declaredClass?J(b)||P(b)||M(b)||"esri.renderers.PointCloudRGBRenderer"===b.declaredClass?[2,this._constructPointCloudRendererLegendElements(b,a)]:"dot-density"===b.type?[2,this._constructDotDensityRendererLegendElements(b)]:
[2,this._constructRendererLegendElements(b,a)]:(G.warn("Renderer not supported!"),[2,[]])})})};e.prototype._getPointCloudRendererTitle=function(b){return b.legendOptions&&b.legendOptions.title||b.field};e.prototype._constructPointCloudRendererLegendElements=function(b,a){var d=this,h=[],e=null,q=null;if(J(b))e={type:"symbol-table",title:a||this._getPointCloudRendererTitle(b),infos:[]},b.colorClassBreakInfos.forEach(function(b){e.infos.unshift({label:b.label||b.minValue+" - "+b.maxValue,value:[b.minValue,
b.maxValue],symbol:d._getAppliedCloneSymbol(N,b.color)})});else if(P(b)){var q=b.stops,r=null;if(q.length&&(1===q.length&&(r=q[0].color),!r)){var p=q[0].value,k=q[q.length-1].value;null!=p&&null!=k&&(r=D.getColorFromPointCloudStops(p+(k-p)/2,q))}e={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(N,r||N.color)}]};q={type:"color-ramp",title:a||this._getPointCloudRendererTitle(b),borderColor:x.getStroke(N).color,overlayColor:D.getRampOverlayColor(this.layer.opacity),
infos:D.getRampStopsForPointCloud(b.stops)}}else M(b)&&(e={type:"symbol-table",title:a||this._getPointCloudRendererTitle(b),infos:[]},b.colorUniqueValueInfos.forEach(function(b){e.infos.push({label:b.label||b.values.join(", "),value:b.values.join(", "),symbol:d._getAppliedCloneSymbol(N,b.color)})}));e&&e.infos.length&&h.push(e);q&&q.infos.length&&h.push(q);b=h.reduce(function(b,a){return b.concat(a.infos)},[]).filter(function(b){return!!b.symbol}).map(function(b){return d._getSymbolPreview(b)});return c.eachAlways(b).then(function(){return h})};
e.prototype._getElementInfoForDotDensity=function(b,a){var c=b.outline,c=b.dotSize+"-"+a+"-"+b.backgroundColor+"-"+(c&&JSON.stringify(c.toJSON())),d=this._dotDensityUrlCache;b=d.has(c)?d.get(c):E.renderDotDensityPreview(b,a);d.set(c,b);return{opacity:1,src:b.src,preview:b,width:b.width,height:b.height}};e.prototype._constructDotDensityRendererLegendElements=function(b){var a=this,d=b.calculateDotValue(this.view.scale),h={type:"symbol-table",title:{value:d&&Math.round(d),unit:b.legendOptions&&b.legendOptions.unit||
""},infos:[]};b.attributes.forEach(function(c){var d=a._getElementInfoForDotDensity(b,c.color);d.label=c.label||c.valueExpressionTitle||c.field;h.infos.push(d)});return c.resolve([h])};e.prototype._constructRendererLegendElements=function(b,a){return k(this,void 0,void 0,function(){var d,h,e,q,r,p,k,f,x,z,H,w,g,J,n,F,E,u,y,B,m,Z,D,l,v,P,O,M=this;return t(this,function(t){switch(t.label){case 0:return[4,this._loadRenderer(b)];case 1:return d=t.sent(),this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=
!1,[4,this._getVisualVariableLegendElements(d)];case 2:h=t.sent()||[];e={type:"symbol-table",title:a||this._getRendererTitle(d),infos:[]};q=null;r=!1;if(L(d))h.push({type:"heatmap-ramp",title:a,infos:C.getHeatmapRampStops(d)});else if(S(d)){if(k=(p=d&&d.authoringInfo)&&"relationship"===p.type){if(f=p.focus,x=p.numClasses,z=p.field1,H=p.field2,x&&z&&H){w=this.layer;g=[z,H];J=R.getRotationAngleForFocus(f)||0;n=0;for(F=g;n<F.length;n++)E=F[n],u=E.field,y=E.normalizationField,B={field:this._getFieldAlias(u,
w),normField:y&&this._getFieldAlias(y,w)},m=V.clone(),m.angle=J,e.infos.push({label:B,symbol:m}),J+=90;Z=R.getRelationshipRampElement({focus:f,numClasses:x,infos:d.uniqueValueInfos});h.unshift(Z)}}else D=d.field,d.uniqueValueInfos.forEach(function(b){b.symbol&&e.infos.push({label:b.label||M._getDomainName(D,b.value)||b.value,value:b.value,symbol:b.symbol})});d.defaultSymbol&&(e.infos.push({label:d.defaultLabel||"others",symbol:d.defaultSymbol}),r=!0)}else if(I(d)){q=this._isUnclassedRenderer(d);if(l=
!q||!this._hasSizeRamp)d.classBreakInfos.forEach(function(b){b.symbol&&e.infos.unshift({label:b.label||(q?null:b.minValue+" - "+b.maxValue),value:[b.minValue,b.maxValue],symbol:b.symbol})}),q&&(e.title=null),this._updateInfosforClassedSizeRenderer(d,e.infos);d.defaultSymbol&&!q&&(e.infos.push({label:d.defaultLabel||"others",symbol:d.defaultSymbol}),r=!0)}else K(d)&&d.symbol&&!this._hasSizeRamp&&e.infos.push({label:d.label,symbol:d.symbol});v=d.defaultSymbol;!v||r||K(d)||q&&!this._hasColorRamp&&!this._hasSizeRamp&&
!this._hasOpacityRamp||h.push({type:"symbol-table",infos:[{label:d.defaultLabel||"others",symbol:v}]});e.infos.length&&h.unshift(e);P=this._getSymbolConfig("visualVariables"in d&&d.visualVariables);O=h.reduce(function(b,a){return b.concat(a.infos)},[]).filter(function(b){return!(!b||!b.symbol)}).map(function(b){return M._getSymbolPreview(b,P)});d=null;return[4,c.eachAlways(O)];case 3:return t.sent(),[2,h]}})})};e.prototype._updateInfosforClassedSizeRenderer=function(b,a){var c=b.authoringInfo&&"class-breaks-size"===
b.authoringInfo.type,d=b.classBreakInfos.some(function(b){return B.isVolumetricSymbol(b.symbol)});if(c&&d){var h=O.REAL_WORLD_MAX_SIZE;b=b.classBreakInfos.length;var e=(h-O.REAL_WORLD_MIN_SIZE)/(1<b?b-1:b);a.forEach(function(b,a){b.size=h-e*a})}};e.prototype._getSymbolConfig=function(b){var a=!1,c=!1;if(b)for(var d=0;d<b.length&&(!a||!c);d++){var h=b[d];"size"===h.type&&("height"===h.axis&&(a=!0),"width-and-depth"===h.axis&&(c=!0))}return a&&c?"tall":null};e.prototype._getSymbolPreview=function(b,
a){return E.renderPreviewHTML(b.symbol,{size:b.size,opacity:this.layer.opacity,symbolConfig:a,rotation:b.symbol.angle}).then(function(a){b.preview=a;return b}).catch(function(){b.preview=null;return b})};e.prototype._loadRenderer=function(b){return k(this,void 0,void 0,function(){var a,d,h,e,q=this;return t(this,function(r){switch(r.label){case 0:return a=[],b=b.clone(),[4,this._getMedianColor(b)];case 1:d=r.sent();if(I(b)||S(b))h=b.classBreakInfos||b.uniqueValueInfos,e=h.map(function(b){return q._fetchSymbol(b.symbol,
d).then(function(a){b.symbol=a}).catch(function(){b.symbol=null})}),Array.prototype.push.apply(a,e);a.push(this._fetchSymbol(b.symbol||b.defaultSymbol,b.defaultSymbol?null:d).then(function(a){q._applySymbolToRenderer(b,a,K(b))}).catch(function(){q._applySymbolToRenderer(b,null,K(b))}));return[2,c.eachAlways(a).then(function(){return b})]}})})};e.prototype._applySymbolToRenderer=function(b,a,c){c?b.symbol=a:b.defaultSymbol=a};e.prototype._getMedianColor=function(b){return k(this,void 0,void 0,function(){var a,
c,d,h,e;return t(this,function(q){switch(q.label){case 0:if(!("visualVariables"in b&&b.visualVariables))return[2,null];a=y.find(b.visualVariables,function(b){return"color"===b.type});if(!a)return[2,null];d=c=null;if(a.stops){if(1===a.stops.length)return[2,a.stops[0].color];c=a.stops[0].value;d=a.stops[a.stops.length-1].value}h=c+(d-c)/2;return[4,new Promise(function(b,a){A(["../../../renderers/visualVariables/support/visualVariableUtils"],b,a)})];case 1:return e=q.sent().getColor,[2,e(a,h)]}})})};
e.prototype._fetchSymbol=function(b,a){var d=this;if(!b)return c.reject();if("web-style"===b.type){var h=b.portal,h=b.name+"-"+b.styleName+"-"+b.styleUrl+"-"+(h&&h.url)+"-"+(h&&h.user&&h.user.username),e=this._webStyleSymbolCache;e.has(h)||e.set(h,b.fetchSymbol());return e.get(h).then(function(b){return d._getAppliedCloneSymbol(b,a)}).catch(function(){G.warn("Fetching web-style failed!");return c.reject()})}return c.resolve(this._getAppliedCloneSymbol(b,a))};e.prototype._getAppliedCloneSymbol=function(b,
a){if(!b)return b;b=b.clone();var c=-1<b.type.indexOf("3d");a=a&&a.toRgba();c?this._applyColorTo3dSymbol(b,a):b.color&&(b.color=new m(a||b.color));return b};e.prototype._applyColorTo3dSymbol=function(b,a){a&&b.symbolLayers.forEach(function(b){b&&(b.material||(b.material={}),b.material.color=new m(a))})};e.prototype._getVisualVariableLegendElements=function(a){return k(this,void 0,void 0,function(){var d,h,e,r,p,f,x,z,L,w,g,J=this;return t(this,function(n){switch(n.label){case 0:if(!("visualVariables"in
a&&a.visualVariables))return[2,null];d=a.visualVariables;h=[];e=[];r=[];p=this.layer;f=p.opacity;d.forEach(function(b){"color"===b.type?h.push(b):"size"===b.type?e.push(b):"opacity"===b.type&&r.push(b)});x=h.concat(e,r);0===h.length&&I(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&(z=(w=a.classBreakInfos[0])&&w.symbol);0===h.length&&K(a)&&(z=a.symbol);z&&(-1<z.type.indexOf("3d")?(g=z.symbolLayers.getItemAt(0),"water"===g.type?b.isSome(g.color)&&(L=g.color):b.isSome(g.material)&&b.isSome(g.material.color)&&
(L=g.material.color)):z.url||(L=z.color),L&&(L=L.toRgba()));return[4,c.all(x.map(function(b){return k(J,void 0,void 0,function(){var c,d,h,e,r,k,z,x,g,w,J;return t(this,function(t){switch(t.label){case 0:if(b.legendOptions&&!1===b.legendOptions.showLegend)return[3,8];c=this._getRampTitle(b,p);d=D.getRampBorderColor(a);h=D.getRampOverlayColor(f);e=null;if("color"!==b.type)return[3,2];r={type:"color-ramp",title:c,borderColor:d,overlayColor:h};return[4,D.getRampStops(a,b)];case 1:return e=(r.infos=t.sent(),
r),this._hasColorRamp||(this._hasColorRamp=!(null==e.infos||!e.infos.length)),[3,7];case 2:if("size"!==b.type)return[3,5];z=(k="getField"in p&&p.getField&&p.getField(b.field))&&q.isDateField(k);x={type:"size-ramp",title:c};g=O.getRampStops;w=[a,b];return[4,this._getMedianColor(a)];case 3:return[4,g.apply(void 0,w.concat([t.sent(),this.scale,this.view,z]))];case 4:return e=(x.infos=t.sent(),x),this._hasSizeRamp||(this._hasSizeRamp=!(null==e.infos||!e.infos.length)),[3,7];case 5:if("opacity"!==b.type)return[3,
7];J={type:"opacity-ramp",title:c,borderColor:d,overlayColor:h};return[4,D.getRampStops(a,b,L)];case 6:e=(J.infos=t.sent(),J),this._hasOpacityRamp||(this._hasOpacityRamp=!(null==e.infos||!e.infos.length)),t.label=7;case 7:return[2,e.infos&&e];case 8:return[2]}})})}))];case 1:return[2,n.sent().filter(function(b){return!!b})]}})})};e.prototype._getDomainName=function(b,a){if(b&&"function"!==typeof b){var c=this.layer;return(c=(b=c.getField&&c.getField(b))&&c.getFieldDomain?c.getFieldDomain(b.name):
null)&&c.codedValues?c.getName(a):null}return null};e.prototype._getRampTitle=function(b,a){var c=b.field,d=b.normalizationField,h=!1,e=!1,q=!1,r=null,c="function"===typeof c?null:c,d="function"===typeof d?null:d;if(null!=(b.legendOptions&&b.legendOptions.title))r=b.legendOptions.title;else if(b.valueExpressionTitle)r=b.valueExpressionTitle;else{if("renderer"in a&&a.renderer&&"authoringInfo"in a.renderer&&a.renderer.authoringInfo&&a.renderer.authoringInfo.visualVariables)for(b=a.renderer.authoringInfo.visualVariables,
r=0;r<b.length;r++){var p=b[r];if("color"===p.type){if("ratio"===p.style){h=!0;break}if("percent"===p.style){e=!0;break}if("percent-of-total"===p.style){q=!0;break}}}r={field:c&&this._getFieldAlias(c,a),normField:d&&this._getFieldAlias(d,a),ratio:h,ratioPercent:e,ratioPercentTotal:q}}return r};e.prototype._getRendererTitle=function(b,a){if(b.legendOptions&&b.legendOptions.title)return b.legendOptions.title;if(b.valueExpressionTitle)return b.valueExpressionTitle;var c=this.layer,d=b.field,h=null,e=
null;I(b)&&(h=b.normalizationField,e="percent-of-total"===b.normalizationType);d="function"===typeof d?null:d;h="function"===typeof h?null:h;b=null;if(d||h)b={field:a?d:d&&this._getFieldAlias(d,c),normField:a?h:h&&this._getFieldAlias(h,c),normByPct:e};return b};e.prototype._getFieldAlias=function(b,a){var c="popupTemplate"in a&&a.popupTemplate,c=c&&c.fieldInfos;a="function"===typeof b?null:"getField"in a&&a.getField&&a.getField(b);var d=null;c&&c.some(function(a){if(b===a.fieldName)return d=a,!0});
var c=d||a,h=null;c&&(h=d&&d.label||a&&a.alias||"name"in c&&c.name||"fieldName"in c&&c.fieldName);return h};e.prototype._isUnclassedRenderer=function(b){var a=b.visualVariables,c=!1;I(b)&&b.classBreakInfos&&1===b.classBreakInfos.length&&a&&(c=b.field?a.some(function(a){return!(!a||b.field!==a.field||(b.normalizationField||a.normalizationField)&&b.normalizationField!==a.normalizationField)}):!!a.length);return c};a([w.property()],e.prototype,"children",void 0);a([w.property()],e.prototype,"layer",
void 0);a([w.property()],e.prototype,"legendElements",void 0);a([w.property()],e.prototype,"parent",void 0);a([w.property({readOnly:!0})],e.prototype,"ready",null);a([w.property()],e.prototype,"scale",void 0);a([w.property({dependsOn:["layer.renderer?.valueExpression?","layer.renderer?.visualVariables?"],readOnly:!0})],e.prototype,"isScaleDriven",null);a([w.property()],e.prototype,"title",void 0);a([w.property({dependsOn:["ready"],readOnly:!0,value:0})],e.prototype,"version",null);a([w.property()],
e.prototype,"view",void 0);return e=a([w.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],e)}(w.declared(e))})},"esri/layers/support/ExportImageParameters":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./sublayerUtils ./timeUtils ../../views/View".split(" "),function(A,l,f,g,a,k,t,m,n,v){Object.defineProperty(l,"__esModule",{value:!0});
var e={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};A=function(k){function u(){var a=null!==k&&k.apply(this,arguments)||this;a._scale=null;a.view=null;return a}g(u,k);Object.defineProperty(u.prototype,"dynamicLayers",{get:function(){if(!this.hasDynamicLayers)return null;var a=this.visibleSublayers.map(function(a){return a.toExportImageJSON()});
return a.length?JSON.stringify(a):null},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"hasDynamicLayers",{get:function(){return m.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"layer",{set:function(a){var d=this;this._get("layer")!==a&&(this._set("layer",a),this._layerHandles&&(this._layerHandles.forEach(function(b){return b.remove()}),this._layerHandles.length=0),a&&(this._layerHandles=
[a.allSublayers.on("change",function(){return d.notifyChange("visibleSublayers")}),a.on("sublayer-update",function(b){return d.notifyChange(e[b.propertyName])})]))},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"layers",{get:function(){var a=this.visibleSublayers;return a?a.length?"show:"+a.map(function(a){return a.id}).join(","):"show:-1":null},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"layerDefs",{get:function(){var a=this.visibleSublayers.filter(function(a){return null!=
a.definitionExpression});return a.length?JSON.stringify(a.reduce(function(a,b){a[b.id]=b.definitionExpression;return a},{})):null},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(a){this.view||(this._scale=a,this.notifyChange("scale"))},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"version",{get:function(){this.layers;this.layerDefs;this.dynamicLayers;this.timeExtent;
var a=this.layer;a.dpi;a.imageFormat;a.imageTransparency;a.gdbVersion;return(this._get("version")||0)+1},set:function(a){this._set("version",a)},enumerable:!0,configurable:!0});Object.defineProperty(u.prototype,"visibleSublayers",{get:function(){var a=this,d=this.layer.sublayers,b=[],c=function(d){var e=a.scale,h=0===d.minScale||e<=d.minScale,p=0===d.maxScale||e>=d.maxScale;d.visible&&(0===e||h&&p)&&(d.sublayers?d.sublayers.forEach(c):b.unshift(d))};d&&d.forEach(c);d=this._get("visibleSublayers");
return!d||d.length!==b.length||d.some(function(a,c){return b[c]!==a})?b:d},enumerable:!0,configurable:!0});u.prototype.toJSON=function(){var a=this.layer,a={dpi:a.dpi,format:a.imageFormat,transparent:a.imageTransparency,gdbVersion:a.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?a.dynamicLayers=this.dynamicLayers:a=f({},a,{layers:this.layers,layerDefs:this.layerDefs});return a};a([t.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],u.prototype,"dynamicLayers",
null);a([t.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],u.prototype,"hasDynamicLayers",null);a([t.property()],u.prototype,"layer",null);a([t.property({readOnly:!0,dependsOn:["visibleSublayers"]})],u.prototype,"layers",null);a([t.property({readOnly:!0,dependsOn:["visibleSublayers"]})],u.prototype,"layerDefs",null);a([t.property({type:Number,dependsOn:["view.scale"]})],u.prototype,"scale",null);a([t.property(n.combinedViewLayerTimeExtentProperty)],
u.prototype,"timeExtent",void 0);a([t.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion timeExtent".split(" ")})],u.prototype,"version",null);a([t.property({type:v})],u.prototype,"view",void 0);a([t.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],u.prototype,"visibleSublayers",null);return u=a([t.subclass("esri.layers.mixins.ExportImageParameters")],u)}(t.declared(k));l.ExportImageParameters=A})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/compilerUtils ../../core/maybe ../../core/promiseUtils ./previewSymbol2D ./previewSymbol3D ./previewWebStyleSymbol ./utils".split(" "),
function(A,l,f,g,a,k,t,m,n,v,e){function y(d,b){switch(d.type){case "web-style":return v.previewWebStyleSymbol(d,y,b);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return n.previewSymbol3D(d,b);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":case "cim":return m.previewSymbol2D(d,b);default:a.neverReached(d)}}function u(a){return a&&"opacity"in a?a.opacity*u(a.parent):1}Object.defineProperty(l,"__esModule",
{value:!0});var h=null;l.renderDotDensityPreview=function(a,b,c){var d=a.backgroundColor,e=a.outline;a=a.dotSize;var k=c&&c.swatchSize||22,p=Math.round(k*k/Math.pow(a,2)*.8),q=window.devicePixelRatio;c=document.createElement("canvas");var r=k*q;c.width=r;c.height=r;c.style.width=c.width/q+"px";c.style.height=c.height/q+"px";var f=c.getContext("2d");d&&(f.fillStyle=d.toCss(!0),f.fillRect(0,0,r,r),f.fill());f.fillStyle=b.toCss(!0);if(h&&h.length/2===p)for(b=0;b<2*p;b+=2){var d=h[b],g=h[b+1];f.fillRect(d,
g,a*q,a*q);f.fill()}else for(h=[],b=0;b<2*p;b+=2)d=Math.floor(Math.random()*(r-0+1)+0),g=Math.floor(Math.random()*(r-0+1)+0),h.push(d,g),f.fillRect(d,g,a*q,a*q),f.fill();e&&(e.color&&(f.strokeStyle=e.color.toCss(!0)),f.lineWidth=e.width,f.strokeRect(0,0,r,r));e=new Image(k,k);e.src=c.toDataURL();return e};l.renderPreviewHTML=y;l.getDisplayedSymbol=function(a,b){return g(this,void 0,void 0,function(){var c,d,h,g,p,q,r,x,n,y,m,C,l,v,K,I;return f(this,function(f){switch(f.label){case 0:if(!a)return[2];
c=u(a.layer||a.sourceLayer);if(k.isSome(a.symbol))return d=a.symbol.clone(),e.applyColorToSymbol(d,null,c),[2,d];h=a.get("layer.renderer")||a.get("sourceLayer.renderer");return[4,h.getSymbolAsync(a)];case 1:g=f.sent();if(!g)return[2];g=g.clone();return!("visualVariables"in h)||"visualVariables"in h&&!h.visualVariables||"visualVariables"in h&&h.visualVariables&&!h.visualVariables.length?[2,g]:[4,t.create(function(b){return A(["../../renderers/visualVariables/support/visualVariableUtils"],b)})];case 2:p=
f.sent();q=[];r=[];x=[];n=[];y=0;for(m=h.visualVariables;y<m.length;y++)switch(C=m[y],C.type){case "color":q.push(C);break;case "opacity":r.push(C);break;case "rotation":n.push(C);break;case "size":x.push(C)}v=(l=!!q.length&&q[q.length-1])?p.getColor(l,a,b):null;I=(K=!!r.length&&r[r.length-1])?p.getOpacity(K,a,b):null;null!=c&&(I=null!=I?I*c:c);e.applyColorToSymbol(g,v,I);x.forEach(function(c){return e.applySizeToSymbol(g,p.getSize(c,a,b),c.axis)});n.forEach(function(c){return e.applyRotationToSymbol(g,
p.getRotationAngle(c,a,b),c.axis)});return[2,g]}})})}})},"esri/symbols/support/previewSymbol2D":function(){define("require exports ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils".split(" "),function(A,l,f,g,a,k,t,m){function n(a,d){var b=e.getContext("2d"),c=[];d&&(d.weight&&c.push(d.weight),d.size&&c.push(d.size+"px"),d.family&&c.push(d.family));b.font=c.join(" ");return b.measureText(a).width}function v(e){if(0===e.length)return 0;if(2<e.length){var d=
a.px2pt(1),b=parseFloat(e);switch(e.slice(-2)){case "px":return b;case "pt":return b*d;case "in":return 72*b*d;case "pc":return 12*b*d;case "mm":return b*y*d;case "cm":return b*u*d}}return parseFloat(e)}Object.defineProperty(l,"__esModule",{value:!0});var e=document.createElement("canvas"),y=7.2/2.54,u=72/2.54;l.previewSymbol2D=function(e,d){var b=d&&d.size?a.pt2px(d.size):null,c=d&&d.maxSize?a.pt2px(d.maxSize):null,h=d&&null!=d.opacity?d.opacity:null,y=d&&null!=d.rotation?d.rotation:null,w=k.getStroke(e),
p={shape:null,fill:null,stroke:w};w&&w.width&&(w.width=Math.min(w.width,80));var q=0,r=0,x=w&&w.width||0,u=!1;switch(e.type){case "simple-marker":w=e.style;r=q=b=Math.min(b||a.pt2px(e.size),c||120);switch(w){case "circle":p.shape={type:"circle",cx:0,cy:0,r:.5*b};break;case "cross":p.shape={type:"path",path:[{command:"M",values:[0,.5*r]},{command:"L",values:[q,.5*r]},{command:"M",values:[.5*q,0]},{command:"L",values:[.5*q,r]},{command:"E",values:[]}]};break;case "diamond":p.shape={type:"path",path:[{command:"M",
values:[0,.5*r]},{command:"L",values:[.5*q,0]},{command:"L",values:[q,.5*r]},{command:"L",values:[.5*q,r]},{command:"Z",values:[]}]};break;case "square":p.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[q,0]},{command:"L",values:[q,r]},{command:"L",values:[0,r]},{command:"Z",values:[]}]};break;case "triangle":p.shape={type:"path",path:[{command:"M",values:[.5*q,0]},{command:"L",values:[q,r]},{command:"L",values:[0,r]},{command:"Z",values:[]}]};break;case "x":p.shape={type:"path",
path:[{command:"M",values:[0,0]},{command:"L",values:[q,r]},{command:"M",values:[q,0]},{command:"L",values:[0,r]},{command:"E",values:[]}]};break;case "path":u=!0,p.shape={type:"path",path:e.path||""}}break;case "simple-line":x=Math.min(b||x,c||80);q=22<x?2*x:40;r=x;w.width=x;x=0;p.shape={type:"path",path:[{command:"M",values:[0,.5*r]},{command:"L",values:[q,.5*r]},{command:"E",values:[]}]};break;case "picture-fill":case "simple-fill":r=q=b=Math.min(b,c||120);u=!0;p.shape=t.shapes.fill[0];break;case "picture-marker":var c=
c||120,w=a.pt2px(e.width),B=a.pt2px(e.height),b=Math.min(b||Math.max(w,B),c),B=w/B,w=1>=B?Math.ceil(b*B):b,B=1>=B?b:Math.ceil(b/B),q=w,r=B;p.shape={type:"image",x:-Math.round(w/2),y:-Math.round(B/2),width:w,height:B,src:e.url||""};break;case "text":var w=e.text||"Aa",B=e.font,b=Math.min(b||a.pt2px(B.size),c||120),l=n(w,{weight:B.weight,size:b,family:B.family}),q=(c=/[\uE600-\uE6FF]/.test(w))?b:l,r=b,l=.25*v((B?b:0).toString());c&&(l+=5);p.shape={type:"text",text:w,x:0,y:l,align:"middle",decoration:B&&
B.decoration,rotated:e.rotated,kerning:e.kerning};p.font=B&&{size:b,style:B.style,decoration:B.decoration,weight:B.weight,family:B.family}}if(!p.shape)return g.reject(new f("symbolPreview: renderPreviewHTML2D","symbol not supported."));var q=(q||22)+x+1,r=(r||22)+x+1,C=k.getFill(e),x=e.color,b=null;C&&"pattern"===C.type&&x&&"picture-fill"!==e.type?b=k.getPatternUrlWithColor(C.src,x.toCss(!0)).then(function(b){C.src=b;p.fill=C;return p}):(p.fill=C,b=g.resolve(p));return b.then(function(b){return m.renderSymbol([[b]],
[q,r],{node:d&&d.node,scale:u,opacity:h,rotation:y})})}})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(A,l){Object.defineProperty(l,"__esModule",{value:!0});l.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",
path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",
path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},
{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};l.getPathSymbolShapes=function(f){var g=22,a=22;1>f?g*=.75:1<f&&(a*=1.25);
return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,a-11]},{command:"L",values:[g-11,a-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",values:[g-11,22]},{command:"L",values:[g-11,a-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[g-11,a-11]},{command:"L",values:[0,a-11]},{command:"L",values:[0,22]},{command:"L",values:[g-11,22]},{command:"Z",values:[]}]}]};
l.getExtrudeSymbolShapes=function(f){f*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+f]},{command:"L",values:[0,22*.7+f-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+f]},{command:"L",values:[22,f]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,
22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};l.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
l.getCubeShapes=function(f,g){var a=g?20:f,k=g?4:6,k=a=22>=a?a-.5*k:a-k;g=g?.35*a:.5*a;return[{type:"path",path:[{command:"M",values:[.5*k,0]},{command:"L",values:[k,.5*g]},{command:"L",values:[.5*k,g]},{command:"L",values:[0,.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*g]},{command:"L",values:[.5*k,g]},{command:"L",values:[.5*k,f]},{command:"L",values:[0,f-.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*k,g]},{command:"L",values:[.5*k,
f]},{command:"L",values:[k,f-.5*g]},{command:"L",values:[k,.5*g]},{command:"Z",values:[]}]}]};l.getCylinderShapes=function(f,g){var a=g?20:f;g=g?4:6;a=22>=a?a-.5*g:a-g;g=.5*a;var k=.15*a;f-=k;return[{type:"ellipse",cx:.5*a,cy:f,rx:g,ry:k},{type:"path",path:[{command:"M",values:[0,k]},{command:"L",values:[0,f]},{command:"L",values:[a,f]},{command:"L",values:[a,k]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*a,cy:k,rx:g,ry:k}]};l.getConeShapes=function(f,g){var a=g?20:f;g=g?4:6;a=22>=a?a-.5*g:a-
g;g=.15*a;var k=a;f-=g;return[{type:"ellipse",cx:.5*a,cy:f,rx:.5*a,ry:g},{type:"path",path:[{command:"M",values:[.5*k,0]},{command:"L",values:[k,f]},{command:"L",values:[0,f]},{command:"Z",values:[]}]}]};l.getInvertedConeShapes=function(f){var g=f,g=22>g?g-3:g-6,a=.15*g,k=g;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,0]},{command:"L",values:[.5*k,f-a]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*g,cy:0,rx:.5*g,ry:a}]};l.getDiamondShapes=function(f){var g=f,g=22>
g?g-2:g-4,a=Math.floor(f/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*g,0]},{command:"L",values:[g,.5*f-a]},{command:"L",values:[.45*g-a,.5*f+a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*g,0]},{command:"L",values:[.45*g-a,.5*f+a]},{command:"L",values:[0,.5*f-a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*f-a]},{command:"L",values:[.45*g-a,.5*f+a]},{command:"L",values:[.45*g,f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*g,f]},{command:"L",values:[g,.5*f-a]},{command:"L",values:[.45*g-a,.5*f+a]},{command:"Z",values:[]}]}]};l.getTetrahedronShapes=function(f){var g=f,g=22>g?g-1:g-2;return[{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[f,g]},{command:"L",values:[.45*f,.6*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[.45*f,.6*g]},{command:"L",values:[0,g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,g]},
{command:"L",values:[.45*f,.6*g]},{command:"L",values:[f,g]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports dojox/gfx dojox/gfx/matrix ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils".split(" "),function(A,l,f,g,a,k,t,m,n,v){function e(a){return a.map(function(a){return a.command+" "+a.values.join(",")}).join(" ").trim()}function y(a,d,b,c){var h=c&&c.node||document.createElement("div"),
k=f.createSurface(h,d,b);null!=c.opacity&&(h.style.opacity=c.opacity.toString());try{a.forEach(function(a){var h=k.createGroup(),q=0;a.forEach(function(b){var a=b.shape,c=b.fill,d=b.stroke;q+=d&&d.width||0;var r=null;a&&("path"===a.type&&"string"!==typeof a.path&&(a.path=e(a.path)),r=h.createShape(a).setFill(c).setStroke(d?d:{width:0}),"text"===a.type&&r.setFont(b.font))});a=d/2;var r=b/2,f=h.getBoundingBox(),z=f.width,t=f.height,w=!1;if(c.scale&&0!==f.width&&0!==f.height){var n=f.width/f.height,
w=(d>b?d:b)-2*q,u=1,y=1;isNaN(w)||(1<n?(u=w/f.width,y=w/n/f.height):(y=w/f.height,u=w*n/f.width));h.applyTransform(g.scaleAt(u,y,a,r));w=!0}n=f.x+z/2;f=f.y+t/2;h.applyTransform(g.translate(a-n,r-f));!w&&(z>d||t>b)&&(w=z/d>t/b,z=((w?d:b)-5)/(w?z:t),h.applyTransform(g.scaleAt(z,z,a,r)));c.rotation&&h.applyTransform(g.rotategAt(c.rotation,n,f))})}catch(w){return k.clear(),k.destroy(),null}return h}function u(a,d,b){return a?k(a,{responseType:"image"}).then(function(a){a=a.data;var c=a.width,e=a.height,
h=c/e,p=d;b&&(p=Math.min(p,Math.max(c,e)));return{image:a,width:1>=h?Math.ceil(p*h):p,height:1>=h?p:Math.ceil(p/h)}}):v.reject(new m("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(l,"__esModule",{value:!0});l.renderSymbol=function(a,d,b){var c=Math.ceil(d[0]);d=Math.ceil(d[1]);return a.some(function(b){return!!b.length})?y(a,c,d,b):null};l.tintImageWithColor=function(e,d,b,c,f){return u(e,d,f).then(function(h){var f=h.width?h.width:d,p=h.height?h.height:d,q;if(q=h.image)q=
b&&"ignore"!==c?"multiply"===c&&255===b.r&&255===b.g&&255===b.b&&1===b.a?!1:!0:!1;if(q){var r=h.image.width,k=h.image.height;/\.svg$/i.test(e)&&(--r,--k);var g,z;g=Math.ceil(f);z=Math.ceil(p);q=document.createElement("canvas");q.width=g;q.height=z;q.style.width=g+"px";q.style.height=z+"px";q=q.getContext("2d");q.clearRect(0,0,g,z);q.drawImage(h.image,0,0,r,k,0,0,f,p);h=q.getImageData(0,0,f,p);r=[b.r/255,b.g/255,b.b/255,b.a];k=t.toHSV(b);for(g=0;g<h.data.length;g+=4){z=h.data;var n=g,u=r,y=k;switch(c){case "multiply":z[n+
0]*=u[0];z[n+1]*=u[1];z[n+2]*=u[2];z[n+3]*=u[3];break;default:var m=t.toHSV({r:z[n+0],g:z[n+1],b:z[n+2]});m.h=y.h;m.s=y.s;m.v=m.v/100*y.v;y=t.toRGB(m);z[n+0]=y.r;z[n+1]=y.g;z[n+2]=y.b;z[n+3]*=u[3]}}q.putImageData(h,0,0);e=q.canvas.toDataURL("image/png")}else(q=a.id&&a.id.findCredential(e))&&q.token&&(h=-1===e.indexOf("?")?"?":"\x26",e=""+e+h+"token\x3d"+q.token);return{url:e,width:f,height:p}}).catch(function(){return{url:e,width:d,height:d}})}})},"dojox/gfx":function(){define(["dojo/_base/lang",
"./gfx/_base","./gfx/renderer!"],function(A,l,f){l.switchTo(f);return l})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(A,l,f,g,a,k,t,m,n){var v=l.getObject("dojox.gfx",!0),e=v._base={};v._hasClass=function(b,a){return(b=b.getAttribute("className"))&&0<=(" "+b+" ").indexOf(" "+a+" ")};v._addClass=function(b,a){var c=b.getAttribute("className")||
"";(!c||0>(" "+c+" ").indexOf(" "+a+" "))&&b.setAttribute("className",c+(c?" ":"")+a)};v._removeClass=function(b,a){var c=b.getAttribute("className");c&&b.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+a+"(\\s+|$)"),"$1$2"))};e._getFontMeasurements=function(){var b={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,d;g("ie")&&(d=a.doc.documentElement.style.fontSize||"",d||(a.doc.documentElement.style.fontSize="100%"));
var e=m.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},a.body());for(c in b)e.style.fontSize=c,b[c]=16*Math.round(12*e.offsetHeight/16)/12/1E3;g("ie")&&(a.doc.documentElement.style.fontSize=d);a.body().removeChild(e);return b};var y=null;e._getCachedFontMeasurements=function(b){if(b||!y)y=e._getFontMeasurements();return y};var u=null,h={};e._getTextBox=function(b,c,
d){var e,f,p=arguments.length,q;u||(u=m.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},a.body()));e=u;e.className="";f=e.style;f.borderWidth="0";f.margin="0";f.padding="0";f.outline="0";if(1<p&&c)for(q in c)q in h||(f[q]=c[q]);2<p&&d&&(e.className=d);e.innerHTML=b;e.getBoundingClientRect?(f=e.getBoundingClientRect(),f={l:f.left,t:f.top,w:f.width||f.right-f.left,h:f.height||f.bottom-f.top}):f=n.getMarginBox(e);e.innerHTML="";return f};e._computeTextLocation=
function(b,a,d,e){var c={};switch(b.align){case "end":c.x=b.x-a;break;case "middle":c.x=b.x-a/2;break;default:c.x=b.x}c.y=b.y-d*(e?.75:1);return c};e._computeTextBoundingBox=function(b){if(!v._base._isRendered(b))return{x:0,y:0,width:0,height:0};var a;a=b.getShape();var d=b.getFont()||v.defaultFont;b=b.getTextWidth();d=v.normalizedLength(d.size);a=e._computeTextLocation(a,b,d,!0);return{x:a.x,y:a.y,width:b,height:d}};e._isRendered=function(b){for(b=b.parent;b&&b.getParent;)b=b.parent;return null!==
b};var d=0;e._getUniqueId=function(){var b;do b=A._scopeName+"xUnique"+ ++d;while(t.byId(b));return b};e._fixMsTouchAction=function(b){b.rawNode.style.touchAction="none"};l.mixin(v,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,
y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},
{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var b={};return function(a){var c=b[a];if(c)return new c;c=b[a]=new Function;c.prototype=v["default"+a];return new c}}(),normalizeColor:function(b){return b instanceof f?b:new f(b)},normalizeParameters:function(b,a){var c;if(a){var d={};for(c in b)c in a&&!(c in d)&&(b[c]=a[c])}return b},
makeParameters:function(b,a){var c=null;if(!a)return l.delegate(b);var d={};for(c in b)c in d||(d[c]=l.clone(c in a?a[c]:b[c]));return d},formatNumber:function(b,a){var c=b.toString();if(0<=c.indexOf("e"))c=b.toFixed(4);else{var d=c.indexOf(".");0<=d&&5<c.length-d&&(c=b.toFixed(4))}return 0>b?c:a?" "+c:c},makeFontString:function(b){return b.style+" "+b.variant+" "+b.weight+" "+b.size+" "+b.family},splitFontString:function(b){var a=v.getDefault("Font");b=b.split(/\s+/);if(!(5>b.length)){a.style=b[0];
a.variant=b[1];a.weight=b[2];var d=b[3].indexOf("/");a.size=0>d?b[3]:b[3].substring(0,d);var e=4;0>d&&("/"==b[4]?e=6:"/"==b[4].charAt(0)&&(e=5));e<b.length&&(a.family=b.slice(e).join(" "))}return a},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return v._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(b){return b*v.px_in_pt()},px2pt:function(b){return b/v.px_in_pt()},normalizedLength:function(b){if(0===b.length)return 0;if(2<b.length){var a=v.px_in_pt(),d=parseFloat(b);switch(b.slice(-2)){case "px":return d;
case "pt":return d*a;case "in":return 72*d*a;case "pc":return 12*d*a;case "mm":return d*v.mm_in_pt*a;case "cm":return d*v.cm_in_pt*a}}return parseFloat(b)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(b,a){return b&&a&&b===a},switchTo:function(b){var a="string"==typeof b?v[b]:b;a&&(k.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath Surface createSurface fixTarget".split(" "),
function(b){v[b]=a[b]}),"string"==typeof b?v.renderer=b:k.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(b){return v.renderer=v[b]&&v[b].Surface===v.Surface?b:null}))}});return v})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(A,l,f,g,a){var k=null;f.add("vml",function(a,f,k){k.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';a="adj"in k.firstChild;k.innerHTML="";return a});return{load:function(t,
m,n){function v(){m(["dojox/gfx/"+e],function(a){A.renderer=e;k=a;n(a)})}if(k&&"force"!=t)n(k);else{var e=a.forceGfxRenderer;t=!e&&(l.isString(a.gfxRenderer)?a.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var y,u;!e&&t.length;)switch(t.shift()){case "svg":"SVGAngle"in g.global&&(e="svg");break;case "vml":f("vml")&&(e="vml");break;case "silverlight":try{f("ie")?(y=new ActiveXObject("AgControl.AgControl"),y.IsVersionSupported("1.0"))&&(u=!0):navigator.plugins["Silverlight Plug-In"]&&(u=
!0)}catch(h){u=!1}finally{y=null}u&&(e="silverlight");break;case "canvas":g.global.CanvasRenderingContext2D&&(e="canvas")}"canvas"===e&&!1!==a.canvasEvents&&(e="canvasWithEvents");a.isDebug&&console.log("gfx renderer \x3d "+e);"svg"==e&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(v):v()}}}})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(A,l){var f=A.matrix={},g={};f._degToRad=function(a){return g[a]||(g[a]=Math.PI*a/180)};f._radToDeg=function(a){return a/
Math.PI*180};f.Matrix2D=function(a){if(a)if("number"==typeof a)this.xx=this.yy=a;else if(a instanceof Array){if(0<a.length){for(var k=f.normalize(a[0]),g=1;g<a.length;++g){var m=k,n=f.normalize(a[g]),k=new f.Matrix2D;k.xx=m.xx*n.xx+m.xy*n.yx;k.xy=m.xx*n.xy+m.xy*n.yy;k.yx=m.yx*n.xx+m.yy*n.yx;k.yy=m.yx*n.xy+m.yy*n.yy;k.dx=m.xx*n.dx+m.xy*n.dy+m.dx;k.dy=m.yx*n.dx+m.yy*n.dy+m.dy}l.mixin(this,k)}}else l.mixin(this,a)};l.extend(f.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});l.mixin(f,{identity:new f.Matrix2D,
flipX:new f.Matrix2D({xx:-1}),flipY:new f.Matrix2D({yy:-1}),flipXY:new f.Matrix2D({xx:-1,yy:-1}),translate:function(a,k){return 1<arguments.length?new f.Matrix2D({dx:a,dy:k}):new f.Matrix2D({dx:a.x,dy:a.y})},scale:function(a,k){return 1<arguments.length?new f.Matrix2D({xx:a,yy:k}):"number"==typeof a?new f.Matrix2D({xx:a,yy:a}):new f.Matrix2D({xx:a.x,yy:a.y})},rotate:function(a){var k=Math.cos(a);a=Math.sin(a);return new f.Matrix2D({xx:k,xy:-a,yx:a,yy:k})},rotateg:function(a){return f.rotate(f._degToRad(a))},
skewX:function(a){return new f.Matrix2D({xy:Math.tan(a)})},skewXg:function(a){return f.skewX(f._degToRad(a))},skewY:function(a){return new f.Matrix2D({yx:Math.tan(a)})},skewYg:function(a){return f.skewY(f._degToRad(a))},reflect:function(a,k){1==arguments.length&&(k=a.y,a=a.x);var g=a*a,m=k*k,n=g+m,l=2*a*k/n;return new f.Matrix2D({xx:2*g/n-1,xy:l,yx:l,yy:2*m/n-1})},project:function(a,k){1==arguments.length&&(k=a.y,a=a.x);var g=a*a,m=k*k,n=g+m,l=a*k/n;return new f.Matrix2D({xx:g/n,xy:l,yx:l,yy:m/n})},
normalize:function(a){return a instanceof f.Matrix2D?a:new f.Matrix2D(a)},isIdentity:function(a){return 1==a.xx&&0==a.xy&&0==a.yx&&1==a.yy&&0==a.dx&&0==a.dy},clone:function(a){var k=new f.Matrix2D,g;for(g in a)"number"==typeof a[g]&&"number"==typeof k[g]&&k[g]!=a[g]&&(k[g]=a[g]);return k},invert:function(a){a=f.normalize(a);var k=a.xx*a.yy-a.xy*a.yx;return a=new f.Matrix2D({xx:a.yy/k,xy:-a.xy/k,yx:-a.yx/k,yy:a.xx/k,dx:(a.xy*a.dy-a.yy*a.dx)/k,dy:(a.yx*a.dx-a.xx*a.dy)/k})},_multiplyPoint:function(a,
f,g){return{x:a.xx*f+a.xy*g+a.dx,y:a.yx*f+a.yy*g+a.dy}},multiplyPoint:function(a,k,g){a=f.normalize(a);return"number"==typeof k&&"number"==typeof g?f._multiplyPoint(a,k,g):f._multiplyPoint(a,k.x,k.y)},multiplyRectangle:function(a,k){var g=f.normalize(a);k=k||{x:0,y:0,width:0,height:0};if(f.isIdentity(g))return{x:k.x,y:k.y,width:k.width,height:k.height};a=f.multiplyPoint(g,k.x,k.y);var m=f.multiplyPoint(g,k.x,k.y+k.height),n=f.multiplyPoint(g,k.x+k.width,k.y);k=f.multiplyPoint(g,k.x+k.width,k.y+k.height);
var g=Math.min(a.x,m.x,n.x,k.x),l=Math.min(a.y,m.y,n.y,k.y);return{x:g,y:l,width:Math.max(a.x,m.x,n.x,k.x)-g,height:Math.max(a.y,m.y,n.y,k.y)-l}},multiply:function(a){for(var k=f.normalize(a),g=1;g<arguments.length;++g){var m=k,n=f.normalize(arguments[g]),k=new f.Matrix2D;k.xx=m.xx*n.xx+m.xy*n.yx;k.xy=m.xx*n.xy+m.xy*n.yy;k.yx=m.yx*n.xx+m.yy*n.yx;k.yy=m.yx*n.xy+m.yy*n.yy;k.dx=m.xx*n.dx+m.xy*n.dy+m.dx;k.dy=m.yx*n.dx+m.yy*n.dy+m.dy}return k},_sandwich:function(a,g,l){return f.multiply(f.translate(g,
l),a,f.translate(-g,-l))},scaleAt:function(a,g,l,m){switch(arguments.length){case 4:return f._sandwich(f.scale(a,g),l,m);case 3:return"number"==typeof l?f._sandwich(f.scale(a),g,l):f._sandwich(f.scale(a,g),l.x,l.y)}return f._sandwich(f.scale(a),g.x,g.y)},rotateAt:function(a,g,l){return 2<arguments.length?f._sandwich(f.rotate(a),g,l):f._sandwich(f.rotate(a),g.x,g.y)},rotategAt:function(a,g,l){return 2<arguments.length?f._sandwich(f.rotateg(a),g,l):f._sandwich(f.rotateg(a),g.x,g.y)},skewXAt:function(a,
g,l){return 2<arguments.length?f._sandwich(f.skewX(a),g,l):f._sandwich(f.skewX(a),g.x,g.y)},skewXgAt:function(a,g,l){return 2<arguments.length?f._sandwich(f.skewXg(a),g,l):f._sandwich(f.skewXg(a),g.x,g.y)},skewYAt:function(a,g,l){return 2<arguments.length?f._sandwich(f.skewY(a),g,l):f._sandwich(f.skewY(a),g.x,g.y)},skewYgAt:function(a,g,l){return 2<arguments.length?f._sandwich(f.skewYg(a),g,l):f._sandwich(f.skewYg(a),g.x,g.y)}});A.Matrix2D=f.Matrix2D;return f})},"esri/core/colorUtils":function(){define(["require",
"exports"],function(A,l){function f(a,g){var e=[],h,d;if(a[0].length!==g.length)throw"dimensions do not match";var b=a.length,c=a[0].length,f=0;for(h=0;h<b;h++){for(d=f=0;d<c;d++)f+=a[h][d]*g[d];e.push(f)}return e}function g(a){a=[a.r/255,a.g/255,a.b/255].map(function(a){return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)});a=f(n,a);return{x:100*a[0],y:100*a[1],z:100*a[2]}}function a(a){a=f(v,[a.x/100,a.y/100,a.z/100]).map(function(a){return Math.min(1,Math.max(.0031308>=a?12.92*a:1.055*Math.pow(a,
1/2.4)-.055,0))});return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function k(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(function(a){return a>Math.pow(6/29,3)?Math.pow(a,1/3):1/3*Math.pow(29/6,2)*a+4/29});return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function t(a){var e=a.l;a=[(e+16)/116+a.a/500,(e+16)/116,(e+16)/116-a.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function m(e){if("r"in
e&&"g"in e&&"b"in e)return e;if("l"in e&&"c"in e&&"h"in e){var g=e.c,f=e.h;return a(t({l:e.l,a:g*Math.cos(f),b:g*Math.sin(f)}))}if("l"in e&&"a"in e&&"b"in e)return a(t(e));if("x"in e&&"y"in e&&"z"in e)return a(e);if("h"in e&&"s"in e&&"v"in e){f=(e.h+360)%360/60;g=e.v/100*255;e=e.s/100*g;var h=e*(1-Math.abs(f%2-1));switch(Math.floor(f)){case 0:f={r:e,g:h,b:0};break;case 1:f={r:h,g:e,b:0};break;case 2:f={r:0,g:e,b:h};break;case 3:f={r:0,g:h,b:e};break;case 4:f={r:h,g:0,b:e};break;case 5:case 6:f={r:e,
g:0,b:h};break;default:f={r:0,g:0,b:0}}f.r=Math.round(f.r+g-e);f.g=Math.round(f.g+g-e);f.b=Math.round(f.b+g-e);return f}}Object.defineProperty(l,"__esModule",{value:!0});var n=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],v=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];l.toRGB=m;l.toHSV=function(a){if("h"in a&&"s"in a&&"v"in a)return a;var e=m(a);a=e.r;var f=e.g,e=e.b,h=Math.max(a,f,e),d=h-Math.min(a,f,e),b;0===d?b=0:h===a?b=(f-e)/d%6:h===f?b=(e-a)/d+2:h===e&&
(b=(a-f)/d+4);0>b&&(b+=6);return{h:60*b,s:100*(0===d?0:d/h),v:100/255*h}};l.toLAB=function(a){return"l"in a&&"a"in a&&"b"in a?a:k(g(m(a)))};l.toLCH=function(a){if(!("l"in a&&"c"in a&&"h"in a)){var e=k(g(m(a)));a=e.l;var f=e.a,h=e.b,e=Math.sqrt(f*f+h*h),f=Math.atan2(h,f),f=0<f?f:f+2*Math.PI;a={l:a,c:e,h:f}}return a};l.toXYZ=function(a){return"x"in a&&"y"in a&&"z"in a?a:g(m(a))}})},"esri/symbols/support/previewSymbol3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/colorUtils ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),
function(A,l,f,g,a,k,t,m,n,v,e,y,u,h,d,b,c){function z(a){var b=a.outline,c=m.isSome(a.material)?a.material.color:null,c=m.isSome(c)?c.toRgba().toString():null;if(m.isNone(b))return"fill"===a.type&&"255,255,255,1"===c?{color:"#bdc3c7",width:.75}:null;a=v.pt2px(b.size)||0;return{color:"rgba("+(m.isSome(b.color)?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function F(a,d){var e=d&&d.resource,e=e&&e.href;return a.thumbnail&&a.thumbnail.url?n.resolve(a.thumbnail.url):e&&"object"!==d.type?
n.resolve(c.getIconHref(a,d)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?b.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(function(a){return a}).then(function(a){return a&&a.thumbnail&&a.thumbnail.url||I}):n.resolve(I)}function w(a,b){void 0===b&&(b=1);var c=a.a;a=g.toHSV(a);b=g.toRGB({h:a.h,s:a.s/b,v:100-(100-a.v)/b});return[b.r,b.g,b.b,c]}function p(a,b){return Math.round(Math.min(Math.max(a+191.25*b,0),255))}function q(a){return"water"===
a.type?m.isNone(a.color)?null:a.color:m.isNone(a.material)||m.isNone(a.material.color)?null:a.material.color}function r(a,b){void 0===b&&(b=0);a=q(a);if(!a)return b=p(e.defaultThematicColor.r,b),[b,b,b,100];a=a.toRgba();for(var c=0;3>c;c++)a[c]=p(a[c],b);return a}function x(a){return a.outline?z(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function E(a,b){a=q(a);if(!a)return null;var c;c="rgba("+(p(a.r,b)+",");c+=p(a.g,b)+",";c+=p(a.b,b)+",";return c+a.a+");"}function B(a,b){b=E(a,b);if(!b)return{};a=
Math.min(a.size?v.pt2px(a.size):.75,80);return{color:b,width:a}}function D(a,b,c){c*=.75;return{type:"linear",x1:c?.25*c:0,y1:c?.5*c:0,x2:c||4,y2:c?.5*c:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}function C(a){var b=a.depth,c=a.height;return(a=a.width)&&b&&c&&a===b&&a<c}function R(b,c,d){var e=[];if(!b)return e;switch(b.type){case "icon":var f=b.resource&&b.resource.primitive||y.defaultPrimitive;switch(f){case "circle":e.push({shape:{type:"circle",cx:0,cy:0,r:.5*c},fill:r(b,0),stroke:z(b)});
break;case "square":e.push({shape:{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[0,0]},{command:"L",values:[c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:r(b,0),stroke:z(b)});break;case "triangle":e.push({shape:{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,c]},{command:"Z",values:[]}]},fill:r(b,0),stroke:z(b)});break;case "cross":e.push({shape:{type:"path",path:[{command:"M",values:[.5*c,0]},{command:"L",values:[.5*
c,c]},{command:"M",values:[0,.5*c]},{command:"L",values:[c,.5*c]},{command:"E",values:[]}]},stroke:x(b)});break;case "x":e.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[c,c]},{command:"M",values:[c,0]},{command:"L",values:[0,c]},{command:"E",values:[]}]},stroke:x(b)});break;case "kite":e.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[.5*c,0]},{command:"L",values:[c,.5*c]},{command:"L",values:[.5*c,c]},{command:"Z",values:[]}]},fill:r(b,
0),stroke:z(b)});break;default:a.neverReached(f)}break;case "object":switch(f=b.resource&&b.resource.primitive||u.defaultPrimitive,f){case "cone":f=r(b,0);b=r(b,-.6);b=D(f,b,d?20:c);c=h.getConeShapes(c,d);e.push({shape:c[0],fill:b});e.push({shape:c[1],fill:b});break;case "inverted-cone":d=r(b,0);b=r(b,-.6);b=D(d,b,c);c=h.getInvertedConeShapes(c);e.push({shape:c[0],fill:b});e.push({shape:c[1],fill:d});break;case "cube":c=h.getCubeShapes(c,d);e.push({shape:c[0],fill:r(b,0)});e.push({shape:c[1],fill:r(b,
-.3)});e.push({shape:c[2],fill:r(b,-.5)});break;case "cylinder":var f=r(b,0),g=r(b,-.6),f=D(f,g,d?20:c);c=h.getCylinderShapes(c,d);e.push({shape:c[0],fill:f});e.push({shape:c[1],fill:f});e.push({shape:c[2],fill:r(b,0)});break;case "diamond":c=h.getDiamondShapes(c);e.push({shape:c[0],fill:r(b,-.3)});e.push({shape:c[1],fill:r(b,0)});e.push({shape:c[2],fill:r(b,-.3)});e.push({shape:c[3],fill:r(b,-.7)});break;case "sphere":d=r(b,0);b=r(b,-.6);b=D(d,b);b.x1=0;b.y1=0;b.x2=.25*c;b.y2=.25*c;e.push({shape:{type:"circle",
cx:0,cy:0,r:.5*c},fill:b});break;case "tetrahedron":c=h.getTetrahedronShapes(c);e.push({shape:c[0],fill:r(b,-.3)});e.push({shape:c[1],fill:r(b,0)});e.push({shape:c[2],fill:r(b,-.6)});break;default:a.neverReached(f)}}return e}function O(b,a){var c=a&&a.size?v.pt2px(a.size):null,e=a&&a.maxSize?v.pt2px(a.maxSize):null,f=a&&a.disableUpsampling,h=b.symbolLayers,g=[],q=0,r=0,p=h.getItemAt(h.length-1),k;p&&"icon"===p.type&&(k=p.size&&v.pt2px(p.size));h.forEach(function(h,p){if("icon"===h.type||"object"===
h.type){p="icon"===h.type?h.size&&v.pt2px(h.size):0;var x=c||p?Math.ceil(Math.min(c||p,e||120)):22,l="icon"===h.type?z(h):null,w=l?l.width:0;h&&h.resource&&h.resource.href?(p=F(b,h).then(function(b){var a=h.get("material.color"),c;c="icon"===h.type?"multiply":"tint";return d.tintImageWithColor(b,x,a,c,f)}).then(function(b){var a=b.width,c=b.height;q=Math.max(q,a+w+1);r=Math.max(r,c+w+1);return[{shape:{type:"image",x:0,y:0,width:a,height:c,src:b.url},fill:null,stroke:null}]}),g.unshift(p)):(l=x,"icon"===
h.type&&k&&c&&(l=p/k*x),p=a&&"tall"===a.symbolConfig||("object"===h.type?C(h):!1),q=Math.max(q,p?20:l+w+1),r=Math.max(r,l+w+1),g.unshift(n.resolve(R(h,l,p))))}});return n.eachAlways(g).then(function(b){var c=[];b.forEach(function(b){b.value?c.push(b.value):b.error&&S.warn("error while building swatchInfo!",b.error)});return d.renderSymbol(c,[q,r],{node:a&&a.node,scale:!1,opacity:a&&a.opacity})})}function K(b,a){var e=b.symbolLayers,g=[];b=c.isVolumetricSymbol(b);var q=a&&a.size?v.pt2px(a.size):null,
p=(a&&a.maxSize?v.pt2px(a.maxSize):null)||80,k=0,x=0,l;e.forEach(function(b,a){if(b&&("line"===b.type||"path"===b.type)){var c=[];switch(b.type){case "line":var d=B(b,0),e=d&&d.width||0;0===a&&(l=e);var n=Math.min(q||e,p);a=0===a?n:q?e/l*n:n;x=Math.max(x,a);k=Math.max(k,22<a?a+1:40);d.width=a;c.push({shape:{type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[k,.5*x]},{command:"E",values:[]}]},stroke:d});break;case "path":a=Math.min(q||22,p);e=r(b,0);n=r(b,-.2);d=(d=E(b,-.4))?{color:d,
width:1}:{};if("quad"===b.profile){var w=b.width||b.size;b=b.height||b.size;b=h.getPathSymbolShapes(w&&b?w/b:1);w=f({},d,{join:"bevel"});c.push({shape:b[0],fill:n,stroke:w});c.push({shape:b[1],fill:n,stroke:w});c.push({shape:b[2],fill:e,stroke:w})}else c.push({shape:h.shapes.pathSymbol3DLayer[0],fill:n,stroke:d}),c.push({shape:h.shapes.pathSymbol3DLayer[1],fill:e,stroke:d});k=x=Math.max(x,a+(d.width||0)+1)}g.push(c)}});return n.resolve(d.renderSymbol(g,[k,x],{node:a&&a.node,scale:b,opacity:a&&a.opacity}))}
Object.defineProperty(l,"__esModule",{value:!0});var I=A.toUrl("../../images/Legend/legend3dsymboldefault.png"),S=t.getLogger("esri.symbols.support.previewSymbol3D");l.getSymbolLayerFill=r;l.previewSymbol3D=function(b,a){if(0===b.symbolLayers.length)return n.reject(new k("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var c=null;switch(b.type){case "point-3d":c=O(b,a);break;case "line-3d":c=K(b,a);break;case "polygon-3d":case "mesh-3d":c="mesh-3d"===b.type;b=b.symbolLayers;
for(var e=a&&a.size?v.pt2px(a.size):null,g=a&&a.maxSize?v.pt2px(a.maxSize):null,e=e||22,p=[],x=0,l=0,m=!1,y=0;y<b.length;y++){var E=b.getItemAt(y),u=[];if(!c||"fill"===E.type){var C=h.shapes.fill[0];switch(E.type){case "fill":var t=z(E),m=t&&t.width||0,D=Math.min(e,g||120),x=Math.max(x,D+m),l=Math.max(l,D+m),m=!0;u.push({shape:C,fill:r(E,0),stroke:t});break;case "line":E=(t=B(E,0))&&t.width||0;C={stroke:t,shape:C};x=Math.max(x,22+E);l=Math.max(l,22+E);u.push(C);break;case "extrude":var t=f({join:"round"},
B(E,-.4)),C=r(E,0),E=r(E,-.2),D=Math.min(e,g||120),F=h.getExtrudeSymbolShapes(D);t.width=1;u.push({shape:F[0],fill:E,stroke:t});u.push({shape:F[1],fill:E,stroke:t});u.push({shape:F[2],fill:C,stroke:t});C=22*.7+.5*D;x=Math.max(x,22+t.width+1);l=Math.max(l,C+t.width+1);break;case "water":m=q(E),C=w(m),E=w(m,2),t=w(m,3),D=h.getWaterSymbolShapes(),m=!0,u.push({shape:D[0],fill:C}),u.push({shape:D[1],fill:E}),u.push({shape:D[2],fill:t}),D=Math.min(e,g||120),x=Math.max(x,D),l=Math.max(l,D)}p.push(u)}}c=
n.resolve(d.renderSymbol(p,[x,l],{node:a&&a.node,scale:m,opacity:a&&a.opacity}))}return c?c:n.reject(new k("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require","exports","../../request","../../core/screenUtils"],function(A,l,f,g){Object.defineProperty(l,"__esModule",{value:!0});l.previewWebStyleSymbol=function(a,k,l){var m=a.thumbnail&&a.thumbnail.url;return m?f(m,{responseType:"image"}).then(function(a){a=a.data;var f=
!/\\.svg$/i.test(a.src)&&l&&l.disableUpsampling,e=Math.max(a.width,a.height),k=l&&null!=l.maxSize?g.pt2px(l.maxSize):120;f&&(k=Math.min(e,k));f=Math.min(k,l&&null!=l.size?g.pt2px(l.size):e);f!==e&&(e=0!==a.width&&0!==a.height?a.width/a.height:1,1<=e?(a.width=f,a.height=f/e):(a.width=f*e,a.height=f));return l&&l.node?(l.node.appendChild(a),l.node):a}):a.fetchSymbol().then(function(a){return k(a,l)})}})},"esri/widgets/Legend/support/colorRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../core/promiseUtils ../../../renderers/support/numberUtils ../../../symbols/support/gfxUtils ./utils @dojo/framework/shim/Promise".split(" "),
function(A,l,f,g,a,k,t,m,n){function v(d,b,c){void 0===c&&(c=u);return f(this,void 0,void 0,function(){var e,f;return g(this,function(h){switch(h.label){case 0:return e=new a(c),[4,new Promise(function(a,b){A(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=h.sent().getOpacity(b,d),null!=f&&(e.a=f),[2,e]}})})}function e(d,b){d=y(d,b);var c=d.startIndex,e=d.endIndex;if(c===e)return b[c].color;b=a.blendColors(b[c].color,b[e].color,d.weight);return new a(b)}
function y(a,b){var c=0,d=b.length-1;b.some(function(b,e){if(a<b.value)return d=e,!0;c=e;return!1});return{startIndex:c,endIndex:d,weight:(a-b[c].value)/(b[d].value-b[c].value)}}Object.defineProperty(l,"__esModule",{value:!0});var u=[64,64,64],h=[255,255,255];l.getRampBorderColor=function(a){var b=null;if("simple"===a.type)b=a.symbol;else if("unique-value"===a.type||"class-breaks"===a.type)b=(a=(a=a.classBreakInfos||a.uniqueValueInfos)&&a[0])&&a.symbol;return(a=(a=b&&-1===b.type.indexOf("line-symbol")?
m.getStroke(b):null)&&a.color)&&0<a.a&&!(240<=a.r&&240<=a.g&&240<=a.b)?a:null};l.getRampOverlayColor=function(d){var b=new a(h);b.a=1-d;return b};l.getRampStops=function(a,b,c){return f(this,void 0,void 0,function(){var a,d,e,h,q,r,l,m,u=this;return g(this,function(p){switch(p.label){case 0:a=!1;d=[];e=[];b.stops&&(h=b.stops,d=h.map(function(a){return a.value}),(a=h.some(function(a){return!!a.label}))&&(e=h.map(function(a){return a.label})));q=d[0];r=d[d.length-1];if(null==q&&null==r)return[2,null];
l=r-q;return[4,k.all(d.map(function(h,r){return f(u,void 0,void 0,function(){var f,p,k;return g(this,function(g){switch(g.label){case 0:return"opacity"!==b.type?[3,2]:[4,v(h,b,c)];case 1:return p=g.sent(),[3,4];case 2:return[4,new Promise(function(a,b){A(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 3:p=g.sent().getColor(b,h),g.label=4;case 4:return f=p,k=a?e[r]:n.getLabelPrefix(r,d.length-1)+t.format(h),[2,{value:h,color:f,label:k,offset:l?1-(h-q)/l:1}]}})})}))];
case 1:return m=p.sent(),[2,m.reverse()]}})})};l.getRampStopsForPointCloud=function(a){var b=!1,c=[],d=[],c=a.map(function(a){return a.value});(b=a.some(function(a){return!!a.label}))&&(d=a.map(function(a){return a.label}));var f=c[0],h=c[c.length-1];if(null==f&&null==h)return null;var g=h-f;return c.map(function(h,r){var q=e(h,a);r=b?d[r]:n.getLabelPrefix(r,c.length-1)+t.format(h);return{value:h,color:q,label:r,offset:g?1-(h-f)/g:1}}).reverse()};l.getColorFromPointCloudStops=e})},"esri/widgets/Legend/support/utils":function(){define(["require",
"exports"],function(A,l){Object.defineProperty(l,"__esModule",{value:!0});l.getLabelPrefix=function(f,g){return 0===f?"\x3c ":f===g?"\x3e ":""}})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["require","exports","../../../renderers/support/HeatmapColorStop"],function(A,l,f){Object.defineProperty(l,"__esModule",{value:!0});l.getHeatmapRampStops=function(g){g=g.colorStops;var a=g.length-1;if(g&&g[0]){var k=g[a];k&&1!==k.ratio&&(g=g.slice(0),g.push(new f.HeatmapColorStop({ratio:1,
color:k.color})),a++)}return g.map(function(f,g){var k="";0===g?k="low":g===a&&(k="high");return{color:f.color,label:k,ratio:f.ratio,offset:1-f.ratio}}).reverse()}})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define("require exports dojox/gfx dojox/gfx/matrix ../../../symbols/support/gfxUtils ../../../symbols/support/previewSymbol3D".split(" "),function(A,l,f,g,a,k){function t(e){if(e){var d=e.type;return-1<d.indexOf("3d")?k.getSymbolLayerFill(e.symbolLayers.getItemAt(0)):"simple-line"===
d||"simple-marker"===e.type&&("x"===e.style||"cross"===e.style)?(e=a.getStroke(e))&&e.color:a.getFill(e)}}function m(a,d){var b=d.HH.label,c=d.LL.label,e=d.HL.label;d=d.LH.label;switch(a){case "HH":return{top:b,bottom:c,left:e,right:d};case "HL":return{top:e,bottom:d,left:c,right:b};case "LL":return{top:c,bottom:b,left:d,right:e};case "LH":return{top:d,bottom:e,left:b,right:c};default:return{top:b,bottom:c,left:e,right:d}}}function n(a){var d=y[a];a&&null==d&&(d=y.HH);return d||0}function v(a,d,b,
c){var e=c+"_arrowStart";c+="_arrowEnd";d="left"===d;switch(b){case "HL":a.setAttribute(d?"marker-start":"marker-end","url(#"+(d?c:e)+")");break;case "LL":a.setAttribute("marker-start","url(#"+c+")");break;case "LH":a.setAttribute(d?"marker-end":"marker-start","url(#"+(d?e:c)+")");break;default:a.setAttribute("marker-end","url(#"+e+")")}}function e(a,d,b){var c="start"===d;d=c?b+"_arrowStart":b+"_arrowEnd";b=c?"0,0 5,5 0,10":"5,0 0,5 5,10";var e=c?"5":"0",c=document.createElementNS("http://www.w3.org/2000/svg",
"marker");c.setAttribute("id",d);c.setAttribute("markerWidth","10");c.setAttribute("markerHeight","10");c.setAttribute("refX",e);c.setAttribute("refY","5");c.setAttribute("markerUnits","strokeWidth");c.setAttribute("orient","auto");d=document.createElementNS("http://www.w3.org/2000/svg","polyline");d.setAttribute("points",b);d.setAttribute("fill","none");d.setAttribute("stroke","#555555");d.setAttribute("stroke-width","1");c.appendChild(d);a.appendChild(c)}Object.defineProperty(l,"__esModule",{value:!0});
var y={HH:315,HL:45,LL:135,LH:225},u={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};l.getRelationshipRampElement=function(a){var d=a.focus,b=a.numClasses,c=u[b],e={};a.infos.forEach(function(a){e[a.value]={label:a.label,fill:t(a.symbol)}});a=[];for(var f=0;f<b;f++){for(var h=[],g=0;g<b;g++)h.push(e[c[f][g]].fill);a.push(h)}c=m(d,e);return{type:"relationship-ramp",
numClasses:b,focus:d,colors:a,labels:c,rotation:n(d)}};l.getRotationAngleForFocus=n;l.renderRamp=function(h,d,b,c){void 0===c&&(c=60);var k=h.focus,l=h.numClasses,n=h.colors,p=h.rotation;h=!!k;var q=Math.sqrt(Math.pow(c,2)+Math.pow(c,2))+(h?0:5),r=document.createElement("div"),x=f.createSurface(r,q,q);null!=b&&(r.style.opacity=b.toString());var m=a.create2DColorRamp({surface:x,colors:n,numClasses:l,size:c});b=(q-c)/2;q=(q-c)/2;m.applyTransform(g.translate(b,q));l=c/2;n=c/2;m.applyTransform(g.rotategAt(p,
l,n));var p=x.createGroup(),m={width:1,color:"#555555"},u=x.defNode;e(u,"start",d);e(u,"end",d);u=p.createLine({x1:-10,y1:c-15,x2:-10,y2:15}).setStroke(m);c=p.createLine({x1:15,y1:c+10,x2:c-15,y2:c+10}).setStroke(m);v(u.rawNode,"left",k,d);v(c.rawNode,"right",k,d);p.applyTransform(g.translate(b,q));h?p.applyTransform(g.rotategAt(-45,l,n)):x.rawNode.style.margin="-15px -15px -18px -15px";return r}})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../symbols ../../../core/promiseUtils ../../../intl/date ../../../renderers/support/numberUtils ../../../symbols/support/utils ./utils @dojo/framework/shim/Promise".split(" "),
function(A,l,f,g,a,k,t,m,n,v){function e(a,b){var c=null,d=null;if("simple"===a.type)c=a.symbol;else if("unique-value"===a.type||"class-breaks"===a.type)c=(c=(a=a.classBreakInfos||a.uniqueValueInfos)&&a[0])&&c.symbol,d=1<a.length;if(!c||y(c))return null;c=c.clone();if(b||d)-1<c.type.indexOf("3d")?u(c):(b=c,-1!==b.type.indexOf("line")?b.color=p:(b.color=F,"simple-marker"===b.type&&(b.outline={color:p,width:1.5})));return c}function y(b){if(b)return a.isSymbol3D(b)?b.symbolLayers?b.symbolLayers.some(function(a){return a&&
"fill"===a.type}):!1:-1!==b.type.indexOf("fill")}function u(a){n.isVolumetricSymbol(a)||("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:p}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:w}:(a.material={color:F},a.outline={color:p,size:1.5})}))}function h(a,c,e,h,p){return f(this,void 0,void 0,function(){var f,r,q,k,l;return g(this,function(g){switch(g.label){case 0:return[4,new Promise(function(a,b){A(["../../../renderers/visualVariables/support/visualVariableUtils"],
a,b)})];case 1:r=(f=g.sent().getSizeRangeAtScale(c,h,p))&&d(f);if(!f&&!r)return[2];q=r.map(function(a){var b=f.minSize,d=f.maxSize,e=c.minDataValue,g=c.maxDataValue;return a<=b?e:a>=d?g:(a-b)/(d-b)*(g-e)+e});q=m.round(q);k=1;g.label=2;case 2:return k<q.length-1?[4,b(a,c,e,q[k],q[k-1],h,p)]:[3,5];case 3:if(l=g.sent())q[k]=l[0],r[k]=l[1];g.label=4;case 4:return k++,[3,2];case 5:return[2,q]}})})}function d(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],d=0;5>d;d++)c.push(b+a*d);return c}function b(a,
b,d,e,h,p,k){return f(this,void 0,void 0,function(){var f,r,q,l,n,x,u,w,y,t,E,C,B,v,z,D,A,F,W,aa,T,U;return g(this,function(g){switch(g.label){case 0:return[4,c(a,b,d,e,p,k)];case 1:return r=g.sent(),[4,c(a,b,d,h,p,k)];case 2:q=g.sent(),l=m.numDigits(e),n=l.fractional,x=20,u=l.integer,y=w=null,0<e&&1>e&&(w=Math.pow(10,n),e*=w,u=m.numDigits(e).integer),t=u-1,g.label=3;case 3:if(!(0<=t))return[3,8];E=Math.pow(10,t);C=Math.floor(e/E)*E;B=Math.ceil(e/E)*E;null!=w&&(C/=w,B/=w);v=(C+B)/2;f=m.round([C,v,
B],{indexes:[1]});v=f[1];return[4,c(a,b,d,C,p,k)];case 4:return z=g.sent(),[4,c(a,b,d,B,p,k)];case 5:return D=g.sent(),[4,c(a,b,d,v,p,k)];case 6:A=g.sent();F=m.percentChange(r,z,q,null);W=m.percentChange(r,D,q,null);aa=m.percentChange(r,A,q,null);T=F.previous<=x;U=W.previous<=x;T&&U&&(F.previous<=W.previous?(T=!0,U=!1):(U=!0,T=!1));T?y=[C,z]:U?y=[B,D]:aa.previous<=x&&(y=[v,A]);if(y)return[3,8];g.label=7;case 7:return t--,[3,3];case 8:return[2,y]}})})}function c(a,b,c,d,e,h){return f(this,void 0,void 0,
function(){var a;return g(this,function(f){switch(f.label){case 0:return[4,new Promise(function(a,b){A(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return a=f.sent().getSize,[2,a(b,d,{scale:e,view:h,shape:-1!==c.type.indexOf("marker-symbol")?c.style:null})]}})})}function z(b,c){b=b.clone();if(a.isSymbol3D(b))n.isVolumetricSymbol(b)||b.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=c)});else if("esri.symbols.SimpleMarkerSymbol"===b.declaredClass)b.size=
c;else if("esri.symbols.PictureMarkerSymbol"===b.declaredClass){var d=b.width,e=b.height;b.height=c;b.width=d/e*c}else"esri.symbols.SimpleLineSymbol"===b.declaredClass?b.width=c:"esri.symbols.TextSymbol"===b.declaredClass&&b.font&&(b.font.size=c);return b}Object.defineProperty(l,"__esModule",{value:!0});l.REAL_WORLD_MAX_SIZE=30;l.REAL_WORLD_MIN_SIZE=12;var F=[255,255,255],w=[200,200,200],p=[128,128,128];l.getRampStops=function(a,b,d,p,w,u){return f(this,void 0,void 0,function(){var r,q,x,y,E,B,D,
A,F,M,G,Q,N,V,X,Y,H=this;return g(this,function(C){switch(C.label){case 0:q=(r=b.legendOptions)&&r.customValues;x=e(a,d);y=!!x;E=!!q;B=null!=b.minSize&&null!=b.maxSize;D=b.stops&&1<b.stops.length;A=!!b.target;if(!y||!(E||B||D&&!A))return[2];F=n.isVolumetricSymbol(x);Q=G=M=null;if(!F||D)return[3,1];G=m.round([b.minDataValue,b.maxDataValue]);return[3,4];case 1:return(N=q)?[3,3]:[4,h(a,b,x,p,w)];case 2:N=C.sent(),C.label=3;case 3:G=N,C.label=4;case 4:!G&&D&&(G=b.stops.map(function(a){return a.value}),
(M=b.stops.some(function(a){return!!a.label}))&&(Q=b.stops.map(function(a){return a.label})));F&&G&&2<G.length&&(G=[G[0],G[G.length-1]]);if(!G)return[2,null];V=[l.REAL_WORLD_MIN_SIZE,l.REAL_WORLD_MAX_SIZE];X=n.getSymbolOutlineSize(x);return[4,k.all(G.map(function(d,e){return f(H,void 0,void 0,function(){var f,h,k,r;return g(this,function(g){switch(g.label){case 0:if(!F)return[3,1];k=V[e];return[3,3];case 1:return[4,c(a,b,x,d,p,w)];case 2:k=g.sent(),g.label=3;case 3:return f=k,h=z(x,f),r=M?Q[e]:v.getLabelPrefix(e,
G.length-1)+(u?t.formatDate(d):m.format(d)),[2,{value:d,symbol:h,label:r,size:f,outlineSize:X}]}})})}))];case 5:return Y=C.sent(),[2,Y.reverse()]}})})}})},"esri/widgets/Legend/styles/Card":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/assignHelper dojo/i18n!../../../nls/common dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/colorUtils ../../support/widget".split(" "),
function(A,l,f,g,a,k,t,m,n,v,e,y,u,h,d,b,c){var z=window.devicePixelRatio;return function(a){function l(b){b=a.call(this)||this;b._handles=new v;b._hasIndicators=!1;b._selectedSectionName=null;b._sectionNames=[];b._sectionMap=new Map;b.activeLayerInfos=null;b.layout="stack";b.type="card";b.view=null;return b}f(l,a);l.prototype.postInitialize=function(){var a=this;this.own([this.watch("activeLayerInfos",function(b){a._handles.removeAll();a._watchForSectionChanges(b)})])};l.prototype.destroy=function(){this._handles.destroy();
this._handles=null};l.prototype.render=function(){var a=this,b;this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var d=this.activeLayerInfos,e=d&&d.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;
var f=this._sectionNames.length,d=this._sectionNames.map(function(b,d){var e;d=n.substitute(k.pagination.pageText,{index:d+1,total:f});return c.tsx("div",{key:b,"aria-label":d,title:d,tabIndex:0,onclick:a._selectSection,onkeydown:a._selectSection,bind:a,class:a.classes("esri-legend--card__carousel-indicator",(e={},e["esri-legend--card__carousel-indicator--activated"]=a._selectedSectionName===b,e)),"data-section-name":b})}),d=this._hasIndicators&&1<f?c.tsx("div",{class:"esri-legend--card__carousel-indicator-container",
key:"carousel-navigation"},d):null,e=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):e&&e.length?e:null,g=(b={},b["esri-legend--stacked"]=this._hasIndicators,b);return c.tsx("div",{class:this.classes("esri-legend--card esri-widget",g)},d,e?e:c.tsx("div",{class:"esri-legend--card__message"},t.noLegend))};l.prototype._selectSection=function(a){if(a=a.target.getAttribute("data-section-name"))this._selectedSectionName=a};l.prototype._watchForSectionChanges=function(a){var b=this;this._generateSectionNames();
a&&(a.forEach(function(a){var c="activeLayerInfo-"+a.layer.uid+"-version-change";b._handles.remove(c);b._watchForSectionChanges(a.children);b._handles.add(a.watch("version",function(){return b._generateSectionNames()}),c)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(a.on("change",function(){return b._watchForSectionChanges(a)}),"activeLayerInfos-collection-change"))};l.prototype._generateSectionNames=function(){this._sectionNames.length=0;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,
this)};l.prototype._generateSectionNamesForActiveLayerInfo=function(a){var b=this;a.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);a.legendElements&&a.legendElements.forEach(function(c,d){b._sectionNames.push("esri-legend--card__"+a.layer.uid+"-type-"+c.type+"-"+d)})};l.prototype._renderLegendForLayer=function(a){var b=this,d;if(!a.ready)return null;if(a.children.length)return d=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),c.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},c.tsx("div",{class:"esri-legend--card__service-caption-container"},a.title),d);var e=a.legendElements;if(e&&!e.length)return null;var f=e.some(function(a){return"relationship-ramp"===a.type}),e=e.map(function(c,d){return b._renderLegendForElement(c,a,d,f)}).filter(function(a){return!!a});if(!e.length)return null;var g=(d={},d["esri-legend--card__group-layer-child"]=!!a.parent,d);return c.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service",g)},c.tsx("div",{class:"esri-legend--card__service-caption-container"},c.tsx("div",{class:"esri-legend--card__service-caption-text"},a.title)),c.tsx("div",{class:"esri-legend--card__service-content"},e))};l.prototype._renderLegendForElement=function(a,b,e,f){var g=this;void 0===f&&(f=!1);var k,l="color-ramp"===a.type,r="opacity-ramp"===a.type,p="size-ramp"===a.type,q=b.layer,n=a.title,m=null;"string"===typeof n?m=n:n&&(m=d.getTitle(n,l||r),m=n.title?
n.title+" ("+m+")":m);e="esri-legend--card__"+q.uid+"-type-"+a.type+"-"+e;n=this._hasIndicators?c.tsx("div",null,c.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend--card__carousel-title")},b.title),c.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},m)):m?c.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},m):null;m=null;"symbol-table"===a.type?(p=a.infos.map(function(c,d){return g._renderLegendForElementInfo(c,
b,a.legendType,d)}).filter(function(a){return!!a}),p.length&&(q=p[0].properties.classes&&p[0].properties.classes["esri-legend--card__symbol-row"],f=(k={},k["esri-legend--card__label-container"]=!q&&!f,k["esri-legend--card__relationship-label-container"]=f,k),m=c.tsx("div",{key:e,class:"esri-legend--card__section"},n,c.tsx("div",{class:this.classes(f)},p)))):"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?m=c.tsx("div",{key:e,class:"esri-legend--card__section"},n,this._renderLegendForRamp(a,
q.opacity)):p?m=c.tsx("div",{key:e,class:"esri-legend--card__section"},n,this._renderSizeRamps(a,q.opacity)):"relationship-ramp"===a.type&&(m=c.tsx("div",{key:e,class:this.classes("esri-legend--card__section","esri-legend--card__relationship-section")},n,h.renderRelationshipRamp(a,this.id,q.opacity)));if(!m)return null;this._sectionMap.set(e,m);return m};l.prototype._renderLegendForElementInfo=function(a,e,f,g){var h,k,l,q=e.layer;if(a.type)return this._renderLegendForElement(a,e,g);e=d.isImageryStretchedLegend(q,
f);if(a.symbol&&a.preview){if(-1===a.symbol.type.indexOf("simple-fill")){if(!a.label)return c.tsx("div",{key:g,bind:a.preview,afterCreate:d.attachToNode});q=(h={},h["esri-legend--card__symbol-cell"]=this._hasIndicators,h);return c.tsx("div",{key:g,class:this.classes("esri-legend--card__layer-row",(k={},k["esri-legend--card__symbol-row"]=this._hasIndicators,k))},c.tsx("div",{class:this.classes(q),bind:a.preview,afterCreate:d.attachToNode}),c.tsx("div",{class:this.classes("esri-legend--card__image-label",
(l={},l["esri-legend--card__label-cell"]=this._hasIndicators,l))},d.getTitle(a.label,!1)||""))}l=k=h=255;e=0;var r=f=255,p=255,n=0,m=a.symbol.color&&a.symbol.color.a,u=a.symbol.outline&&a.symbol.outline.color.a;m&&(h=a.symbol.color.r,k=a.symbol.color.g,l=a.symbol.color.b,e=a.symbol.color.a*q.opacity);u&&(f=a.symbol.outline.color.r,r=a.symbol.outline.color.g,p=a.symbol.outline.color.b,n=a.symbol.outline.color.a*q.opacity);var x=(q=a.symbol.color?b.isBright(a.symbol.color):!0)?"rgba(255, 255, 255, .6)":
"rgba(0, 0, 0, .6)";return c.tsx("div",{key:g,class:"esri-legend--card__layer-row"},c.tsx("div",{class:"esri-legend--card__label-element",styles:{background:m?"rgba("+h+", "+k+", "+l+", "+e+")":"none",color:q?"black":"white",textShadow:"-1px -1px 0 "+x+",\n                                              1px -1px 0 "+x+",\n                                              -1px 1px 0 "+x+",\n                                              1px 1px 0 "+x,border:u?"1px solid rgba("+f+", "+r+", "+p+", "+n+")":
"none"}}," ",a.label," "))}if(a.src)return q=this._renderImage(a,q,e),c.tsx("div",{key:g,class:"esri-legend--card__layer-row"},q,c.tsx("div",{class:"esri-legend--card__image-label"},a.label||""))};l.prototype._renderImage=function(a,b,d){var e,f=a.label,g=a.src,h=a.opacity;d=(e={},e["esri-legend--card__imagery-layer-image--stretched"]=d,e["esri-legend--card__symbol"]=!d,e);b={opacity:""+(null!=h?h:b.opacity)};return c.tsx("img",{alt:f,src:g,border:0,width:a.width,height:a.height,class:this.classes(d),
styles:b})};l.prototype._drawImageOnSizeRamp=function(a,b,c){var d=c.x,e=c.y,f=c.width,g=c.height,h=new Image;h.src=b;h.onload=function(){a.drawImage(h,d,e,f,g);URL.revokeObjectURL(b)}};l.prototype._attachSizeRampToNode=function(a){var b=a["data-layer-opacity"];null!=b&&(a.style.opacity=b.toString());var b=a["data-legend-element"].infos,c=b[0],d=b[b.length-1],f=c.symbol,g=d.symbol,h="picture-marker"===f.type;f?-1<f.type.indexOf("3d")?(b=f.symbolLayers&&f.symbolLayers.length)?(b=f.symbolLayers.getItemAt(b-
1).get("resource.primitive"),b="triangle"===b||"cone"===b||"tetrahedron"===b):b=void 0:b="triangle"===f.style:b=void 0;var k;f?-1<f.type.indexOf("3d")?(k=f.symbolLayers&&f.symbolLayers.length)?(k=f.symbolLayers.getItemAt(k-1),k=k.resource&&k.resource.primitive,k="circle"===k||"cross"===k||"kite"===k||"sphere"===k||"cube"===k||"diamond"===k):k=void 0:(k=f.style,k="circle"===k||"diamond"===k||"cross"===k):k=void 0;var l,n;h?(l=f.url,n=g.url):(c.preview&&(c.preview.firstChild.setAttributeNS("http://www.w3.org/2000/xmlns/",
"xmlns","http://www.w3.org/2000/svg"),l=new Blob([c.preview.innerHTML],{type:"image/svg+xml"}),l=URL.createObjectURL(l)),d.preview&&(d.preview.firstChild.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),n=new Blob([d.preview.innerHTML],{type:"image/svg+xml"}),n=URL.createObjectURL(n)));var p=e.pt2px(c.size+c.outlineSize)*z,f=e.pt2px(d.size+d.outlineSize)*z,g=this._hasIndicators?p:p+100*z,h=this._hasIndicators?g+50*z:p,c=document.createElement("canvas");c.width=
g;c.height=h;c.style.width=c.width/z+"px";c.style.height=c.height/z+"px";d=c.getContext("2d");this._hasIndicators?(this._drawImageOnSizeRamp(d,l,{x:0,y:0,width:p,height:p}),this._drawImageOnSizeRamp(d,n,{x:g/2-f/2,y:h-f,width:f,height:f}),d.beginPath(),l=g/2-f/2,n=h-(b?0:k?f/2:f),d.moveTo(0,k?g/2:g),d.lineTo(l,n),l=g/2+f/2,b=h-(b?0:k?f/2:f),d.moveTo(g,k?g/2:g),d.lineTo(l,b)):(this._drawImageOnSizeRamp(d,l,{x:g-p,y:0,width:p,height:p}),this._drawImageOnSizeRamp(d,n,{x:0,y:h/2-f/2,width:f,height:f}),
d.beginPath(),l=g-(k||b?p/2:p),d.moveTo(f-(k||b?f/2:0),h/2-f/2),d.lineTo(l,0),b=g-(k?p/2:p),d.moveTo(f-(k?f/2:0),h/2+f/2),d.lineTo(b,h));d.strokeStyle="#ddd";d.stroke();a.appendChild(c)};l.prototype._renderSizeRamps=function(a,b){var d,e=a.infos,f=e[0].label,e=e[e.length-1].label;return c.tsx("div",{class:this.classes("esri-legend--card__layer-row",(d={},d["esri-legend--card__size-ramp-row"]=this._hasIndicators,d))},c.tsx("div",{class:"esri-legend--card__ramp-label"},this._hasIndicators?f:e),c.tsx("div",
{class:"esri-legend--card__size-ramp-container"},c.tsx("div",{bind:this,"data-layer-opacity":b,"data-legend-element":a,afterCreate:this._attachSizeRampToNode})),c.tsx("div",{class:"esri-legend--card__ramp-label"},this._hasIndicators?e:f))};l.prototype._renderLegendForRamp=function(a,b){var e=a.infos,f="heatmap-ramp"===a.type,g=e.length-1,h=2<g&&!f?25*g:100,k=h+20;a=document.createElement("div");a.style.width=k+"px";null!=b&&(a.style.opacity=b.toString());b=m.createSurface(a,k,25);var l=e.slice(0).reverse();
try{l.forEach(function(a,b){a.offset=f?a.ratio:b/g}),f||b.createPath("M0 12.5 L10 0 L10 25 Z").setFill(l[0].color).setStroke(null),b.createRect({x:10,y:0,width:h,height:25}).setFill({type:"linear",x1:10,y1:0,x2:h+10,y2:0,colors:l}).setStroke(null),f||b.createPath("M"+(h+10)+" 0 L"+k+" 12.5 L"+(h+10)+" 25 Z").setFill(l[l.length-1].color).setStroke(null)}catch(R){b.clear(),b.destroy()}if(!b)return null;b=l.filter(function(a,b){return!!a.label&&0!==b&&b!==l.length-1}).map(function(a){return c.tsx("div",
{class:"esri-legend--card__interval-separators-container"},c.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),c.tsx("div",{class:"esri-legend--card__ramp-label"},a.label))});h=e[e.length-1].label;e=e[0].label;return c.tsx("div",{class:"esri-legend--card__layer-row"},c.tsx("div",{class:"esri-legend--card__ramp-label"},f?t[h]:h),c.tsx("div",{class:"esri-legend--card__symbol-container"},c.tsx("div",{bind:a,afterCreate:d.attachToNode}),b),c.tsx("div",{class:"esri-legend--card__ramp-label"},
f?t[e]:e))};g([c.renderable(),y.property()],l.prototype,"activeLayerInfos",void 0);g([y.property()],l.prototype,"layout",void 0);g([y.property({readOnly:!0})],l.prototype,"type",void 0);g([y.property()],l.prototype,"view",void 0);g([c.accessibleHandler()],l.prototype,"_selectSection",null);return l=g([y.subclass("esri.widgets.Legend.styles.Card")],l)}(y.declared(u))})},"esri/widgets/Legend/styles/support/utils":function(){define(["require","exports","../../support/relationshipRampUtils","../../support/styleUtils",
"../../../support/widget"],function(A,l,f,g,a){Object.defineProperty(l,"__esModule",{value:!0});l.renderRelationshipRamp=function(k,l,m){var n=k.labels,t=!!k.focus;k=f.renderRamp(k,l,m);return t?a.tsx("div",{class:"esri-relationship-ramp--diamond__container"},a.tsx("div",{class:"esri-relationship-ramp--diamond__left-column"},n.left),a.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column"},a.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},n.top),a.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--ramp",
bind:k,afterCreate:g.attachToNode}),a.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},n.bottom)),a.tsx("div",{class:"esri-relationship-ramp--diamond__right-column"},n.right)):a.tsx("div",{class:"esri-relationship-ramp--square__table"},a.tsx("div",{class:"esri-relationship-ramp--square__table-row"},a.tsx("div",{class:a.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-bottom")},
n.left),a.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),a.tsx("div",{class:a.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-bottom")},n.top)),a.tsx("div",{class:"esri-relationship-ramp--square__table-row"},a.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),a.tsx("div",{class:"esri-relationship-ramp--square__table-cell",bind:k,afterCreate:g.attachToNode}),a.tsx("div",
{class:"esri-relationship-ramp--square__table-cell"})),a.tsx("div",{class:"esri-relationship-ramp--square__table-row"},a.tsx("div",{class:a.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-top")},n.bottom),a.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),a.tsx("div",{class:a.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-top")},
n.right)))}})},"esri/widgets/Legend/support/styleUtils":function(){define(["require","exports","dojo/i18n!../../Legend/nls/Legend","../../../intl"],function(A,l,f,g){Object.defineProperty(l,"__esModule",{value:!0});l.attachToNode=function(a){a.appendChild(this)};l.getTitle=function(a,k){if(a){if("string"===typeof a)return a;if("value"in a||"unit"in a)return g.substitute(f.dotValue,a);var l=null;k?l=a.ratioPercentTotal?"showRatioPercentTotal":a.ratioPercent?"showRatioPercent":a.ratio?"showRatio":a.normField?
"showNormField":a.field?"showField":null:k||(l=a.normField?"showNormField":a.normByPct?"showNormPct":a.field?"showField":null);return l?g.substitute("showField"===l?"{field}":f[l],{field:a.field,normField:a.normField}):null}};l.isRendererTitle=function(a,f){return!f};l.isImageryStretchedLegend=function(a,f){return!!(f&&"Stretched"===f&&10.3<=a.version&&"esri.layers.ImageryLayer"===a.declaredClass)}})},"esri/widgets/support/colorUtils":function(){define(["require","exports","../../Color"],function(A,
l,f){function g(a){return new f(a)}function a(a){return!!a&&4===a.length&&v.test(a)}function k(a){return!!a&&7===a.length&&e.test(a)}function t(a){return 127<=.299*a.r+.587*a.g+.114*a.b}function m(a,e){void 0===e&&(e=1);e=Math.pow(.7,e);return new f([Math.round(a.r*e),Math.round(a.g*e),Math.round(a.b*e),a.a])}function n(a,e){void 0===e&&(e=1);e=Math.pow(.7,e);var g=a.r,d=a.g,b=a.b;30>g&&(g=30);30>d&&(d=30);30>b&&(b=30);return new f([Math.min(255,Math.round(g/e)),Math.min(255,Math.round(d/e)),Math.min(255,
Math.round(b/e)),a.a])}Object.defineProperty(l,"__esModule",{value:!0});var v=/^#[0-9A-F]{3}$/i,e=/^#[0-9A-F]{6}$/i;l.equal=function(a,e){return a&&e&&a.r===e.r&&a.g===e.g&&a.b===e.b&&a.a===e.a};l.normalizeHex=function(a){return a?"#"+a.trim().replace(/#/g,"").substr(0,6):""};l.normalizeColor=g;l.isValidHex=function(e){return a(e)||k(e)};l.isShorthandHex=a;l.isLonghandHex=k;l.toHex=function(a){return g(a).toHex()};l.getContrastingColor=function(a){return t(a)?m(a):n(a,3)};l.isBright=t;l.darker=m;
l.brighter=n})},"esri/widgets/Legend/styles/Classic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),function(A,l,f,g,a,k,t,m,n,v,e){return function(l){function m(a){a=l.call(this)||this;a.activeLayerInfos=null;a.type="classic";return a}f(m,l);m.prototype.render=
function(){var f=this,d=this.activeLayerInfos,b=this.classes("esri-legend esri-widget--panel","esri-widget"),d=d&&d.toArray().map(function(a){return f._renderLegendForLayer(a)}).filter(function(a){return!!a});return e.tsx("div",{class:b},d&&d.length?d:e.tsx("div",{class:"esri-legend__message"},a.noLegend))};m.prototype._renderLegendForLayer=function(a){var d=this,b;if(!a.ready)return null;var c=!!a.children.length,f="esri-legend__"+a.layer.uid+"-version-"+a.version,g=a.title?e.tsx("h3",{class:this.classes("esri-widget__heading",
"esri-legend__service-label")},a.title):null;if(c)return b=a.children.map(function(a){return d._renderLegendForLayer(a)}).toArray(),e.tsx("div",{key:f,class:this.classes("esri-legend__service","esri-legend__group-layer")},g,b);if((c=a.legendElements)&&!c.length)return null;c=c.map(function(b){return d._renderLegendForElement(b,a.layer)}).filter(function(a){return!!a});if(!c.length)return null;var h=(b={},b["esri-legend__group-layer-child"]=!!a.parent,b);return e.tsx("div",{key:f,class:this.classes("esri-legend__service",
h)},g,e.tsx("div",{class:"esri-legend__layer"},c))};m.prototype._renderLegendForElement=function(a,d,b){var c=this,f,g="color-ramp"===a.type,h="opacity-ramp"===a.type,k="size-ramp"===a.type,l=null;if("symbol-table"===a.type||k){var m=a.infos.map(function(b){return c._renderLegendForElementInfo(b,d,k,a.legendType)}).filter(function(a){return!!a});m.length&&(l=e.tsx("div",{class:"esri-legend__layer-body"},m))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?l=this._renderLegendForRamp(a,
d.opacity):"relationship-ramp"===a.type&&(l=n.renderRelationshipRamp(a,this.id,d.opacity));if(!l)return null;var m=a.title,t=null;"string"===typeof m?t=m:m&&(t=v.getTitle(m,g||h),t=v.isRendererTitle(m,g||h)&&m.title?m.title+" ("+t+")":t);g=b?"esri-legend__layer-child-table":"esri-legend__layer-table";h=t?e.tsx("div",{class:"esri-legend__layer-caption"},t):null;b=(f={},f["esri-legend__layer-table--size-ramp"]=k||!b,f);return e.tsx("div",{class:this.classes(g,b)},h,l)};m.prototype._renderLegendForRamp=
function(f,d){var b=f.infos,c="opacity-ramp"===f.type,g="heatmap-ramp"===f.type,h=b.length-1;f=document.createElement("div");f.className="esri-legend__color-ramp "+(c?"esri-legend__opacity-ramp":"");f.style.height="75px";null!=d&&(f.style.opacity=d.toString());d=k.createSurface(f,"100%",75);try{g||b.forEach(function(a,b){a.offset=b/h}),d.createRect({x:0,y:0,width:"100%",height:75}).setFill({type:"linear",x1:0,y1:0,x2:0,y2:75,colors:b}).setStroke(null)}catch(w){d.clear(),d.destroy()}if(!d)return null;
b=b.filter(function(a){return!!a.label}).map(function(b){return e.tsx("div",{class:"esri-legend__ramp-label"},g?a[b.label]:b.label)});return e.tsx("div",{class:"esri-legend__layer-row"},e.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},e.tsx("div",{class:"esri-legend__ramps",bind:f,afterCreate:v.attachToNode})),e.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},e.tsx("div",{class:"esri-legend__ramp-labels",styles:{height:"75px"}},
b)))};m.prototype._renderLegendForElementInfo=function(a,d,b,c){var f,g;if(a.type)return this._renderLegendForElement(a,d,!0);var h=null;c=v.isImageryStretchedLegend(d,c);a.symbol&&a.preview?h=e.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:v.attachToNode}):a.src&&(h=this._renderImage(a,d,c));if(!h)return null;d=(f={},f["esri-legend__imagery-layer-info--stretched"]=c,f);b=(g={},g["esri-legend__imagery-layer-info--stretched"]=c,g["esri-legend__size-ramp"]=!c&&b,g);return e.tsx("div",
{class:"esri-legend__layer-row"},e.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",b)},h),e.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",d)},v.getTitle(a.label,!1)||""))};m.prototype._renderImage=function(a,d,b){var c,f=a.label,g=a.src,h=a.opacity;b=(c={},c["esri-legend__imagery-layer-image--stretched"]=b,c["esri-legend__symbol"]=!b,c);d={opacity:""+(null!=h?h:d.opacity)};return e.tsx("img",{alt:f,src:g,border:0,width:a.width,
height:a.height,class:this.classes(b),styles:d})};g([e.renderable(),t.property()],m.prototype,"activeLayerInfos",void 0);g([t.property({readOnly:!0})],m.prototype,"type",void 0);return m=g([t.subclass("esri.widgets.Legend.styles.Classic")],m)}(t.declared(m))})},"widgets/Legend/_build-generate_module":function(){define(["dojo/i18n!./nls/strings"],function(){})},"*now":function(A){A(['dojo/i18n!*preload*widgets/Legend/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define(["dojo/_base/declare","jimu/BaseWidget","esri/widgets/Legend"],function(A,l,f){return A([l],{name:"Legend",baseClass:"jimu-widget-legend",templateString:"\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d'legendDiv'\x3e\x3c/div\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);this.legend=new f({container:this.legendDiv,view:this.sceneView})},destroy:function(){this.legend&&this.legend.destroy();this.inherited(arguments)}})});