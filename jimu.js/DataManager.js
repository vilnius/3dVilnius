// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","./WidgetManager"],function(g,c,a,h){var f=null,e;e=g(null,{constructor:function(){a.subscribe("publishData",c.hitch(this,this.onDataPublished));a.subscribe("fetchData",c.hitch(this,this.onFetchData));a.subscribe("clearAllData",c.hitch(this,this.onClearAllData));a.subscribe("removeData",c.hitch(this,this.onRemoveData));a.subscribe("clearDataHistory",c.hitch(this,this.onClearDataHistory));this.widgetManager=h.getInstance()},_dataStore:{},
onDataPublished:function(b,a,d,c){"undefined"===typeof c&&(c=!1);this._dataStore[a]?(this._dataStore[a].current=d,c&&(this._dataStore[a].history?this._dataStore[a].history.push(d):this._dataStore[a].history=[d])):(this._dataStore[a]={current:d},c&&(this._dataStore[a].history=[d]))},onFetchData:function(b){var c;if(b)"framework"===b?this._dataStore[b]?a.publish("dataFetched","framework","framework",this._dataStore[b].current,this._dataStore[b].history):a.publish("noData","framework","framework"):(c=
this.widgetManager.getWidgetById(b))?this._dataStore[b]?a.publish("dataFetched",c.name,b,this._dataStore[b].current,this._dataStore[b].history):a.publish("noData",c.name,b):a.publish("noData",void 0,b);else for(var d in this._dataStore)(c=this.widgetManager.getWidgetById(d))&&a.publish("dataFetched",c.name,d,this._dataStore[d].current,this._dataStore[d].history)},onClearAllData:function(){this._dataStore={};a.publish("allDataCleared")},onRemoveData:function(b){delete this._dataStore[b];a.publish("dataRemoved",
b)},onClearDataHistory:function(b){this._dataStore[b]&&(this._dataStore[b].history=[]);a.publish("dataHistoryCleared",b)}});e.getInstance=function(){null===f&&(f=new e);return f};return e});