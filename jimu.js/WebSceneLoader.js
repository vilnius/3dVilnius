// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/Deferred dojo/_base/lang dojo/_base/array dojo/_base/html dojo/promise/all esri/kernel esri/WebScene esri/views/SceneView esri/portal/Portal esri/portal/PortalItem esri/core/has ./utils ./portalUtils ./portalUrlUtils".split(" "),function(k,e,m,l,n,p,q,r,t,u,v,w,x,y){return{createMap:function(b,a,c){var d=new k;v("esri-webgl")?d=this._createMap(b,a,c):(d.reject("The browser doesn't support webgl."),(b=e.getObject("webSceneLoader.webglSupportTip",!1,window.jimuNls))||(b="3D web apps aren't supported in your browser."),
l.create("div",{"class":"app-error",innerHTML:b},document.body));return d},_createMap:function(b,a,c){w.getEsriConfig().portalUrl=y.getStandardPortalUrl(a);var d=new k,g=[];t._default=null;var h=new q({portalItem:new u({id:c})}),f=new r({map:h,container:b,constraints:{collision:{enabled:!1},tilt:{max:179.99}}});g.push(f.when());a=x.getPortal(a);g.push(a.getItemById(c));g.push(a.getItemData(c));n(g).then(e.hitch(this,function(a){f.popup&&(f.popup.closeOnViewChangeEnabled=!0);h.id=b;h.itemId=c;h.itemInfo=
{item:a[1],itemData:a[2]};this._handleLocalScene(f);d.resolve(f)}),e.hitch(this,function(a){console.error(a);d.reject(a)}));return d},_handleLocalScene:function(b){try{b.viewingMode&&"local"===b.viewingMode.toLowerCase()&&(e.setObject("constraints.collision.enabled",!1,b),e.setObject("constraints.tilt.max",179.99,b))}catch(a){console.error(a)}},_handleAttribution:function(b){try{if("4.0"!==p.version){var a=b.ui&&b.ui._components;a&&0<a.length&&m.some(a,function(a){return(a=a&&a._widget)&&"esri.widgets.Attribution"===
a.declaredClass?(a.domNode.parentNode.style.width="100%",l.create("span",{innerHTML:"Powered by Esri","class":"esri-attribution-powered-by"},a.domNode),!0):!1})}}catch(c){console.error(c)}}}});