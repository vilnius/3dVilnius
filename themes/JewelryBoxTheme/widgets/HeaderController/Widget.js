// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"themes/JewelryBoxTheme/widgets/HeaderController/PopupTileNodes":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/dom-construct dojo/query dijit/_WidgetBase dijit/_TemplatedMixin jimu/dijit/ViewStack jimu/utils".split(" "),function(r,f,k,b,n,c,h,p,a,g,e){return r([p,a],{baseClass:"jimu-header-more-popup",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"pages" data-dojo-attach-point\x3d"pagesNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"points jimu-corner-bottom"\x3e\x3cdiv class\x3d"points-inner"data-dojo-attach-point\x3d"pointsNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
margin:4,postCreate:function(){this.nodes=[];this.pages=[];this.createCloseBtn()},startup:function(){this.viewStack=new g({views:[],viewType:"dom"},this.pagesNode);this.viewStack.startup();this.resize()},resize:function(){var a=this._calculateGridParam(),c;null!==a?(b.setStyle(this.domNode,e.getPositionStyle(a.position)),this.nodeWidth=a.cellSize-this.margin,this.oldGridParam&&this.oldGridParam.rows===a.rows&&this.oldGridParam.cols===a.cols||(this.clearPages(),this.createPages(a)),this.nodes.forEach(f.hitch(this,
function(b,d){this.setItemNodePosition(b,d,a)})),this.oldGridParam=a,c=h("div.close",this.domNode)[0],b.setStyle(c,{width:.25*this.nodeWidth+"px",height:.25*this.nodeWidth+"px"})):(this.oldGridParam=null,b.setStyle(this.domNode,e.getPositionStyle({left:0,top:0,width:0,height:0,zIndex:111})),this.nodeWidth=0)},setItemNodePosition:function(a,c,l){var d,u,e=48,g=16;d=0===c%l.cols?0:this.margin/2;u=c%(l.rows*l.cols)<l.cols?0:this.margin/2;c={};"number"===typeof this.nodeWidth&&(c.width=this.nodeWidth+
"px",c.height=this.nodeWidth+"px");"number"===typeof d&&(window.isRTL?c.marginRight=d+"px":c.marginLeft=d+"px");"number"===typeof u&&(c.marginTop=u+"px");if(d=h("img",a)[0])l.iconScaled&&(e*=this.nodeWidth/120),b.setStyle(d,{width:e+"px",height:e+"px"});if(e=h("div.node-label",a)[0])l.showLabel?(l.iconScaled&&(g*=this.nodeWidth/120),b.setStyle(e,{"font-size":g+"px",display:"block"})):b.setStyle(e,{"font-size":g+"px",display:"none"});b.setStyle(a,c)},clearPages:function(){k.forEach(this.pages,function(a){this.viewStack.removeView(a.pageNode)},
this);c.empty(this.pointsNode);this.pages=[];this.nodes=[]},createPages:function(a){var b,d,e,g;b=Math.ceil(this.items.length/(a.rows*a.cols));for(d=0;d<b;d++)e=c.create("div",{"class":"page"}),this.createPageItems(d,e,a),this.viewStack.addView(e),1<b&&(g=c.create("div",{"class":"point"},this.pointsNode),this.own(n(g,"click",f.hitch(this,this._onPageNodeClick,d)))),this.pages.push({pageNode:e,pointNode:g});0<this.viewStack.views.length&&this._selectPage(0)},_onPageNodeClick:function(a){this._selectPage(a)},
_selectPage:function(a){1<this.pages.length&&(h(".point",this.domNode).removeClass("point-selected"),b.addClass(this.pages[a].pointNode,"point-selected"));this.viewStack.switchView(this.pages[a].pageNode)},createPageItems:function(a,b,c){var d,e,g;d=this.items.length;e=c.rows*c.cols;c=(a+1)*e;g=c-d;c=Math.min(c,d);for(a*=e;a<c;a++)this.createItemNode(a,b);for(a=d;a<d+g;a++)this.createEmptyItemNode(b)},createItemNode:function(a,g){var d;a=this.items[a];d=c.create("div",{"class":"icon-node jimu-float-leading jimu-main-background",
title:a.label,settingId:a.id},g);g=c.create("img",{src:a.icon},d);window.isRTL&&a.mirrorIconForRTL&&b.addClass(g,"jimu-flipx");c.create("div",{"class":"node-label",title:a.label,innerHTML:e.stripHTML(a.label)},d);d.config=a;this.own(n(d,"click",f.hitch(this,function(){this.onNodeClicked(d)})));this.nodes.push(d)},createEmptyItemNode:function(a){a=c.create("div",{"class":"icon-node jimu-float-leading jimu-main-background"},a);this.nodes.push(a);return a},createCloseBtn:function(){var a;a=c.create("div",
{"class":"close"},this.domNode);c.create("div",{"class":"close-inner jimu-main-background"},a);n(a,"click",f.hitch(this,function(){this.hide()}));return a},hide:function(){b.setStyle(this.domNode,"display","none")},show:function(){b.setStyle(this.domNode,"display","block")},onNodeClicked:function(a){this.hide()},_calculateGridParam:function(){var a,c,e,g,h=!1,f=!0;a=b.getContentBox(jimuConfig.mapId);c=Math.min(a.w,a.h)-40;if(360<=c)g=120;else{g=Math.floor(c/3);if(10>g)return null;h=!0;80>g&&(f=!1)}c=
Math.floor((a.h-40)/g);e=Math.floor((a.w-40)/g);c=4<c?4:c;c=3>c?3:c;e=3>c?3:4<e?4:e;return{rows:c,cols:e,cellSize:g,iconScaled:h,showLabel:f,position:{top:(a.h-g*c)/2,bottom:(a.h-g*c)/2,left:(a.w-g*e)/2,right:(a.w-g*e)/2,width:g*e-this.margin*(e-1)/2,height:g*c-this.margin*(c-1)/2,zIndex:111}}}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(r,f,k,b,n){return r(n,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",
_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);b.forEach(this.views,f.hitch(this,function(b){1===b.nodeType?(k.place(b,this.domNode),k.addClass(b,"view"),k.setStyle(b,"display","none")):b.domNode&&(k.place(b.domNode,this.domNode),k.addClass(b.domNode,"view"),k.setStyle(b.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var b=
"",h=this.getSelectedView();h&&(b=h.label);return b},getViewByLabel:function(b){for(var c=0;c<this.views.length;c++)if(b===this.views[c].label)return this.views[c];return null},addView:function(b){this.views.push(b);1===b.nodeType?(k.place(b,this.domNode),k.addClass(b,"view")):b.domNode&&(k.place(b.domNode,this.domNode),k.addClass(b.domNode,"view"))},removeView:function(c){var f=this.views.length;this.views=b.filter(this.views,function(b){return c!==b});f!==this.views.length&&(1===c.nodeType?k.destroy(c):
c.domNode&&c.destroyRecursive())},switchView:function(b){var c,p;c="number"===typeof b?this.views[b]:"string"===typeof b?this.getViewByLabel(b):b;this.views.forEach(f.hitch(this,function(a){a&&(1===a.nodeType?p=a:a.domNode&&(p=a.domNode),a===c?(k.setStyle(p,"display","block"),a.domNode&&!a._started&&(a.startup(),a._started=!0)):k.setStyle(p,"display","none"))}));this._currentView=c;this.onViewSwitch(c)},onViewSwitch:function(){}})})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),
function(r,f,k,b,n){function c(a){for(;a.childNodes[0]&&1==a.childNodes[0].nodeType;)a=a.childNodes[0];return a}function h(a,c){"string"==typeof a?(a=b.toDom(a,c&&c.ownerDocument),11==a.nodeType&&(a=a.childNodes[0])):1==a.nodeType&&a.parentNode&&(a=a.cloneNode(!1));return a}var p=r.NodeList;f.extend(p,{_placeMultiple:function(a,c){a="string"==typeof a||a.nodeType?r(a):a;for(var e=[],g=0;g<a.length;g++)for(var f=a[g],l=this.length,k=l-1,h;h=this[k];k--)0<g&&(h=this._cloneNode(h),e.unshift(h)),k==l-
1?b.place(h,f,c):f.parentNode.insertBefore(h,f),f=h;e.length&&(e.unshift(0),e.unshift(this.length-1),Array.prototype.splice.apply(this,e));return this},innerHTML:function(a){return arguments.length?this.addContent(a,"only"):this[0].innerHTML},text:function(a){if(arguments.length){for(var b=0,c;c=this[b];b++)1==c.nodeType&&n.set(c,"textContent",a);return this}for(var d="",b=0;c=this[b];b++)d+=n.get(c,"textContent");return d},val:function(a){if(arguments.length){for(var b=f.isArray(a),c=0,d;d=this[c];c++){var h=
d.nodeName.toUpperCase(),l=d.type,p=b?a[c]:a;if("SELECT"==h)for(h=d.options,l=0;l<h.length;l++){var n=h[l];n.selected=d.multiple?-1!=k.indexOf(a,n.value):n.value==p}else"checkbox"==l||"radio"==l?d.checked=d.value==p:d.value=p}return this}if((d=this[0])&&1==d.nodeType){a=d.value||"";if("SELECT"==d.nodeName.toUpperCase()&&d.multiple){a=[];h=d.options;for(l=0;l<h.length;l++)n=h[l],n.selected&&a.push(n.value);a.length||(a=null)}return a}},append:function(a){return this.addContent(a,"last")},appendTo:function(a){return this._placeMultiple(a,
"last")},prepend:function(a){return this.addContent(a,"first")},prependTo:function(a){return this._placeMultiple(a,"first")},after:function(a){return this.addContent(a,"after")},insertAfter:function(a){return this._placeMultiple(a,"after")},before:function(a){return this.addContent(a,"before")},insertBefore:function(a){return this._placeMultiple(a,"before")},remove:p.prototype.orphan,wrap:function(a){if(this[0]){a=h(a,this[0]);for(var b=0,e;e=this[b];b++){var d=this._cloneNode(a);e.parentNode&&e.parentNode.replaceChild(d,
e);c(d).appendChild(e)}}return this},wrapAll:function(a){if(this[0]){a=h(a,this[0]);this[0].parentNode.replaceChild(a,this[0]);a=c(a);for(var b=0,e;e=this[b];b++)a.appendChild(e)}return this},wrapInner:function(a){if(this[0]){a=h(a,this[0]);for(var b=0;b<this.length;b++){var c=this._cloneNode(a);this._wrap(f._toArray(this[b].childNodes),null,this._NodeListCtor).wrapAll(c)}}return this},replaceWith:function(b){b=this._normalize(b,this[0]);for(var a=0,c;c=this[a];a++)this._place(b,c,"before",0<a),c.parentNode.removeChild(c);
return this},replaceAll:function(b){b=r(b);for(var a=this._normalize(this,this[0]),c=0,d;d=b[c];c++)this._place(a,d,"before",0<c),d.parentNode.removeChild(d);return this},clone:function(){for(var b=[],c=0;c<this.length;c++)b.push(this._cloneNode(this[c]));return this._wrap(b,this,this._NodeListCtor)}});p.prototype.html||(p.prototype.html=p.prototype.innerHTML);return p})},"themes/JewelryBoxTheme/widgets/HeaderController/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:themes/JewelryBoxTheme/widgets/HeaderController/Widget.html":'\x3cdiv\x3e\r\n  \x3c!-- solve the bug of style delay loading --\x3e\r\n  \x3cdiv class\x3d"header-section jimu-float-leading" data-dojo-attach-point\x3d"headerNode"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"logoLinkNode" target\x3d"_blank"\x3e\r\n      \x3cimg class\x3d"logo jimu-float-leading jimu-leading-margin1" data-dojo-attach-point\x3d"logoNode" data-dojo-attach-event\x3d"onload:_onLogoLoad"\x3e\r\n    \x3c/a\x3e\r\n    \x3cdiv class\x3d"titles jimu-float-leading jimu-leading-margin1" data-dojo-attach-point\x3d"titlesNode"\x3e\r\n      \x3cdiv class\x3d"jimu-title jimu-float-leading" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-subtitle jimu-float-leading jimu-leading-margin5" data-dojo-attach-point\x3d"subtitleNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"links jimu-float-leading jimu-leading-margin25" data-dojo-attach-point\x3d"linksNode"\x3e\r\n      \x3cdiv class\x3d"dynamic-section jimu-float-leading" data-dojo-attach-point\x3d"dynamicLinksNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"signin-section jimu-float-leading" data-dojo-attach-point\x3d"signInSectionNode"\x3e\r\n        \x3ca href\x3d"#" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onSigninClick"\r\n        data-dojo-attach-point\x3d"signinLinkNode"\x3e${nls.signin}\x3c/a\x3e\r\n        \x3ca href\x3d"" target\x3d"_blank" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onUserNameClick" data-dojo-attach-point\x3d"userNameLinkNode"\x3e\x3c/a\x3e\r\n        \x3ca href\x3d"#" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onSignoutClick" data-dojo-attach-point\x3d"signoutLinkNode"\x3e${nls.signout}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-section jimu-float-leading" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:themes/JewelryBoxTheme/widgets/HeaderController/css/style.css":".jimu-widget-header-controller{box-shadow: 0px 1px 8px 0px rgba(0, 0, 0, 0.4);}.jimu-widget-header-controller .header-section{height: 100%; overflow: hidden;}.jimu-widget-header-controller .container-section{height: 100%; min-width: 80px;}.jimu-widget-header-controller .logo{cursor: pointer;}.jimu-widget-header-controller .hide-logo{display: none;}.jimu-widget-header-controller .titles{height: 100%; overflow: hidden;}.jimu-widget-header-controller .jimu-title{text-align: center; height: 100%;}.jimu-widget-header-controller .jimu-subtitle{text-align: center; height: 100%;}.jimu-widget-header-controller .links{height: 100%; overflow: hidden;}.jimu-widget-header-controller .dynamic-section,.jimu-widget-header-controller .signin-section{height: 100%;}.jimu-widget-header-controller .links .jimu-link{height: 100%;}.jimu-widget-header-controller .signin-section .jimu-link{color: #d9dde0;}.jimu-widget-header-controller .icon-node{cursor: pointer; opacity: 0.6; text-align: center; border-right: 1px solid #323e4f;}.jimu-widget-header-controller .icon-node img{height: 24px; width: 24px;}.jimu-widget-header-controller .icon-node:first-child{border: none;}.jimu-widget-header-controller .icon-node:hover{opacity: 1;}.jimu-widget-header-controller .icon-node.jimu-state-selected{background-color: rgba(0, 0, 0, 0.3); opacity: 1; border: none; border-top: 2px solid #8491a1;}.jimu-widget-header-controller .drop-triangle{position: absolute; width: 0px; height: 0px; bottom: 1px; border-left: 4px solid transparent; border-right: 4px solid transparent; border-top: 4px solid white;}.jimu-widget-header-controller .jimu-drop-menu{box-shadow: 0px 1px 8px 0px rgba(0, 0, 0, 0.4);}.jimu-widget-header-controller .jimu-drop-menu .menu-item{overflow: hidden; border-top: 1px solid rgba(0, 0, 0, 0.2);}.jimu-widget-header-controller .jimu-drop-menu .menu-item:hover{background-color: rgba(0, 0, 0, 0.2);}.jimu-widget-header-controller .jimu-drop-menu .menu-item img{width: 24px; height: 24px; cursor: pointer; margin: 8px;}.jimu-widget-header-controller .jimu-drop-menu .menu-item .label{cursor: pointer; margin-top: 12px; font-size: 14px; color: white; min-width: 50px; text-align: center; white-space: nowrap; max-width: 300px; text-overflow: ellipsis; overflow: hidden; padding-right: 8px;}.jimu-rtl .jimu-widget-header-controller .jimu-drop-menu .menu-item .label{padding-left: 8px;}.popup-links .popup-title{}.popup-links .logo{*/ height: 30px;}.popup-links .title{color:#fff; text-align: center; font-size: 16px; */ width: 71.42857142857143%; overflow: hidden; white-space: nowrap; height: 100%;}.popup-links .line{width: 100%; height: 4px; border-bottom: 1px solid #393c40;}.popup-links .link-section{width: 100%; height: 66px;}.popup-links a{color: #fff; margin-left: 20px; font-size: 14px; height: 100%; width: 95%; overflow: hidden; display: inline-block;}.popup-links .link-section.signin a{color: #d9dde0;}.jimu-header-more-popup{position: absolute; border-radius: 2px; z-index: 111; background-color: #516070;}.jimu-header-more-popup .pages{position: relative; overflow: hidden; padding: 2px;}.jimu-header-more-popup .points{position: absolute; overflow: hidden; bottom: -15px; left: 0px; right: 0px; text-align: center; background-color: #bababa;}.jimu-header-more-popup .points-inner{display: inline-block; overflow: hidden;}.jimu-header-more-popup .point{float: left; width: 8px; height: 8px; margin-left: 5px; border-radius: 4px; background-color: #f2f6f9; cursor: pointer;}.jimu-header-more-popup .point-selected{background-color: #485566;}.jimu-header-more-popup .page{position: relative; overflow: hidden;}.jimu-header-more-popup .close{position: absolute; top: -3.125%; right: -3.125%; border-radius: 50%; background-color: #697a8c; cursor: pointer;}.jimu-rtl .jimu-header-more-popup .close{left: -04.46428571428571%; right: auto;}.jimu-header-more-popup .close-inner{width: 80%; height: 80%; margin-left: 10%; margin-top: 10%; border-radius: 50%; background: #1d2123 url(images/close.png) no-repeat center center;}.jimu-header-more-popup .icon-node{background-color: #697a8c; cursor: pointer;}.jimu-header-more-popup .icon-node.jimu-state-selected{background-color: red;}.jimu-header-more-popup img{width: 48px; height: 48px; margin: auto; margin-top: 25%; display: block;}.jimu-header-more-popup .node-label{width: 100%; text-align: center; font-size: 16px; margin-top: 5px; color: white; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; display: inline-block;}@media screen and (max-width:600px){.jimu-header-more-popup .node-label{font-size: 14px;}}.jimu-more-icon-cover{z-index: 110; position: absolute; left: 0; top: 0; width: 100%; height: 100%;}.esriPopup .titlePane {background-color: rgba(72, 85, 102, 0.9);}.jimu-widget-header-controller{display: flex !important; justify-content: space-between;}.jimu-widget-header-controller .header-section,.jimu-widget-header-controller .container-section {display: flex; flex-direction: row; align-items: center; flex-wrap: nowrap;}.jimu-widget-header-controller .container-section {flex-direction: row-reverse;}.jimu-widget-header-controller .titles,.jimu-widget-header-controller .links,.jimu-widget-header-controller .icon-node{flex-shrink: 0;}.jimu-widget-header-controller .icon-node{flex-basis: 40px;}",
"*now":function(r){r(['dojo/i18n!*preload*themes/JewelryBoxTheme/widgets/HeaderController/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/aspect dojo/query dojo/on dojo/Deferred dojo/mouse dojo/dom-construct dojo/dom-geometry jimu/BaseWidget jimu/PoolControllerMixin jimu/tokenUtils jimu/portalUtils jimu/portalUrlUtils jimu/utils jimu/dijit/Message ./PopupTileNodes dojo/NodeList-manipulate".split(" "),function(r,f,k,b,n,c,h,p,a,g,e,d,u,l,w,v,t,x,y){return r([d,u],{baseClass:"jimu-widget-header-controller jimu-main-background",maxIconCount:-1,createMoreIcon:!1,
switchableElements:{},height:40,openedId:"",moveTopOnActive:!1,postCreate:function(){this.inherited(arguments);this._processGroupSetting();this.switchableElements.title=this.titleNode;this.switchableElements.links=this.linksNode;this.switchableElements.subtitle=this.subtitleNode;this._handleTitleColorAndLogoLink(this.appConfig);this.position&&this.position.height&&(this.height=this.position.height);b.setStyle(this.signInSectionNode,"display","none");this.appConfig&&this.appConfig.logo?(this.logoNode.src=
this.appConfig.logo,b.removeClass(this.logoNode,"hide-logo")):(this.logoNode.src="",b.addClass(this.logoNode,"hide-logo"));this.switchableElements.title.innerHTML=t.sanitizeHTML(this.appConfig.title?this.appConfig.title:"");this.switchableElements.subtitle.innerHTML=t.sanitizeHTML(this.appConfig.subtitle?this.appConfig.subtitle:"");this._createDynamicLinks(this.appConfig.links);this._setElementsSize();this.own(h(this.domNode,a.enter,f.hitch(this,function(){var b="",a=v.getServerByUrl(this.appConfig&&
this.appConfig.portalUrl||"");v.isArcGIScom(a)&&(a="ArcGIS.com");a&&(b=this.nls.signInTo+" "+a);this.signinLinkNode.title=b})))},startup:function(){this.inherited(arguments);this.resize();setTimeout(f.hitch(this,this.resize),100)},onAction:function(b,a){"highLight"===b&&a&&(a=c('div[settingid\x3d"'+a.widgetId+'"]',this.domNode)[0],this._highLight(a));"removeHighLight"===b&&this._removeHighLight()},onSignIn:function(a){this.inherited(arguments);b.setStyle(this.signinLinkNode,"display","none");b.setStyle(this.userNameLinkNode,
"display","");b.setStyle(this.signoutLinkNode,"display","");this.userNameLinkNode.innerHTML=a.userId;b.setAttr(this.userNameLinkNode,"href",this.appConfig.portalUrl+"home/user.html");this.popupLinkNode&&(b.setStyle(this.popupSigninNode,"display","none"),b.setStyle(this.popupUserNameNode,"display",""),b.setStyle(this.popupSignoutNode,"display",""),c("a",this.popupUserNameNode).html(a.userId).attr("href",this.appConfig.portalUrl+"home/user.html"));this.resize()},onSignOut:function(){this.inherited(arguments);
this._onSignOut(this.nls.signin);w.getPortal(this.appConfig.portalUrl).loadSelfInfo().then(f.hitch(this,function(b){this._onSignOut(this.nls.signInTo+" "+b.name)}),f.hitch(this,function(b){console.error(b)}))},_onSignOut:function(a){b.setStyle(this.signinLinkNode,"display","");b.setAttr(this.signinLinkNode,"innerHTML",a);b.setStyle(this.userNameLinkNode,"display","none");b.setStyle(this.signoutLinkNode,"display","none");this.userNameLinkNode.innerHTML="";this.popupLinkNode&&(b.setStyle(this.popupSigninNode,
"display",""),b.setAttr(this.popupSigninNode,"innerHTML",a),b.setStyle(this.popupUserNameNode,"display","none"),b.setStyle(this.popupSignoutNode,"display","none"),c("a",this.popupUserNameNode).html(""));this.resize()},resize:function(){this._resize()},_resize:function(){var a=b.getContentBox(this.domNode);this._showSwitchableElements(["title","links","subtitle"]);this._createIconNodes(a);this.morePane&&this.morePane.resize();this.popupLinkNode&&b.setStyle(jimuConfig.layoutId,{left:b.getContentBox(this.popupLinkNode).w+
"px"})},destroy:function(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null);this.morePane&&this.morePane.destroy();this.moreIconPaneCoverNode&&(b.destroy(this.moreIconPaneCoverNode),this.moreIconPaneCoverNode=null);this.popupLinkNode&&this.popupLinksVisible&&this._hidePopupLink();b.destroy(this.popupLinkNode);this.inherited(arguments)},onAppConfigChanged:function(b,a,c){switch(a){case "attributeChange":this._onAttributeChange(b,c);break;default:return}this.appConfig=
b;this.resize()},getOpenedIds:function(){this.inherited(arguments);return""===this.openedId?[]:[this.openedId]},setOpenedIds:function(b){if(0!==b.length){var a=this.getConfigById(b[0]);a&&(this.openedId&&this._switchNodeToClose(this.openedId),this.openedId=b[0],a.widgets&&"openAll"===a.openType?this._showIconContent(a):a.widgets||this._showIconContent(a))}},_onLogoLoad:function(){this.resize()},_highLight:function(b){this.hlDiv&&this._removeHighLight();if(b){var a=e.getMarginBox(b);this.hlDiv=g.create("div",
{style:{position:"absolute",left:a.l+"px",top:a.t+"px",width:a.w+"px",height:a.h+"px"},"class":"icon-highlight"},b,"before")}},_removeHighLight:function(){this.hlDiv&&(g.destroy(this.hlDiv),this.hlDiv=null)},_onAttributeChange:function(a,q){"title"in q&&q.title!==this.appConfig.title&&(this.titleNode.innerHTML=t.sanitizeHTML(q.title));"subtitle"in q&&q.subtitle!==this.appConfig.subtitle&&(this.subtitleNode.innerHTML=t.sanitizeHTML(q.subtitle));"logo"in q&&q.logo!==this.appConfig.logo&&(q.logo?(b.setAttr(this.logoNode,
"src",q.logo),b.removeClass(this.logoNode,"hide-logo")):(b.removeAttr(this.logoNode,"src"),b.addClass(this.logoNode,"hide-logo")));"links"in q&&this._createDynamicLinks(q.links);this._handleTitleColorAndLogoLink(a)},_handleTitleColorAndLogoLink:function(a){a.titleColor?b.setStyle(this.titleNode,"color",a.titleColor):b.setStyle(this.titleNode,"color","");a.logoLink?(b.setAttr(this.logoLinkNode,"href",a.logoLink),b.setStyle(this.logoNode,"cursor","pointer")):(b.setAttr(this.logoLinkNode,"href","javascript:void(0)"),
b.setStyle(this.logoNode,"cursor","default"))},_setElementsSize:function(){b.setStyle(this.logoNode,{height:"30px"});b.setStyle(this.titleNode,{lineHeight:this.height+"px"});b.setStyle(this.subtitleNode,{lineHeight:this.height+"px"});c(".jimu-link",this.domNode).style({lineHeight:this.height+"px"})},_processGroupSetting:function(){k.forEach(this.appConfig.widgetPool.groups,function(b){var a;a:{if(this.config.groupSetting)for(a=0;a<this.config.groupSetting.length;a++)if(this.config.groupSetting[a].label===
b.label){a=this.config.groupSetting[a].type;break a}a="openAll"}b.openType=a},this)},_createDynamicLinks:function(a){if(window.isRTL){var m=[];k.forEach(a,function(a){m.unshift(a)});a=m}b.empty(this.dynamicLinksNode);k.forEach(a,function(a){b.create("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",innerHTML:t.sanitizeHTML(a.label),"class":"jimu-link jimu-align-leading jimu-leading-margin1",style:{lineHeight:this.height+"px"}},this.dynamicLinksNode)},this)},_showSwitchableElements:function(a){var m=
this.switchableElements,c;for(c in m)m.hasOwnProperty(c)&&(-1<a.indexOf(c)?(b.setStyle(m[c],"display","block"),m[c].visible=!0):(b.setStyle(m[c],"display","none"),m[c].visible=!1));this.logoClickHandle&&this.logoClickHandle.remove();0>a.indexOf("links")?this.logoClickHandle=h(this.logoNode,"click",f.hitch(this,this._onLogoClick)):this.popupLinksVisible&&this._hidePopupLink()},_switchSignin:function(){var a=l.getPortalCredential(this.appConfig.portalUrl);if(a)this.onSignIn(a);else this.onSignOut()},
_onLogoClick:function(){this.popupLinkNode&&b.destroy(this.popupLinkNode);this.popupLinkNode=this._createPopupLinkNode();this.popupLinksVisible?this._hidePopupLink():this._showPopupLink()},_hidePopupLink:function(){b.setStyle(this.popupLinkNode,"display","none");window.isRTL?b.setStyle(jimuConfig.layoutId,{right:0}):b.setStyle(jimuConfig.layoutId,{left:0});this.popupLinksVisible=!1},_showPopupLink:function(){b.setStyle(this.popupLinkNode,"display","");window.isRTL?b.setStyle(jimuConfig.layoutId,{right:b.getContentBox(this.popupLinkNode).w+
"px"}):b.setStyle(jimuConfig.layoutId,{left:b.getContentBox(this.popupLinkNode).w+"px"});this.popupLinksVisible=!0},_createPopupLinkNode:function(){var a,c;b.getContentBox(jimuConfig.mainPageId);a=b.create("div",{"class":"popup-links jimu-main-background",style:{position:"absolute",zIndex:100,top:0,bottom:0}},jimuConfig.mainPageId);window.isRTL?b.setStyle(a,{right:0,left:"50px"}):b.setStyle(a,{left:0,right:"50px"});c=b.create("div",{"class":"popup-title",style:{height:this.height+"px",width:"100%"}},
a);var d=b.create("img",{"class":"logo jimu-float-leading jimu-leading-margin1",src:this.appConfig.logo?this.appConfig.logo:this.folderUrl+"images/app-logo.png",style:{width:"30px",height:"30px",marginTop:(this.height-30)/2+"px"}},c),e=b.create("div",{"class":"title jimu-float-leading jimu-leading-margin1 jimu-ellipsis",innerHTML:t.sanitizeHTML(this.appConfig.title),style:{lineHeight:this.height+"px"}},c),f="auto";try{f=b.getMarginBox(c).w-b.getMarginBox(d).w-b.getMarginExtents(e).w+"px"}catch(z){console.error(z),
f="auto"}b.setStyle(e,"width",f);k.forEach(this.appConfig.links,function(b){this._createLinkNode(a,b,!1)},this);this._createLinkNode(a,{label:"",url:"#"},!1);return a},_createLinkNode:function(a,c,d){a=b.place('\x3cdiv class\x3d"jimu-link"\x3e\x3c/div\x3e',a);b.place('\x3cdiv class\x3d"line"\x3e\x3c/div\x3e',a);d=b.place('\x3cdiv class\x3d"'+(d?"link-section signin":"link-section")+'"\x3e\x3c/div\x3e',a);b.create("a",{href:c.url,"class":"jimu-ellipsis",target:"_blank",rel:"noopener noreferrer",innerHTML:t.sanitizeHTML(c.label),
title:c.label,style:{lineHeight:"66px"}},d);return a},_onSigninClick:function(){l.signInPortal(this.appConfig.portalUrl,this.appConfig.appId)},_onSignoutClick:function(){this.appConfig.mode?new x({message:this.nls.cantSignOutTip}):l.signOutAll()},_onUserNameClick:function(){},_getHeaderSectionWidth:function(){return b.getMarginBox(this.headerNode).w},_getContainerWidth:function(a){var b=this._getHeaderSectionWidth();return a.w-b-this._getEmptyWidth(a)},_calcContainerAndEmptyWidth:function(a){var b=
this._getContainerWidth(a),c=this._getEmptyWidth(a);b<2*this.iconWidth&&(this.switchableElements.subtitle.visible?(this._showSwitchableElements(["title","links"]),b=this._getContainerWidth(a),b<2*this.iconWidth&&(this._showSwitchableElements(["title"]),b=this._getContainerWidth(a),b<2*this.iconWidth&&(this._showSwitchableElements([]),b=this._getContainerWidth(a),b<2*this.iconWidth&&(c-=2*this.iconWidth-b,b=2*this.iconWidth,this._getContainerWidth(a))))):(this._showSwitchableElements([]),b=this._getContainerWidth(a),
b<2*this.iconWidth&&(c-=2*this.iconWidth-b,b=2*this.iconWidth)));return{containerWidth:b,emptyWidth:c}},_getEmptyWidth:function(a){return.1*a.w},_createIconNodes:function(a){c(".icon-node",this.containerNode).remove();var b,m=this.getAllConfigs();this.iconWidth=a.h;a=this._calcContainerAndEmptyWidth(a);this.maxIconCount=Math.floor(a.containerWidth/this.iconWidth);this.maxIconCount>=m.length?(this.headerIconCount=m.length,this.createMoreIcon=!1):(this.headerIconCount=this.maxIconCount-1,this.createMoreIcon=
!0);this.createMoreIcon&&this._createIconNode({label:this.nls.more,name:"__more"});var d;for(a=this.headerIconCount-1;0<=a;a--){b=m[a];var e=this._createIconNode(b);b.openAtStart&&(d=e)}d&&!this.openAtStartWidget&&(this.openAtStartWidget=d.config.id,this._onIconClick(d));this.openedId&&this.getConfigById(this.openedId)&&!1===this.getConfigById(this.openedId).inPanel&&(m=this._getIconNodeById(this.openedId),d=this.widgetManager.getWidgetById(this.openedId),m&&d?this._setOffPanelWidgetPosition(m,d):
(this.widgetManager.closeWidget(this.openedId),this.openedId=""))},_createIconNode:function(a){var c,m;m="__more"===a.name?this.folderUrl+"images/more_icon.png":a.icon;c=b.create("div",{"class":"icon-node jimu-float-trailing",title:a.label,settingId:a.id,style:{width:this.height+"px",height:this.height+"px"}},this.containerNode);m=b.create("img",{src:m,style:{marginTop:(this.height-24)/2+"px"}},c);window.isRTL&&a.mirrorIconForRTL&&b.addClass(m,"jimu-flipx");"__more"===a.name?h(c,"click",f.hitch(this,
this._showMorePane,a)):h(c,"click",f.hitch(this,function(){this._onIconClick(c)}));c.config=a;c.config.widgets&&1<c.config.widgets.length&&"dropDown"===c.config.openType&&this._createDropTriangle(c);return c},_createDropTriangle:function(a){var c=b.getMarginBox(a);b.create("div",{"class":"drop-triangle",style:{left:c.l+c.w/2-4+"px"}},a)},_onIconClick:function(a){a.config.widgets&&1!==a.config.widgets.length&&"openAll"!==a.config.openType?this.dropMenuNode?this._closeDropMenu():this._openDropMenu(a):
this.openedId&&this.openedId===a.config.id?this._switchNodeToClose(this.openedId):this.openedId?this._switchNodeToClose(this.openedId).then(f.hitch(this,function(){this._closeDropMenu();this._switchNodeToOpen(a.config.id)})):this._switchNodeToOpen(a.config.id)},_closeDropMenu:function(){this.dropMenuNode&&(b.destroy(this.dropMenuNode),this.dropMenuNode=null)},_openDropMenu:function(a){this.dropMenuNode=b.create("div",{"class":"jimu-drop-menu jimu-main-background",title:a.config.label,style:{position:"absolute",
zIndex:"101"}});b.place(this.dropMenuNode,this.containerNode);k.forEach(a.config.widgets,function(a){this._createDropMenuItem(a)},this);this._setDropMenuPosition(a);this.morePane&&this.morePane.hide()},_createDropMenuItem:function(a){var c=b.create("div",{"class":"menu-item",title:a.label,style:{height:this.height+"px"}},this.dropMenuNode);b.create("img",{"class":"jimu-float-leading",src:a.icon},c);b.create("div",{"class":"label jimu-float-leading",innerHTML:t.sanitizeHTML(a.label)},c);this.own(h(c,
"click",f.hitch(this,function(){this._closeDropMenu();this.openedId?this._switchNodeToClose(this.openedId).then(f.hitch(this,function(){this._showIconContent(c.config)})):this._showIconContent(c.config)})));c.config=a;return c},_setDropMenuPosition:function(a){var c={},c=b.getMarginBox(this.dropMenuNode),c=this._getDropdownPosition(a,c);c.zIndex=101;b.setStyle(this.dropMenuNode,t.getPositionStyle(c))},_getDropdownPosition:function(a,c){var d={};a=b.getMarginBox(a);var m=b.getMarginBox(this.domNode);
d.top=this.height+1;window.isRTL?d.right=0>a.l+a.w-c.w?0:a.l+a.w-c.w:a.l+c.w>m.w?d.right=0:d.left=a.l;return d},_switchNodeToOpen:function(a){a=this._getIconNodeById(a);this._showIconContent(a.config)},_switchNodeToClose:function(a){c(".icon-node",this.domNode).removeClass("jimu-state-selected");var b=this.appConfig.getConfigElementById(a);if(b)return!1===b.inPanel?(this.widgetManager.closeWidget(a),this.openedId="",a=new p,a.resolve(),a):this.panelManager.closePanel(a+"_panel");a=new p;a.resolve();
return a},_getIconNodeById:function(a){a=c('.icon-node[settingId\x3d"'+a+'"]',this.domNode);if(0!==a.length)return a[0]},_unSelectIcon:function(a){c('.icon-node[settingId\x3d"'+a+'"]',this.domNode).removeClass("jimu-state-selected");this.openedId=""},_showIconContent:function(a){!1===a.inPanel?this.widgetManager.loadWidget(a).then(f.hitch(this,function(d){this.openedId=a.id;var e=this._getIconNodeById(a.id);c(".icon-node",this.domNode).removeClass("jimu-state-selected");b.addClass(e,"jimu-state-selected");
b.setStyle(d.domNode,"zIndex",101);this._setOffPanelWidgetPosition(e,d);this.widgetManager.openWidget(d);this.own(n.after(d,"onClose",f.hitch(this,function(){this._unSelectIcon(a.id)})))})):this.panelManager.showPanel(a).then(f.hitch(this,function(d){this.openedId=a.id;var e=this._getIconNodeById(a.id);c(".icon-node",this.domNode).removeClass("jimu-state-selected");b.addClass(e,"jimu-state-selected");this.own(n.after(d,"onClose",f.hitch(this,function(){this._unSelectIcon(a.id)})))}))},_setOffPanelWidgetPosition:function(a,
b){a=this._getDropdownPosition(a,this.widgetManager.getWidgetMarginBox(b));b.setPosition(a,this.containerNode)},_showMorePane:function(){var a,c,d=[],e=this.getAllConfigs();for(a=this.headerIconCount;a<e.length;a++)c=e[a],d.push(c);this.morePane&&this.morePane.destroy();this.moreIconPaneCoverNode&&b.destroy(this.moreIconPaneCoverNode);this._closeDropMenu();this.morePane=new y({openedId:this.openedId,items:d});this._createCoverNode();b.place(this.morePane.domNode,jimuConfig.mapId);this.morePane.startup();
n.after(this.morePane,"onNodeClicked",f.hitch(this,function(a){this._moveConfigToHeader(a.config);this._createIconNodes(b.getContentBox(this.domNode));this._onIconClick(this._getIconNodeById(a.config.id))}),!0);n.after(this.morePane,"hide",f.hitch(this,function(){b.destroy(this.moreIconPaneCoverNode)}),!0)},_moveConfigToHeader:function(a){var b=this.getAllConfigs(),c=a.index;a.index=b[this.headerIconCount-1].index;b[this.headerIconCount-1].index=c},_createCoverNode:function(){this.moreIconPaneCoverNode=
b.create("div",{"class":"jimu-more-icon-cover"},jimuConfig.layoutId)}})});